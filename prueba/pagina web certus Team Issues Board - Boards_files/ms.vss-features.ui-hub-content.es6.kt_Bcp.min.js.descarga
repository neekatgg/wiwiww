"use strict";define("VSSUI",["require","exports","OfficeFabric/Button","OfficeFabric/Callout","OfficeFabric/FocusZone","OfficeFabric/Link","OfficeFabric/ResizeGroup","OfficeFabric/Utilities","react","VSS/Core/Util/Object","VSS/Core/Observable","OfficeFabric/ContextualMenu","OfficeFabric/Icon","OfficeFabric/Slider","OfficeFabric/Toggle","OfficeFabric/CommandBar","OfficeFabric/Dropdown","OfficeFabric/Fabric","VSS/Platform/Layout"],(function(e,t,i,s,r,o,n,a,c,l,d,m,h,p,u,b,v,g,P){var _,I,B,f,k,y,C,w,S,x,O,E,A,V,L,T,N;!function(e){_=t[e]={};const d=4;class m extends a.BaseComponent{constructor(e){super(e),this._onPositioned=()=>{this._pickList.focus()},this._onDismiss=()=>{this.closeDropdown()},this.state={calloutIsVisible:!1,itemPicker:e.item.itemPicker,events:this._events,updateDelegate:()=>this.forceUpdate()}}render(){const{getPinElement:e,item:i,width:r,minWidth:o,maxWidth:n,maxHeight:a,pickListClassName:l}=this.props;if(this.state.calloutIsVisible){const d=i.itemPicker;return c.createElement(s.Callout,{isBeakVisible:!1,target:e(),onPositioned:this._onPositioned,onDismiss:this._onDismiss},c.createElement(t.PickList.PickList,{className:(0,t.Util.css)("picker-dropdown",l),ref:e=>this._pickList=e,getActions:()=>d.actions,getListItem:d.getListItem,groups:d.groups,pivots:d.pivots,indicators:d.dropdownIndicators,initiallySelectedItems:d.selectedItem?[d.selectedItem]:void 0,isSearchable:d.isSearchable,items:d.getItems(),searchResultsLoadingText:d.searchResultsLoadingText,noItemsText:d.noItemsText,itemAriaDescription:d.itemAriaDescription,searchNoResultsText:d.searchNoResultsText,searchResultsGroupName:d.searchResultsGroupName,searchTextPlaceholder:d.searchTextPlaceholder,shouldVirtualize:e=>(e||[]).length>50,width:r,minWidth:o,maxWidth:n,maxHeight:a,onFocusLost:this._onDismiss,onSearch:d.onSearch,onSelectionChanged:i.onSelectionChanged,onRenderItemText:d.onRenderItemText,onSelectedPivotChanged:d.onSelectedPivotChanged}))}return null}componentDidMount(){this.props.item.isHeaderPickerItem&&this.props.item.itemPicker&&(this.props.item.itemPicker,this._events.on(this.props.item.itemPicker,t.PickList.PICKER_CHANGE_EVENT,this.state.updateDelegate))}componentWillUnmount(){this.props.item.isHeaderPickerItem&&this.props.item.itemPicker&&this._events.off(this.props.item.itemPicker,t.PickList.PICKER_CHANGE_EVENT,this.state.updateDelegate)}componentWillReceiveProps(e){this.props.item.isHeaderPickerItem&&this.props.item.itemPicker&&this.props.item.itemPicker!==e.item.itemPicker&&(this._events.off(this.props.item.itemPicker,t.PickList.PICKER_CHANGE_EVENT,this.state.updateDelegate),this._events.on(e.item.itemPicker,t.PickList.PICKER_CHANGE_EVENT,this.state.updateDelegate))}openDropdown(){this.props.onPickListOpened&&this.props.onPickListOpened(),this.setState({calloutIsVisible:!0})}closeDropdown(){this.setState({calloutIsVisible:!1}),this.props.onPickListClosed&&this.props.onPickListClosed()}toggleDropdown(){this.state.calloutIsVisible?this.closeDropdown():this.openDropdown()}}class h extends c.Component{constructor(e){super(e),this._pinElements={},this._linkElements={},this._breadcrumbElements={},this._focusedLinkIndex=-1,this._onItemClick=e=>{this.setState({pickerItemKey:e.key},(()=>{this.pickList&&this.pickList.toggleDropdown()}))},this.onRenderItem=(e,i)=>{const{presentationStyles:s,shouldUseFocusZone:r}=this.props,{pickerItemKey:n}=this.state,a=Object.assign({},e);delete a.onClick,delete a.href;const d=this._getIcon(e.leftIconProps),m=i(a),h=m.props&&m.props.className;let p=1&s?"vss-Breadcrumb--itemText-small":"vss-Breadcrumb--itemText vss-HubBreadcrumb--itemText";p=(0,t.Util.css)(p,"ellipsis-text",!!(2&s)&&"vss-Breadcrumb--light");const u=Object.assign(Object.assign({},m.props),{className:(0,t.Util.css)(h,p),style:m.props.style?Object.assign({},m.props.style):{}});this.props.maxItemWidth&&(u.style.maxWidth=this.props.maxItemWidth);const b=c.cloneElement(m,u),v=r?0:-2,g=(0,l.getId)("vss-breadcrumb-item-described-by");if(e.isHeaderPickerItem&&e.itemPicker){const i=!e.nonInteractive&&!!(8&s);let a;return e.nonInteractive||(a=this._onItemClick.bind(this,e)),c.createElement("div",{ref:t=>{t&&(this._pinElements[e.key]=t,this._breadcrumbElements[e.key]=t)},className:(0,t.Util.css)("vss-Breadcrumb--item vss-HubBreadcrumb--item",!a&&"no-click",!!(16&s)&&"vss-Breadcrumb--item-min-height")},c.createElement(o.Link,{key:"BreadcrumbItem$"+e.key,componentRef:t=>{t&&(this._linkElements[e.key]=t)},onClick:a,href:e.href,"aria-haspopup":!0,"aria-expanded":this.state.pickerIsOpen,"aria-label":e.ariaLabel,"aria-describedby":(0,t.Util.getSafeId)(g),tabIndex:v,onFocus:r?void 0:this._onLinkFocus.bind(this,e.key)},c.createElement("div",{className:"vss-Breadcrumb--itemContainer vss-HubBreadcrumb--itemContainer",role:e.role,"aria-level":e.ariaLevel},d,c.createElement(t.TooltipEx.Tooltip,{overflowOnly:!0,text:e.text},b),i&&this._getBreadcrumbIcon(e)),c.createElement("div",{id:(0,t.Util.getSafeId)(g),className:"vss-Breadcrumb--hiddenElement"},e.ariaDescription)),n&&n===e.key&&this._renderPickerDropdown(e),this._getIndicators(e))}return e.onClick||e.href?c.createElement("div",{ref:t=>{t&&(this._breadcrumbElements[e.key]=t)},className:(0,t.Util.css)("vss-Breadcrumb--item vss-HubBreadcrumb--item",!!(16&s)&&"vss-Breadcrumb--item-min-height")},c.createElement(o.Link,{componentRef:t=>{t&&(this._linkElements[e.key]=t)},key:"BreadcrumbItem$"+e.key,onClick:e.onClick,href:e.href,"aria-label":e.ariaLabel,"aria-describedby":(0,t.Util.getSafeId)(g),tabIndex:v,onFocus:r?void 0:this._onLinkFocus.bind(this,e.key)},c.createElement("div",{className:"vss-Breadcrumb--itemContainer"},d,b),c.createElement("div",{id:(0,t.Util.getSafeId)(g),className:"vss-Breadcrumb--hiddenElement"},e.ariaDescription))):c.createElement("div",{ref:t=>{t&&(this._breadcrumbElements[e.key]=t)},className:(0,t.Util.css)("vss-Breadcrumb--item vss-HubBreadcrumb--item",!!(16&s)&&"vss-Breadcrumb--item-min-height"),"aria-label":e.ariaLabel},d,b)},this._onLinkFocus=e=>{this._focusedLinkIndex<0&&(this._focusedLinkIndex=(0,a.findIndex)(this.state.linkItems,(t=>t.key===e)))},this._getCustomDivider=e=>{const i=e.item,{presentationStyles:s}=this.props;return void 0===s||8&s?c.createElement("div",{key:"BreadcrumbItemDivider$"+i.key,className:"vss-Breadcrumb--divider-container",ref:e=>{e&&(this._pinElements[i.key]=e,this._breadcrumbElements["BreadcrumbItemDivider$"+i.key]=e)}},this._getDividerButtonOrIcon(i)):c.createElement("div",{ref:e=>{e&&(this._breadcrumbElements["BreadcrumbItemDivider$"+i.key]=e)},key:"BreadcrumbItemDivider$"+i.key,className:(0,t.Util.css)("vss-Breadcrumb--divider vss-HubBreadcrumb--divider",!!(4&s)&&"vss-Breadcrumb--divider-extra-padding",!!(2&s)&&"vss-Breadcrumb--divider-light")},this._getBreadcrumbIcon(i))},this._onKeyDown=e=>{const{linkItems:t}=this.state;37===e.which&&this._focusedLinkIndex>0&&(this.props.extraContentSelected&&this.props.onExtraContentSelectionChanged(!1),this._linkElements[t[--this._focusedLinkIndex].key].focus(),e.preventDefault()),39===e.which&&this._focusedLinkIndex>=0&&(this._focusedLinkIndex<t.length-1?(this._linkElements[t[++this._focusedLinkIndex].key].focus(),e.preventDefault()):this._focusedLinkIndex===t.length-1&&this._isExtraContentSelectable()&&this.props.onExtraContentSelectionChanged?(this.props.onExtraContentSelectionChanged(!0),this._focusedLinkIndex++,e.preventDefault()):this.props.extraContentSelected&&this.props.onExtraContentSelectionChanged(!1)),40===e.which&&this._focusedLinkIndex>=0&&!this.props.extraContentSelected&&this._onItemClick(t[this._focusedLinkIndex])},this._onBlur=()=>{this.state.pickerIsOpen||this.props.extraContentSelected||(this._focusedLinkIndex=-1)},this._dataDidRender=e=>{const{dataDidRender:t}=this.props;if(t){let i=0;1===e.renderedItems.length?i=this._breadcrumbElements[e.renderedItems[0].key].clientWidth:Object.keys(this._breadcrumbElements).map(((e,t)=>{i+=this._breadcrumbElements[e].clientWidth})),t(e,i)}};const i=h._arrangeItems(e.items);this.state={pickerIsOpen:!1,pickerItemKey:null,displayedItems:i,linkItems:h._getLinkItems(i)}}static getDerivedStateFromProps(e,t){const i=h._arrangeItems(e.items);return Object.assign(Object.assign({},t),{displayedItems:i,linkItems:h._getLinkItems(i)})}componentDidUpdate(e){!e.extraContentSelected&&this.props.extraContentSelected?this._focusedLinkIndex=this.state.linkItems.length:e.extraContentSelected&&!this.props.extraContentSelected&&this._focusedLinkIndex===this.state.linkItems.length&&(this._focusedLinkIndex=-1)}static _getLinkItems(e){return e.filter((e=>e.isHeaderPickerItem&&e.itemPicker||e.href||e.onClick))}_getIcon(e){return e?c.createElement(t.VssIcon.VssIcon,Object.assign({},e,{className:(0,t.Util.css)("vss-Breadcrumb--item-leftIcon vss-HubBreadcrumb--item-leftIcon",e.className)})):null}_renderPickerDropdown(e){const{pickListClassName:t,pickListWidth:i,pickListMinWidth:s,pickListMaxWidth:r,pickListMaxHeight:o}=this.props,n=e.pickerWidth||i||s||this._pinElements[e.key]&&this._pinElements[e.key].clientWidth,a=!r,l=e.pickListClassName||t;return c.createElement(m,{ref:e=>{this.pickList=e},item:e,getPinElement:()=>this._pinElements[e.key],width:a&&n,minWidth:!a&&n,maxWidth:r,maxHeight:o,pickListClassName:l,onPickListClosed:()=>this.setState({pickerIsOpen:!1}),onPickListOpened:()=>this.setState({pickerIsOpen:!0})})}_getBreadcrumbIcon(e){const{pickerItemKey:i}=this.state,{dividerType:s}=this.props;return 1===s?c.createElement("div",{className:"vss-Breadcrumb--forward-slash"},"/"):c.createElement(t.VssIcon.VssIcon,{iconName:e.isHeaderPickerItem||e.key===i&&this.state.pickerIsOpen?"ChevronDown":"ChevronRight",iconType:0,key:"RightIcon$"+e.key,className:(0,t.Util.css)("vss-Breadcrumb--item-dropdown vss-HubBreadcrumb--item-dropdown",e.isHeaderPickerItem&&"vss-Breadcrumb--item-dropdown-with-picker vss-HubBreadcrumb--item-dropdown-with-picker")})}_getDividerButtonOrIcon(e){const{pickerItemKey:i}=this.state,s=this._getBreadcrumbIcon(e);return e.itemPicker?c.createElement(o.Link,{onClick:this._onItemClick.bind(this,e),"aria-expanded":this.state.pickerIsOpen,"aria-label":e.itemPicker.ariaLabel,className:(0,t.Util.css)("vss-Breadcrumb--divider vss-Breadcrumb--divider-link")},s,i&&i===e.key&&e.itemPicker&&this._renderPickerDropdown(e)):s}_getIndicators(e){const i=e.isHeaderPickerItem&&e.itemPicker;return i&&i.selectedItem&&i.selectedItemIndicators&&i.selectedItemIndicators.length?c.createElement(t.ItemIndicator.ItemIndicatorSet,{indicators:i.selectedItemIndicators.map((e=>e.getItemIndicator(i.selectedItem)))}):null}static _arrangeItems(e){const t={};e.forEach((e=>{(!t[e.key]||(t[e.key].priority||0)<=(e.priority||0))&&(t[e.key]=e)}));const i=[];Object.keys(t).forEach((e=>{i.push(t[e])}));return i.some((e=>e.rank>=0))&&i.sort(((e,t)=>(e.rank||Number.MAX_VALUE)-(t.rank||Number.MAX_VALUE))),i}_isExtraContentSelectable(){const e=document.getElementById((0,t.Util.getSafeIdSelector)("breadcrumb-extra-content"));return!!e&&!!e.querySelector('[tabindex="-2"]')}render(){const{ariaLabel:e,className:i,maxDisplayedItems:s=d,onReduceData:r,overflowIndex:o,shouldUseFocusZone:n,extraContent:a}=this.props;return c.createElement("div",{className:(0,t.Util.css)("vss-Breadcrumb--container vss-HubBreadcrumb--container",i),onKeyDown:n?void 0:this._onKeyDown,onBlur:n?void 0:this._onBlur},c.createElement(u,{onReduceData:r||(e=>{}),dataDidRender:this._dataDidRender,items:this.state.displayedItems,className:(0,t.Util.css)("vss-Breadcrumb vss-HubBreadcrumb"),onRenderItem:this.onRenderItem,ariaLabel:e||t.VSSResourcesVSSUI.BreadcrumbAriaLabel,maxDisplayedItems:s,overflowIndex:o,dividerAs:this._getCustomDivider,shouldUseFocusZone:n,extraContent:a}))}}t[e].VssBreadcrumb=h,h.defaultProps={items:[]};const p=()=>null;class u extends c.Component{constructor(e){super(e),this._focusZone=(0,a.createRef)(),this._onRenderBreadcrumb=e=>{const{ariaLabel:s,dividerAs:o=t.Icon.Icon,onRenderItem:n=this._onRenderItem,overflowAriaLabel:a,overflowIndex:l,className:d,shouldUseFocusZone:m,extraContent:h}=e.props,{renderedOverflowItems:u,renderedItems:b}=e,v=u.map(((e,t)=>({name:e.text,key:e.key,onClick:e.onClick?this._onBreadcrumbClicked.bind(this,e):null,href:e.href}))),g=b.length-1,P=u&&0!==u.length,_=b.map(((e,t)=>c.createElement("li",{className:"internal-breadcrumb--listItem",key:e.key||String(t)},n(e,this._onRenderItem),(t!==g||P&&t===l-1)&&c.createElement(o,{className:"internal-breadcrumb--chevron",iconName:"ChevronRight",item:e}))));P&&_.splice(l,0,c.createElement("li",{className:"internal-breadcrumb--overflow",key:"overflow"},c.createElement(i.IconButton,{className:"internal-breadcrumb--overflowButton",iconProps:{iconName:"More"},role:"button","aria-haspopup":"true",ariaLabel:a,onRenderMenuIcon:p,menuProps:{items:v,directionalHint:4}}),l!==g+1&&c.createElement(o,{className:"internal-breadcrumb--chevron",iconName:"ChevronRight",item:u[u.length-1]}))),h&&_.push(c.createElement("li",{key:"breadcrumb-extra-content",id:(0,t.Util.getSafeId)("breadcrumb-extra-content")},h));let I=c.createElement("ol",{className:"internal-breadcrumb--list"},_);return m&&(I=c.createElement(r.FocusZone,{componentRef:this._focusZone,direction:r.FocusZoneDirection.horizontal},I)),c.createElement("div",{className:d,role:"navigation","aria-label":s},I)},this._onRenderItem=e=>c.createElement("span",{className:"internal-breadcrumb--item"},e.text),this._onBreadcrumbClicked=(e,t)=>{e.onClick&&e.onClick(t,e)},u._validateProps(e),this.state={}}render(){const{onReduceData:e,dataDidRender:t,overflowIndex:i,maxDisplayedItems:s,items:r}=this.props,o=[...r],a=o.splice(i,o.length-s),l={props:this.props,renderedItems:o,renderedOverflowItems:a};return c.createElement(n.ResizeGroup,{onRenderData:this._onRenderBreadcrumb,onReduceData:e,dataDidRender:t,data:l,className:"vss-Breadcrumb--resizeGroup"})}static getDerivedStateFromProps(e,t){return u._validateProps(e),t}static _validateProps(e){const{maxDisplayedItems:t,overflowIndex:i,items:s}=e;if(i<0||t>1&&i>t-1||s.length>0&&i>s.length-1)throw new Error("Breadcrumb: overflowIndex out of range")}}u.defaultProps={items:[],maxDisplayedItems:999,overflowIndex:0}}("ComponentsVssBreadcrumbVssBreadcrumb"),function(e){I=t[e]={};class i extends a.BaseComponent{constructor(e){super(e)}getIcon(){if(this.props.iconProps){const e=Object.assign(Object.assign({},this.props.iconProps),{className:(0,t.Util.css)(this.props.iconProps.className,"vss-HubTitle-titleIcon")});return c.createElement(t.VssIcon.VssIcon,Object.assign({},e))}return null}getTitleText(){return c.createElement("div",{className:"vss-HubTitle--titleText"},this.props.titleText)}render(){const e=(0,t.Util.css)("vss-HubTitle");return c.createElement("h1",{className:e,onClick:this.props.onClick},this.getIcon(),this.getTitleText())}}t[e].HubTitle=i}("ComponentsHubHeaderHubTitle"),function(e){B=t[e]={};class i extends a.BaseComponent{constructor(e){super(e),this.dataDidRender=(e,t)=>{const{breadcrumbProps:i,breadcrumbDataDidRender:s}=this.props,{canBreadcrumbShrink:r}=this.state;if(i&&i.onReduceData){const t=i.onReduceData(e);void 0===t&&r?this.setState({canBreadcrumbShrink:!1}):void 0===t||r||this.setState({canBreadcrumbShrink:!0})}s&&s(e,t)},this.onSelectionChanged=e=>{const{headerItemPicker:t}=this.state;let i=!1;return t&&t.onSelectedItemChanged&&(i=!0===t.onSelectedItemChanged(e.selectedItems&&e.selectedItems.length>0?e.selectedItems[0]:null),this._hubBreadcrumb&&this._hubBreadcrumb.pickList&&this._hubBreadcrumb.pickList.closeDropdown()),i},this.onHeaderPickerChanged=e=>{this.setState({headerItemPicker:e})},this.state={headerItemPicker:d.ObservableLike.getValue(this.props.headerItemPicker),canBreadcrumbShrink:!0}}componentWillMount(){d.ObservableLike.subscribe(this.props.headerItemPicker,this.onHeaderPickerChanged)}componentWillUnmount(){d.ObservableLike.unsubscribe(this.props.headerItemPicker,this.onHeaderPickerChanged)}componentWillReceiveProps(e){this.props.headerItemPicker!==e.headerItemPicker&&(this.setState({headerItemPicker:d.ObservableLike.getValue(e.headerItemPicker)}),d.ObservableLike.unsubscribe(this.props.headerItemPicker,this.onHeaderPickerChanged),d.ObservableLike.subscribe(e.headerItemPicker,this.onHeaderPickerChanged))}getTitle(){return this.props.breadcrumbItems&&this.props.breadcrumbItems.length>0||this.props.headerItemPicker?this.getBreadcrumb():this.props.title?c.createElement(I.HubTitle,{titleText:this.props.title,iconProps:this.props.iconProps}):(console.log("Must use title or breadcrumb items + headerItemPicker"),null)}getBreadcrumb(){let e=this.props.breadcrumbItems?[...this.props.breadcrumbItems]:[];const{maxBreadcrumbItemWidth:t,collapseBreadcrumb:i,iconProps:s,pickListClassName:r,pickListMinWidth:o,pickListMaxWidth:n,pickListMaxHeight:a,title:l,hubBreadcrumbAriaLabel:d,breadcrumbProps:m}=this.props,{headerItemPicker:h}=this.state;if(h&&h.getListItem){const t=h.selectedItem&&h.getListItem(h.selectedItem),i=h.selectedItem&&h.getTitleTextForItem?h.getTitleTextForItem(h.selectedItem):t&&t.name,r={key:"title-item",text:l||i,leftIconProps:s,onSelectionChanged:this.onSelectionChanged,itemPicker:h,ariaLabel:h.ariaLabel,isHeaderPickerItem:!0};e.push(r)}else if(l){const t={key:"title-item",text:l,leftIconProps:s};e.push(t)}return i&&(e=e.slice(e.length-1),m&&(m.overflowIndex=0)),c.createElement(_.VssBreadcrumb,Object.assign({},m,{dataDidRender:this.dataDidRender,ref:e=>{this._hubBreadcrumb=e},items:e,maxItemWidth:"string"==typeof t?t:"340px",pickListClassName:r,pickListMinWidth:o,pickListMaxWidth:n,pickListMaxHeight:a,ariaLabel:d,shouldUseFocusZone:!0,presentationStyles:24}))}render(){return c.createElement("div",{className:(0,t.Util.css)("vss-HubHeader",!this.state.canBreadcrumbShrink&&"vss-HubHeader-no-shrink")},this.getTitle(),this.props.children)}}t[e].HubHeader=i}("ComponentsHubHeaderHubHeader"),function(e){f=t[e]={};class i extends a.BaseComponent{render(){const{text:e,secondaryText:i}=this.props,s=(0,t.Util.css)("vss-HubTextTile vss-HubTile");return c.createElement("div",{className:s},c.createElement(t.Dynamic.DynamicText,{text:e,className:(0,t.Util.css)("vss-HubTextTile--primaryText",!this.props.secondaryText&&"vss-HubTextTile--primaryTextOnly")}),c.createElement(t.Dynamic.DynamicText,{text:i,className:"vss-HubTextTile--secondaryText"}))}}t[e].HubTextTile=i}("ComponentsHubHeaderHubTextTile"),function(e){k=t[e]={};class i extends a.BaseComponent{render(){const e=(0,t.Util.css)("vss-HubTileRegion"),i=c.Children.toArray(this.props.children),s=c.Children.map(i||[],((e,t)=>{const i=e.props,s=i&&i.className,r=Object.assign(Object.assign({},i),{className:s?s+" vss-HubTile":"vss-HubTile"});return c.cloneElement(e,r)}));return c.createElement("div",{className:e},s)}}t[e].HubTileRegion=i}("ComponentsHubHeaderHubTileRegion"),y=t[N="ComponentsHubHeaderindex"]={},__exportStar(B,t[N]),__exportStar(f,t[N]),__exportStar(k,t[N]),function(e){C=t[e]={},__exportStar(y,t[e])}("HubHeader"),function(e){w=t[e]={};class i extends a.BaseComponent{render(){return c.createElement("div",Object.assign({},(0,a.getNativeProps)(this.props,a.divProperties),{className:(0,t.Util.css)("vss-PivotBarItem",this.props.className)}),this.props.children)}}t[e].PivotBarItem=i}("ComponentsPivotBarPivotBarItem"),function(e){S=t[e]={};const i="vss-PivotBar--commandBar-item";var s,o;function n(e,s,r,n){let a=[];for(let t of e||[]){const e=o.getInstance(s,t.actionType||0);a=a.concat(e.getVisualization(t,r,n))}return a.forEach((e=>{e.className=(0,t.Util.css)(e.className,i)})),a}function l(e,t,i,s,r){e?e.setViewOption(t,i):"function"==typeof r.onClick&&r.onClick(s,r)}!function(e){e[e.Bar=0]="Bar",e[e.Overflow=1]="Overflow"}(s||(s={})),t[e].mapActionsToItems=function(e,t,i){return n(e,s.Bar,t,i)},t[e].mapItemToActions=function e(t){const i=t.iconProps.iconType,s=i===h.IconType.default||i===h.IconType.Default?0:3,r={key:t.key,name:t.name,href:t.href,title:t.title,iconProps:Object.assign(Object.assign({},t.iconProps),{iconType:s}),onClick:t.onClick,disabled:t.disabled,important:t.important,target:t.target,separator:t.itemType===m.ContextualMenuItemType.Divider};return t.items&&(r.children=t.items.map(e)),r},function(e){const t={};function i(e,t){return`${e}:${t}`}e.register=function(e,s,r){const o=i(e,s);t[o]=r},e.getInstance=function(e,s){const r=i(e,s);let o=t[r];if(!o)throw new Error(`No visualization found for area ${e} and action type ${s}`);return new o}}(o||(o={}));class d{getVisualization(e,i){const r={key:e.key,name:e.name||"",ariaLabel:e.ariaLabel,className:e.actionProps&&e.actionProps.className,title:e.title,onClick:e.onClick,href:e.href,disabled:e.disabled,target:e.target,itemType:e.separator?m.ContextualMenuItemType.Divider:m.ContextualMenuItemType.Normal};if(e.iconProps){const i=Object.assign({},e.iconProps);i.className=(0,t.Util.css)(i.className,"vss-PivotBar--commandBar-icon"),r.iconProps=t.VssIcon.VssIcon.getIconProps(i)}const o=e.actionProps;return o&&o.showChevron&&(r.subMenuProps={items:[]}),Array.isArray(e.children)&&(r.subMenuProps={className:"vss-PivotBar--commandBar-overflow",items:n(e.children,s.Overflow,i)}),[r]}}o.register(s.Bar,0,d),o.register(s.Overflow,0,d);class b{getVisualization(e,t){return[]}getActionProps(e){return e.actionProps||(e.actionProps={on:!1}),e.actionProps}isOn(e,t){return!!t&&!0===t.getViewOption(e)}}o.register(s.Bar,1,class extends b{getVisualization(e,i,s){const r=this.getActionProps(e),o=this.isOn(e.key,i),n=o?t.VSSResourcesVSSUI.PivotBarViewActionOnText:t.VSSResourcesVSSUI.PivotBarViewActionOffText;let a;!1!==r.showText&&(a=n);let d=o?r.onAriaLabel:r.offAriaLabel,m=e.title;void 0===d&&(d=void 0!==m?m:n),void 0===m&&(m=void 0!==d?d:n);let h=o?r.onIconProps:r.offIconProps;h||(h=e.iconProps);return[{key:e.key,onRender:(n,p,u,b)=>{const v=c.createElement(t.Button.Button,{subtle:!0,className:(0,t.Util.css)("vss-PivotBar--commandBar-toggle","pivotBar-toggle-button",r.className),text:a,ariaSetSize:b,ariaPosInSet:u,ariaChecked:o,disabled:e.disabled,iconProps:t.VssIcon.VssIcon.getIconProps(h,"vss-PivotBar--commandBar-icon"),onClick:t=>{l(i,n.key,!this.isOn(n.key,i),t,e),s&&s()},ariaLabel:d,role:"switch",tooltipProps:m?{showOnFocus:!0,text:m}:void 0});return m?c.createElement(t.TooltipEx.Tooltip,{text:m},c.createElement("span",{className:"vss-PivotBar-commandBar-toggle-host"},v)):v}}]}});o.register(s.Overflow,1,class extends b{getVisualization(e,i){const s=this.getActionProps(e);let r=[];const o=s.onText||t.VSSResourcesVSSUI.PivotBarViewActionOnText,n=s.offText||t.VSSResourcesVSSUI.PivotBarViewActionOffText,a=s.onAriaLabel||(e.ariaLabel?e.ariaLabel:null),d=s.offAriaLabel||(e.ariaLabel?e.ariaLabel:null),h={key:e.key,onRender:r=>{const m=c.createElement(u.Toggle,{key:`${e.key}-toggle`,className:(0,t.Util.css)("vss-PivotBar--commandBar-toggle",s.className),styles:{root:{paddingLeft:8,marginTop:4},container:{alignItems:"center"},pill:{fontSize:"15px"}},checked:this.isOn(e.key,i),disabled:e.disabled,onText:o,offText:n,onAriaLabel:a,offAriaLabel:d,onChanged:t=>{l(i,r.key,t,null,e)}});return e.title?c.createElement(t.Tooltip.TooltipHost,{content:e.title,key:`${e.key}-toggle-tooltip`},m):m}};return e.name?r.push({key:e.key,sectionProps:{items:[h],title:e.name,key:`${e.key}-section`},itemType:m.ContextualMenuItemType.Section}):r.push(h),r}});class v{getVisualization(e,t){return[]}getActionProps(e){if(!e.actionProps)throw new Error(`Options must be specified for the choice group ${e.key}`);return e.actionProps}getSelectedOption(e,t,i){const s=(i?i.getViewOption(e):null)||t.defaultSelectedKey;return t.options.filter((e=>e.key===s))[0]||t.options[0]}}class g extends a.BaseComponent{constructor(e){super(e),this._onCycleClick=e=>{this._changeOption(e,this._getNextOptionIndex(this.props.options))},this._onOptionClick=(e,t)=>{e.stopPropagation(),this._changeOption(e,(0,a.findIndex)(this.props.options,(e=>e.key===t.key)))},this._onDropClick=e=>{this.setState({showDropdown:!0,dropTarget:e.currentTarget})},this._onDismiss=e=>{this.setState({showDropdown:!1})},this.state={showDropdown:!1,selectedOptionIndex:this._getSelectedOptionIndex(this.props.options,this.props.defaultSelectedKey)}}componentWillReceiveProps(e){this.setState({showDropdown:!1,selectedOptionIndex:this._getSelectedOptionIndex(e.options,e.defaultSelectedKey)})}render(){const{dropButtonClassName:e,ariaLabel:i,dropButtonAriaLabel:s,options:r}=this.props,{selectedOptionIndex:o,showDropdown:n,dropTarget:a}=this.state,l=r[o];return c.createElement("div",{className:"vss-ChoiceGroupButton"},c.createElement(t.Button.Button,{subtle:!0,ariaLabel:i||s||t.VSSResourcesVSSUI.PivotBarMoreOptionsAriaLabel,"aria-expanded":n,"aria-haspopup":!0,className:(0,t.Util.css)("vss-ChoiceGroupButton--drop",e),text:l.text,onClick:this._onDropClick},(0,t.Icon.Icon)({iconName:"ChevronDown",className:"pivotBar-choice-group-icon"})),n?c.createElement(m.ContextualMenu,{shouldFocusOnMount:!0,isBeakVisible:!1,target:a,onDismiss:this._onDismiss,directionalHint:6,items:r.map((e=>({key:e.key,name:e.text,ariaLabel:e.ariaLabel,isChecked:e===l,canCheck:!0,onClick:this._onOptionClick})))}):null)}_getSelectedOptionIndex(e,t=null){const i=t?(0,a.findIndex)(e,(e=>e.key===t)):-1;return Math.max(i,0)}_getNextOptionIndex(e){let t=this.state.selectedOptionIndex+1;return t===e.length&&(t=0),t}_changeOption(e,t){const{onChange:i,options:s}=this.props;this.setState({selectedOptionIndex:t}),i&&i(e,s[t])}}o.register(s.Bar,2,class extends v{getVisualization(e,i){const s=this.getActionProps(e),r=this.getSelectedOption(e.key,s,i);return[{key:e.key,className:(0,t.Util.css)("vss-PivotBar--commandBar-barChoiceGroup",s.className),onRender:(t,o,n,a)=>c.createElement(g,{ariaLabel:t.ariaLabel,"aria-setsize":a,"aria-posinset":n,dropButtonAriaLabel:s.dropButtonAriaLabel,defaultSelectedKey:r.key,options:s.options,dropButtonClassName:"vss-PivotBar--commandBar-barChoiceDrop",onChange:(t,s)=>{l(i,e.key,s.key,t,e)}})}]}});o.register(s.Overflow,2,class extends v{getVisualization(e,t){const i=this.getActionProps(e),s=this.getSelectedOption(e.key,i,t);let r=[];e.name&&r.push({key:`${e.key}-header`,name:e.name,itemType:m.ContextualMenuItemType.Header});for(let o of i.options)r.push({key:o.key,name:o.text,ariaLabel:o.ariaLabel,isChecked:o===s,canCheck:!0,title:o.title,onClick:(i,s)=>{l(t,e.key,s.key,i,e),t&&i&&i.preventDefault()}});return r}});class P{getActionProps(e){const t=e.actionProps;if(!t||!t.text)throw new Error(`Text must be specified through actionProps for ${e.key}`);return t}getVisualization(e,i){const s=this.getActionProps(e);return[{key:e.key,className:"vss-PivotBar--commandBar-text",onRender:i=>{const r=c.createElement(t.Dynamic.DynamicText,{className:s.className,key:`${e.key}-text`,text:s.text});return e.title?c.createElement(t.TooltipEx.Tooltip,{text:e.title,key:`${e.key}-tooltip`},c.createElement("span",null,r)):r}}]}}o.register(s.Bar,3,P),o.register(s.Overflow,3,P);class _ extends a.BaseComponent{constructor(){super(...arguments),this._onOuterKeyDown=e=>{13===e.which&&this._innerFocus&&(this._innerFocus.focus(),e.preventDefault(),e.stopPropagation())},this._onInnerKeyDown=e=>{27===e.which&&this._outerFocus&&(this._outerFocus.focus(),e.preventDefault(),e.stopPropagation())}}render(){return c.createElement(t.TooltipEx.Tooltip,{text:this.props.title},c.createElement("div",{ref:e=>this._outerFocus=e,onKeyDown:this._onOuterKeyDown,"data-is-focusable":!0,className:"vss-PivotBarSlider"},c.createElement(r.FocusZone,{componentRef:e=>this._innerFocus=e,onKeyDown:this._onInnerKeyDown,direction:r.FocusZoneDirection.horizontal},c.createElement(p.Slider,Object.assign({},this.props)))))}}class I{getActionProps(e){return e.actionProps||(e.actionProps={}),e.actionProps}getValue(e,t){return t&&t.getViewOption(e)||0}get useLabel(){return!0}getVisualization(e,i){const s=this.getActionProps(e),r=this.getValue(e.key,i);return[{key:e.key,className:"vss-PivotBar--commandBar-barSlider",onRender:(o,n,a,d)=>c.createElement(_,{key:`${e.key}-slider`,className:(0,t.Util.css)("vss-PivotBar--commandBar-slider",s.className),label:this.useLabel?e.name:void 0,value:r,min:s.minValue,max:s.maxValue,step:s.step,ariaLabel:e.ariaLabel,"aria-setsize":d,"aria-posinset":a,title:e.title,showValue:!1,disabled:e.disabled,onChange:t=>{l(i,e.key,t,null,e)}})}]}}o.register(s.Bar,4,class extends I{});o.register(s.Overflow,4,class extends I{get useLabel(){return!1}getVisualization(e,t){const i=super.getVisualization(e,t);return e.name&&i.unshift({key:`${e.key}-header`,name:e.name,itemType:m.ContextualMenuItemType.Header}),i}})}("ComponentsPivotBarPivotBarAction"),function(e){x=t[e]={};class i extends a.BaseComponent{constructor(e){super(e),this._onCommandsChanged=()=>{this.setState({commands:this._getCommands(this.props)})},this._onViewActionsChanged=()=>{this.setState({viewActions:this._getViewActions(this.props)})},this._forceUpdate=()=>{this.forceUpdate()},this.state={commands:this._getCommands(this.props),viewActions:this._getViewActions(this.props)}}componentWillReceiveProps(e){let i=!1;(0,t.Util.arrayEquals)(this.props.commands,e.commands)||(this._unsubscribeItems(this.props.commands,this._onCommandsChanged),this._subscribeItems(e.commands,this._onCommandsChanged),i=!0),(0,t.Util.arrayEquals)(this.props.viewActions,e.viewActions)||(this._unsubscribeItems(this.props.viewActions,this._onViewActionsChanged),this._subscribeItems(e.viewActions,this._onViewActionsChanged),i=!0),this.props.showFilterAction===e.showFilterAction&&this.props.filterBar===e.filterBar||(i=!0),i&&this.setState({commands:this._getCommands(e),viewActions:this._getViewActions(e)})}componentDidMount(){this._subscribeItems(this.props.commands,this._onCommandsChanged),this._subscribeItems(this.props.viewActions,this._onViewActionsChanged)}componentWillUnmount(){this._unsubscribeItems(this.props.commands,this._onCommandsChanged),this._unsubscribeItems(this.props.viewActions,this._onViewActionsChanged)}render(){const{className:e,viewOptions:i,filterBar:s,hasAppliedFilter:r,showFilterAction:o,onShowFilterBarClicked:n,showFilterBarViewOptionKey:a,prependSeparator:l,role:d,ariaLabel:m,commandsMenuBarAriaLabel:h,inlineFilterAriaLabel:p}=this.props,{commands:u,viewActions:v}=this.state;let g=[],P=[];if(u&&u.length){const e=u.filter((e=>e.important)),t=u.filter((e=>!e.important));g=(0,S.mapActionsToItems)(e,i,this._forceUpdate),P=(0,S.mapActionsToItems)(t,i,this._forceUpdate)}const _=[];if(v&&v.length){_.push(...v.filter((e=>e.important&&1===e.viewActionRenderArea)));const e=v.filter((e=>!e.important));e.length&&_.push({key:"viewOptions",title:t.VSSResourcesVSSUI.PivotBarViewOptionsText,ariaLabel:t.VSSResourcesVSSUI.PivotBarViewOptionsText,actionProps:{className:"vss-PivotBar--viewOptionsMenu"},important:!0,actionType:0,iconProps:{iconName:"Equalizer"},children:e}),_.push(...v.filter((e=>e.important&&1!==e.viewActionRenderArea&&2!==e.viewActionRenderArea)))}o&&!s&&_.push({key:a,important:!0,actionType:1,actionProps:{showText:!1,onAriaLabel:t.VSSResourcesVSSUI.PivotBarFilterActionTextHide,offAriaLabel:t.VSSResourcesVSSUI.PivotBarFilterActionTextShow,onIconProps:{iconName:r?"FilterSolid":"Filter"},offIconProps:{iconName:r?"FilterSolid":"Filter"}},onClick:n}),v&&v.length&&_.push(...v.filter((e=>e.important&&2===e.viewActionRenderArea)));const I=(0,S.mapActionsToItems)(_,i,this._forceUpdate);return s&&I.unshift({className:"vss-PivotBar--inlineFilterBar",key:"filterBar",ariaLabel:p,onRender:()=>s}),g.length||P.length||I.length?c.createElement("div",{className:"vss-PivotBar--right",role:d,"aria-label":m},!(!l||!g.length&&!P.length)&&c.createElement("div",{className:"vss-PivotBar--separator"}),c.createElement(b.CommandBar,{componentRef:e=>{this._commandBar=e},className:(0,t.Util.css)(e),items:g,overflowItems:P,farItems:I,elipisisAriaLabel:t.VSSResourcesVSSUI.PivotBarMoreCommandsAriaLabel,ariaLabel:h})):null}focus(){this._commandBar&&this._commandBar.focus()}_subscribeItems(e,t){(e||[]).forEach((e=>e.subscribe(t)))}_unsubscribeItems(e,t){(e||[]).forEach((e=>e.unsubscribe(t)))}_getCommands(e){const t=[],i=e.commands||[];for(const e of i)t.push(...e.value);return t}_getViewActions(e){const t=[],i=e.viewActions||[];for(const e of i)t.push(...e.value);return t}}t[e].PivotCommandBar=i}("ComponentsPivotBarPivotCommandBar"),function(e){O=t[e]={};t[e].MAX_PIVOT_WAIT=1e3;class i extends a.BaseComponent{constructor(e){super(e),this._subscribedToPivotObservables=!1,this._pivotSelected=!1,this._pivotItemsRendered={},this._pivotHeader=(0,a.createRef)(),this._onFilterBarDismissClicked=()=>{const{showFilterBarViewOptionKey:e,viewOptions:t}=this.props;t&&e&&this.props.viewOptions.setViewOption(e,!1),this._commandBar&&this._commandBar.focus(),this.setState({showFilterBar:!1})},this._onDropDownSelected=e=>{const t=e.key;this._updateSelectedItem(t,null)},this._renderPivotItem=(e,i)=>{const s=e.itemKey,r=this.state.selectedPivot===s;return c.createElement(t.Dynamic.DynamicLink,{url:e.url,className:(0,t.Util.css)("vss-PivotBar--itemLink",e.child&&e.child.props.headerClassName),tabIndex:-1,role:"presentation","data-is-focusable":!1,key:s},c.createElement(t.Button.Button,{id:e.id,className:(0,t.Util.css)("vss-PivotBar--button",r?"selected":""),onClick:this._onPivotClick.bind(this,s),ariaLabel:e.ariaLabel,role:"tab",ariaSelected:r,ariaPosInSet:i+1,ariaSetSize:this.state.items.length},this._renderPivotItemContent(e)))},this._onShowFilterBarClicked=()=>{this.setState({showFilterBar:!this.state.showFilterBar})},this._onFilterApplied=()=>{const e=this.props.filter.hasChangesToReset();e!==this.state.hasAppliedFilter&&this.setState({hasAppliedFilter:e})},this._onContributedPivotsChanged=()=>{if(this.setState({items:this._getPivotBarItems(this.props)}),this._pivotSelected){if(this.state.selectedPivot&&!this.getSelectedPivot()){let e;this.props.initialSelectedPivot&&this._getPivotBarItemByItemKey(this.props.initialSelectedPivot)?e=this.props.initialSelectedPivot:this.state.items&&this.state.items.length>0&&(e=this.state.items[0].itemKey),e&&this.selectPivot(e)}}else this.setState(this._buildInitialPivotState())},this._onViewOptionChanged=e=>{const{showFilterBarViewOptionKey:t}=this.props,{viewActions:i}=this.state;let s=!1;if(t in e&&(this._focusFilterBar=!0,s=!0),!s){const t=[];i&&i.forEach((e=>t.push(...e.value)));for(const i in e)if((0,a.findIndex)(t,(e=>e.key===i))>=0){s=!0;break}}s&&this.forceUpdate()},this._makeIPivotBarItemFromContribution=(e,t)=>({contributedItem:e,id:this._makeContributedPivotBarItemId(e,t),itemKey:e.itemKey||e.id,groupKey:e.groupKey,name:e.text,order:e.order,ariaLabel:e.ariaLabel,onRenderFilterBar:e.renderFilterBar,commandProviders:e.commandProviders,viewActionProviders:e.viewActionProviders,badgeCount:e.badgeCount,url:e.url,hidden:e.hidden,onBeforePivotChange:e.onBeforePivotChange}),this._getPivotBarItemId=e=>e.contributedItem?e.contributedItem.id:e.itemKey||e.id,this._id=(0,l.getId)("PivotBar"),this._setupPivotObservables(this.props),this._actionsManager=new s,this._disposables.push(this._actionsManager),this.state={items:this._getPivotBarItems(this.props)},this.state=Object.assign({hasAppliedFilter:!!this.props.filter&&this.props.filter.hasChangesToReset(),items:this.state.items},this._buildInitialPivotState())}focus(e){if(this._commandBar&&0===e)this._commandBar.focus()}selectPivot(e){return!!this._getPivotBarItemByItemKey(e)&&(this._updateSelectedItem(e,null),!0)}getSelectedPivot(){return this._getPivotBarItemByItemKey(this.state.selectedPivot)}toggleFilterBar(){this._onShowFilterBarClicked()}componentWillReceiveProps(e){(0,t.Util.arrayEquals)(this.props.pivotProviders,e.pivotProviders)||this._setupPivotObservables(e);const i=this._getPivotBarItems(e);this.setState(((e,t)=>Object.assign({items:i},this._buildInitialPivotState(t,i,!0))))}componentDidMount(){this.props.viewOptions&&this.props.showFilterBarViewOptionKey&&this._events.on(this.props.viewOptions,t.UtilitiesViewOptions.VIEW_OPTIONS_CHANGE_EVENT,this._onViewOptionChanged),this.props.filter&&this.props.filter.subscribe(this._onFilterApplied,t.UtilitiesFilter.FILTER_APPLIED_EVENT),this._updateHeaderTopIfNeeded(),this._subscribeToPivotObservables()}componentDidUpdate(){this._updateHeaderTopIfNeeded(),this.props.onRenderComplete&&this.props.onRenderComplete()}componentWillUnmount(){this.props.viewOptions&&this.props.showFilterBarViewOptionKey&&this._events.off(this.props.viewOptions,t.UtilitiesViewOptions.VIEW_OPTIONS_CHANGE_EVENT,this._onViewOptionChanged),this.props.filter&&this.props.filter.unsubscribe(this._onFilterApplied,t.UtilitiesFilter.FILTER_APPLIED_EVENT),this._contributedPivotWait&&(clearTimeout(this._contributedPivotWait),this._contributedPivotWait=null),this._unsubscribeFromPivotObservables()}render(){let{className:e,filter:i,showPivots:s,showFilterBarViewOptionKey:r,filterBarClassName:o,pivotRenderingModeOptions:n,isCommandBarSticky:a,isPivotBarContentScrollable:l,pivotBarSize:d="compact",canBreadcrumbShrink:m,maxBreadcrumbWidth:h,pivotBarHeaderClassName:p}=this.props,{showFilterBar:u,headerTop:b}=this.state;const v=c.Children.toArray(this.props.children)||[],g=v.filter((e=>"object"!=typeof e||e.type!==w.PivotBarItem&&e.type!==t.FilterBar.FilterBar&&e.type!==C.HubTileRegion));let P=null;const _=this._getHubTileRegionIndex(v);_>-1&&(P=v[_]);let I=null,B=_>-1;void 0===s?s=this.state.items&&this.state.items.length>1:B=B&&s,s&&(I=this._renderPivotItems(n)),this._singleLineMode=!s&&!B;const f=this._singleLineMode?"vss-PivotBar--bar-one-line":"vss-PivotBar--bar-two-line";let k;this.props.viewOptions&&r&&(u=this.props.viewOptions.getViewOption(r));const y=this._getFilterBarSettings(v),S=y&&y.showInline,x=!1===this.props.isPivotBarContentScrollable&&!!a;y&&(u||y.showInline)&&(k=y.filterBarElement,k=c.cloneElement(k,{className:(0,t.Util.css)(k.props.className,o),filter:k.props.filter||i,onDismissClicked:this._onFilterBarDismissClicked,onMounted:e=>{!S&&this._focusFilterBar&&e.focus()}}),x&&(k=c.createElement("div",{className:"vss-PivotBar--filter-sticky"},k)));const O=!(!I&&!this._singleLineMode),E=x?"sticky":"";let A={};this._singleLineMode&&h&&(A={maxWidth:`${h}px`});return n&&2===n.mode?c.createElement("div",{className:(0,t.Util.css)("vss-PivotBar",e)},c.createElement("div",{className:(0,t.Util.css)(p,"vss-PivotBar--header vertical")},g,B&&P),c.createElement("div",{className:"vss-PivotBar--pivotsContainer vertical"},I,c.createElement("div",{className:"vss-PivotBar--barAndContentContainer"},c.createElement("div",{className:(0,t.Util.css)("vss-PivotBar--bar",d)},this._renderCommandBar(S?k:null,!!y,!1),S?null:k),this._renderContent()))):c.createElement("div",{className:(0,t.Util.css)("vss-PivotBar",e)},c.createElement("div",{className:(0,t.Util.css)(f,E,!u&&"bottom-border"),style:{top:this._singleLineMode?0:b}},c.createElement("div",{className:(0,t.Util.css)(p,"vss-PivotBar--header",m&&this._singleLineMode&&"can-shrink"),ref:this._pivotHeader,style:A},g,B&&P),c.createElement("div",{className:(0,t.Util.css)("vss-PivotBar--bar",d)},I,this._renderCommandBar(S?k:null,!!y,O))),S?null:k,this._renderContent())}_updateHeaderTopIfNeeded(){!1===this.props.isPivotBarContentScrollable&&this.props.isCommandBarSticky&&void 0===this.state.headerTop&&!this._singleLineMode&&this.setState({headerTop:`-${this._pivotHeader.current.clientHeight}px`})}_renderPivotItems(e){return e&&1===e.mode?this._renderDropdown(e.props):e&&2===e.mode?this._renderVerticalTabs():this._renderHorizontalTabs()}_renderDropdown(e){const i=[];if(this.state.items.length>0){let e=this.state.items[0].groupKey;for(const t of this.state.items){const{name:s,itemKey:r,groupKey:o}=t;e!==o&&(i.push({key:`${o}-separator`,text:"-",itemType:v.DropdownMenuItemType.Divider}),e=o),i.push({key:r,text:s})}}return c.createElement(v.Dropdown,{ariaLabel:t.VSSResourcesVSSUI.PivotItemAriaLabel,className:"vss-PivotBar--dropdown",selectedKey:this.state.selectedPivot,options:i,onChanged:this._onDropDownSelected,dropdownWidth:e.dropdownWidth})}_pivotCompare(e,t){return(void 0===e?100:e)-(void 0===t?100:t)}_renderHorizontalTabs(){const e=this.state.items?this.state.items.sort(((e,t)=>this._pivotCompare(e.order,t.order))):null,{pivotBarSize:i="compact",headerAriaLabel:s}=this.props;let o;if(this.state.items&&this.state.selectedPivot&&this.props.autoFocus){const e=this._getPivotBarItemByItemKey(this.state.selectedPivot);e&&(o=(0,t.Util.getSafeIdSelector)(e.id))}return c.createElement("div",{role:"navigation","aria-label":s},c.createElement(r.FocusZone,{key:o,className:(0,t.Util.css)("vss-PivotBar--pivots",i),role:"tablist",direction:r.FocusZoneDirection.horizontal,defaultActiveElement:o},e&&e.map(this._renderPivotItem)))}_renderVerticalTabs(){let e=[];const i={};let s;if(this.props.pivotRenderingModeOptions&&this.props.pivotRenderingModeOptions.props){const{groups:t,navAriaLabel:r}=this.props.pivotRenderingModeOptions.props;if(t){for(const e of t)i[e.key]=!0;e=t.sort(((e,t)=>this._pivotCompare(e.rank,t.rank)))}s=r}const o=[],n=this.state.items.reduce(((e,t)=>(t.groupKey&&i[t.groupKey]?(e[t.groupKey]=e[t.groupKey]||[]).push(t):o.push(t),e)),{}),a=[c.createElement(t.DeprecatedAccordion.Accordion,{key:"PivotBarVerticalAccordion",className:"pivot-bar--accordion",initiallyExpandAll:!0,items:e.map((e=>{let t;return n[e.key]&&(n[e.key].sort(((e,t)=>this._pivotCompare(e.order,t.order))),t={key:e.key,title:e.name,onRenderContent:()=>c.createElement("div",{key:t.key,role:"tablist"},n[e.key].map(((t,i)=>this._renderVerticalPivotItem(t,i,n[e.key].length))))}),t})).filter((e=>void 0!==e))})];let l;if(a.push(c.createElement("div",{className:"pivot-bar--ungrouped",key:"PivotBarVerticalUngrouped",role:"tablist"},o.map(((e,t)=>this._renderVerticalPivotItem(e,t,o.length))))),this.state.items&&this.state.selectedPivot){const e=this._getPivotBarItemByItemKey(this.state.selectedPivot);e&&(l=(0,t.Util.getSafeIdSelector)(e.id))}return c.createElement(r.FocusZone,{key:l,direction:r.FocusZoneDirection.vertical,className:"vss-PivotBar--pivots vertical flex-column","aria-label":s,defaultActiveElement:l},a)}_renderVerticalPivotItem(e,i,s){const r=e.itemKey,o=this.state.selectedPivot===r;return c.createElement(t.Dynamic.DynamicLink,{url:e.url,className:(0,t.Util.css)("vss-PivotBar--itemLink-v",e.child&&e.child.props.headerClassName),tabIndex:-1,role:"presentation","data-is-focusable":!1,key:r},c.createElement(t.Button.Button,{subtle:!0,id:e.id,tooltipProps:{text:e.tooltip},className:(0,t.Util.css)("vss-PivotBar--button-v",o?"selected":""),onClick:this._onPivotClick.bind(this,r),ariaLabel:e.ariaLabel,role:"tab",ariaSelected:o,ariaPosInSet:i+1,ariaSetSize:s},c.createElement(t.VssIcon.VssIcon,{className:(0,t.Util.css)("pivotbar-pivot--icon-v",e.iconProps&&e.iconProps.className),iconName:e.iconProps&&e.iconProps.iconName}),c.createElement(t.TooltipEx.Tooltip,{anchorOrigin:{horizontal:"center",vertical:"end"},overflowOnly:!0,text:e.name,tooltipOrigin:{horizontal:"center",vertical:"start"}},c.createElement("div",{className:"flex flex-grow text-ellipsis"},e.name))))}_renderPivotItemContent(e){const{name:i,iconProps:s,badgeCount:r,maxItemWidth:o}=e;let n,a,l;return"string"==typeof r?n=r:"number"==typeof r&&(n=(0,t.UtilitiesFriendlyNumber.getFriendlyDisplayValue)(r),n!==r.toString()&&(a=r.toString())),n&&(l=c.createElement("span",{className:"badge"},n),a&&(l=c.createElement(t.TooltipEx.Tooltip,{text:a},l))),c.createElement("span",{className:"innerContainer"},void 0!==s&&c.createElement(t.VssIcon.VssIcon,Object.assign({className:"icon"},s)),void 0!==i&&c.createElement(t.TooltipEx.Tooltip,{overflowOnly:!0,text:i},c.createElement("span",{className:"text",style:{maxWidth:o||340}},i)),l)}_renderCommandBar(e,t,i){return c.createElement(x.PivotCommandBar,{componentRef:e=>{this._commandBar=e},className:"vss-PivotBar--commandBar",commands:this.state.commands,viewActions:this.state.viewActions,filterBar:e,showFilterAction:void 0===this.props.hideFilterAction&&t,showFilterBarViewOptionKey:this.props.showFilterBarViewOptionKey,hasAppliedFilter:this.state.hasAppliedFilter,prependSeparator:i,viewOptions:this.props.viewOptions,onShowFilterBarClicked:this._onShowFilterBarClicked,role:"region",ariaLabel:this.props.headerAriaLabel,commandsMenuBarAriaLabel:this.state.commandsMenuBarAriaLabel,inlineFilterAriaLabel:this.props.inlineFilterAriaLabel})}_renderContent(){const e=[],i=(this.state.selectedPivot||"").toUpperCase(),s=void 0===this.props.isPivotBarContentScrollable||this.props.isPivotBarContentScrollable;for(const r of this.state.items){const o=r.itemKey.toUpperCase(),n=i===o,a=!n&&1===r.deselectionBehavior&&!0===this._pivotItemsRendered[o];(n||a)&&(e.push(c.createElement("div",{key:o,className:(0,t.Util.css)("vss-PivotBar--content",!s&&"vss-PivotBar--content-unscrollable",a&&"hide-content",this.props.pivotBarContentClassName),role:"tabpanel",tabIndex:-1,"data-is-scrollable":s,"aria-label":this.props.pivotBarContentAriaLabel},r&&(r.child||r.contributedItem.render((0,t.Util.css)("vss-PivotBarItem","content-host"))))),this._pivotItemsRendered[o]=!0)}return e}_makePivotBarItemId(e){return`${this._id}-Tab${e.index}`}_makeContributedPivotBarItemId(e,t){return`${this._id}-ContributedTab${t}`}_getPivotBarItemByItemKey(e,t=this.state.items){const i=(e||"").toUpperCase(),s=(0,a.findIndex)(t,(e=>e.itemKey.toUpperCase()===i));return s>=0?t[s]:void 0}_getPivotBarItems(e){const i={},s=(0,t.UtilitiesChildrenUtils.childrenOfType)(e.children,w.PivotBarItem),r=e=>{const t=e.groupKey||"";let s=i[t];s||(s=[],i[t]=s),s.push(e)};let o=100;for(const e of s){const t=e.item.props;t.hidden||r({child:e.item,id:this._makePivotBarItemId(e),itemKey:t.itemKey,name:t.name,tooltip:t.tooltip,groupKey:t.groupKey,order:null!=t.order?t.order:o++,ariaLabel:t.ariaLabel,iconProps:t.iconProps,badgeCount:t.badgeCount,maxItemWidth:t.maxItemWidth,commands:t.commands,viewActions:t.viewActions,commandProviders:t.commandProviders,viewActionProviders:t.viewActionProviders,deselectionBehavior:t.deselectionBehavior,url:t.url,onBeforePivotChange:t.onBeforePivotChange,onRenderFilterBar:t.onRenderFilterBar,commandsMenuBarAriaLabel:t.commandsMenuBarAriaLabel})}return this._contributedPivots.forEach((e=>e.value.forEach((e=>{e.hidden||r(e)})))),Object.keys(i).reduce(((e,t)=>(i[t].forEach((t=>e.push(t))),e)),[])}_setupPivotObservables(e){let i=0;const s=this._subscribedToPivotObservables;s&&this._unsubscribeFromPivotObservables(),this._contributedPivots=[],e.pivotProviders&&(e.pivotProviders.forEach((e=>{const s=new t.UtilitiesItemContribution.ContributedItemWithIdArray(e,(e=>this._makeIPivotBarItemFromContribution(e,i++)),this._getPivotBarItemId);this._contributedPivots.push(s)})),s&&this._subscribeToPivotObservables())}_unsubscribeFromPivotObservables(){this._contributedPivots.forEach((e=>e.unsubscribe(this._onContributedPivotsChanged))),this._subscribedToPivotObservables=!1}_subscribeToPivotObservables(){this._contributedPivots.forEach((e=>e.subscribe(this._onContributedPivotsChanged))),this._subscribedToPivotObservables=!0}_getFilterBarSettings(e){let i,{onRenderFilterBar:s,showFilterBarInline:r}=this.props;const o=this._getPivotBarItemByItemKey(this.state.selectedPivot);if(o&&o.onRenderFilterBar&&(i=o.onRenderFilterBar()),!i&&s&&(i=s()),!i){const s=(0,a.findIndex)(e,(e=>"object"==typeof e&&e.type===t.FilterBar.FilterBar));if(s>=0){const t=e[s],o=c.Children.toArray(t.props.children);if(o&&o.length>=1&&(i=t,1===o.length&&!r)){const e=o[0];"object"==typeof e&&!0===e.props.isTextItem&&(r=!0)}}}if(i)return{filterBarElement:i,showInline:r}}_getHubTileRegionIndex(e){return(0,a.findIndex)(e,(e=>"object"==typeof e&&e.type===C.HubTileRegion))}_isKeyValid(e,t=this.state.items){return void 0!==e&&void 0!==this._getPivotBarItemByItemKey(e,t)}_buildInitialPivotState(i=this.props,s,r=!1){const o=()=>{const e=s||this._getPivotBarItems(i);return e.length>0?e[0].itemKey:null};let n=null;return i.initialSelectedPivot||i.selectedPivot||(n=o()),!n&&i.initialSelectedPivot&&this._isKeyValid(i.initialSelectedPivot)&&(n=i.initialSelectedPivot),!n&&i.selectedPivot&&this._isKeyValid(i.selectedPivot)&&(n=i.selectedPivot),this._isKeyValid(n,s)||(n=null,this._contributedPivotWait||(this._contributedPivotWait=setTimeout((()=>{this._pivotSelected||(n=o(),n&&this._updateSelectedItem(n,null)),this._contributedPivotWait=null}),t[e].MAX_PIVOT_WAIT))),this._pivotSelected=null!==n,this._buildNewPivotState(i,n,s,r)}_buildNewPivotState(e,t,i,s=!1){const r=this._getPivotBarItemByItemKey(t,i),o=t&&r;return{selectedPivot:o?r.itemKey:"",commands:o?this._actionsManager.getCommandObservables(e.commands,r,s):[],viewActions:o?this._actionsManager.getViewActionObservables(e.viewActions,r,s):[],commandsMenuBarAriaLabel:o?r.commandsMenuBarAriaLabel:void 0}}_onPivotClick(e,t){let i=!0;if(t.ctrlKey){const t=this._getPivotBarItemByItemKey(e);t&&t.url&&("string"==typeof t.url||t.url.value)&&(i=!1)}i&&(t.preventDefault(),this._updateSelectedItem(e,t))}_updateSelectedItem(e,t){const i=this._getPivotBarItemByItemKey(e);if(i&&(this.props.onBeforePivotChange||i.onBeforePivotChange)){const s=i&&i.url&&("string"==typeof i.url?i.url:i.url.value);if(i.onBeforePivotChange&&!i.onBeforePivotChange(t,e,s))return;if(this.props.onBeforePivotChange&&!this.props.onBeforePivotChange(t,e,s))return}const s=this.props;this._pivotSelected=!0,this.setState(this._buildNewPivotState(s,e)),s.onPivotClicked&&s.onPivotClicked(t,e)}}t[e].PivotBar=i,i.defaultProps={autoFocus:!0};class s{constructor(){this._commands={},this._viewActions={},this._getPivotActionItemId=e=>e.key}getCommandObservables(e,i,s=!1){const r=i.id;if(!0===s&&delete this._commands[r],!this._commands[r]){const s=[];this._commands[r]=s,s.push(d.ObservableLike.isObservable(e)?e:new d.ObservableArray(e)),s.push(d.ObservableLike.isObservable(i.commands)?i.commands:new d.ObservableArray(i.commands)),i.commandProviders&&i.commandProviders.forEach((e=>{const i=new t.UtilitiesItemContribution.ContributedItemWithIdArray(e,(e=>e),this._getPivotActionItemId);s.push(i)}))}return this._commands[r]}getViewActionObservables(e,i,s=!1){const r=i.id;if(!0===s&&delete this._viewActions[r],!this._viewActions[r]){const s=[];this._viewActions[r]=s,s.push(d.ObservableLike.isObservable(i.viewActions)?i.viewActions:new d.ObservableArray(i.viewActions)),s.push(d.ObservableLike.isObservable(e)?e:new d.ObservableArray(e)),i.viewActionProviders&&i.viewActionProviders.forEach((e=>{const i=new t.UtilitiesItemContribution.ContributedItemArray(e,(e=>e));s.push(i)}))}return this._viewActions[r]}dispose(){this._commands=null,this._viewActions=null}}}("ComponentsPivotBarPivotBar"),function(e){E=t[e]={},__exportStar(O,t[e]),__exportStar(S,t[e]),__exportStar(w,t[e]),__exportStar(x,t[e])}("ComponentsPivotBarindex"),function(e){A=t[e]={},__exportStar(E,t[e])}("PivotBar"),function(e){V=t[e]={};class i extends a.BaseComponent{constructor(e){super(e),this._wireDataDidRender=e=>c.cloneElement(e,{breadcrumbDataDidRender:(t,i)=>{this._dataDidRender(t,i);const s=e;s&&s.props&&s.props.breadcrumbDataDidRender&&s.props.breadcrumbDataDidRender(t,i)}}),this._dataDidRender=(e,t)=>{const{maxBreadcrumbWidth:i,canBreadcrumbShrink:s}=this.state,{minDisplayedBreadcrumbItems:r=0}=this.props;s&&e.renderedItems.length<=r?this.setState({canBreadcrumbShrink:!1}):!s&&e.renderedItems.length>r&&this.setState({canBreadcrumbShrink:!0});const o=e.renderedItems.length+e.renderedOverflowItems.length;this._breadcrumbItemCount&&o!==this._breadcrumbItemCount?this.setState({maxBreadcrumbWidth:void 0}):0===e.renderedOverflowItems.length&&void 0!==t&&(void 0===i||1===e.renderedItems.length&&t>i)&&this.setState({maxBreadcrumbWidth:t+12}),this._breadcrumbItemCount=o},this._onViewActionObservableChanged=()=>{this._viewActionsObservable.value=[...this._underlyingViewActionsObservable.value,this._getFullScreenViewAction()]},this._onSelectedPivotChanged=e=>{this.setState({selectedPivot:e})},this._onPivotClicked=(e,t)=>{if(t!==this.props.hubViewState.selectedPivot.value)if(this.props.hubViewState.canSwitchPivots(t))this.props.hubViewState.selectedPivot.value=t;else{const e=this.props.hubViewState.selectedPivot.value;this.pivotBar.selectPivot(e)}},this._chromeless=document.body.classList.contains("chromeless"),this.state={viewActions:this._getViewActions(e),selectedPivot:this.props.hubViewState.selectedPivot.value,inFullScreenMode:this.props.hubViewState.viewOptions.getViewOption(t.UtilitiesHubViewState.HubViewOptionKeys.fullScreen),canBreadcrumbShrink:!0}}focus(e){if(0===e)this.pivotBar&&this.pivotBar.focus(e)}componentWillReceiveProps(e){this.props.viewActions!==e.viewActions&&this.setState({viewActions:this._getViewActions(e)})}componentDidMount(){this.props.hubViewState.selectedPivot.subscribe(this._onSelectedPivotChanged),this._events.on(this.props.hubViewState.viewOptions,t.UtilitiesViewOptions.VIEW_OPTIONS_CHANGE_EVENT,this._onViewOptionChanged)}componentDidUpdate(){this._exitingFullScreenMode&&(this._exitingFullScreenMode=!1,this.focus(0))}componentWillUnmount(){this.props.hubViewState.selectedPivot.unsubscribe(this._onSelectedPivotChanged),this._events.off(this.props.hubViewState.viewOptions,t.UtilitiesViewOptions.VIEW_OPTIONS_CHANGE_EVENT,this._onViewOptionChanged),this._underlyingViewActionsObservable&&this._underlyingViewActionsObservable.unsubscribe(this._onViewActionObservableChanged)}render(){const e=c.Children.toArray(this.props.children);this.validateChildren(e);const{className:i,commands:s,hideHeader:r,hubViewState:o,onRenderFilterBar:n,pivotProviders:a,onBeforePivotChange:l,onPivotBarRenderComplete:d,showFilterBarInline:m,showPivots:h,useShadowStyle:p,pivotRenderingModeOptions:u,onRenderSecondaryContent:b,splitterProps:v,scrollableRegion:P,pivotHeaderAriaLabel:_,breadcrumbIsExpandable:I,pivotBarContentAriaLabel:B,inlineFilterAriaLabel:f}=this.props,{selectedPivot:k,viewActions:y,inFullScreenMode:C,maxBreadcrumbWidth:w,canBreadcrumbShrink:S}=this.state;I&&(e[0]=this._wireDataDidRender(e[0]));const x={onPivotClicked:this._onPivotClicked,onBeforePivotChange:l,commands:s,selectedPivot:k,viewOptions:o.viewOptions,filter:o.filter,pivotProviders:a,showPivots:!C&&h,onRenderComplete:d,viewActions:y,onRenderFilterBar:n,showFilterBarInline:m,showFilterBarViewOptionKey:t.UtilitiesHubViewState.HubViewOptionKeys.showFilterBar,filterBarClassName:"vss-Hub--filterBar",pivotRenderingModeOptions:u,pivotBarContentClassName:this.props.pivotBarContentClassName,isPivotBarContentScrollable:1===P,isCommandBarSticky:0===P,pivotBarSize:"tall",headerAriaLabel:_,canBreadcrumbShrink:S,maxBreadcrumbWidth:w,pivotBarHeaderClassName:I&&"vss-PivotBar--header-with-expandable-breadcrumb",pivotBarContentAriaLabel:B,inlineFilterAriaLabel:f},O=c.createElement(A.PivotBar,Object.assign({},x,{className:(0,t.Util.css)("vss-HubPivotBar",0===P&&"vss-HubPivotBar--scrollable",p&&"shadowStyle",r&&"hideHeader",this.props.pivotBarClassName),componentRef:e=>{this.pivotBar=e}}),e);let E=O;return b&&(E=c.createElement(t.Splitter.Splitter,Object.assign({},v,{onRenderFarElement:()=>O,onRenderNearElement:b}))),c.createElement(g.Fabric,{className:(0,t.Util.css)("vss-Hub",i)},E)}validateChildren(e){const i=(0,t.UtilitiesChildrenUtils.childrenOfType)(e,C.HubHeader)[0];if(!i||0!==i.index)throw new Error("Expected first child of Hub to be HubHeader.");this.state.inFullScreenMode&&(e[i.index]=c.cloneElement(e[i.index],{collapseBreadcrumb:!0}))}_getFullScreenViewAction(){return{key:t.UtilitiesHubViewState.HubViewOptionKeys.fullScreen,important:!0,viewActionRenderArea:2,actionType:1,actionProps:{showText:!1,onAriaLabel:t.VSSResourcesVSSUI.ExitFullScreenAriaLabel,offAriaLabel:t.VSSResourcesVSSUI.EnterFullScreenAriaLabel,onIconProps:{iconName:"BackToWindow"},offIconProps:{iconName:"FullScreen"}}}}_getViewActions(e){if(d.ObservableLike.isObservable(e.viewActions)){if(!e.hideFullScreenToggle&&!this._chromeless){this._underlyingViewActionsObservable&&this._underlyingViewActionsObservable.unsubscribe(this._onViewActionObservableChanged);const t=e.viewActions,i=new d.ObservableArray([...t.value,this._getFullScreenViewAction()]);return this._underlyingViewActionsObservable=t,this._viewActionsObservable=i,t.subscribe(this._onViewActionObservableChanged),i}return e.viewActions}{const t=e.viewActions||[];return e.hideFullScreenToggle||this._chromeless||t.push(this._getFullScreenViewAction()),t}}_onViewOptionChanged(e){if(t.UtilitiesHubViewState.HubViewOptionKeys.fullScreen in e){const i=!0===e[t.UtilitiesHubViewState.HubViewOptionKeys.fullScreen];i||(this._exitingFullScreenMode=!0),this.setState({inFullScreenMode:i})}}}t[e].Hub=i,i.defaultProps={scrollableRegion:1}}("ComponentsHubHub"),function(e){L=t[e]={},__exportStar(V,t[e])}("ComponentsHubindex"),function(e){T=t[e]={},__exportStar(_,t[e])}("ComponentsVssBreadcrumbindex"),t.RegistrationPivotBarRegistration={},P.VssComponent.register("pivotBar",A.PivotBar),t.Hub={},__exportStar(L,t.Hub),function(e){t[e]={},__exportStar(T,t[e])}("VssBreadcrumb")}),["Components/VssBreadcrumb/VssBreadcrumb","Components/HubHeader/HubTitle","Components/HubHeader/HubHeader","Components/HubHeader/HubTextTile","Components/HubHeader/HubTileRegion","Components/HubHeader/index","HubHeader","Components/PivotBar/PivotBarItem","Components/PivotBar/PivotBarAction","Components/PivotBar/PivotCommandBar","Components/PivotBar/PivotBar","Components/PivotBar/index","PivotBar","Components/Hub/Hub","Components/Hub/index","Components/VssBreadcrumb/index","Registration/PivotBarRegistration","Hub","VssBreadcrumb"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-hub-content"}}));