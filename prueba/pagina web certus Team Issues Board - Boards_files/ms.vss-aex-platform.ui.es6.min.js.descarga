"use strict";define("Aex/Platform/UI",["require","exports","Aex/Platform/Telemetry/AexTelemetry","Aex/Platform/Telemetry/Constants","VSS/Core/Util/Memoize","VSS/Platform/Location","Aex/Platform/Utils/useAsyncAction","react","Aex/Platform/Utils/useDependentState","Aex/Platform/Utils/useMemoizedResultCallback","Aex/Platform/Utils/useAsyncState","VSSUI/Utilities/Selection"],(function(e,t,r,n,o,i,s,a,l,c,u,f){var d,m,h;!function(e){t[e]={};t[e].AexPageContextService=class{constructor(e,t,s,a){this.pageContext=e,this.getCurrentRoute=(0,o.memoizeFunction)((()=>this.pageContext.getService("IVssNavigationService").getCurrentRoute())),this.getPageData=(0,o.memoizeFunction)((()=>this.pageContext.getService("IVssPageService").getData())),this.getPageUserData=(0,o.memoizeFunction)((()=>{const e=this.getPageData();if(e)return e.user})),this.getService=(0,o.memoizeFunction)((e=>this.pageContext.getService(e))),this.getRestClient=(0,o.memoizeFunction)(((e,t)=>this.pageContext.getRestClient(e,t))),this.getNamedAuthenticationTokenProvider=(0,o.memoizeFunction)((e=>this.pageContext.getService("IAuthenticationService").getNamedTokenProvider(e))),this.isFeatureEnabled=(0,o.memoizeFunction)(((e,t)=>{if(!t)try{const t=localStorage.getItem(e);if("true"===t)return!0;if("false"===t)return!1}catch(e){}return this.pageContext.getService("IVssFeatureService").isFeatureEnabled(e)})),this.isFeatureFlagEnabled=(0,o.memoizeFunction)((e=>this.pageContext.getService("IVssFeatureService").isFeatureFlagEnabled(e))),this.getAssetLocation=(0,o.memoizeFunction)((e=>(0,i.getAssetLocation)(this.pageContext,e))),this.getServiceLocation=(0,o.memoizeFunction)(((e,t)=>(0,i.getServiceLocation)(this.pageContext,e,t))),this.getRestClientOptions=(0,o.memoizeFunction)(((e,t,r)=>({hostType:t,rootPath:r,authTokenProvider:e}))),this.getCrossServiceRestClientOptions=this.getRestClientOptions;const l=e.getService(n.ServiceName.IAexTelemetryService);let c;if(a){c=[];for(const e of a){const t=this.isFeatureEnabled(e),r=this.isFeatureEnabled(e,!0);if(t===r&&t)c.push(e);else if(t!==r){const r=e+"!"+(t?"+":"-");c.push(r)}}}this.telemetry=new r.AexTelemetry(l,t,s,c)}getCrossServiceRestClient(e,t,r,n){return this.getRestClient(e,this.getCrossServiceRestClientOptions(t,r,n))}}}("ContextsAexPageContextService"),t[h="ContextsFormWorkflow"]={},t[h].useAsyncFormWorkflow=function(e,t,r){const n=a.useCallback((async(n,o)=>{let i=t(n,o);if(void 0!==i){if(r){const e=await r(i,o);if(!e)return;i=e}return e(i,o)}}),[e,t,r]);return(0,s.useAsyncAction)(n)},function(e){t[e]={};t[e].CollectionDataStore=class{constructor(e,t=[]){this.getKey=e,this.initialValue=t,this.dataLog=[],this.reconciledValue=t}get value(){return this.reconcile()}clear(){this.dataLog.length=0,this.reconciledValue=this.initialValue}upsert(e){this.dataLog.push([0,e])}deleteItems(e){this.dataLog.push([1,e])}reconcile(){if(0===this.dataLog.length)return this.reconciledValue;let e=0;const t={};for(;this.dataLog.length>0;){const r=this.dataLog.shift();if(!r)break;const[n,o]=r;if(0===n){const r=o;for(const n of r)t[this.getKey(n)]=[0,[n,e++]]}else if(1===n){const e=o;for(const r of e)t[r]=[1,void 0]}}const r=[];for(const e of this.reconciledValue){const n=this.getKey(e),o=t[n];if(o){const[e,i]=o;0===e&&r.push(i[0]),delete t[n]}else r.push(e)}const n=[];for(const e in t)if(t[e]){const[r,o]=t[e];0===r&&n.push(o)}return n.sort(((e,t)=>e[1]-t[1])),r.push(...n.map((e=>e[0]))),this.reconciledValue=r,this.reconciledValue}}}("UtilCollectionDataStore"),function(e){t[e]={};const r=new class{next(){return Promise.resolve({done:!0,value:void 0})}};function n(e,t){const[r,n]=(0,l.useAsyncDependentState)(void 0,[e]),[o,i]=(0,l.useAsyncDependentState)(t.value,[t]),s=(0,a.useCallback)((e=>{t.upsert(e),i(t.value)}),[t,i]),u=(0,a.useCallback)((e=>{t.deleteItems(e),i(t.value)}),[t,i]);let f,d=!1;r&&(r.done?d=!0:f=r.value[2]);const m=(0,a.useCallback)((async t=>{const r=await e.next(t);n(r),r.value&&s(r.value[0])}),[e,n,s]),h=r&&(r.done?void 0:r.value[1]),g=(0,c.useMemoizedResultCallback)((()=>m(h)),[m,h]);return{value:o,upsert:s,deleteItems:u,isDone:d,fetchNext:g,extraYield:f}}t[e].useContinuationTokenCollectionDataIterator=n,t[e].useNullableContinuationTokenCollectionDataIterator=function(e,t){const o=n(e||r,t);return e?o:{isDone:!0,fetchNext:()=>Promise.resolve(void 0),extraYield:void 0,value:[],upsert:()=>{},deleteItems:()=>{}}},t[e].useContinuationTokenCollectionDataIteratorAutoLoadingEffect=function(e,t,r){(0,a.useEffect)((()=>{e||t().catch((e=>{if(!r)throw e;r(e)}))}),[e,t])}}("HooksuseCollectionDataIterator"),function(e){t[e]={},t[e].useContributionData=function(e,t,r){const n=(0,a.useMemo)((()=>e.getService("IVssContributionService")),[e]),[o,i]=(0,u.useAsyncState)((()=>n.getData(r))),[s,l]=(0,u.useAsyncState)(void 0),c=void 0!==o,f=(0,a.useRef)(!1);return(0,a.useEffect)((()=>{c||f.current||(f.current=!0,(async()=>{try{const t=await e.getService("IVssContributionService").getDataAsync(r);if(void 0===t)throw new Error(`Fetched undefined contribution data for data provider: ${r}`);i(t)}catch(e){if(!t)throw e;t.trackException(e),l(e)}})())}),[c,f.current]),[o,s]}}("HooksuseContributionData"),function(e){t[e]={},t[e].useMutableCallback=function(e,t){const r=(0,a.useCallback)(e,t),n=(0,a.useRef)(r);return n.current=r,(0,a.useCallback)(((...e)=>n.current(...e)),[])}}("HooksuseMutableCallback"),function(e){function r(e,t,r,n=[]){return(0,a.useEffect)((()=>{(0,f.compareSelectionRanges)(e.value,t).length>0&&(e.clear(),e.value=t),(0,f.compareSelectionRanges)(e.unselectableRanges,n).length>0&&(e.unselectableRanges=n);const o=()=>{r(e.value)};return e.subscribe(o),()=>{e.unsubscribe(o)}})),e}function n(e,t,r){const n=[];if(!t||!e)return n;let o;return e.forEach(((e,i)=>{for(const s of t)if(r(e,s)){!o||i-o.endIndex>1?(o&&n.push(o),o={beginIndex:i,endIndex:i}):o.endIndex=i;break}})),o&&n.push(o),n}function o(e,t,r){return(0,a.useMemo)((()=>n(e,t,r)),[e,t,r])}function i(e,t,r){if(!e)return;const n=[];for(const o of t)for(let t=o.beginIndex;t<=o.endIndex;++t){const o=r(e[t]);void 0!==o&&n.push(o)}return n}function s(e,t,r,n,s){const l=o(e,t,n),c=(0,a.useCallback)((t=>{const n=i(e,t,s);void 0!==n&&r(n)}),[e,r,s]),u=(0,a.useMemo)((()=>i(e,l,s)),[e,t,l,s]);return[l,c,u]}t[e]={},t[e].useSelection=r,t[e].useSelectionFactory=function(e,t,n,o=[]){return r((0,a.useMemo)((()=>e()),[]),t,n,o)},t[e].getSelectionRanges=n,t[e].useSelectionRanges=o,t[e].onGetSelfValue=function(e){return e},t[e].useSelectedItems=s,t[e].useSingleSelectedItem=function(e,t,r,n,o){const i=(0,a.useMemo)((()=>{if(void 0!==t)return[t]}),[t]),l=(0,a.useCallback)((e=>{r(e[0])}),[r]),[c,u]=s(e,i,l,n,o);return[c,u]}}("HooksuseSelection"),function(e){d=t[e]={},t[e].getTypeKey=function(e){const t=e;if(t.serverError)return t.serverError.typeKey},t[e].getErrorStatus=function(e){const t=e;if("number"==typeof t.status)return t.status},t[e].getCustomProperties=function(e){const t=e;if(t.serverError)return t.serverError.customProperties}}("UtilExceptions"),function(e){t[e]={};t[e].HandledError=class{constructor(e,t,r=!1){this.isUserError=t,this.showErrorMessage=r,this.error="string"==typeof e?new Error(e):e,void 0===t&&"string"!=typeof e&&(this.statusCode=(0,d.getErrorStatus)(e),this.typeKey=(0,d.getTypeKey)(e),void 0!==this.statusCode&&this.statusCode>=400&&this.statusCode<500&&(this.isUserError=!0,this.showErrorMessage=!0))}get message(){return this.error.message}getCustomProperties(){return(0,d.getCustomProperties)(this.error)}}}("ModelsHandledError"),function(e){m=t[e]={},t[e].prefix="aex-"}("StylingCommon"),function(e){t[e]={},t[e].BackgroundColorClassNames={default:"background-color-default",communicationBackground:"background-color-communication-background",neutral2:"background-color-neutral-2",statusInfoBackground:"background-color-status-info-background",statusErrorBackground:"background-color-status-error-background"},t[e].ColorClassNames={primaryText:m.prefix+"color-primary-text",secondaryText:m.prefix+"color-secondary-text",textOnCommunicationBackground:"color-text-on-communication-background",communicationForeground:"color-communication-foreground",white:"color-white",statusErrorForeground:"color-status-error-foreground"},t[e].getColorClassName=function(e,t,r="color"){return`${m.prefix}${r}-${e}-${t}`}}("StylingColorClassNames"),function(e){t[e]={},t[e].FontClassNames={fontWeightNormal:"fontWeightNormal",fontWeightSemiBold:"fontWeightSemiBold",fontWeightHeavy:"fontWeightHeavy",fontSizeS:"fontSizeS",fontSizeDefault:"fontSize",fontSizeM:"fontSizeM",fontSizeMm:"fontSizeMM",fontSizeL:"fontSizeL",fontSizeLl:"fontSizeLL",fontSizeXl:"fontSizeXL",fontSizeXxl:"fontSizeXXL"},t[e].TypographyClassNames={titleS:"title-s"},t[e].FlexClassNames={flexRow:"flex-row",flexColumn:"flex-column",flexGrow:"flex-grow",alignItemsBaseline:"flex-baseline",alignItemsCenter:"flex-center",alignItemsFlexStart:"flex-start",alignItemsFlexEnd:"flex-end",alignItemsStretch:"flex-stretch",alignSelfCenter:"flex-self-center",alignSelfStretch:"flex-self-stretch",justifyContentCenter:"justify-center",justifyContentFlexEnd:"justify-end"},t[e].TextClassNames={ellipsis:"text-ellipsis",alignCenter:"text-center",alignRight:"text-right"},t[e].LayoutClassNames={overflowAuto:"scroll-auto",overflowHidden:"scroll-hidden",overflowYAuto:"v-scroll-auto",overflowXAuto:"h-scroll-auto"}}("StylingCoreClassNames"),function(e){t[e]={},t[e].CssClassNames={background:{position:{leftBottom:m.prefix+"background-position-left-bottom"},repeat:{noRepeat:m.prefix+"background-repeat-no-repeat"}},border:{top:{style:{solid:m.prefix+"border-top-style-solid"},width1:m.prefix+"border-top-width-1"},radius50:m.prefix+"border-radius-50"},display:{inlineFlex:m.prefix+"display-inline-flex"},flex:{auto:m.prefix+"flex-auto",none:m.prefix+"flex-none"},flexShrink1:m.prefix+"flex-shrink-1",jusitfyContent:{spaceAround:m.prefix+"justify-content-space-around",spaceBetween:m.prefix+"justify-content-space-between"},whiteSpace:{normal:m.prefix+"white-space-normal"}}}("StylingCssClassNames"),function(e){t[e]={},t[e].SizeClassNames={width100:m.prefix+"width-100",width50:m.prefix+"width-50",height100:m.prefix+"height-100"}}("StylingSizing"),function(e){t[e]={},t[e].getSpacingContainerClassName=function(e,t){return`${m.prefix}spacing-container-${e}-${t}`},t[e].getSpacingClassName=function(e,t,r){const n="all"===t?"":"-"+t;return`${m.prefix}${e}${n}-${r}`}}("StylingSpacing"),function(e){t[e]={};class r{constructor(e,t){this.eventPrefix=t,this.isRenderCompleteMarked=!1,this.isInteractiveMarked=!1,this.perfService=e.getService("IVssPerformanceService")}markRenderStart(){if(!this.renderScenario){const e=this.eventPrefix+r.renderScenario;this.renderScenario=this.perfService.startScenario(e,!0)}return this.renderScenario}markRenderComplete(){if(!this.isRenderCompleteMarked){const e=this.eventPrefix+r.renderScenario;this.perfService.addSplitTiming(r.renderCompleteTiming,e),this.isRenderCompleteMarked=!0}}markInteractive(){this.renderScenario&&!this.isInteractiveMarked&&(this.renderScenario.complete(),this.isInteractiveMarked=!0)}}t[e].PerfUtil=r,r.renderScenario="render",r.renderCompleteTiming="renderComplete"}("UtilPerfUtil"),function(e){t[e]={},t[e].urlSearchParamsGet=function(e,t){const r=e.find((e=>e.name===t));return r&&r.value||null},t[e].urlSearchParamsAppend=function(e,t,r){e.push({name:t,value:r})}}("UtilUrl"),function(e){t[e]={};class r extends a.Component{constructor(){super(...arguments),this.parseTemplate=(0,o.memoizeFunction)((e=>{const t=e.split(/{\d+}/m),r=e.match(/{\d+}/gm),n=[];for(let e=0;e<t.length-1;++e){const o=t[e];if(n.push({isPlaceholder:!1,stringPart:o}),r&&r[e]){const t=r[e].match(/\d+/);if(t){const e=parseInt(t[0],void 0);n.push({isPlaceholder:!0,placeholderId:e})}}}return n.push({isPlaceholder:!1,stringPart:t[t.length-1]}),n}))}render(){const e=a.Children.toArray(this.props.children),t=this.parseTemplate(this.props.template).map((t=>t.isPlaceholder?e[t.placeholderId]:t.stringPart));return a.createElement(a.Fragment,null,...t)}}t[e].TemplateString=r,t[e].TemplateJoinedString=function(e){const t=a.useMemo((()=>a.Children.toArray(e.children)),[e.children]);let r=!1;return a.createElement(a.Fragment,null,t.map(((t,n)=>{if(null!=t&&!1!==t)return r?a.createElement(a.Fragment,{key:n},e.delimiter,t):(r=!0,a.createElement(a.Fragment,{key:n},t))})))}}("ComponentsTemplateString"),function(e){t[e]={},t[e].GeneralErrorContext=a.createContext({error:void 0,setError:()=>{}});class r extends a.Component{constructor(e){super(e),this.getMemoizedValue=(0,o.memoizeFunction)((e=>({error:e,setError:this.setError}))),this.setError=e=>{"function"==typeof e?this.setState((t=>({error:e(t.error)}))):this.setState({error:e})},this.state={error:void 0}}componentDidCatch(e,t){this.props.telemetry.trackException(e,"GeneralErrorContextProvider",{componentStack:t.componentStack}),this.setError([e,t])}render(){return a.createElement(t[e].GeneralErrorContext.Provider,{value:this.getMemoizedValue(this.state.error)},this.props.children)}}t[e].GeneralErrorContextProvider=r,t[e].useGeneralError=function(){return a.useContext(t[e].GeneralErrorContext).error}}("ContextsGeneralErrorContext")}),["Contexts/AexPageContextService","Contexts/FormWorkflow","Util/CollectionDataStore","Hooks/useCollectionDataIterator","Hooks/useContributionData","Hooks/useMutableCallback","Hooks/useSelection","Util/Exceptions","Models/HandledError","Styling/Common","Styling/ColorClassNames","Styling/CoreClassNames","Styling/CssClassNames","Styling/Sizing","Styling/Spacing","Util/PerfUtil","Util/Url","Components/TemplateString","Contexts/GeneralErrorContext"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-aex-platform.ui"}}));