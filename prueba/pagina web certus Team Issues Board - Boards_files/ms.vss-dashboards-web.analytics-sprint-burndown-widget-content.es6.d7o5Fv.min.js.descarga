"use strict";define("Widgets/AnalyticsSprintBurndown",["require","exports","Widgets/Burndown/BurndownWidgetComponents/BurndownChartOptionFactory","VSS/Features/Charts/Contracts","WidgetCommon/DateUtils/DateUtils","WidgetCommon/ModernWidgetTypes/ChartOptionFactoryBase","Analytics/Boards/BoardsQueries/IterationsQuery","VSS/Core/Util/String","Tfs/Widget/Context","WidgetCommon/ModernWidgetTypes/CommonConfigurationTypes","WidgetCommon/ModernWidgetTypes/SettingsManagerBase","Widgets/Burndown/BurndownWidgetComponents/BurndownSettings","Dashboards/Clients/Work","Reporting/Visuals/LayoutComponents/Widgets/Demands/DemandType","Reporting/Visuals/LayoutComponents/Widgets/LayoutState","Widgets/Burndown/BurndownWidgetComponents/AsyncDataHelpers","Widgets/Burndown/BurndownWidgetComponents/BurndownDataFactory","Widgets/Burndown/BurndownWidgetComponents/BurndownDataManager","Widgets/Burndown/BurndownWidgetComponents/TimeIntervalUtils","Widgets/Burndown/Resources","VSS/Platform/Feature","Widgets/Burndown/BurndownWidgetComponents/BurndownConstants","Analytics/Common/Utilities/AnalyticsExceptionUtilities","Dashboards/WidgetContracts/WidgetProps","react","Reporting/Visuals/LayoutComponents/Widgets/ComponentLayoutEngine","Reporting/Visuals/VisualMessages/CompactChartErrorWarningComponent","WidgetCommon/ModernWidgetTypes/ViewComponentBase","Widgets/Burndown/BurndownWidgetComponents/BurndownActionCreator","Widgets/Burndown/BurndownWidgetComponents/BurndownViewComponent","VSS/Platform/Layout"],(function(t,e,n,a,i,r,o,s,d,c,l,m,u,g,p,h,y,C,f,S,D,w,I,T,B,A,W,b,k,x,O){var M,P,E,v,L,j,R,Q,N,F,V,U;M=e[U="Resources"]={},e[U].TeamCapacityTrendlineTooltipLabel="Remaining Capacity",e[U].TeamCapacityIdealTrendLabel="Ideal Trend",e[U].CurrentIterationLabel="@CurrentIteration",e[U].IterationDatesUnconfiguredMessage="Iteration dates unconfigured",function(t){function a(t){let e=0;for(let n=0;n<t.length;n++){const a=t=>null!=t?t:0,i=a(t[n]),r=n>0?a(t[n-1]):0;e+=Math.max(i-r,0)}return e}P=e[t]={},e[t].determinePeakScope=a,e[t].getPeakScope=function(t,e,i,r,o){return a(r?function(t){const e=[];if(t.length>0){const n=t[0].data.length,a=t.length;for(let i=0;i<n;i++){let n=0;for(let e=0;e<a;e++){const a=t[e].data[i];n+=null!=a?a:0}e[i]=n}}return e}((0,n.getWorkItemStackedEffortColumnSeries)(t,e,i,o)):(0,n.reduceEffortToSeriesData)(t,e,i))}}("AnalyticsSprintBurndownWidgetComponentsTotalWorkProjectionHelper"),function(t){E=e[t]={};class o extends r.ChartOptionFactoryBase{constructor(t){super(),this.pageContext=t}createChartOptions(t){const e=new n.BurndownChartOptionFactory(this.pageContext),r=e.createChartOptions(t);if(r.interpolateNullValues=!1,r.xAxis.formatAccessibleLabelsUsingAxisCategories=!0,!t.isMinimalChart){!function(t,e,n,r,o,s){const d=l(n.daysOff),c=e.map((t=>({daysOff:l(t.daysOff),activities:t.activities}))),u=m(o.map((t=>(0,i.parseIsoDateStringInLocalTime)(t))),r,d,c,s);if(u.some((t=>null!=t&&t>0))){const e={name:M.TeamCapacityTrendlineTooltipLabel,data:u,color:"#6DB72C",plotDashedStyle:!0};t.series.push(e),t.specializedOptions.chartTypes.push(a.ChartTypesConstants.Line),null!=u[0]&&null!=t.yAxis&&null!=t.yAxis.max&&u[0]>t.yAxis.max&&(t.yAxis.max=u[0])}}(r,t.teamMemberCapacities,t.teamDaysOff,t.teamWorkingDays,t.sampleDates,t.showRemainingCapacityAtStartOfDay);const e=(0,P.getPeakScope)(t.remainingEffort,t.sampleDates,t.todayInAccountTimezone,t.showStackedWorkItemTypes,t.workItemTypeColorDictionary);!function(t,e,n,r,o){const s=l(e.daysOff),d=h(r.map((t=>(0,i.parseIsoDateStringInLocalTime)(t))),n,s,o),c="#9D9D9D",m={name:M.TeamCapacityIdealTrendLabel,data:d,color:c};t.series.push(m),t.specializedOptions.chartTypes.push(a.ChartTypesConstants.Line),null!=t.yAxis&&null!=t.yAxis.max&&o>t.yAxis.max&&(t.yAxis.max=o)}(r,t.teamDaysOff,t.teamWorkingDays,t.sampleDates,e)}if(t.showNonWorkingDays){if(!t.isMinimalChart){const e=this.pageContext.getService("IVssThemeService").getCurrentTheme().isDark?"#c8c8c8":"#dedede";r.xAxis.plotBands=s(t.sampleDates,t.teamDaysOff,t.teamWorkingDays,e)}}else{const e=t.teamDaysOff.daysOff,n=function(t,e,n,a){const r=new Set,o=l(n);for(let t=0;t<e.length;t++){g((0,i.parseIsoDateStringInLocalTime)(e[t]),a,o)||r.add(t)}return Array.from(r).sort(((t,e)=>e-t)).forEach((n=>{!function(t,e){t.xAxis.labelValues.splice(e,1),t.series.forEach((t=>{t.data.splice(e,1)}))}(t,n),function(t,e){t.splice(e,1)}(e,n)})),e}(r,t.sampleDates,e,t.teamWorkingDays);t.sampleDates=n}return t.allowChartClicks&&(r.click=n=>this.handleClick(n,t,e)),r}handleClick(t,e,n){const a=t.seriesName;a!==M.TeamCapacityTrendlineTooltipLabel&&a!==M.TeamCapacityIdealTrendLabel&&n._handleClick(t,e)}}function s(t,e,n,a){const r=[],o=l(e.daysOff);for(let e=0;e<o.length;e++){const n=(0,i.toLocalDateIsoString)(o[e].start);let s=t.indexOf(n);const c=(0,i.toLocalDateIsoString)(o[e].end);let l=t.indexOf(c);-1===s&&-1===l||(s=-1===s?0:s,l=-1===l?t.length-1:l,r.push(d(s,l,a)))}for(let e=0;e<t.length;e++){const o=new Date(t[e]);c(n,(0,i.shiftToUtc)(o).getDay())||r.push(d(e,e,a))}return r}function d(t,e,n){return{start:t-1,end:e,color:n}}function c(t,e){return-1!==t.indexOf(e)}function l(t){return t.map((t=>({start:(0,i.shiftToUtc)(t.start),end:(0,i.shiftToUtc)(t.end)})))}function m(t,e,n,a,i){let r=0;const o=[],s=t.map((t=>new Date(t.getTime())));let d,c;for(const t of s.reverse())c=i?t:d,null!=c&&g(c,e,n)&&(r+=u(c,a)),o.push(r),d=t;return o.reverse()}function u(t,e){let n=0;for(const a of e)p(t,a.daysOff)||a.activities.forEach((t=>n+=t.capacityPerDay));return n}function g(t,e,n){return c(e,t.getDay())&&!p(t,n)}function p(t,e){let n=!1;for(const a of e)if(t.getTime()>=a.start.getTime()&&t.getTime()<=a.end.getTime()){n=!0;break}return n}function h(t,e,n,a){const i=function(t,e,n){let a=0;for(const i of t)a+=g(i,e,n)?1:0;return a}(t,e,n),r=i>0?a/i:0,o=[];let s,d=0;const c=t.map((t=>new Date(t.getTime()))).reverse();for(const t of c)null!=s&&g(s,e,n)&&(d+=r),o.push(d),s=t;return o.reverse()}e[t].AnalyticsSprintBurndownChartOptionsFactory=o,e[t].addPlotBandsForWeekendsAndOffDays=s,e[t].calculateTeamCapacity=m,e[t].calculateIdealTrendline=h}("AnalyticsSprintBurndownWidgetComponentsAnalyticsSprintBurndownChartOptionsFactory"),function(t){v=e[t]={};class n{}e[t].AnalyticsSprintBurndownConstants=n,n.featureName="AnalyticsSprintBurndownWidget",n.command="SprintBurndown"}("AnalyticsSprintBurndownWidgetComponentsAnalyticsSprintBurndownConstants"),e.AnalyticsSprintBurndownWidgetComponentsAnalyticsSprintBurndownSettings={},function(t){function n(n){return e[t].currentIterationId===n}function a(t){const e=new Date;let a={};const i=t.findIndex((t=>!n(t.IterationSK)&&new Date(t.StartDateTimeOffset)<e&&new Date(t.EndDateTimeOffset)>e));if(i>=0&&(a=t[i]),i<0){const i=t.filter((t=>!n(t.IterationSK)&&new Date(t.StartDateTimeOffset)<e&&null!=t.EndDateTimeOffset));i.length>0&&(i.sort(((t,e)=>{const n=new Date(t.EndDateTimeOffset).getTime()-new Date(e.EndDateTimeOffset).getTime();return 0!==n?n:0===n?(0,s.localeComparer)(t.IterationPath,e.IterationPath):n})),a=i[i.length-1])}return a}L=e[t]={},e[t].currentIterationId="@CurrentIteration",e[t].isSymbolicCurrentIteration=n,e[t].getIterations=async function(t,e,n){const a=t.getService("IDashboardsCacheableQueryService");return await a.getCacheableQueryResult(o.IterationsQuery.onTeam(e,n,100))},e[t].selectActualCurrentIteration=a,e[t].populateSymbolicCurrentIteration=function(n){const i=a(n);return Object.assign(Object.assign({},i),{IterationName:M.CurrentIterationLabel,IterationSK:e[t].currentIterationId,StartDateTimeOffset:i.StartDateTimeOffset,EndDateTimeOffset:i.EndDateTimeOffset})}}("AnalyticsSprintBurndownWidgetComponentsConfigQueriesIterationsHelper"),function(t){j=e[t]={};class n extends l.SettingsManagerBase{constructor(t,e){super(),this.pageContext=t,this.teamContext=e}static isValidDate(t){return null!=t&&!isNaN(new Date(t).getTime())}static settingsAreValid(t){if(!(null!=t&&null!=t.timePeriodConfiguration&&n.isValidDate(t.timePeriodConfiguration.startDate)&&n.isValidDate(t.timePeriodConfiguration.endDate)))throw Error(M.IterationDatesUnconfiguredMessage);const e=null!=t&&null!=t.timePeriodConfiguration&&(0,i.daysBetweenDates)((0,i.parseIsoDateStringInLocalTime)(t.timePeriodConfiguration.startDate),(0,i.parseIsoDateStringInLocalTime)(t.timePeriodConfiguration.endDate))<=180,a=null!=t&&null!=t.timePeriodConfiguration&&(0,i.parseIsoDateStringInLocalTime)(t.timePeriodConfiguration.startDate).getTime()<(0,i.parseIsoDateStringInLocalTime)(t.timePeriodConfiguration.endDate).getTime();return null!=t&&null!=t.aggregation&&null!=t.aggregation.identifier&&(t.aggregation.identifier===c.AggregationMode.Count||t.aggregation.identifier===c.AggregationMode.Sum&&null!=t.aggregation.settings)&&null!=t.iterationId&&""!=t.iterationId&&null!=t.team&&null!=t.team.projectId&&null!=t.team.teamId&&e&&a}getFeatureName(){return v.AnalyticsSprintBurndownConstants.featureName}async hasSatisfactoryConfiguration(t){return this.isCorrectlyConfigured(t)}isCorrectlyConfigured(t){if(!super.isConfigured(t))return!1;const e=JSON.parse(t.settings);return n.settingsAreValid(e)}async generateDefaultSettings(){const t=this.packContext(this.teamContext),e={identifier:"BacklogCategory",settings:await r(this.pageContext,this.teamContext)},n=await(0,L.getIterations)(this.pageContext,t.projectId,t.teamId);let a=(0,L.populateSymbolicCurrentIteration)(n);null==a&&(a={IterationSK:"",IterationPath:""});const i=new Date(null!=a&&a.StartDateTimeOffset||""),s=new Date(null!=a&&a.EndDateTimeOffset||"");return Promise.resolve(o(t.projectId,t.teamId,e,void 0,i,s,a,!1))}packContext(t){return{teamId:t.id,projectId:d.getProject(this.pageContext).id}}}function a(t,e){return{startDate:null==t||isNaN(t.getTime())?"":(0,i.toLocalDateIsoString)(t),endDate:null==e||isNaN(e.getTime())?"":(0,i.toLocalDateIsoString)(e)}}async function r(t,e){const n=t.getService("IVssContributionService");return(await n.getDataAsync("ms.vss-dashboards-web.backlog-configuration-for-team-data-provider",{teamId:e.id})).taskBacklog.id}function o(t,e,n,i,r,o,s,d){return{totalScopeTrendlineEnabled:!0,completedWorkEnabled:!1,stackByWorkItemTypeEnabled:!1,showNonWorkingDays:d,showResolvedItemsAsCompletedEnabled:!1,aggregation:i||{identifier:c.AggregationMode.Sum,settings:"Microsoft.VSTS.Scheduling.RemainingWork"},workItemTypeFilter:n,timePeriodConfiguration:a(r,o),team:{teamId:e,projectId:t},iterationId:null!=s&&s.IterationSK||"",iterationPath:null!=s&&s.IterationPath||"",isMinimalChart:!1,isLightboxChart:!1,isLegacy:!1}}e[t].AnalyticsSprintBurndownSettingsManager=n,e[t].assembleTimePeriodConfiguration=a,e[t].getTaskBacklogCategoryReferenceName=r,e[t].assembleBurndownReportSettings=o,e[t].convertSprintBurndownToBurndownSettings=function(t){return{burndownTrendlineEnabled:!1,totalScopeTrendlineEnabled:t.totalScopeTrendlineEnabled,completedWorkEnabled:t.completedWorkEnabled,stackByWorkItemTypeEnabled:t.stackByWorkItemTypeEnabled,aggregation:t.aggregation,workItemTypeFilter:t.workItemTypeFilter,showResolvedItemsAsCompletedEnabled:t.showResolvedItemsAsCompletedEnabled,timePeriodConfiguration:{startDate:t.timePeriodConfiguration.startDate,samplingConfiguration:{identifier:m.DateSampleMode.ByDateInterval,settings:{endDate:t.timePeriodConfiguration.endDate,lastDayOfWeek:5,sampleInterval:i.DateSampleInterval.Days}}},teams:[{teamId:t.team&&t.team.teamId,projectId:t.team&&t.team.projectId}],fieldFilters:[{fieldName:"System.IterationPath",queryOperation:"=",queryValue:t.iterationPath}]}},e[t].mapSymbolicIterationToConcrete=async function(t,e){let n=e;if((0,L.isSymbolicCurrentIteration)(e.iterationId)){n=Object.assign({},e);const r=await(0,L.getIterations)(t,e.team.projectId,e.team.teamId),o=(0,L.selectActualCurrentIteration)(r);n.iterationId=o.IterationSK,n.iterationPath=o.IterationPath,n.timePeriodConfiguration=a((0,i.parseIsoDateStringInLocalTime)(o.StartDateTimeOffset),(0,i.parseIsoDateStringInLocalTime)(o.EndDateTimeOffset))}return n}}("AnalyticsSprintBurndownWidgetComponentsAnalyticsSprintBurndownSettingsManager"),function(t){R=e[t]={};e[t].TeamCapacityCacheableQuery=class{constructor(t,e,n){this.pageContext=t,this.projectData=d.getProject(this.pageContext),this.teamId=e,this.iterationId=n}async runQuery(t){const e=(0,u.getWorkClient)(t),n={project:this.projectData.id,projectId:this.projectData.id,team:this.teamId,teamId:this.teamId};return e.getCapacities(n,this.iterationId)}getKey(){return"TeamCapacityCacheableQuery"+JSON.stringify({projectId:this.projectData.id,teamId:this.teamId,iterationId:this.iterationId})}}}("AnalyticsSprintBurndownWidgetComponentsTfsQueriesTeamCapacityCacheableQuery"),function(t){Q=e[t]={};e[t].TeamDaysOffCacheableQuery=class{constructor(t,e,n){this.pageContext=t,this.projectData=d.getProject(this.pageContext),this.teamId=e,this.iterationId=n}async runQuery(t){const e=(0,u.getWorkClient)(t),n={project:this.projectData.id,projectId:this.projectData.id,team:this.teamId,teamId:this.teamId};return e.getTeamDaysOff(n,this.iterationId)}getKey(){return"TeamDaysOffCacheableQuery"+JSON.stringify({projectId:this.projectData.id,teamId:this.teamId,iterationId:this.iterationId})}}}("AnalyticsSprintBurndownWidgetComponentsTfsQueriesTeamDaysOffCacheableQuery"),function(t){N=e[t]={};e[t].TeamWorkingDaysCacheableQuery=class{constructor(t,e){this.pageContext=t,this.projectData=d.getProject(this.pageContext),this.teamId=e}async runQuery(t){const e=(0,u.getWorkClient)(t),n={project:this.projectData.id,projectId:this.projectData.id,team:this.teamId,teamId:this.teamId};return(await e.getTeamSettings(n)).workingDays}getKey(){return"TeamWorkingDaysCacheableQuery"+JSON.stringify({projectId:this.projectData.id,teamId:this.teamId})}}}("AnalyticsSprintBurndownWidgetComponentsTfsQueriesTeamWorkingDaysCacheableQuery"),function(t){F=e[t]={};class n extends C.BurndownDataManager{constructor(t,e,n,a,i,r){super(t,e,n,a,i,undefined,r),this.settingsManager=new j.AnalyticsSprintBurndownSettingsManager(t,e),this.isAutomationScenario=!0===r,this.AnalyticsSprintBurndownDataManagerPageContext=t}demandsArePresent(){return this.demandTracker.isDemandPresent(g.DemandType.subtitle)||this.demandTracker.isDemandPresent(g.DemandType.scalar)||this.demandTracker.isDemandPresent(g.DemandType.chart)||this.demandTracker.isDemandPresent(g.DemandType.submetrics)}async getDataImpl(){try{if(null==this.settings)throw new Error(S.BurndownWidgetDataManager_NoWidgetSettingsFound);let t=JSON.parse(this.settings);t.showResolvedItemsAsCompletedEnabled=!!(0,D.isFeatureFlagEnabled)(this.AnalyticsSprintBurndownDataManagerPageContext,w.BurndownConstants.featureFlagName_ShowResolvedItemsAsCompleted,!1)&&t.showResolvedItemsAsCompletedEnabled,(0,L.isSymbolicCurrentIteration)(t.iterationId)&&(t=await(0,j.mapSymbolicIterationToConcrete)(this.context,t));const e=(0,j.convertSprintBurndownToBurndownSettings)(t),n=[t.team.projectId],a=t.team.teamId,r=h.AsyncDataHelpers.getWorkItemTypesForTeam(this.context,t.workItemTypeFilter,a,this.isAutomationScenario),o=r.then((t=>h.AsyncDataHelpers.getWorkItemTypeFieldsPromise(this.context,t,n,this.dataService,this.isAutomationScenario,this.command)));return Promise.all([r,o]).then((([n,r])=>{let o;if(this.demandTracker.isDemandPresent(g.DemandType.chart)||this.demandTracker.isDemandPresent(g.DemandType.submetrics)){const d=f.TimeIntervalUtils.getSampleDates(t.timePeriodConfiguration.startDate,e.timePeriodConfiguration.samplingConfiguration.settings),l=this.getEffortSnapshotsPromise(e,n,r,d),m=this.getCurrentEffortPromise(e,n,r);let u,g;if(t.aggregation.identifier===c.AggregationMode.Sum&&(u=this.getUnestimatedCountPromise(e,n,r)),!t.iterationId)throw new Error("Iteration for widget is not set.");g=this.getTeamDaysOffPromise(a,t.iterationId);const h=this.getTeamWorkingDaysPromise(a),C=this.getTeamCapacity(a,t.iterationId),S=this.getWitColorDictionaryPromise(this.context,t.stackByWorkItemTypeEnabled,n),D=e.timePeriodConfiguration.samplingConfiguration.settings.sampleInterval,w=(0,i.fetchTodayInAccountTimeZone)(this.context);o=Promise.all([l,m,u,g,h,C,S,w]).then((async([a,i,o,l,m,u,g,h])=>{if(0===a.length&&null==o)return this.packMessageAsState(p.MessageType.NoData);this.resetMessageState();const C=d.sampleDates.filter((t=>(0,s.localeIgnoreCaseComparer)(t,h)<=0)),f=y.BurndownDataFactory.getRemainingEffort(a,t.showResolvedItemsAsCompletedEnabled),S=y.BurndownDataFactory.getCompletedEffort(a,t.showResolvedItemsAsCompletedEnabled),w=y.BurndownDataFactory.getEffortByDate(a),I=this.resolvePastDays(C,f,S,w),T=-y.BurndownDataFactory.getAverageChange(I,C),B=y.BurndownDataFactory.getCompletedPercentage(i,t.showResolvedItemsAsCompletedEnabled),A=y.BurndownDataFactory.getSumOfAggregatedEffort(i)-w[C[0]],W=this.allowChartClicks,b=!t.isMinimalChart&&(t.aggregation.identifier===c.AggregationMode.Count||"Microsoft.VSTS.Scheduling.RemainingWork"!==t.aggregation.settings)&&t.totalScopeTrendlineEnabled,k=new E.AnalyticsSprintBurndownChartOptionsFactory(this.context).createChartOptions({todayInAccountTimezone:h,showOtherEffort:t.completedWorkEnabled,showScopeTrendline:b,showBurnTrendline:!1,showResolvedItemsAsCompleted:t.showResolvedItemsAsCompletedEnabled,sampleDatesInterval:D,lastGeneratedIntervalSampleDate:d.lastIntervalDate,sampleDates:d.sampleDates,datesToTotalEffort:w,remainingEffort:f,completedEffort:S,startDate:t.timePeriodConfiguration.startDate,suppressAnimations:this.suppressAnimations,showStackedWorkItemTypes:t.stackByWorkItemTypeEnabled,workItemTypeColorDictionary:g,averageBurn:T,datesToPrimarySeriesEffort:I,onClick:this.getOnClickChartHandler(e,n,r,void 0),burnDirection:this.getBurnDirection(),allowChartClicks:W,showFillAsArea:!0,skipFutureScopeInTrendLine:!0,showNonWorkingDays:t.showNonWorkingDays,showRemainingCapacityAtStartOfDay:t.showRemainingCapacityAtStartOfDay,teamDaysOff:l,teamWorkingDays:m,teamMemberCapacities:u,isMinimalChart:t.isMinimalChart});return this.currentState.chartData={chartOptions:k},this.currentState.submetricsData=this.getSubMetrics(e,n,r,B,W,T,A),this.updateHeaderAndMetrics(o,d.sampleDates,e,n,r,W),Promise.resolve()}))}return this.handleScalarAndTitlePromise(o,e,n,r)})).then(void 0,(t=>this.handleError(t)))}catch(t){return this.handleError(t)}}async getTeamDaysOffPromise(t,e){const n=new Q.TeamDaysOffCacheableQuery(this.context,t,e);return this.dataService.getCacheableQueryResult(n)}async getTeamWorkingDaysPromise(t){const e=new N.TeamWorkingDaysCacheableQuery(this.context,t);return this.dataService.getCacheableQueryResult(e)}async getTeamCapacity(t,e){const n=new R.TeamCapacityCacheableQuery(this.context,t,e);return this.dataService.getCacheableQueryResult(n)}}e[t].AnalyticsSprintBurndownDataManager=n}("AnalyticsSprintBurndownWidgetComponentsAnalyticsSprintBurndownDataManager"),function(t){V=e[t]={};class n extends b.ViewComponentBase{createDataManager(t){const e=this.isMinimalChart(),n=this.isLightboxChart(),a=this.computeCommandName();return new F.AnalyticsSprintBurndownDataManager(this.context.pageContext,this.props.teamContext,t,!e&&!n,a,e)}getLayoutMappings(){return A.MinimalChartAndLightBoxAndReportComponentLayouts.getDefaultMappings()}createActionCreator(){return new k.BurndownActionCreator(this.context.pageContext,this.dataManager,this.store,this.actions,this.props.contributionId,I.extractODataError)}createSettingsManager(){return new j.AnalyticsSprintBurndownSettingsManager(this.context.pageContext,this.props.teamContext)}getMessageOptions(){return(0,x.getMessageOptions)(this.context.pageContext,this.getStoreState(),this.props)}renderMessageCard(){return this.isMinimalChart()?B.createElement(W.CompactChartErrorWarningComponent,null):super.renderMessageCard()}handleErrorOnRenderCompletion(t){this.isMinimalChart()?this.props.onRenderCompletion({outcome:T.LoadingStatus.success}):super.handleErrorOnRenderCompletion(t)}handleSettingsError(t){return-1!==t.message.indexOf(M.IterationDatesUnconfiguredMessage)?(this.store.setState((0,p.packMessageAsState)(p.MessageType.SetIterationDates)),void this.setStoreStateAndRenderCompletion()):(0,I.recognizeAnalyticsException)(t)===I.AnalyticsExceptionType.MissingAnalyticsPermissions?(this.store.setState((0,p.packMessageAsState)(p.MessageType.MissingPermissions)),void this.setStoreStateAndRenderCompletion()):void super.handleSettingsError(t)}isMinimalChart(){return this.props&&this.props.settings&&JSON.parse(this.props.settings).isMinimalChart}isLightboxChart(){return this.props&&this.props.settings&&JSON.parse(this.props.settings).isLightboxChart}packWidgetLoadedTelemetryData(t){if(!t)return{settingsWereEmpty:!0};try{const e=(0,j.convertSprintBurndownToBurndownSettings)(t),n=(0,x.packWidgetLoadedTelemetryData)(this.context.pageContext,e);return n.showNonWorkingDays=t.showNonWorkingDays,n.isCustomized=t.isCustomized,n.isLegacy=t.isLegacy,n.isMinimal=!!this.isMinimalChart(),n.isLightbox=!!this.isLightboxChart(),n}catch(t){return{settingsCouldNotBePacked:!0}}}computeCommandName(){return"embedded-View"===this.props.presentationMode?this.isMinimalChart()?"HeaderSprintBurndownReport":"SprintBurndownReport":"SprintBurndown"}}e[t].default=n}("AnalyticsSprintBurndownWidgetComponentsAnalyticsSprintBurndownViewComponent"),function(t){e[t]={};class n extends O.VssComponent{render(){return B.createElement(V.default,Object.assign({},this.props,{suppressAnimations:!this.props.showLoadAnimations,onRenderCompletion:this.props.onWidgetLoaded}))}}e[t].AnalyticsSprintBurndownWidget=n,O.VssComponent.register("analyticsSprintBurndownWidget",n)}("AnalyticsSprintBurndownWidget")}),["Resources","AnalyticsSprintBurndownWidgetComponents/TotalWorkProjectionHelper","AnalyticsSprintBurndownWidgetComponents/AnalyticsSprintBurndownChartOptionsFactory","AnalyticsSprintBurndownWidgetComponents/AnalyticsSprintBurndownConstants","AnalyticsSprintBurndownWidgetComponents/AnalyticsSprintBurndownSettings","AnalyticsSprintBurndownWidgetComponents/ConfigQueries/IterationsHelper","AnalyticsSprintBurndownWidgetComponents/AnalyticsSprintBurndownSettingsManager","AnalyticsSprintBurndownWidgetComponents/TfsQueries/TeamCapacityCacheableQuery","AnalyticsSprintBurndownWidgetComponents/TfsQueries/TeamDaysOffCacheableQuery","AnalyticsSprintBurndownWidgetComponents/TfsQueries/TeamWorkingDaysCacheableQuery","AnalyticsSprintBurndownWidgetComponents/AnalyticsSprintBurndownDataManager","AnalyticsSprintBurndownWidgetComponents/AnalyticsSprintBurndownViewComponent","AnalyticsSprintBurndownWidget"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-dashboards-web.analytics-sprint-burndown-widget-content"}}));