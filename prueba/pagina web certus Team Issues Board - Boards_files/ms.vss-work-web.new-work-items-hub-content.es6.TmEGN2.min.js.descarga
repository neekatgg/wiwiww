"use strict";define("WorkItemsHub",["require","exports","VSS/Reflux/Action","VSS/Platform/Trace","react","VSSUI/TooltipEx","VSS/Core/Util/String","VSS/Platform/Date","VSS/Platform/Location","Wit/Common/Utilities/TempQueryUtils","VSSUI/Link","Wit/UI/WorkItemTypeIcon","OfficeFabric/DetailsList","VSS/Platform/Feature","Wit/Common/DateUtils","Wit/Common/Generated/Constants","Wit/Common/Utilities/FormatUtils","Wit/Filter/Utilities/Utilities","Wit/Identity/Utilities/WorkItemIdentityHelper","Wit/UI/IdentityView","Wit/UI/TagsList","Wit/UI/WorkItemState","Wit/Filter/AreaPathHelper","Wit/Filter/FilterStateManager","Wit/Common/Utilities/Array","VSS/Legacy/Legacy","Wit/Clients/Wit/RestClient/WorkItemTracking","Wit/Common/WorkItemDialogs/Components/DeleteDialog","Wit/Common/Utilities/Core","react-dom","VSS/Core/Util/Accessibility","VSS/Core/Util/Promise","VSSUI/Callout","VSSUI/ContextualMenuButton","VSS/Reflux/Store","Wit/Filter/FilterValueProviders","Wit/Filter/WorkItemFilter","Wit/Filter/AssignedToFilterProvider","Wit/Filter/FieldFilterProvider","Wit/Filter/AreaPathFilterProvider","Wit/Filter/FilterManager","Wit/Filter/TagsFilterProvider","Wit/Filter/TextFilterProvider","VSS/Platform/FPS","VSSUI/Util","VSS/Platform/Layout","VSS/Features/Frame/ContributedPivotBarItemProvider","VSSUI/Hub","VSSUI/HubHeader","VSSUI/Utilities/HubViewState","Wit/Common/Constants/CustomerInteligence","VSSUI/ZeroData","VSS/Core/Observable","VSSUI/Utilities/ViewOptions","VSSUI/Navigation/VssHubViewState","OfficeFabric/Selection","VSS/Core/TimerManagement","VSSUI/Components/VssDetailsList/VssDetailsList","VSSUI/Spinner","VSSUI/Utilities/Filter"],(function(e,t,o,i,r,s,a,n,l,m,c,d,u,h,p,g,I,b,C,_,k,y,f,T,S,w,D,v,W,F,P,A,H,N,R,x,M,O,E,V,U,L,B,Z,j,G,K,q,Q,z,$,Y,X,J,ee,te,oe,ie,re,se){var ae,ne,le,me,ce,de,ue,he,pe,ge,Ie,be,Ce,_e,ke,ye,fe,Te,Se,we,De,ve,We,Fe,Pe,Ae,He,Ne,Re,xe,Me,Oe,Ee,Ve,Ue,Le,Be,Ze,je,Ge,Ke;ae=t[Ke="Resources"]={},t[Ke].UnableToLoadHubData="Unable to load data for this tab",t[Ke].WorkItemsHubTitle="Work items",t[Ke].WorkItemUnassigned="Unassigned",t[Ke].OpenInQueriesCommand="Open in Queries",t[Ke].CheckButtonLabel="Select the row",t[Ke].OpenSelectionInQueriesCommand="Open selected items in Queries",t[Ke].OpenFilteredInQueriesCommand="Open filtered view in Queries",t[Ke].KeyboardShortcutGroup_Work="Work",t[Ke].KeyboardShortcutGroup_WorkItems="Work Items",t[Ke].KeyboardShortcutDescription_ToggleFullScreen="Toggle full screen mode",t[Ke].CompletedItemsViewOptionName="Completed Work Items",t[Ke].CompletedItemsHidden="Hidden",t[Ke].CompletedItemsShown="Shown",t[Ke].SortAscendingText="Ascending",t[Ke].SortByLabel="Sort by",t[Ke].SortDescendingText="Descending",t[Ke].BackToWorkItems="Back to Work Items",t[Ke].TriageNextWorkItemTooltip='Next work item in the "{0}" tab (Alt + N)',t[Ke].TriagePreviousWorkItemTooltip='Previous work item in the "{0}" tab (Alt + P)',t[Ke].TriageBackToTabTooltip='Back to "{0}" tab (Alt + Q)',t[Ke].KeyboardShortcutDescription_BackToWorkItemsHub="Back to Work Items",t[Ke].CompletedWorkItemsOffText="Completed work items hidden",t[Ke].CompletedWorkItemsOnText="Completed work items shown",t[Ke].CompletedWorkItemsToggleLabel="{0}. Press to toggle the completed work items option.",t[Ke].FilterChangedAnnouncementFormat="Filter has changed: {0}",t[Ke].WorkItemsHubGridLandmarkLabel="Work Items Hub grid",t[Ke].ColumnOptions="Column Options",t[Ke].ActivityDateColumnDisplayName="Activity Date",t[Ke].MentionedDateColumnDisplayName="Mentioned Date",t[Ke].MyActivityDetailsColumnDisplayName="Activity Details",t[Ke].MyActivityDetailsUpdated="Updated",t[Ke].MyActivityDetailsViewed="Viewed",t[Ke].WorkItemsHubTruncatedCommentCount="{0}+",t[Ke].WorkItemsHubComments="Comments",t[Ke].CopySelectedWorkitemsOpenAsQuery="Open as query",t[Ke].CommandBarTitle_CopyWorkItems="(Ctrl+C)",t[Ke].CommandBarTitle_DeleteWorkItems="(Del)",t[Ke].CopiedContentDialogTitle="Copied!",t[Ke].EmailSelectedWorkItems="Email...",t[Ke].DeleteSelectedWorkItems="Delete",t[Ke].RecycleBin="Recycle Bin",t[Ke].ImportWorkItems="Import Work Items",t[Ke].CopyToClipboard="Copy to clipboard",t[Ke].Loading="Loading...",t[Ke].NewWorkItemButtonText="New Work Item",t[Ke].FilterByKeyword="Filter by keyword",t[Ke].FilterByTypes="Types",t[Ke].FilterNoTypes="No types available",t[Ke].FilterByStates="States",t[Ke].FilterNoStates="No states available",t[Ke].FilterByTags="Tags",t[Ke].FilterNoTags="No tags available",t[Ke].FilterByAreaPath="Area",t[Ke].FilterNoArea="No areas available",t[Ke].FilterByAssignedTo="Assigned to",t[Ke].FilterResults="Filter results",t[Ke].SelectAllAriaLabel="Select all work items",t[Ke].SingleWorkItemFiltered="{0} work item found",t[Ke].MultipleWorkItemsFiltered="{0} work items found",t[Ke].Illustrations_GetBackToRecentWorkAltText="Get back to your recent work",t[Ke].Illustrations_KeepAnEyeOnImportantWorkAltText="Keep an eye on important work",t[Ke].Illustrations_MentionSomeoneAltText="Mention someone",t[Ke].Illustrations_SomethingWrongOnServerAltText="Server error",t[Ke].Illustrations_YourWorkInOnePlaceAltText="Your work, all in one place",t[Ke].ZeroData_SecondaryMessageLinkText="Learn more about work items",t[Ke].ZeroData_AssignedToMe_PrimaryMessage="Your work, all in one place",t[Ke].ZeroData_AssignedToMe_SecondaryMessage="Quickly take action on work items assigned to you.",t[Ke].ZeroData_AssignedToMe_SecondaryMessageLinkUrl="https://go.microsoft.com/fwlink/?linkid=2010008",t[Ke].ZeroData_Filter_WorkItems_ArtifactName="work items",t[Ke].ZeroData_Following_NotConfigured_PrimaryMessage="Feature not supported",t[Ke].ZeroData_Following_NotConfigured_SecondaryMessage="Enable this feature to keep an eye on important work.",t[Ke].ZeroData_Following_NotConfigured_SecondaryMessageLinkText="Learn more about how to enable following",t[Ke].ZeroData_Following_NotConfigured_SecondaryMessageLinkUrl="https://go.microsoft.com/fwlink/?linkid=2010112",t[Ke].ZeroData_Following_PrimaryMessage="Keep an eye on important work",t[Ke].ZeroData_Following_SecondaryMessageFormat="Click {0} to get updates about the items you want to track.",t[Ke].ZeroData_Following_SecondaryMessageLinkText="Learn more about following",t[Ke].ZeroData_Following_SecondaryMessageLinkUrl="https://go.microsoft.com/fwlink/?linkid=2010009",t[Ke].ZeroData_Mentioned_PrimaryMessage="Don't miss important work",t[Ke].ZeroData_Mentioned_SecondaryMessage="Quickly take action on items where you have been @mentioned.",t[Ke].ZeroData_Mentioned_SecondaryMessageLinkText="Learn more about @mentions",t[Ke].ZeroData_Mentioned_SecondaryMessageLinkUrl="https://go.microsoft.com/fwlink/?linkid=852411",t[Ke].ZeroData_MyActivity_PrimaryMessage="Get back to your recent work",t[Ke].ZeroData_MyActivity_SecondaryMessage="Find work items you have recently opened or edited.",t[Ke].ZeroData_MyActivity_SecondaryMessageLinkUrl="https://go.microsoft.com/fwlink/?linkid=2010008",t[Ke].ZeroData_RecentlyUpdated_PrimaryMessage="Find recently updated items",t[Ke].ZeroData_RecentlyUpdated_SecondaryMessage="View items that have been recently updated.",t[Ke].ZeroData_RecentlyUpdated_SecondaryMessageLinkUrl="https://go.microsoft.com/fwlink/?linkid=831361",t[Ke].ZeroData_RecentlyCreated_PrimaryMessage="Find recently created items",t[Ke].ZeroData_RecentlyCreated_SecondaryMessage="View items that are being created for this project.",t[Ke].ZeroData_RecentlyCreated_SecondaryMessageLinkUrl="https://go.microsoft.com/fwlink/?linkid=831361",t[Ke].ZeroData_ServerError_PrimaryText="Server error",t[Ke].ZeroData_RecentlyCompleted_PrimaryMessage="Find recently completed items",t[Ke].ZeroData_RecentlyCompleted_SecondaryMessage="View items that are being completed for this project.",t[Ke].ZeroData_RecentlyCompleted_SecondaryMessageLinkUrl="https://go.microsoft.com/fwlink/?linkid=831361",t[Ke].ZeroData_MyTeams_PrimaryMessage="Find what my team is working on",t[Ke].ZeroData_MyTeams_SecondaryMessage="View items from your team(s) that have been recently updated.",t[Ke].ZeroData_MyTeams_SecondaryMessageLinkUrl="https://go.microsoft.com/fwlink/?linkid=2010008",t[Ke].ZeroData_MyTeams_NotConfigured_PrimaryMessage="Feature not supported",t[Ke].ZeroData_MyTeams_NotConfigured_SecondaryMessage="You need to be a member of a team to find what your team is working on.",t[Ke].GenericFilterZeroData_Message="No {0} match your filter",t.DataContractsIActionsDataContract={},function(e){ne=t[e]={};t[e].ActionsHub=class{constructor(){this.endRefreshDataProvider=new o.Action,this.invalidateAllTabsData=new o.Action,this.removeWorkItems=new o.Action,this.invalidateTabData=new o.Action,this.updateFilter=new o.Action,this.setCompletedItemsVisibility=new o.Action,this.sortItems=new o.Action,this.endPageWorkItems=new o.Action}}}("ActionsActionsHub"),function(e){le=t[e]={},function(e){e.MentionedDateField="MentionedDate"}(t[e].MentionedTabDataProvider||(t[e].MentionedTabDataProvider={})),function(e){e.MyActivityDateField="MyActivityDate",e.MyActivityDetailsField="MyActivityDetails",e.RecentlyUpdatedDateField="RecentlyUpdatedDate"}(t[e].RecentActivityConstants||(t[e].RecentActivityConstants={})),function(e){e.MaxWorkItems=1e3,e.InitialPageSize=100}(t[e].WorkItemsHubPaging||(t[e].WorkItemsHubPaging={})),function(e){e.TabRouteParameterName="name"}(t[e].WorkItemsHubRouteConstants||(t[e].WorkItemsHubRouteConstants={})),function(e){e.WorkItemsHubRecentTabIdKey="WorkItemsHub/RecentTabId",e.WorkItemsHubColumnSettingsKeyTemplate="WorkItemsHub/ColumnSettings/{0}",e.WorkItemsHubShowCompletedKeyTemplate="WorkItemsHub/ShowCompleted/{0}",e.InjectedCommentCount=1,e.NonexistentCommentCount=0}(t[e].WorkItemsHubSettingsHelper||(t[e].WorkItemsHubSettingsHelper={})),function(e){e[e.AssignedToMe=0]="AssignedToMe",e[e.Following=1]="Following",e[e.Mentioned=2]="Mentioned",e[e.MyActivity=3]="MyActivity",e[e.RecentlyCreated=4]="RecentlyCreated",e[e.RecentlyUpdated=5]="RecentlyUpdated",e[e.RecentlyCompleted=6]="RecentlyCompleted",e[e.MyTeams=7]="MyTeams"}(t[e].WorkItemsHubTabs||(t[e].WorkItemsHubTabs={}))}("GeneratedConstants"),function(e){me=t[e]={},t[e].TabEnumValueByTabIdMap={},t[e].TabIdByTabEnumValueMap={},t[e].TabIds=[],Object.keys(le.WorkItemsHubTabs).every((o=>{if("number"==typeof le.WorkItemsHubTabs[o])return!1;const i=parseInt(o,10),r=le.WorkItemsHubTabs[i].toLowerCase();return t[e].TabEnumValueByTabIdMap[r]=i,t[e].TabIdByTabEnumValueMap[i]=r,t[e].TabIds.push(r),!0})),t[e].getTabIdByName=function(o){if(o){const i=o.toLowerCase();if(t[e].TabIds.indexOf(i)>=0)return i}return null}}("UtilsWorkItemsHubTabUtils"),function(e){var o;ce=t[e]={},function(e){e.DefaultDataProvider="ms.vss-work-web.new-work-items-hub-default-data-provider",e.AssignedToMeDataProvider="ms.vss-work-web.new-work-items-hub-assignedtome-tab-data-provider",e.FollowingDataProvider="ms.vss-work-web.new-work-items-hub-following-tab-data-provider",e.MentionedDataProvider="ms.vss-work-web.new-work-items-hub-mentioned-tab-data-provider",e.MyActivityDataProvider="ms.vss-work-web.new-work-items-hub-myactivity-tab-data-provider",e.RecentlyUpdatedDataProvider="ms.vss-work-web.new-work-items-hub-recentlyupdated-tab-data-provider",e.RecentlyCreatedDataProvider="ms.vss-work-web.new-work-items-hub-recentlycreated-tab-data-provider",e.RecentlyCompletedDataProvider="ms.vss-work-web.new-work-items-hub-recentlycompleted-tab-data-provider",e.MyTeamsDataProvider="ms.vss-work-web.new-work-items-hub-myteams-tab-data-provider"}(o=t[e].WorkItemsHubDataProviderConstants||(t[e].WorkItemsHubDataProviderConstants={}));const i={[le.WorkItemsHubTabs.AssignedToMe]:o.AssignedToMeDataProvider,[le.WorkItemsHubTabs.Following]:o.FollowingDataProvider,[le.WorkItemsHubTabs.Mentioned]:o.MentionedDataProvider,[le.WorkItemsHubTabs.MyActivity]:o.MyActivityDataProvider,[le.WorkItemsHubTabs.RecentlyUpdated]:o.RecentlyUpdatedDataProvider,[le.WorkItemsHubTabs.RecentlyCreated]:o.RecentlyCreatedDataProvider,[le.WorkItemsHubTabs.RecentlyCompleted]:o.RecentlyCompletedDataProvider,[le.WorkItemsHubTabs.MyTeams]:o.MyTeamsDataProvider};!function(e){function t(e,t){const o=r(t);return e.getService("IVssContributionService").getData(o)}function r(e){const t=me.TabEnumValueByTabIdMap[e];let r=i[t];return r||(r=o.DefaultDataProvider),r}function s(e){const t=e.getService("IVssHistoryService").getCurrentRouteValues()[le.WorkItemsHubRouteConstants.TabRouteParameterName];return me.getTabIdByName(t)}e.refreshDataAsync=function(e,t,o){const i=r(t);return e.getService("IVssContributionService").getDataAsync(i,{pageSize:o},!0)},e.getData=t,e.getDataForCurrentTab=function(e){return t(e,s(e))},e.getDataProviderId=r,e.getCurrentTabId=s,e.pageWorkItems=function(e,t,o,i){const s=r(t);return e.getService("IVssContributionService").getDataAsync(s,{workItemIds:o,fieldReferenceNames:i},!0)}}(t[e].WorkItemsHubDataProvider||(t[e].WorkItemsHubDataProvider={}))}("DataProvidersWorkItemsHubDataProvider"),t.StoresIWorkItemsHubFilterDataSource={},function(e){var o,i;de=t[e]={},function(e){e.Area="WorkItemsHub",e.WorkItemsHubInitialLoad="WorkItemsHubInitialLoad",e.WorkItemsHubTabSwitch="WorkItemsHubTabSwitch",e.CreateWorkItem="CreateWorkItem",e.OpenInQueries="OpenInQueries",e.ColumnOptionsCommand="ColumnOptionsCommand",e.RecycleBin="RecycleBin",e.ImportWorkItems="ImportWorkItems",e.CopyToClipboard="CopyToClipboard",e.Email="Email",e.Delete="Delete",e.DeleteCommand="DeleteCommand",e.CompletedWorkItems="CompletedWorkItems",e.ColumnOptionsChange="ColumnOptionsChange",e.ColumnResize="ColumnResize",e.ColumnHeaderClick="ColumnHeaderClick",e.BackCompatOpenWorkItem="BackCompatOpenWorkItem",e.BackCompatQuery="BackCompatQuery",e.LoadWorkItemsHub="LoadWorkItemsHub",e.ClickOnWorkItem="ClickOnWorkItem",e.ChangedTabValue="ChangedTabValue"}(o=t[e].TelemetryConstants||(t[e].TelemetryConstants={})),function(e){e[e.Unknown=0]="Unknown",e[e.PageLoad=1]="PageLoad",e[e.TabSwitch=2]="TabSwitch"}(i||(i={}));class r{constructor(e){this._service=e.getService("IVssPerformanceService")}static getInstance(e){return r._instance||(r._instance=new r(e)),r._instance}startPageLoad(){this._scenarioType=i.PageLoad}startTabSwitch(){this._scenarioType=i.TabSwitch,this._service.startScenario(o.WorkItemsHubTabSwitch,!1)}endScenario(e){switch(this._scenarioType){case i.TabSwitch:this._service.endScenario(o.Area,o.WorkItemsHubTabSwitch,!1,void 0,e);break;case i.PageLoad:this._service.markTimeToInteractive(o.Area,o.WorkItemsHubInitialLoad,void 0,e)}this._scenarioType=i.Unknown}split(e){this._service.addSplitTiming(e)}}t[e].PerformanceTelemetryHelper=r,function(e){function t(e,t,i){e.getService("IVssTelemetryService").publishEvent(o.Area,t,i)}e.publishCreateNewWorkItemTelemetry=function(e,i){t(e,o.CreateWorkItem,{workItemType:i})},e.publishImportWorkItemsCommand=function(e,i){t(e,o.ImportWorkItems,{tabId:i})},e.publishRecycleBinCommand=function(e,i){t(e,o.RecycleBin,{tabId:i})},e.publishColumnOptionsCommandpageContext=function(e,i){t(e,o.ColumnOptionsCommand,{tabId:i})},e.publishOpenInQueriesTelemetry=function(e,i,r,s){t(e,o.OpenInQueries,{tabId:i,hasFilter:r,hasSelection:s})},e.publishCopyToClipboardTelemetry=function(e,i,r){t(e,o.CopyToClipboard,{tabId:i,keyboardShortcutEvent:r})},e.publishDeleteTelemetry=function(e,i,r){t(e,o.Delete,{tabId:i,keyboardShortcutEvent:r})},e.publishEmailTelemetry=function(e,i){t(e,o.Email,{tabId:i})},e.publishCompletedWorkItemsViewOptionTelemetry=function(e,i,r){t(e,o.CompletedWorkItems,{tabId:i,isOn:r})},e.publishColumnOptionsChange=function(e,i,r){t(e,o.ColumnOptionsChange,Object.assign({tabId:i},r))},e.publishColumnOptionsCommand=function(e,i){t(e,o.ColumnOptionsCommand,{tabId:i})},e.publishColumnResize=function(e,i,r){t(e,o.ColumnResize,Object.assign({tabId:i},r))},e.publishColumnHeaderClick=function(e,i,r){t(e,o.ColumnHeaderClick,Object.assign({tabId:i},r))},e.publishBackCompatUrlOpenWorkItem=function(e,i){t(e,o.BackCompatOpenWorkItem,{hash:i})},e.publishBackCompatUrlQuery=function(e,i){t(e,o.BackCompatQuery,{hash:i})},e.publishLoadWorkItemsHub=function(e,i){t(e,o.LoadWorkItemsHub,{tabId:i})},e.publishClickOnWorkItem=function(e,i){t(e,o.ClickOnWorkItem,{workItemId:i})},e.publishChangedTabValue=function(e,i){t(e,o.ChangedTabValue,{tabId:i})}}(t[e].UsageTelemetryHelper||(t[e].UsageTelemetryHelper={}))}("UtilsTelemetry"),function(e){ue=t[e]={};t[e].ActionsCreator=class{constructor(e,t){this._pageContext=e,this._actionsHub=t}invalidateTabData(e){this._actionsHub.invalidateTabData.invoke(e)}refreshDataProviderAsync(e,t=!1,o=le.WorkItemsHubPaging.MaxWorkItems){t&&this._actionsHub.invalidateAllTabsData.invoke(null),ce.WorkItemsHubDataProvider.refreshDataAsync(this._pageContext,e,o).then((t=>{this._actionsHub.endRefreshDataProvider.invoke({tabId:e,tabData:t})}),(t=>{this._actionsHub.endRefreshDataProvider.invoke({tabId:e,tabData:null}),(0,i.traceError)(this._pageContext,de.TelemetryConstants.Area,"refreshDataAsync",t)}))}removeWorkItemFromDataProvider(e,t){this._actionsHub.removeWorkItems.invoke({tabId:e,workItemIds:t})}updateFilterState(e,t){this._actionsHub.updateFilter.invoke({tabId:e,updatedFilter:t})}sortColumn(e,t){this._actionsHub.sortItems.invoke({tabId:e,sortOptions:t})}setCompletedItemsVisibility(e,t){this._actionsHub.setCompletedItemsVisibility.invoke({tabId:e,showCompletedItems:t})}pageWorkItems(e,t){const o=t.getNextPageIds(),r=t.getPageableFieldReferenceNames();ce.WorkItemsHubDataProvider.pageWorkItems(this._pageContext,e,o,r).then((t=>{this._actionsHub.endPageWorkItems.invoke({tabId:e,fieldReferenceNames:r,fieldValuesList:t.fieldValues})})).then(null,(e=>{(0,i.traceError)(this._pageContext,de.TelemetryConstants.Area,"pageWorkItems",e)}))}}}("ActionsActionsCreator"),t.ComponentsIWorkItemsTabContentData={},function(e){he=t[e]={},t[e].MyActivityDateFieldValues={},function(e){e.ACTION="action",e.ACTION_QUERY="query",e.ACTION_EDIT="edit"}(t[e].ActionUrl||(t[e].ActionUrl={})),function(e){e.TEMPQUERYID="tempQueryId",e.PATH="path",e.ID="id",e.IMPORTDATA="importData"}(t[e].ActionParameters||(t[e].ActionParameters={})),function(e){e.UseTokenFiltering="WebAccess.WorkItemTracking.UseTokenFiltering"}(t[e].FeatureFlags||(t[e].FeatureFlags={})),t[e].WorkItemsHubViewName="new-work-items-hub-view",t[e].WorkItemsHubTabGroupContributionId="ms.vss-work-web.new-work-items-hub-tab-group",t[e].WorkItemsHubRouteId="ms.vss-work-web.new-work-items-hub-view-route",t[e].CreateWorkItemRouteId="ms.vss-work-web.work-items-create-route",t[e].OpenWorkItemRouteId="ms.vss-work-web.work-items-form-route-with-id",t[e].QueriesRouteId="ms.vss-work-web.query-route-basic",t[e].TabContent_BaseClassName="work-items-tab-content",t[e].TabContent_GridBaseClassName="work-items-hub-grid",t[e].TabContent_WorkItemsHubDetailsListClassName="work-items-hub-detailslist",t[e].TabContent_WorkItemsHubGridRowClassName="work-items-hub-row"}("Constants"),t.DataContractsIWorkItemsGridData={},function(e){pe=t[e]={},t[e].shallowEquals=function(e,t){if(e===t)return!0;if(null==e||null==t||e.length!==t.length)return!1;for(let o=0,i=e.length;o<i;++o)if(e[o]!==t[o])return!1;return!0},t[e].toDictionary=function(e,t,o,i){var r={};return e.forEach(((e,s)=>{var a=t(e,s);if(a){var n;if(n=o?o(e,s):e,i&&r[a])throw new Error("toDictionary: Duplicate entries for key: "+a);r[a]=n}})),r},t[e].findIndex=function(e,t){for(var o=0,i=e.length;o<i;o++)if(t(e[o]))return o;return-1},t[e].uniqueSort=function(e,t){e.sort(t);for(var o=1,i=e.length;o<i;o++)0===t(e[o],e[o-1])&&(e.splice(o--,1),i--);return e}}("UtilsArray"),function(e){ge=t[e]={};const o=a.format(ae.WorkItemsHubTruncatedCommentCount,99);t[e].createWorkItemCommentCountCell=function(e){var t=Number(e.workItemCommentCount)>99?o:e.workItemCommentCount;return r.createElement(s.Tooltip,{text:t,overflowOnly:!0},r.createElement("div",{className:"work-item-comment-count-cell"},r.createElement("span",{className:"bowtie-icon bowtie-comment-discussion work-item-comment-count-icon"}),r.createElement("span",null,t)))}}("ComponentsCellsWorkItemCommentCountCell"),function(e){Ie=t[e]={},t[e].createWorkItemDateTimeCell=function(e){const{dateTime:t,contentFormat:o="{0}"}=e,i=new Intl.DateTimeFormat(void 0,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),l=(0,n.localeDateFormat)(t,"G",i).replace(",",""),m=l;return r.createElement(s.Tooltip,{text:l,overflowOnly:!0},r.createElement("span",{className:"work-item-date-time-cell"},a.format(o,m)))}}("ComponentsCellsWorkItemDateTimeCell"),function(e){function o(e,t,o){return`${(0,l.routeUrl)(e,he.QueriesRouteId,{project:t})}?${o}`}function i(e){var t=[];for(let i in e){let r=e[i];if(null!=r){var o="action"===i?"_a":i;t.push(o+"="+encodeURIComponent(r))}}return t.join("&")}be=t[e]={},t[e].getCurrentHashString=function(){let e=window.location.hash;return e&&"#"===e[0]&&(e=e.substr(1)),e},t[e].deserializeState=function(e){const t={};return(e||"").split("&").forEach((e=>{let o=e.split("=",2);if(2===o.length){let e=o[0];"_a"===e&&(e="action");const i=o[1].replace(/\+/g,"%20");try{t[e]=decodeURIComponent(i)}catch(o){t[e]=i}}})),t},t[e].getWorkItemHubUrl=function(e){return(0,l.routeUrl)(e,he.WorkItemsHubRouteId)},t[e].getQueriesHubUrl=o,t[e].getEditWorkItemUrl=function(e,t,o){return t?(0,l.routeUrl)(e,he.OpenWorkItemRouteId,{project:t,id:`${o}`}):""},t[e].getCreateWorkItemUrl=function(e,t,o){return`${(0,l.routeUrl)(e,he.CreateWorkItemRouteId,{project:t})}/${o}`},t[e].getImportWorkItemsUrl=function(e,t){return`${o(e,t,i({[he.ActionUrl.ACTION]:he.ActionUrl.ACTION_QUERY,[he.ActionParameters.IMPORTDATA]:"csv"}))}`},t[e].getRecycleBinUrl=function(e,t){return`${o(e,t,i({[he.ActionUrl.ACTION]:he.ActionUrl.ACTION_QUERY,[he.ActionParameters.PATH]:ae.RecycleBin}))}`},t[e].getTempQueryUrl=function(e,t,r){return`${o(e,t,i({[he.ActionUrl.ACTION]:he.ActionUrl.ACTION_QUERY,[he.ActionParameters.TEMPQUERYID]:r}))}`}}("UtilsUrlUtils"),function(e){Ce=t[e]={},t[e].openInQueries=function(e,t,o,r,s){if(r){const a=o=>{n.location.href=be.getTempQueryUrl(e,t,o)},n=window.open("","_blank"),l=s&&s.length>0,c=r.hasFilter();let d;if(l)d=r.generateWiqlForSelectedIds(s);else if(c){const e=r.getFilteredIds();d=r.generateWiqlForSelectedIds(e)}else d=r.generateWiqlForTab();m.TempQueryUtils.beginCreateTemporaryQueryId(e,d).then(a,(t=>i.traceError(e,de.TelemetryConstants.Area,de.TelemetryConstants.OpenInQueries,t.message))),de.UsageTelemetryHelper.publishOpenInQueriesTelemetry(e,o,c,l)}}}("UtilsNavigationUtils"),function(e){_e=t[e]={},t[e].createWorkItemIconTitleCell=function(e,t){return r.createElement("div",{className:"work-item-icon-title-cell"},r.createElement(d.WorkItemTypeIcon,{data:t.icon}),r.createElement("div",{className:"work-item-title"},r.createElement(c.Link,{className:"work-item-title-link",href:be.getEditWorkItemUrl(e,t.projectName,t.workItemId),onClick:o=>{t.onOpenWorkItem(t.workItemId,o),de.UsageTelemetryHelper.publishClickOnWorkItem(e,t.workItemId)},tooltipProps:{className:"work-item-title-tooltiphost",overflowOnly:!0,showOnFocus:!0,text:t.workItemTitle}},t.workItemTitle)))}}("ComponentsCellsWorkItemIconTitleCell"),function(e){ke=t[e]={},t[e].createWorkItemSimpleCell=function(e){return r.createElement(s.Tooltip,{text:e.text,overflowOnly:!0},r.createElement("span",{className:"work-item-simple-cell"},e.text))}}("ComponentsCellsWorkItemSimpleCell"),function(e){ye=t[e]={};class o{static getDefaultColumnWidth(e){return o.KnownColumnDefaultWidths[e]||o.DefaultWidth}create(e,t,i,r,s,a,n,l,m,c){return{key:i,name:r,minWidth:o.MinWidth,calculatedWidth:c,isPadded:!1,isResizable:!0,isSorted:l,isSortedDescending:m,columnActionsMode:u.ColumnActionsMode.clickable,onRender:(o,r,l)=>this._createCell(e,t,o,i,s,l,a,n)}}_createCell(e,t,i,s,a,n,l,m){if(s===g.CoreFieldRefNames.Title)return this._createTitleCell(e,t,i,a,m);if(s===g.CoreFieldRefNames.State)return this._createStateCell(e,t,i,a);const c=a[s];let d,u=i.values[c];if(s===g.CoreFieldRefNames.Tags){const e=(0,b.splitAndTrimTags)(u);return u?r.createElement(k.TagsList,{tags:e,className:"work-item-tags"}):null}return s===g.CoreFieldRefNames.AssignedTo?o._createIdentityCell(e,u):s===g.CoreFieldRefNames.CommentCount?0!==Number(u)?o._createCommentCountCell(u):null:u instanceof Date?o._createDateTimeCell(i.values[c],"{0}",l,!1,e):(0,C.isWorkItemIdentityRef)(u)?o._createIdentityCell(e,u):(s===le.RecentActivityConstants.MyActivityDetailsField&&(u=he.MyActivityDateFieldValues[u]),null!=u&&"string"!=typeof u&&"number"!=typeof u&&(u=String(u)),null!==u&&"number"==typeof u&&(u=u.toLocaleString(void 0,I.DefaultNumberFormatOptions)),d=o.DefaultCreateMethod,d(u,l))}_createStateCell(e,t,o,i){const s=o.values[i[g.CoreFieldRefNames.State]],a=o.values[i[g.CoreFieldRefNames.WorkItemType]],n=e.getService("work-item-state-color-metadata-service").getWorkItemStateColor(t,a,s);if(!(n instanceof Promise))return r.createElement(y.WorkItemState,{data:n,hideText:!1});console.warn("Failed to fetch work item state data from the data provider.")}_createTitleCell(e,t,o,i,r){const s=o.values[i[g.CoreFieldRefNames.Id]],a=o.values[i[g.CoreFieldRefNames.Title]],n=o.values[i[g.CoreFieldRefNames.WorkItemType]],l=e.getService("work-item-type-icon-metadata-service").getWorkItemIcon(t,n);if(!(l instanceof Promise))return(0,_e.createWorkItemIconTitleCell)(e,{workItemId:s,workItemTitle:a,projectName:t,workItemType:n,onOpenWorkItem:r,icon:l});console.warn("Failed to fetch work item icon data from data provider.")}static _createDateTimeCell(e,t,o,i=!0,r){const s=new Date(e),a=(0,h.isFeatureEnabled)(r,"ms.vss-work-web.new-boards-hub-feature");return(0,Ie.createWorkItemDateTimeCell)({dateTime:a?(0,p.getDateInUserTimeZone)(s):s,contentFormat:t,showFriendlyDateTime:i,friendlyStartDateTime:o})}static _createIdentityCell(e,t){const o=(0,C.convertWorkItemIdentityRefFromFieldValue)(e,t),i=t&&o.identityRef;return r.createElement(_.IdentityView,{identityRef:i,viewMode:0,size:"extra-small-plus"})}static _createCommentCountCell(e){return(0,ge.createWorkItemCommentCountCell)({workItemCommentCount:e})}}t[e].WorkItemsGridColumnFactory=o,o.DefaultWidth=150,o.MinWidth=10,o.KnownColumnDefaultWidths={[g.CoreFieldRefNames.Id]:60,[g.CoreFieldRefNames.WorkItemType]:90,[g.CoreFieldRefNames.Title]:450,[g.CoreFieldRefNames.AreaPath]:200,[g.CoreFieldRefNames.IterationPath]:200,[g.CoreFieldRefNames.AssignedTo]:200,[g.CoreFieldRefNames.State]:100,[g.CoreFieldRefNames.Tags]:200,[g.CoreFieldRefNames.CommentCount]:75,[le.RecentActivityConstants.MyActivityDetailsField]:110},o.DefaultCreateMethod=e=>(0,ke.createWorkItemSimpleCell)({text:e})}("UtilsWorkItemsGridColumnFactory"),function(e){fe=t[e]={};class o{constructor(e,t,o,i){this.pageContext=e,this._hubData=t;const{userSettings:r,processSettings:s}=t;let n,l,m=s.defaultSortOptions,c=le.WorkItemsHubSettingsHelper.NonexistentCommentCount;const d=(0,pe.findIndex)(t.processSettings.fieldReferenceNames,(e=>(0,a.equals)(e,g.CoreFieldRefNames.CommentCount,!0)))>=0;r&&(n=r.filter,r.columnSettings&&r.columnSettings.sortOptions&&r.columnSettings.sortOptions.length>0&&(m=r.columnSettings.sortOptions),r.columnSettings&&r.columnSettings.columnOptions&&r.columnSettings.columnOptions.length>0&&(l=r.columnSettings.columnOptions),r.columnSettings&&r.columnSettings.version&&(c=r.columnSettings.version)),l||(d&&(c=le.WorkItemsHubSettingsHelper.InjectedCommentCount),l=this.getDisplayedFieldReferenceNames().map((e=>({fieldReferenceName:e,width:ye.WorkItemsGridColumnFactory.getDefaultColumnWidth(e)})))),this._columnOptions=l,this._version=c,this._filterStateManager=new T.FilterStateManager(this.pageContext,o,this._getFilterRegistryKey(),n),this._columnMap=this._getColumnMap(t);const u=this._columnMap[g.CoreFieldRefNames.Id];isNaN(u)&&console.warn("id column doesn't exist"),this._fillIdMaps(t,u),this._showCompletedItems=s.tabId===me.TabIdByTabEnumValueMap[le.WorkItemsHubTabs.RecentlyCompleted]||i,this._isCompleteItemsLoaded=t.processSettings.completedItemsLoaded,this.setSortInfo(m),this._visibleIds=this._sortItems(this._ids)}static SortValueGetter(e,t){return(0,C.isWorkItemIdentityRef)(t)?o._getDistinctDisplayName(e,t):t}getDataSourceName(){return`WorkItemHub-${this._hubData.processSettings.tabId}`}getItemCount(){return this.getPagedItemsCount()+this._getUnpagedItemsCount()}getVisibleItemsCount(){return this._visibleIds.length}getPagedItemsCount(){return this._ids.length}getCurrentColumnSettingsVersion(){return this._version}setCompletedItemsVisibility(e){this._showCompletedItems=e}setSortInfo(e){let t=e.filter((e=>void 0!==this._columnMap[e.fieldReferenceName]));if(0===t.length){const e=this.getFieldReferenceNames();t=[{fieldReferenceName:e[e.length-1],isAscending:!1}]}this._sortOptions=t}getCurrentColumnOptions(){return this._columnOptions}isFeatureSupported(){return!this._hubData.processSettings.featureNotSupported}getSortOptions(){return this._sortOptions}isSortableField(e){return!(this._hubData.processSettings.unsortableFieldReferenceNames&&this._hubData.processSettings.unsortableFieldReferenceNames.indexOf(e)>=0)}hasAreaPath(){return this._hubData.processSettings.fieldReferenceNames.indexOf(g.CoreFieldRefNames.AreaPath)>=0}shouldShowCompletedItems(){return this._showCompletedItems}isCompletedItemsLoaded(){return!!this._isCompleteItemsLoaded}getIds(){let e=this._ids;return this._showCompletedItems||(e=this.getIdsInDoingStates(this._hubData.fieldValues)),e}_sortItems(e){const t=this._columnMap[g.CoreFieldRefNames.Id],{fieldValues:o}=this._hubData;let i=this._sortOptions.map((e=>e.fieldReferenceName)).map((e=>this._columnMap[e])),r=this._sortOptions.map((e=>e.isAscending));const s=o.map((e=>e.data)).filter((o=>e.indexOf(o[t])>=0));return s.sort(this._sortFunction.bind(this,i,r)),s.map((e=>e[t]))}_sortFunction(e,t,i,r){for(let s=0;s<e.length;s++){const n=e[s],l=t[s];let m=i[n],c=r[n];if(m=null==m?null:o.SortValueGetter(this.pageContext,m),c=null==c?null:o.SortValueGetter(this.pageContext,c),!l){const e=m;m=c,c=e}if(m!==c)return null===m?1:null===c?-1:"string"==typeof m&&"string"==typeof c?(0,a.localeIgnoreCaseComparer)(m,c):m<c?-1:1}return 0}getIdToWorkItemMap(){return this._idToWorkItemMap}getPageSize(){return o.NextPageSize}getFieldReferenceNames(){return this._hubData.processSettings.fieldReferenceNames}getDisplayedFieldReferenceNames(){let e;if(this._hubData.userSettings){const t=this._hubData.userSettings.columnSettings;t&&t.columnOptions&&t.columnOptions.length>0&&(e=t.columnOptions.map((e=>e.fieldReferenceName)))}return e||(e=this._hubData.processSettings.fieldReferenceNames.filter((e=>o.ExcludedFieldsFromDefaultColumns.indexOf(e)<0))),e}getPageableFieldReferenceNames(){return this._hubData.processSettings.fieldReferenceNames.filter((e=>o.NonPageableFields.indexOf(e)<0))}getNextPageIds(){const e=this._hubData.pageContext;return e&&e.unpagedWorkItemIds?e.unpagedWorkItemIds.slice(0,this.getPageSize()):[]}canPageMoreItems(){const e=this._hubData.pageContext;return e&&e.unpagedWorkItemIds&&e.unpagedWorkItemIds.length>0}isPagingSupported(){return!!this._hubData.pageContext}removeWorkItems(e){let t=!1;if(null!=e)for(const o of e){const e=this._ids.indexOf(o);e>=0&&(this._ids.splice(e,1),t=!0);const i=this._visibleIds.indexOf(o);i>=0&&this._visibleIds.splice(i,1);const r=this._columnMap[g.CoreFieldRefNames.Id];if(this._hubData.fieldValues){const e=this._hubData.fieldValues.map((e=>e.data)),t=(0,pe.findIndex)(e,(e=>e[r]===o));t>=0&&this._hubData.fieldValues.splice(t,1)}delete this._idToWorkItemMap[o]}return t}_mergeFieldValues(e,t){const o=t.fieldReferenceNames.indexOf(g.CoreFieldRefNames.Id),i={},r={};t.fieldReferenceNames.forEach(((e,t)=>{r[e]=t}));for(const e of t.fieldValuesList){i[e.data[o]]=e.data}const s=this._hubData.pageContext,a={},n={};if(s.fieldReferenceNames&&s.fieldReferenceNames.length>0&&s.fieldReferenceNames.forEach(((e,t)=>{n[e]=t})),s.fieldValues&&s.fieldValues.length>0)for(let t=0,o=e.length;t<o;t++)a[e[t]]=s.fieldValues[t].data;const l=this.getFieldReferenceNames();for(const t of e)if(i.hasOwnProperty(t)){const e=[];for(const o of l){let s,l=-1;l=r[o],l>=0?s=i[t][l]:(l=n[o],l>=0&&(s=a[t][l])),e.push(s)}this._ids.push(t),this._visibleIds.push(t),this._idToWorkItemMap[t]=e,this._hubData.fieldValues.push({data:e})}}addWorkItems(e){if(e){const t=this._hubData.pageContext,o=this.getNextPageIds();this._mergeFieldValues(o,e);const i=this.getPageSize();return t.unpagedWorkItemIds&&t.unpagedWorkItemIds.length>0&&t.unpagedWorkItemIds.splice(0,i),t.fieldValues&&t.fieldValues.length>0&&t.fieldValues.splice(0,i),!0}return!1}getValue(e,t){const o=this._columnMap[t];if(o>=0){const i=this._idToWorkItemMap[e];return(0,a.equals)(t,g.CoreFieldRefNames.AreaPath,!0)?i&&i[o]:(0,a.equals)(t,g.CoreFieldRefNames.AssignedTo,!0)?i&&(0,C.convertWorkItemIdentityRefFromFieldValue)(this.pageContext,i[o]):i&&i[o]}return null}getVisibleFields(){return this._hubData.processSettings.fieldReferenceNames}getUniqueValues(e){const t=this._columnMap[e];if(void 0===t)return[];let o,i=this._hubData.fieldValues.filter((e=>e.data[t])).map((e=>e.data));if(!this._showCompletedItems){const e=this._hubData.processSettings.doneStateNames,t=this._columnMap[g.CoreFieldRefNames.State];i=i.filter((o=>(0,pe.findIndex)(e,(e=>(0,a.equals)(e,o[t],!0)))<0))}if((0,a.equals)(e,g.CoreFieldRefNames.AssignedTo,!0)){const e=i.map((e=>(0,C.convertWorkItemIdentityRefFromFieldValue)(this.pageContext,e[t])));return(0,C.uniqueSortWorkItemIdentityRefObjects)(e)}if(o=(0,a.equals)(e,g.CoreFieldRefNames.AreaPath,!0)?i.map((e=>(0,f.getAreaPathLeafNode)(e[t]))):i.map((e=>e[t])),(0,a.equals)(e,g.CoreFieldRefNames.Tags,!0)){const e={};for(const t of o){const o=(0,b.splitAndTrimTags)(t);for(const t of o)e[t]=!0}return(0,S.uniqueSort)(Object.keys(e),a.localeIgnoreCaseComparer)}return(0,S.uniqueSort)(o,a.localeIgnoreCaseComparer)}getFilteredData(){return Object.assign(Object.assign({},this._hubData),{fieldValues:this._getFieldValuesByIds(this._visibleIds)})}hideCompletedItems(){const e=this._getFieldValuesByIds(this._visibleIds);this._visibleIds=this.getIdsInDoingStates(e)}getIdsInDoingStates(e){const t=this._hubData.processSettings.doneStateNames,o=this._columnMap[g.CoreFieldRefNames.State],i=this._columnMap[g.CoreFieldRefNames.Id],r=[];for(const s of e){const e=s.data;(0,pe.findIndex)(t,(t=>(0,a.equals)(t,e[o],!0)))<0&&r.push(e[i])}return r}getFilteredIds(){return this._visibleIds}setVisibleIds(e){this._visibleIds=this._sortItems(e)}resetFilter(e){this.setVisibleIds(this._ids),e?this._filterStateManager.resetFilter():this._filterStateManager.setFilterState({})}saveFilters(e){this._filterStateManager.saveFilter(e)}setFilters(e){this._filterStateManager.setFilterState(e)}getFilterState(){return this._filterStateManager.getFilterState()}hasFilter(){const e=this.getFilterState();return e&&Object.keys(e).length>0}generateWiqlForSelectedIds(e){0===(e=e||[]).length&&e.push(0);const t=`${g.CoreFieldRefNames.Id} IN (${e.join(", ")})`;return(0,a.format)(this._hubData.processSettings.wiqlTemplate,t,this._getOrderByClause())}generateWiqlForTab(){const{wiqlTemplate:e,defaultWhereClause:t,doneStateNames:o}=this._hubData.processSettings;let i=t;return this._showCompletedItems||(i+=` and ${g.CoreFieldRefNames.State} NOT IN (${o.map((e=>`"${e}"`)).join(",")})`),(0,a.format)(e,i,this._getOrderByClause())}getFieldValues(e,t){const o=(0,pe.toDictionary)(this._hubData.processSettings.fieldReferenceNames,(e=>e),((e,t)=>t)),i=[];return e.forEach((e=>{if(this._idToWorkItemMap.hasOwnProperty(e.toString())){const r=this._idToWorkItemMap[e],s=t.map((e=>r[o[e]]));i.push(s)}})),i}_getOrderByClause(){const{defaultOrderByClause:e}=this._hubData.processSettings;let t="";return this._sortOptions.forEach((e=>{const{fieldReferenceName:i,isAscending:r}=e;if(o.NonWiqlSortableFields.indexOf(i)<0){const e=`[${i}] ${r?"asc":"desc"}`;t+=""===t?e:`, ${e}`}})),""===t?e:t}_getFilterRegistryKey(){return`Filters/WorkItemsHub/${this._hubData.processSettings.tabId}/Filter`}_getColumnMap(e){const t={};return e.processSettings.fieldReferenceNames.forEach(((e,o)=>{t[e]=o})),t}_getFieldValuesByIds(e){const t=[];return e.forEach((e=>{this._idToWorkItemMap.hasOwnProperty(e.toString())&&t.push({data:this._idToWorkItemMap[e]})})),t}_fillIdMaps(e,t){this._ids=[],this._idToWorkItemMap={};for(const o of e.fieldValues){const e=o.data,i=e[t];this._ids.push(i),this._idToWorkItemMap[i]=e}}_getUnpagedItemsCount(){return this.isPagingSupported()?this._hubData.pageContext.unpagedWorkItemIds.length:0}static _getDistinctDisplayName(e,t){return(0,C.convertWorkItemIdentityRefFromFieldValue)(e,t).distinctDisplayName}}t[e].WorkItemsHubFilterDataSource=o,o.NextPageSize=le.WorkItemsHubPaging.MaxWorkItems-le.WorkItemsHubPaging.InitialPageSize,o.NonPageableFields=[le.RecentActivityConstants.MyActivityDateField,le.RecentActivityConstants.MyActivityDetailsField,le.RecentActivityConstants.RecentlyUpdatedDateField,le.MentionedTabDataProvider.MentionedDateField],o.ExcludedFieldsFromDefaultColumns=[g.CoreFieldRefNames.WorkItemType,le.RecentActivityConstants.MyActivityDetailsField],o.NonWiqlSortableFields=[...o.NonPageableFields,g.CoreFieldRefNames.Tags]}("StoresWorkItemsHubFilterDataSource"),function(e){Te=t[e]={},t[e].getFieldFriendlyName=function(e,t){if(t.fieldReferenceNames){if(a.equals(e,g.CoreFieldRefNames.CommentCount,!0))return ae.WorkItemsHubComments;const o=t.fieldReferenceNames.indexOf(e);if(o>=0)return t.fieldFriendlyNames[o]}return e},t[e].getNormalizedValue=function(e){return(e=e||"").trim().toLowerCase()}}("UtilsWorkItemsHubDataUtils"),function(e){Se=t[e]={},function(e){e.buildColumns=function(e,t,o,i,r,s,n){const l=function(e){return(0,pe.toDictionary)(e.processSettings.fieldReferenceNames,(e=>e),((e,t)=>t))}(o);return function(e){let t;if(e.userSettings){const o=e.userSettings.columnSettings;o&&o.columnOptions&&o.columnOptions.length>0&&(t=e.userSettings.columnSettings.columnOptions)}if(!t){t=e.processSettings.fieldReferenceNames.filter((e=>fe.WorkItemsHubFilterDataSource.ExcludedFieldsFromDefaultColumns.indexOf(e)<0)).map((e=>({fieldReferenceName:e,width:ye.WorkItemsGridColumnFactory.getDefaultColumnWidth(e)})))}return t}(o).map((m=>r.create(e,t,m.fieldReferenceName,(0,Te.getFieldFriendlyName)(m.fieldReferenceName,o.processSettings),l,s,n,function(e,t){let o=!1;t&&t.forEach((t=>{(0,a.equals)(t.fieldReferenceName,e,!0)&&(o=!0)}));return o}(m.fieldReferenceName,i),function(e,t){let o=!1;return t.forEach((t=>{(0,a.equals)(t.fieldReferenceName,e,!0)&&(o=!t.isAscending)})),o}(m.fieldReferenceName,i),m.width)))},e.getData=function(e,t){if(!(e&&e.processSettings&&e.processSettings.fieldReferenceNames&&e.fieldValues))return null;const o=(0,pe.findIndex)(e.processSettings.fieldReferenceNames,(e=>(0,a.equals)(e,g.CoreFieldRefNames.State,!0)));return e.fieldValues.map(((t,i)=>{const r=t.data,s=r[0],n=r[o],l=(0,pe.findIndex)(e.processSettings.doneStateNames,(e=>(0,a.equals)(e,n,!0)))>=0;return{key:i.toString(10),id:s,isCompleted:l,values:r}}))}}(t[e].WorkItemsGridDataProvider||(t[e].WorkItemsGridDataProvider={}))}("DataProvidersWorkItemsGridDataProvider"),function(e){function o(e){return(e=e||"").trim().toLowerCase()}we=t[e]={},t[e].getNormalizedValue=o;class i{constructor(){this._items={}}static getDefault(){return{color:i.DEFAULT_WORKITEMTYPE_COLOR,icon:i.DEFAULT_WORKITEMTYPE_BOWTIE_ICON}}setColorAndIcon(e,t,r){const s=o(e);return this._items[s]={color:i.transformColor(t),icon:i.transformIcon(r)},this._items[s]}getColorAndIcon(e){const t=o(e);return this._items[t]||i.getDefault()}static transformColor(e){return e?`#${e.substr(e.length-6)}`:i.DEFAULT_WORKITEMTYPE_COLOR}static transformIcon(e){return(e=o(e))&&i.ICON_NAME_MAPPINGS[e]?i.ICON_NAME_MAPPINGS[e]:i.DEFAULT_WORKITEMTYPE_BOWTIE_ICON}}t[e].WorkItemTypeColorAndIcons=i,i.ICON_NAME_MAPPINGS={icon_crown:"bowtie-symbol-crown",icon_trophy:"bowtie-symbol-trophy",icon_list:"bowtie-symbol-list",icon_book:"bowtie-symbol-book",icon_sticky_note:"bowtie-symbol-stickynote",icon_clipboard:"bowtie-symbol-task",icon_insect:"bowtie-symbol-bug",icon_traffic_cone:"bowtie-symbol-impediment",icon_chat_bubble:"bowtie-symbol-review",icon_flame:"bowtie-symbol-flame",icon_megaphone:"bowtie-symbol-ask",icon_test_plan:"bowtie-test-plan",icon_test_suite:"bowtie-test-suite",icon_test_case:"bowtie-test-case",icon_test_step:"bowtie-test-step",icon_test_parameter:"bowtie-test-parameter",icon_code_review:"bowtie-symbol-review-request",icon_code_response:"bowtie-symbol-review-response",icon_review:"bowtie-symbol-feedback-request",icon_response:"bowtie-symbol-feedback-response",icon_ribbon:"bowtie-symbol-ribbon",icon_chart:"bowtie-symbol-finance",icon_headphone:"bowtie-symbol-headphone",icon_key:"bowtie-symbol-key",icon_airplane:"bowtie-symbol-airplane",icon_car:"bowtie-symbol-car",icon_diamond:"bowtie-symbol-diamond",icon_asterisk:"bowtie-symbol-asterisk",icon_database_storage:"bowtie-symbol-storage-database",icon_government:"bowtie-symbol-government",icon_gavel:"bowtie-symbol-decision",icon_parachute:"bowtie-symbol-parachute",icon_paint_brush:"bowtie-symbol-paint-brush",icon_palette:"bowtie-symbol-color-palette",icon_gear:"bowtie-settings-gear",icon_check_box:"bowtie-status-success-box",icon_gift:"bowtie-package-fill",icon_test_beaker:"bowtie-test-fill",icon_broken_lightbulb:"bowtie-symbol-defect",icon_clipboard_issue:"bowtie-symbol-issue",icon_github:"bowtie-brand-github",icon_pull_request:"bowtie-tfvc-pull-request",icon_github_issue:"bowtie-status-error-outline"},i.DEFAULT_UNPARENTED_WORKITEM_COLOR="#A6A6A6",i.DEFAULT_UNPARENTED_WORKITEM_BOWTIE_ICON="bowtie-square",i.DEFAULT_WORKITEMTYPE_COLOR_HEX="009CCC",i.DEFAULT_WORKITEMTYPE_COLOR=`#${i.DEFAULT_WORKITEMTYPE_COLOR_HEX}`,i.DEFAULT_WORKITEMTYPE_ICON=g.WorkItemTypeIcons.DefaultWorkItemTypeIconName,i.DEFAULT_WORKITEMTYPE_BOWTIE_ICON=i.ICON_NAME_MAPPINGS[i.DEFAULT_WORKITEMTYPE_ICON];class r{constructor(){this._cachedPromises={},this._projectToColorAndIconsMap={}}static getInstance(e){return r._instance||(r._instance=this._getDataProvider(e)),r._instance}isPopulated(e){return!!e&&(e=o(e),this._projectToColorAndIconsMap.hasOwnProperty(e))}getColorAndIcon(e,t){return e&&t&&(e=o(e),this._projectToColorAndIconsMap[e])?this._projectToColorAndIconsMap[e].getColorAndIcon(t):i.getDefault()}getColor(e,t){return this.getColorAndIcon(e,t).color}ensureColorAndIconsArePopulated(e){const t={};for(let i of e)i=o(i),t.hasOwnProperty(i)||this.isPopulated(i)||(t[i]=null);return Object.keys(t).length,Promise.resolve()}getColorAndIconAsync(e,t){return this.isPopulated(e)?Promise.resolve(this.getColorAndIcon(e,t)):this.queueEnsureColorAndIconsArePopulated(e).then((()=>this.getColorAndIcon(e,t)))}getColorAsync(e,t){return this.getColorAndIconAsync(e,t).then((e=>e.color))}queueEnsureColorAndIconsArePopulated(e){return e=o(e),this._cachedPromises[e]?this._cachedPromises[e]:(this._cachedPromises[e]=this.ensureColorAndIconsArePopulated([e]),this._cachedPromises[e].then((()=>{delete this._cachedPromises[e]}),(t=>{delete this._cachedPromises[e]})))}_setColors(e,t){const r=new i;for(const e of t)r.setColorAndIcon(e.workItemTypeName,e.color,e.icon);e=o(e),this._projectToColorAndIconsMap[e]=r}static _getDataProvider(e){const t=e.getService("ITfsPageService").getData().project;let o=e.getService("IVssContributionService").getData("ms.vss-work-web.work-item-type-color-icon-data-provider");const i=new r;return t&&o&&i._setColors(t.name,o),i}static _toWorkItemTypeColorAndIcon(e){const{color:t,icon:o,name:i}=e;return{color:t,icon:o&&o.id,workItemTypeName:i}}}t[e].WorkItemTypeColorAndIconsProvider=r}("ExternalNewWorkItemWorkItemTypeColorAndIconsProvider"),t.ExternalNewWorkItemINewWorkItemData={},function(e){De=t[e]={};class o{static getNewWorkItemPivotBarActions(e,t){const i=new we.WorkItemTypeColorAndIcons;return o._getWorkItemTypeMenuItems(e,t,i)}static getNewWorkItemPivotBarAction(e,t){const i=null==t.important||t.important,r=new we.WorkItemTypeColorAndIcons,s={iconName:"bowtie-math-plus-light",iconType:1};return t.workItemTypesNames&&1===t.workItemTypesNames.length?{key:o.newWorkItemCommandKey,disabled:t.disabled,name:ae.NewWorkItemButtonText,iconProps:s,important:i,onClick:(o,i)=>t.addNewItem(e,o,i,t.workItemTypesNames[0])}:{key:o.newWorkItemCommandKey,disabled:t.disabled,name:ae.NewWorkItemButtonText,iconProps:s,important:i,children:o._getWorkItemTypeMenuItems(e,t,r)}}static _getWorkItemTypeMenuItems(e,t,i){const r=e.getService("IVssContributionService").getData("ms.vss-work-web.new-workitem-data-provider-non-cached");if(!r||!r.workItemTypes)return[];let s;return s=t.workItemTypesNames&&t.workItemTypesNames.length>0?(0,S.uniqueSort)(t.workItemTypesNames,a.localeIgnoreCaseComparer):(0,S.uniqueSort)(r.workItemTypes,a.localeIgnoreCaseComparer),s.map((s=>o._createMenuItem(e,t,i,r,s)))}static _createMenuItem(e,t,i,r,s){const a=o._getWorkItemTypeColorAndIcon(i,r,s),n={iconName:a.icon,iconType:1,style:{color:a.color}};return{key:s,disabled:t.disabled,name:s,iconProps:n,onClick:(o,i)=>t.addNewItem(e,o,i,s)}}static _getWorkItemTypeColorAndIcon(e,t,o){let i;if((o=(0,we.getNormalizedValue)(o))&&t.colorAndIcons){const r=t.colorAndIcons[o];r&&(i=e.setColorAndIcon(o,r.color,r.icon))}return i||(i=we.WorkItemTypeColorAndIcons.getDefault()),i}}t[e].PivotBarActionHelper=o,o.newWorkItemCommandKey="new-work-item"}("ExternalNewWorkItemNewWorkItem"),function(e){function o(e,t,o,i){const r={[t]:o};return e.getService("ISettingsService").setEntries(r,0,"Project",i)}ve=t[e]={},t[e].updateRecentTabId=function(e,t,i){o(e,le.WorkItemsHubSettingsHelper.WorkItemsHubRecentTabIdKey,i,t),de.UsageTelemetryHelper.publishChangedTabValue(e,i)},t[e].updateColumnSettings=function(e,t,i,r,s,n){const l={columnOptions:r,sortOptions:s,version:n};return o(e,(0,a.format)(le.WorkItemsHubSettingsHelper.WorkItemsHubColumnSettingsKeyTemplate,i),l,t)},t[e].updateShowCompletedForTab=function(e,t,i,r){return o(e,(0,a.format)(le.WorkItemsHubSettingsHelper.WorkItemsHubShowCompletedKeyTemplate,i),r,t)}}("UtilsWorkItemsHubTabSettings"),function(e){We=t[e]={};t[e].LegacyFieldDefinition=class{canSortBy(){return this.canSort}isQueryable(){return this.canQuery}isIgnored(){return!(!a.equals(this.referenceName,g.CoreFieldRefNames.AreaId,!0)&&!a.equals(this.referenceName,g.CoreFieldRefNames.IterationId,!0))}}}("UtilsColumnOptionsPanelContracts"),function(e){Fe=t[e]={};t[e].ColumnOptionsPanelLauncher=class{constructor(e,t){this._actionCreator=e,this._pageContext=t,this._onOkClick=(e,t)=>{if(!t)return;const o=e.display.map((e=>({fieldReferenceName:e.name,width:e.width}))),r=e.sort.map((e=>({fieldReferenceName:e.name,isAscending:e.asc})));(0,ve.updateColumnSettings)(this._pageContext,this._projectId,this._tabId,o,r,this._version).then((()=>{this._actionCreator.invalidateTabData(this._tabId),this._actionCreator.refreshDataProviderAsync(this._tabId),de.UsageTelemetryHelper.publishColumnOptionsChange(this._pageContext,this._tabId,{columns:e.display.map((e=>e.name)).join(),sortOptions:e.sort.map((e=>e.name)).join(),addedColumns:e.added.join(),removedColumns:e.removed.join(),addedColumnsCount:e.added.length,removedColumnsCount:e.removed.length})}),(e=>{(0,i.traceError)(this._pageContext,de.TelemetryConstants.Area,de.TelemetryConstants.ColumnOptionsChange,`Failed to store column settings for work items hub ${this._tabId}, columns: ${o.length}, sort: ${r.length}, ${e}`)}))},this._getAvailableFields=()=>{let e=0;const t=[];return this._pageContext.getRestClient("IWorkItemTrackingRestClient").getFields(this._projectId).then((o=>{for(const i of o)if(!a.equals(i.referenceName,g.CoreFieldRefNames.Parent,!0)){const o=!!a.equals(i.referenceName,g.CoreFieldRefNames.Tags,!0)||i.canSortBy;t.push(this._createWorkItemsHubField(e++,i.referenceName,i.name,o,i.isQueryable))}const i=this._getAdditionalField(e);return i&&t.push(...i),t}),(e=>Promise.reject(e)))},this._getAdditionalField=e=>{const t=[];switch(me.TabEnumValueByTabIdMap[this._tabId]){case le.WorkItemsHubTabs.Mentioned:t.push(this._createWorkItemsHubField(++e,le.MentionedTabDataProvider.MentionedDateField,ae.MentionedDateColumnDisplayName));break;case le.WorkItemsHubTabs.MyActivity:t.push(this._createWorkItemsHubField(++e,le.RecentActivityConstants.MyActivityDetailsField,ae.MyActivityDetailsColumnDisplayName)),t.push(this._createWorkItemsHubField(++e,le.RecentActivityConstants.MyActivityDateField,ae.ActivityDateColumnDisplayName));break;case le.WorkItemsHubTabs.RecentlyUpdated:t.push(this._createWorkItemsHubField(++e,le.RecentActivityConstants.RecentlyUpdatedDateField,ae.ActivityDateColumnDisplayName));break;default:return null}return t},this._getFieldWidth=e=>150;const o=t.getService("ITfsPageService").getData();this._projectId=o.project.id}openColumnOptionPanel(e,t,o,i){const s=t.map((e=>({fieldRefName:e.fieldReferenceName,width:e.width}))),a=o.map((e=>({fieldRefName:e.fieldReferenceName,descending:!e.isAscending})));this._version=i,this._tabId=e;const n={getFieldWidth:this._getFieldWidth,getAvailableFields:this._getAvailableFields,displayColumns:s,sortColumns:a,allowSort:!0,project:this._projectId};this._pageContext.getService("IVssLayoutManager").renderCallout((e=>r.createElement(w.LegacyComponent,Object.assign(Object.assign({modules:["WorkItemTracking/Scripts/Queries/Components/ColumnOptions/ColumnOptionsPanel"],wrappedType:"columnOptionsPanel"},n),{onOkClick:(t,o)=>{e(),this._onOkClick(t,o)},onDismiss:e}),null)))}_createWorkItemsHubField(e,t,o,i=!0,r=!0){const s=new We.LegacyFieldDefinition;return s.id=e,s.name=o,s.referenceName=t,s.canSort=i,s.canQuery=r,s}}}("UtilsColumnOptionsPanelLauncher"),function(e){Pe=t[e]={};t[e].WorkItemsHubDeleteHelper=class{constructor(e,t){this._pageContext=e,this._actionCreator=t,this._testWorkItemTypesMap=null,this._hasDeletePermission=null,this.testCategories=["Microsoft.TestCaseCategory","Microsoft.TestPlanCategory","Microsoft.TestSuiteCategory","Microsoft.SharedParameterCategory","Microsoft.SharedStepCategory"],this.hasDeletePermission()&&this._beginPopulateTestWorkItemTypes()}shouldShowDeleteCommand(e,t){if(this.hasDeletePermission()&&null!=this._testWorkItemTypesMap&&null!=t&&t.length>0){for(const o of t){const t=e.getValue(o,g.CoreFieldRefNames.WorkItemType);if(this._testWorkItemTypesMap.hasOwnProperty(t))return!1}return!0}return!1}deleteWorkItems(e,t,o){if(null==o||0===o.length)return;const i=()=>{this._actionCreator.removeWorkItemFromDataProvider(t,o)},s=e.getService("IVssLayoutManager");(0,h.isFeatureEnabled)(this._pageContext,"ms.vss-work-web.new-boards-hub-feature",!1)?s.renderCallout((e=>r.createElement(v.DeleteDialog,{onDismiss:e,selectedItems:this.getSelectedWorkItems(o),onDeleteItems:i},null))):s.renderCallout((()=>r.createElement(w.LegacyComponent,{modules:["WorkItemsHub/Scripts/LegacyPlatform/DeleteConfirmationDialog"],wrappedType:"deleteConfirmationDialog",workItemIds:o,onDelete:i},null)))}_beginPopulateTestWorkItemTypes(){const e={},t=this._pageContext.getService("ITfsPageService").getData().project.id;this._pageContext.getRestClient(D.WorkItemTrackingClientName).getWorkItemTypeCategories(t).then((t=>{t&&(this.testCategories.forEach((o=>{t.filter((e=>0===(0,a.localeIgnoreCaseComparer)(e.referenceName,o))).forEach((t=>{t.workItemTypes.forEach((t=>{e[t.name]=o}))}))})),this._testWorkItemTypesMap=e)}))}hasDeletePermission(){if(null==this._hasDeletePermission){const e=this._pageContext.getService("IVssContributionService").getData("ms.vss-work-web.work-item-permissions-data-provider");e&&e.workItemDeletePermission&&(this._hasDeletePermission=e.workItemDeletePermission.hasPermission)}return!!this._hasDeletePermission}getSelectedWorkItems(e){return null==e||0===e.length?[]:e.map((e=>({[g.CoreFieldRefNames.Id]:e})))}}}("UtilsWorkItemsHubDeleteHelper"),function(e){Ae=t[e]={};const o="text";function i(e,t){let i=!1;if(t||void 0===window.clipboardData){let o,r,s=document.createElement("div");const a="copyDiv";s.id=a;try{if(s.style.backgroundColor="white",t?s.innerHTML+=e:(s.style.whiteSpace="pre",s.textContent=e),document.body.createTextRange){let e=document.getElementsByTagName("body")[0];e.insertBefore(s,e.firstChild),o=document.body.createTextRange(),o.moveToElementText(document.getElementById(a)),o.select(),i=o.execCommand("copy")}else if(document.createRange&&window.getSelection){document.getElementsByTagName("body")[0].appendChild(s),o=document.createRange(),r=window.getSelection(),r.removeAllRanges(),o.selectNodeContents(document.getElementById(a)),r.addRange(o),i=document.execCommand("copy")}}finally{s.parentElement.removeChild(s)}}else window.clipboardData.setData(o,e),i=!0;return i}function s(e,t,o){e.getService("IVssLayoutManager").renderCallout((()=>r.createElement(w.LegacyComponent,{modules:["WorkItemsHub/Scripts/LegacyPlatform/CopyContentDialog"],wrappedType:"copyContentDialog",data:t,copyAsHtml:o.copyAsHtml},null)))}function a(){return document.queryCommandSupported("copy")||void 0!==window.clipboardData}function n(){return void 0!==document.body.createTextRange||document.queryCommandSupported("copy")&&void 0!==document.createRange}t[e].copyToClipboard=function(e,t,o){if(t&&"string"==typeof t)if(o&&o.showCopyDialog)s(e,t,o);else{var r=!1;if(o&&o.copyAsHtml){if(n())try{r=i(t,!0)}catch(e){}}else if(a())try{r=i(t,!1)}catch(e){}r||s(e,t,o)}},t[e].supportsNativeCopy=a,t[e].supportsNativeHtmlCopy=n}("UtilsClipboard"),function(e){He=t[e]={};class o{constructor(e,t,o){this._rows=e,this._columns=t,this._options=o}_getCellValue(e,t){return this._rows[e][t.index]}_getSafeCellValue(e,t){const o=this._getCellValue(e,t),r=t.isValueHtml?o:i(o);return""===r?"&nbsp;":r}getHtml(){if(0===this._rows.length||0===this._columns.length)return"<div></div>";const e=this._columns.map((e=>`<th style="${o.COLUMN_STYLE}">${i(e.name)}</th>`)),t=`<thead style="${o.HEADER_STYLE}"><tr>${e.join("")}</tr></thead>`,r=`<tbody>${this._rows.map(((e,t)=>{const i=this._columns.map((e=>`<td style="${o.COLUMN_STYLE}">${this._getSafeCellValue(t,e)}</td>`));return`<tr style="${t%2?o.ROW_ALT_BACKGROUND_COLOR:o.ROW_BACKGROUND_COLOR}">${i.join("")}</tr>`})).join("")}</tbody>`,s=this._options&&this._options.extendedHtml?`<div style="${o.FONT_FAMILY+o.FONT_SIZE}">${this._options.extendedHtml}</div>`:"";return`<div><table border="0" cellpadding="0" cellspacing="0" style="${o.TABLE_STYLE}">${t}${r}</table>${s}</div>`}}function i(e){var t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t.innerHTML.replace(/"/g,"&quot;").replace(/'/g,"&#39;")}t[e].HtmlTableFormatter=o,o.HEADER_BACKGROUND_COLOR="background-color: #106EBE;",o.HEADER_COLOR="color: white;",o.FONT_SIZE="font-size: 11pt;",o.FONT_FAMILY="font-family: Calibri, sans-serif;",o.BORDER_COLLAPSE="border-collapse: collapse;",o.COLUMN_BORDER="border: 1px solid white;",o.COLUMN_VERTICAL_ALIGN="vertical-align: top;",o.COLUMN_PADDING="padding: 1.45pt .05in;",o.ROW_BACKGROUND_COLOR="background-color: #FFFFFF",o.ROW_ALT_BACKGROUND_COLOR="background-color: #F8F8F8",o.COLUMN_STYLE=o.COLUMN_BORDER+o.COLUMN_VERTICAL_ALIGN+o.COLUMN_PADDING,o.HEADER_STYLE=o.HEADER_BACKGROUND_COLOR+o.HEADER_COLOR,o.TABLE_STYLE=o.FONT_FAMILY+o.FONT_SIZE+o.BORDER_COLLAPSE,t[e].htmlEncode=i}("UtilsHtmlTableFormatter"),function(e){var o;Ne=t[e]={},function(e){e[e.PlainText=0]="PlainText",e[e.Date=1]="Date",e[e.Identity=2]="Identity"}(o=t[e].WorkItemHtmlTableFormatType||(t[e].WorkItemHtmlTableFormatType={}));class i extends He.HtmlTableFormatter{constructor(e,t,o){super(e,t.map((e=>Object.assign(Object.assign({},e),{isValueHtml:i.isHtmlField(e.fieldReferenceName)})))),this._pageContext=o}_getCellValue(e,t){const r=this._rows[e][t.index];if(a.equals(t.fieldReferenceName,g.CoreFieldRefNames.Id,!0))return i.getIdColumnValue(parseInt(r,10),this._pageContext);let s=t.formatType;return null==s&&(s=i._getColumnFormatType(r)),s===o.Identity?i.getIdentityValue(this._pageContext,r):s===o.Date?(0,W.convertValueToDisplayString)(new Date(r)):(0,W.convertValueToDisplayString)(r)}static getIdentityValue(e,t){return(0,C.convertWorkItemIdentityRefFromFieldValue)(e,t).identityRef.displayName||""}static getIdColumnValue(e,t){const o=t.getService("ITfsPageService").getData().project;return`<a href="${(0,be.getEditWorkItemUrl)(t,o.name,e)}" style="color:#106ebe" target="_blank">${e}</a>`}static isHtmlField(e){return a.equals(g.CoreFieldRefNames.Id,e,!0)}static _getColumnFormatType(e){return(0,C.isWorkItemIdentityRef)(e)||(0,C.isIdentityRef)(e)?o.Identity:e instanceof Date?o.Date:o.PlainText}}t[e].WorkItemHtmlTableFormatter=i}("UtilsWorkItemHtmlTableFormatter"),function(e){Re=t[e]={};class o{static copyWorkItemsToClipboard(e,t,i,r,s,a){const n=e.map(((e,i)=>({index:i,fieldReferenceName:e,name:t[i],formatType:o.HtmlTableFormatterType[e]}))).filter((e=>o.ColumnsToExclude.indexOf(e.fieldReferenceName)<0)),l=new Ne.WorkItemHtmlTableFormatter(i,n,r).getHtml();Ae.copyToClipboard(r,l,{copyAsHtml:!0}),s&&o._showCopiedCallout(s,a)}static openSendEmailDialog(e,t,i,s){const a=t.filter((e=>o.ColumnsToExclude.indexOf(e)<0));e.getService("IVssLayoutManager").renderCallout((()=>r.createElement(w.LegacyComponent,{modules:["WorkItemsHub/Scripts/LegacyPlatform/SendMailDialog"],wrappedType:"sendMailDialog",workItemIds:i,fields:a,subject:s},null)))}static _showCopiedCallout(e,t){let o=document.createElement("div");document.body.appendChild(o);const i=()=>{o&&(F.unmountComponentAtNode(o),o.parentElement.removeChild(o),o=null)},s={anchorOrigin:{horizontal:"center",vertical:"end"},calloutOrigin:{horizontal:"center",vertical:"start"},onDismiss:i,contentClassName:"work-items-hub-callout"};!t||e.clientX>0&&e.clientY>0?s.anchorPoint={x:e.clientX,y:e.clientY}:s.anchorElement=document.querySelector(`.${he.TabContent_WorkItemsHubGridRowClassName}[role="row"][data-item-key="${t.key}"] .${N.ContextualMenuButton.ButtonContainerClassName}`),F.render(r.createElement(H.Callout,Object.assign({},s),ae.CopiedContentDialogTitle),o),(0,A.wait)(500).then(i),P.announce(ae.CopiedContentDialogTitle,!0)}}t[e].WorkItemsHubReportUtils=o,o.ColumnsToExclude=[le.RecentActivityConstants.MyActivityDateField,le.RecentActivityConstants.MyActivityDetailsField,le.RecentActivityConstants.RecentlyUpdatedDateField,le.MentionedTabDataProvider.MentionedDateField],o.HtmlTableFormatterType={[g.CoreFieldRefNames.ChangedDate]:Ne.WorkItemHtmlTableFormatType.Date,[g.CoreFieldRefNames.CreatedDate]:Ne.WorkItemHtmlTableFormatType.Date,[g.CoreFieldRefNames.AssignedTo]:Ne.WorkItemHtmlTableFormatType.Identity,[g.CoreFieldRefNames.CreatedBy]:Ne.WorkItemHtmlTableFormatType.Identity}}("UtilsWorkItemsHubReportUtils"),function(e){xe=t[e]={};class o extends R.Store{constructor(e,t,o,i,r,s=null){super("WorkItemsHubStoreChangedEvent"),this._actionListenerPairs=[],this._filterManager={},this._dataSource={},this._invalidateTabData=e=>{this._dataSource[e]=void 0,this.emitChanged()},this._removeWorkItems=e=>{if(!e)return;let t=!1;for(const o in this._dataSource){const i=this._dataSource[o];i&&(o===e.tabId?t=i.removeWorkItems(e.workItemIds):(this._dataSource[o]=void 0,t=!0))}if(t){const t=this._filterManager[e.tabId];t&&t.dataUpdated(),this.emitChanged()}},this._addWorkItems=e=>{const t=this._dataSource[e.tabId];if(e){if(t.addWorkItems(e)){const t=this._filterManager[e.tabId];t&&(t.dataUpdated(),this._updateDisplayData(e.tabId))}}this.emitChanged()},this._invalidateAllTabsData=()=>{this._dataSource={},this.emitChanged()},this._endRefreshDataProvider=e=>{this._initializeData(e.tabId,e.tabData),this.emitChanged()},this._setCompletedItemsVisibility=e=>{const{showCompletedItems:t,tabId:o}=e;o!==me.TabIdByTabEnumValueMap[le.WorkItemsHubTabs.RecentlyCompleted]&&this._setViewOptions(o,(e=>e.setCompletedItemsVisibility(t))),this.emitChanged()},this._sortItems=e=>{const{tabId:t,sortOptions:o}=e;this._setViewOptions(t,(e=>e.setSortInfo(o))),this.emitChanged()},this._onUpdateFilter=e=>{this._onUpdateFilterInternal(e)&&this.emitChanged()},this._pageContext=t;const a=t.getService("ITfsPageService").getData();this._project=a.project,i&&this._setPermissions(i.permission),this._initializeData(o,i,s),r&&r.forEach((e=>{e&&this._initializeData(e.processSettings.tabId,e)})),this._addListenerToActionsHub(e.invalidateAllTabsData,this._invalidateAllTabsData),this._addListenerToActionsHub(e.invalidateTabData,this._invalidateTabData),this._addListenerToActionsHub(e.removeWorkItems,this._removeWorkItems),this._addListenerToActionsHub(e.endRefreshDataProvider,this._endRefreshDataProvider),this._addListenerToActionsHub(e.updateFilter,this._onUpdateFilter),this._addListenerToActionsHub(e.setCompletedItemsVisibility,this._setCompletedItemsVisibility),this._addListenerToActionsHub(e.sortItems,this._sortItems),this._addListenerToActionsHub(e.endPageWorkItems,this._addWorkItems)}getHubFilterDataSource(e){return this._dataSource[e]}getHubDisplayData(e){return this.isHubDataInitialized(e)?this._dataSource[e].getFilteredData():null}getVisibleItemsCount(e){return this.isHubDataInitialized(e)?this._dataSource[e].getVisibleItemsCount():0}getTotalItemsCount(e){return this.isHubDataInitialized(e)?this._dataSource[e].getItemCount():0}isHubDataInitialized(e){return!!this._dataSource[e]}isHubDataError(e){return null===this._dataSource[e]}isSupportedFeature(e){if(!this.isHubDataInitialized(e))return!0;return this._dataSource[e].isFeatureSupported()}getWorkItemsHubPermission(){return this._permission}getFilterManager(e){return this._filterManager[e]}getHubFilterFields(e){const t=this._dataSource[e],o=this._project.name,i=[{displayType:M.WorkItemFilterFieldType.Text,fieldName:"text",placeholder:ae.FilterByKeyword},{displayType:M.WorkItemFilterFieldType.CheckboxList,fieldName:g.CoreFieldRefNames.WorkItemType,placeholder:ae.FilterByTypes,noItemsText:ae.FilterNoTypes,valueProvider:new x.WorkItemTypeFilterValueProvider(o,t)},{displayType:M.WorkItemFilterFieldType.CheckboxList,fieldName:g.CoreFieldRefNames.State,placeholder:ae.FilterByStates,noItemsText:ae.FilterNoStates,valueProvider:new x.StateFilterValueProvider(o,t)},{displayType:M.WorkItemFilterFieldType.CheckboxList,fieldName:g.CoreFieldRefNames.Tags,placeholder:ae.FilterByTags,noItemsText:ae.FilterNoTags,showOrAndOperators:!0}];if(t.hasAreaPath()){const e=[{displayType:M.WorkItemFilterFieldType.CheckboxList,fieldName:g.CoreFieldRefNames.AreaPath,placeholder:ae.FilterByAreaPath,noItemsText:ae.FilterNoArea,valueProvider:new M.DataSourceFilterValueProvider(g.CoreFieldRefNames.AreaPath,t)}];i.splice(3,0,e[0])}if(0!==(0,a.localeIgnoreCaseComparer)(e,le.WorkItemsHubTabs[le.WorkItemsHubTabs.AssignedToMe])){const e=!this._permission.personalView.hasPermission,o=[{displayType:M.WorkItemFilterFieldType.CheckboxList,fieldName:g.CoreFieldRefNames.AssignedTo,placeholder:ae.FilterByAssignedTo,valueProvider:new x.AssignedToFilterValueProvider(this._pageContext,t,e)}];i.splice(2,0,o[0])}return i}dispose(){this._actionListenerPairs&&(this._actionListenerPairs.forEach((e=>e.action.removeListener(e.listener))),this._actionListenerPairs=null)}_setPermissions(e){this._permission={personalView:{hasPermission:!1},query:{hasPermission:!1},sendEmail:{hasPermission:!1},newWorkItem:{hasPermission:!1}},e&&(this._permission.personalView.hasPermission=!!e.personalView&&e.personalView.hasPermission,this._permission.query.hasPermission=!!e.query&&e.query.hasPermission,this._permission.sendEmail.hasPermission=!!e.sendEmail&&e.sendEmail.hasPermission,this._permission.newWorkItem.hasPermission=!!e.newWorkItem&&e.newWorkItem.hasPermission)}_setViewOptions(e,t){t(this._dataSource[e]);this._filterManager[e].dataUpdated(),this._updateDisplayData(e)}_addListenerToActionsHub(e,t){this._actionListenerPairs.push({action:e,listener:t}),e.addListener(t)}_initializeData(e,t,o=null){if(!t)return void(this._dataSource[e]=null);if(this._dataSource[e])return void console.warn("Should not reinitialized the data for same tab");if(e!==t.processSettings.tabId)return void console.warn("Provided tabId must match the tab data");let i=!0;i=null==o?t.userSettings&&t.userSettings.showCompleted:o;const r=new fe.WorkItemsHubFilterDataSource(this._pageContext,t,this._project.id,i);this._dataSource[e]=r;const s=this._pageContext.getService("IVssPageService").getData(),a=new U.FilterManager(r);this._filterManager[e]=a,a.clearFilterProviders(),(0,h.isFeatureFlagEnabled)(this._pageContext,he.FeatureFlags.UseTokenFiltering,!1)?a.registerFilterProvider(B.TextFilterProvider.PROVIDER_TYPE,new B.TextFilterProviderWithUnassigned):a.registerFilterProvider(B.TextFilterProvider.PROVIDER_TYPE,new B.SubstringTextFilterProvider),a.registerFilterProvider(g.CoreFieldRefNames.WorkItemType,new E.FieldFilterProvider(g.CoreFieldRefNames.WorkItemType)),a.registerFilterProvider(g.CoreFieldRefNames.State,new E.FieldFilterProvider(g.CoreFieldRefNames.State)),a.registerFilterProvider(g.CoreFieldRefNames.AssignedTo,new O.AssignedToFilterProvider(s.user)),a.registerFilterProvider(g.CoreFieldRefNames.AreaPath,new V.AreaPathFilterProvider),a.registerFilterProvider(g.CoreFieldRefNames.Tags,new L.TagsFilterProvider),a.activate(this._pageContext);const n=r.getFilterState();this._onUpdateFilterInternal({tabId:e,updatedFilter:n},!0)}_onUpdateFilterInternal(e,t=!1){const{tabId:o,updatedFilter:i}=e,r=this._filterManager[o];if(r){const e=i;return t?this._dataSource[o].setFilters(e):this._dataSource[o].saveFilters(e),r.setFilters(e),this._updateDisplayData(o,t),!0}return!1}_updateDisplayData(e,t=!1){const o=this._dataSource[e],i=this._filterManager[e];if(i){if(i.isFiltering()){const e=i.filter(this._pageContext);o.setVisibleIds(e)}else{const e=!t;o.resetFilter(e)}}e===me.TabIdByTabEnumValueMap[le.WorkItemsHubTabs.RecentlyCompleted]||o.shouldShowCompletedItems()||o.hideCompletedItems()}}t[e].WorkItemsHubStore=o}("StoresWorkItemsHubStore"),function(e){Me=t[e]={};class o{constructor(e,t,i,r){this._pageContext=e,this._store=t,this._hubViewState=i,this._actionCreator=r,this._openFilteredInQueriesAction={key:o.openQueryCommandKey,name:ae.OpenFilteredInQueriesCommand,important:!0,iconProps:{iconName:"bowtie-arrow-open",iconType:1},onClick:()=>{this._onOpenQueryClick(this._pageContext)}},this._openInQueriesAction={key:o.openQueryCommandKey,name:ae.OpenInQueriesCommand,important:!0,iconProps:{iconName:"bowtie-arrow-open",iconType:1},onClick:()=>{this._onOpenQueryClick(this._pageContext)}},this._importWorkItemsAction={key:o.importWorkItemsCommandKey,name:ae.ImportWorkItems,important:!0,iconProps:{iconName:"Upload",iconType:0},onClick:()=>{this._onImportWorkItemsClick(this._pageContext)}},this._recycleBinAction={key:o.recycleBinCommandKey,name:ae.RecycleBin,important:!0,iconProps:{iconName:"bowtie-recycle-bin",iconType:1},onClick:()=>{this._onRecycleBinClick(this._pageContext)}},this._tabContentData=null,this._deleteCommandHelper=null,this._columnOptionsPanelLauncher=null,this._onColumnOptionsClick=()=>{de.UsageTelemetryHelper.publishColumnOptionsCommand(this._pageContext,this._getSelectedTabId());const e=this.getHubFilterDataSource(),t=this._getSelectedTabId(),o=e.getCurrentColumnOptions(),i=e.getSortOptions(),r=e.getCurrentColumnSettingsVersion();this._columnOptionsPanelLauncher.openColumnOptionPanel(t,o,i,r)},this._onImportWorkItemsClick=e=>{de.UsageTelemetryHelper.publishImportWorkItemsCommand(e,this._getSelectedTabId());const t=e.getService("ITfsPageService").getData().project.name;window.open(be.getImportWorkItemsUrl(e,t))},this._onRecycleBinClick=e=>{de.UsageTelemetryHelper.publishRecycleBinCommand(e,this._getSelectedTabId());const t=e.getService("ITfsPageService").getData().project.name;window.open(be.getRecycleBinUrl(e,t))},this._onOpenQueryClick=e=>{const t=this.getHubFilterDataSource(),o=e.getService("ITfsPageService").getData().project.name;Ce.openInQueries(e,o,this._getSelectedTabId(),t)},this._onOpenSelectedInQueryClick=e=>{const t=this.getHubFilterDataSource(),o=e.getService("ITfsPageService").getData().project.name;Ce.openInQueries(e,o,this._getSelectedTabId(),t,this._tabContentData.selectionIds)},this._onAddNewItem=(e,t,o,i)=>{const r=e.getService("work-item-service"),s=this._getSelectedTabId();e.getService("IWorkItemsHubNavDataService").setNavigationData({tabId:s}),r.createWorkItem(o.key,0),t.preventDefault(),t.stopPropagation()},this._onEmailWorkItemsClick=e=>{const t=this._tabContentData.selectionIds;if(0===t.length)return;const o=this.getHubFilterDataSource(),i=o.getDisplayedFieldReferenceNames();let r;if(1===t.length){const e=t[0];r=`${t[0]} - ${o.getValue(e,g.CoreFieldRefNames.Title)}`}Re.WorkItemsHubReportUtils.openSendEmailDialog(e,i,t,r),de.UsageTelemetryHelper.publishEmailTelemetry(e,this._getSelectedTabId())},this._columnOptionsAction={key:o.columnOptionsCommandKey,name:ae.ColumnOptions,important:!0,iconProps:{iconName:"Repair"},onClick:this._onColumnOptionsClick},this._deleteCommandHelper=new Pe.WorkItemsHubDeleteHelper(e,r),this._addNewWorkItemPrimary=De.PivotBarActionHelper.getNewWorkItemPivotBarAction(this._pageContext,{addNewItem:this._onAddNewItem,important:!0}),this._columnOptionsPanelLauncher=new Fe.ColumnOptionsPanelLauncher(r,e)}setTabData(e){this._tabContentData=e}getCommands(e,t){if(!e)return[];const{hasFilter:o}=this._tabContentData,i=[];if(e.newWorkItem.hasPermission&&i.push(this._addNewWorkItemPrimary),e.query.hasPermission){if(t){const e=o?this._openFilteredInQueriesAction:this._openInQueriesAction;i.push(e),i.push(this._columnOptionsAction)}(0,h.isFeatureFlagEnabled)(this._pageContext,"WebAccess.WorkItemTracking.EnableCSVImport",!1)&&i.push(this._importWorkItemsAction),i.push(this._recycleBinAction)}return i}getContextMenuItems(e,t,i){const r=this._tabContentData.selectionIds?[...this._tabContentData.selectionIds]:[];if(0===r.length)return;const s=[];t.query.hasPermission&&s.push({name:ae.OpenSelectionInQueriesCommand,key:o.openQueryCommandKey,onClick:()=>{this._onOpenSelectedInQueryClick(e)},iconProps:{className:"bowtie-icon bowtie-arrow-open"}}),s.push({name:ae.CopyToClipboard,key:o.copyToClipboardCommandKey,title:ae.CommandBarTitle_CopyWorkItems,onClick:(t,o)=>{this.copyWorkItemsToClipboard(e,!1,t,o&&o.data)},data:i,iconProps:{className:"bowtie-icon bowtie-edit-copy"}}),t.sendEmail.hasPermission&&s.push({name:ae.EmailSelectedWorkItems,key:o.emailCommandKey,onClick:()=>{this._onEmailWorkItemsClick(e)},iconProps:{className:"bowtie-icon bowtie-mail-message"}});const a=this.getHubFilterDataSource();return this.getDeleteHelper().shouldShowDeleteCommand(a,r)&&s.push({name:ae.DeleteSelectedWorkItems,key:o.deleteCommandKey,title:ae.CommandBarTitle_DeleteWorkItems,onClick:()=>{this.deleteWorkItems(e,!1)},iconProps:{className:"bowtie-icon bowtie-trash"}}),s}copyWorkItemsToClipboard(e,t,o,i){if(0===this._tabContentData.selectionIds.length)return;const r=this.getHubFilterDataSource(),s=r.getFilteredData(),a=r.getDisplayedFieldReferenceNames(),n=a.map((e=>(0,Te.getFieldFriendlyName)(e,s.processSettings))),l=r.getFieldValues(this._tabContentData.selectionIds,a);Re.WorkItemsHubReportUtils.copyWorkItemsToClipboard(a,n,l,e,o,i),de.UsageTelemetryHelper.publishCopyToClipboardTelemetry(e,this._getSelectedTabId(),t)}deleteWorkItems(e,t){const o=this._tabContentData.selectionIds,i=this.getDeleteHelper(),r=this.getHubFilterDataSource();if(i.shouldShowDeleteCommand(r,o)){const r=this._getSelectedTabId();i.deleteWorkItems(e,r,o),de.UsageTelemetryHelper.publishDeleteTelemetry(e,r,t)}}getDeleteHelper(){return this._deleteCommandHelper}getHubFilterDataSource(){return this._store.getHubFilterDataSource(this._getSelectedTabId())}_getSelectedTabId(){return this._hubViewState.selectedPivot.value.toLowerCase()}}t[e].WorkItemsHubCommandProvider=o,o.columnOptionsCommandKey="column-options",o.recycleBinCommandKey="recycle-bin",o.importWorkItemsCommandKey="import-workitems",o.openQueryCommandKey="open-in-queries",o.copyToClipboardCommandKey="copy-to-clipboard",o.emailCommandKey="email",o.deleteCommandKey="delete"}("DataProvidersWorkItemsHubCommandProvider"),t.UtilsCommon={},function(e){Oe=t[e]={},t[e].navigateToNewWorkItemForm=function(e,t,o){(0,Z.FastPageSwitch)(e,be.getCreateWorkItemUrl(e,t,o),!0)},t[e].navigateToWorkEditWorkItemForm=function(e,t,o,i){const r=be.getEditWorkItemUrl(e,t,o);return(0,Z.onClickFPS)(e,r,!0,i)}}("UtilsWorkItemsXhrNavigationUtils"),function(e){t[e]={},function(e){e.createTempQueryUrl=function(e,t,o){return(0,be.getQueriesHubUrl)(e,t,o)}}(t[e].WorkItemTempQueryUtils||(t[e].WorkItemTempQueryUtils={}))}("UtilsWorkItemTempQueryUtils"),function(e){Ee=t[e]={};class o extends G.VssComponent{constructor(){super(...arguments),this._onStoreChange=()=>{const e=this.getState();this.setState(e)},this._resolveWorkItemFilter=e=>{this._workItemFilter=e},this.onFilterContentChanged=()=>{this._workItemFilter&&this._workItemFilter.update()}}componentDidMount(){super.componentDidMount(),this.getStore().addChangedListener(this._onStoreChange),this._filterManager=this.getFilterManager(),this._filterManager&&this._filterManager.attachEvent(U.FilterManager.EVENT_DATA_UPDATED,this.onFilterContentChanged)}componentWillUnmount(){super.componentWillUnmount(),this.getStore().removeChangedListener(this._onStoreChange),this._filterManager&&this._filterManager.detachEvent(U.FilterManager.EVENT_DATA_UPDATED,this.onFilterContentChanged)}render(){const e=this.getStore(),t=this.props.tabId;return e.isHubDataInitialized(t)?r.createElement("div",{className:(0,j.css)("work-items-tab-filter-control",this.props.className)},this._renderFilterControl()):null}focusFilterBar(){this._workItemFilter&&this._workItemFilter.focus()}_renderFilterControl(){const{filter:e,tabId:t,onDismissClicked:o}=this.props;return r.createElement(M.WorkItemFilter,{key:t,pageContext:this.context.pageContext,fields:this.props.store.getHubFilterFields(t),dataSource:this.props.store.getHubFilterDataSource(t),filter:e,setDefaultFilter:!1,ref:this._resolveWorkItemFilter,onDismissClicked:o})}getState(){return{}}getStore(){return this.props.store}getFilterManager(){return this.props.store.getFilterManager(this.props.tabId)}}t[e].WorkItemsTabFilter=o}("ComponentsWorkItemsTabFilter"),function(e){Ve=t[e]={};class o extends G.VssComponent{constructor(e,t){super(e,t),this._resolveWorkItemsTabFilter=e=>{this._workItemsTabFilter=e,e?this._focusFilterBarOnMount&&(this._focusFilterBarOnMount=!1,this._workItemsTabFilter.focusFilterBar()):this._focusFilterBarOnMount=!0},this._pivotProvider=new K.ContributedPivotBarItemProvider({pageContext:this.props.pageContext,tabGroupIds:[he.WorkItemsHubTabGroupContributionId]})}componentDidMount(){this.context.pageContext.getService("IVssTelemetryService").publishEvent($.WITCustomerIntelligenceArea,$.WITCustomerIntelligenceFeature.NEW_BOARDS_PLATFORM,{source:"WorkItems"})}render(){const{hubViewState:e,viewActions:t,commands:o,store:i}=this.props;return r.createElement(q.Hub,{className:"work-items-hub-view flex-grow",hubViewState:e,commands:o,viewActions:t,pivotProviders:[this._pivotProvider],pivotRenderingModeOptions:this._getPivotRenderingModeOptions(),onRenderFilterBar:()=>r.createElement(Ee.WorkItemsTabFilter,{filter:e.filter,tabId:e.selectedPivot.value.toLowerCase(),store:i,ref:this._resolveWorkItemsTabFilter})},r.createElement(Q.HubHeader,{title:ae.WorkItemsHubTitle}))}activateFilter(){this.props.hubViewState.viewOptions.setViewOption(z.HubViewOptionKeys.showFilterBar,!0),this._workItemsTabFilter?this._workItemsTabFilter.focusFilterBar():this._focusFilterBarOnMount=!0}_getPivotRenderingModeOptions(){return{mode:1,props:{dropdownWidth:180}}}toggleFullScreen(){const e=this.props.hubViewState.viewOptions.getViewOption(z.HubViewOptionKeys.fullScreen);this.props.hubViewState.viewOptions.setViewOption(z.HubViewOptionKeys.fullScreen,!e)}}t[e].WorkItemsHubView=o}("ComponentsWorkItemsHubView"),function(e){Ue=t[e]={};t[e].WorkItemsHubShortcutGroup=class{constructor(e,t){this._commandProvider=null,this._workItemsHubView=null,this._commandProvider=e,this._workItemsHubView=t}ReRegisterWorkItemsHubShortcuts(e){const t=e.getService("IVssKeyboardShortcutService");t.registerShortcut(ae.KeyboardShortcutGroup_Work,{combos:["z"],description:ae.KeyboardShortcutDescription_ToggleFullScreen,action:()=>{this._workItemsHubView.toggleFullScreen()}}),t.registerShortcut(ae.WorkItemsHubTitle,{combos:["mod+shift+f"],description:ae.FilterResults,action:()=>{this._workItemsHubView.activateFilter()}}),t.registerShortcut(ae.WorkItemsHubTitle,{combos:["mod+c"],description:ae.CopyToClipboard,element:".region-page",action:()=>{this._commandProvider.copyWorkItemsToClipboard(e,!0)}}),this._commandProvider.getDeleteHelper().hasDeletePermission()&&t.registerShortcut(ae.WorkItemsHubTitle,{combos:["del"],description:ae.DeleteSelectedWorkItems,element:".work-items-tab-content",action:()=>{this._commandProvider.deleteWorkItems(e,!0)}})}}}("WorkItemsHubShortcutGroup"),function(e){Le=t[e]={},function(e){e.SomethingWrongOnServer="ms.vss-work-web/new-work-items-hub-content/Illustrations/general-something-wrong-on-server.svg"}(t[e].GeneralZeroDataIllustrationPaths||(t[e].GeneralZeroDataIllustrationPaths={})),function(e){e.GetBackToRecentWork="ms.vss-work-web/new-work-items-hub-content/Illustrations/zerodata-get-back-to-recent-work.svg",e.KeepAnEyeOnImportantWork="ms.vss-work-web/new-work-items-hub-content/Illustrations/zerodata-keep-an-eye-on-important-work.svg",e.MentionSomeone="ms.vss-work-web/new-work-items-hub-content/Illustrations/zerodata-mention-someone.svg",e.YourWorkInOnePlace="ms.vss-work-web/new-work-items-hub-content/Illustrations/zerodata-your-work-in-one-place.svg",e.GeneralNoResultsFound="ms.vss-work-web/new-work-items-hub-content/Illustrations/general-no-results-found.svg"}(t[e].WorkZeroDataIllustrationPaths||(t[e].WorkZeroDataIllustrationPaths={})),function(e){e.YouDontHavePermission="ms.vss-work-web/new-work-items-hub-content/Illustrations/widget-you-dont-have-permission.svg"}(t[e].WorkWidgetIllustrationPaths||(t[e].WorkWidgetIllustrationPaths={}))}("ZeroDataIllustrationUrlUtils"),function(e){Be=t[e]={},t[e].createForAssignedToMe=function(e,t=null){const o={primaryText:ae.ZeroData_AssignedToMe_PrimaryMessage,secondaryText:ae.ZeroData_AssignedToMe_SecondaryMessage,actionHref:t?t.href:ae.ZeroData_AssignedToMe_SecondaryMessageLinkUrl,actionText:t?t.linkText:ae.ZeroData_SecondaryMessageLinkText,actionType:2,imagePath:(0,l.getAssetLocation)(e,Le.WorkZeroDataIllustrationPaths.YourWorkInOnePlace),imageAltText:ae.Illustrations_YourWorkInOnePlaceAltText};return r.createElement(Y.ZeroData,Object.assign({},o))},t[e].createForFollowing=function(e,t=null){const o=ae.ZeroData_Following_SecondaryMessageFormat.split("{0}"),i={primaryText:ae.ZeroData_Following_PrimaryMessage,secondaryText:r.createElement("span",null,o[0],r.createElement("span",{className:"bowtie-icon bowtie-watch-eye"}),o[1]),actionHref:t?t.href:ae.ZeroData_Following_SecondaryMessageLinkUrl,actionText:t?t.linkText:ae.ZeroData_Following_SecondaryMessageLinkText,actionType:2,imagePath:(0,l.getAssetLocation)(e,Le.WorkZeroDataIllustrationPaths.KeepAnEyeOnImportantWork),imageAltText:ae.Illustrations_KeepAnEyeOnImportantWorkAltText};return r.createElement(Y.ZeroData,Object.assign({},i))},t[e].createForFollowingNotconfigured=function(e,t=null){const o={primaryText:ae.ZeroData_Following_NotConfigured_PrimaryMessage,secondaryText:ae.ZeroData_Following_NotConfigured_SecondaryMessage,actionHref:t?t.href:ae.ZeroData_Following_NotConfigured_SecondaryMessageLinkUrl,actionText:t?t.linkText:ae.ZeroData_Following_NotConfigured_SecondaryMessageLinkText,actionType:2,imagePath:(0,l.getAssetLocation)(e,Le.WorkZeroDataIllustrationPaths.KeepAnEyeOnImportantWork),imageAltText:ae.Illustrations_KeepAnEyeOnImportantWorkAltText};return r.createElement(Y.ZeroData,Object.assign({},o))},t[e].createForMyActivity=function(e,t=null){const o={primaryText:ae.ZeroData_MyActivity_PrimaryMessage,secondaryText:ae.ZeroData_MyActivity_SecondaryMessage,actionHref:t?t.href:ae.ZeroData_MyActivity_SecondaryMessageLinkUrl,actionText:t?t.linkText:ae.ZeroData_SecondaryMessageLinkText,actionType:2,imagePath:(0,l.getAssetLocation)(e,Le.WorkZeroDataIllustrationPaths.GetBackToRecentWork),imageAltText:ae.Illustrations_GetBackToRecentWorkAltText};return r.createElement(Y.ZeroData,Object.assign({},o))},t[e].createForMentioned=function(e,t=null){const o={primaryText:ae.ZeroData_Mentioned_PrimaryMessage,secondaryText:ae.ZeroData_Mentioned_SecondaryMessage,actionHref:t?t.href:ae.ZeroData_Mentioned_SecondaryMessageLinkUrl,actionText:t?t.linkText:ae.ZeroData_Mentioned_SecondaryMessageLinkText,actionType:2,imagePath:(0,l.getAssetLocation)(e,Le.WorkZeroDataIllustrationPaths.MentionSomeone),imageAltText:ae.Illustrations_MentionSomeoneAltText};return r.createElement(Y.ZeroData,Object.assign({},o))},t[e].createForRecentlyCreated=function(e,t=null){const o={primaryText:ae.ZeroData_RecentlyCreated_PrimaryMessage,secondaryText:ae.ZeroData_RecentlyCreated_SecondaryMessage,actionHref:t?t.href:ae.ZeroData_RecentlyCreated_SecondaryMessageLinkUrl,actionText:t?t.linkText:ae.ZeroData_SecondaryMessageLinkText,actionType:2,imagePath:(0,l.getAssetLocation)(e,Le.WorkZeroDataIllustrationPaths.GetBackToRecentWork),imageAltText:ae.Illustrations_GetBackToRecentWorkAltText};return r.createElement(Y.ZeroData,Object.assign({},o))},t[e].createForRecentlyCompleted=function(e,t=null){const o={primaryText:ae.ZeroData_RecentlyCompleted_PrimaryMessage,secondaryText:ae.ZeroData_RecentlyCompleted_SecondaryMessage,actionHref:t?t.href:ae.ZeroData_RecentlyCompleted_SecondaryMessageLinkUrl,actionText:t?t.linkText:ae.ZeroData_SecondaryMessageLinkText,actionType:2,imagePath:(0,l.getAssetLocation)(e,Le.WorkZeroDataIllustrationPaths.GetBackToRecentWork),imageAltText:ae.Illustrations_GetBackToRecentWorkAltText};return r.createElement(Y.ZeroData,Object.assign({},o))},t[e].createForRecentlyUpdated=function(e,t=null){const o={primaryText:ae.ZeroData_RecentlyUpdated_PrimaryMessage,secondaryText:ae.ZeroData_RecentlyUpdated_SecondaryMessage,actionHref:t?t.href:ae.ZeroData_RecentlyUpdated_SecondaryMessageLinkUrl,actionText:t?t.linkText:ae.ZeroData_SecondaryMessageLinkText,actionType:2,imagePath:(0,l.getAssetLocation)(e,Le.WorkZeroDataIllustrationPaths.GetBackToRecentWork),imageAltText:ae.Illustrations_GetBackToRecentWorkAltText};return r.createElement(Y.ZeroData,Object.assign({},o))},t[e].createForMyTeams=function(e,t=null){const o={primaryText:ae.ZeroData_MyTeams_PrimaryMessage,secondaryText:ae.ZeroData_MyTeams_SecondaryMessage,actionHref:t?t.href:ae.ZeroData_MyTeams_SecondaryMessageLinkUrl,actionText:t?t.linkText:ae.ZeroData_SecondaryMessageLinkText,actionType:2,imagePath:(0,l.getAssetLocation)(e,Le.WorkZeroDataIllustrationPaths.GetBackToRecentWork),imageAltText:ae.Illustrations_GetBackToRecentWorkAltText};return r.createElement(Y.ZeroData,Object.assign({},o))},t[e].createForMyTeamsNotconfigured=function(e){const t={primaryText:ae.ZeroData_MyTeams_NotConfigured_PrimaryMessage,secondaryText:ae.ZeroData_MyTeams_NotConfigured_SecondaryMessage,imagePath:(0,l.getAssetLocation)(e,Le.WorkZeroDataIllustrationPaths.KeepAnEyeOnImportantWork),imageAltText:ae.Illustrations_KeepAnEyeOnImportantWorkAltText};return r.createElement(Y.ZeroData,Object.assign({},t))},t[e].createForServerError=function(e){return r.createElement(Y.ZeroData,{primaryText:ae.ZeroData_ServerError_PrimaryText,secondaryText:e,imagePath:"",imageAltText:ae.Illustrations_SomethingWrongOnServerAltText})}}("ZeroDataWorkItemTrackingZeroDataUtils"),function(e){Ze=t[e]={};class o extends r.Component{render(){return r.createElement(Y.ZeroData,{imagePath:(0,l.getAssetLocation)(this.props.pageContext,Le.WorkZeroDataIllustrationPaths.GeneralNoResultsFound),imageAltText:"",primaryText:(0,a.format)(ae.GenericFilterZeroData_Message,this.props.artifactName)})}}t[e].GenericFilterZeroData=o}("ZeroDataGenericFilterZeroData"),function(e){je=t[e]={},function(e){const t={[le.WorkItemsHubTabs.AssignedToMe]:e=>Be.createForAssignedToMe(e),[le.WorkItemsHubTabs.MyActivity]:e=>Be.createForMyActivity(e),[le.WorkItemsHubTabs.RecentlyUpdated]:e=>Be.createForRecentlyUpdated(e),[le.WorkItemsHubTabs.Following]:(e,t)=>t?Be.createForFollowing(e):Be.createForFollowingNotconfigured(e),[le.WorkItemsHubTabs.Mentioned]:e=>Be.createForMentioned(e),[le.WorkItemsHubTabs.RecentlyCreated]:e=>Be.createForRecentlyCreated(e),[le.WorkItemsHubTabs.RecentlyCompleted]:e=>Be.createForRecentlyCompleted(e),[le.WorkItemsHubTabs.MyTeams]:(e,t)=>t?Be.createForMyTeams(e):Be.createForMyTeamsNotconfigured(e)};e.createForEmptyData=function(e,o,i=!1,s){if(i)return r.createElement(Ze.GenericFilterZeroData,{artifactName:ae.ZeroData_Filter_WorkItems_ArtifactName,pageContext:s});const a=t[me.TabEnumValueByTabIdMap[e]];return a?a(s,o):null},e.createForMissingTabData=function(e){return r.createElement(Y.ZeroData,{primaryText:ae.UnableToLoadHubData,imagePath:(0,l.getAssetLocation)(e,Le.GeneralZeroDataIllustrationPaths.SomethingWrongOnServer),imageAltText:ae.Illustrations_SomethingWrongOnServerAltText})},e.createForServerError=Be.createForServerError}(t[e].ZeroDataFactory||(t[e].ZeroDataFactory={}))}("ZeroDataZeroDataFactory"),function(e){Ge=t[e]={};const o="show-completed-items",i=["filterText","viewOption"];class s extends G.VssComponent{constructor(e,t){super(e,t),this.isCompatUrl=!1;const o=this.context.pageContext.getService("ITfsPageService").getData().project,i=(0,be.getCurrentHashString)();if(i){const e=(0,be.deserializeState)(i),t=e[he.ActionParameters.ID],r=e[he.ActionUrl.ACTION];t&&r&&a.equals(r,he.ActionUrl.ACTION_EDIT,!0)&&(de.UsageTelemetryHelper.publishBackCompatUrlOpenWorkItem(this.context.pageContext,i),window.location.href=(0,be.getEditWorkItemUrl)(this.context.pageContext,o.name,t),this.isCompatUrl=!0),r&&a.equals(r,he.ActionUrl.ACTION_QUERY,!0)&&(de.UsageTelemetryHelper.publishBackCompatUrlQuery(this.context.pageContext,i),window.location.href=(0,be.getQueriesHubUrl)(this.context.pageContext,o.name,i),this.isCompatUrl=!0)}}render(){return this.isCompatUrl?null:r.createElement(n,null)}}t[e].WorkItemsHubViewComponent=s;class n extends G.VssComponent{constructor(e,t){super(e,t),this._onPivotChanging=e=>{de.PerformanceTelemetryHelper.getInstance(this.context.pageContext).startTabSwitch(),n.hubViewState.viewOptions.setViewOption(le.WorkItemsHubRouteConstants.TabRouteParameterName,e),ve.updateRecentTabId(this.context.pageContext,this._project.id,e)},this._onViewOptionsChanged=(e,t)=>{const{selectedPivot:i}=n.hubViewState,r=i.value,s=n.getStore();if(!s.getHubDisplayData(r))return null;if(e.hasOwnProperty(o)&&r!==me.TabIdByTabEnumValueMap[le.WorkItemsHubTabs.RecentlyCompleted]){const{pageContext:t}=this.context,i=e[o],a=n.getActionsCreator(),l=s.getHubFilterDataSource(r).isCompletedItemsLoaded();a.setCompletedItemsVisibility(r,i),ve.updateShowCompletedForTab(this.context.pageContext,this._project.id,r,i).then((()=>{i&&!l&&(a.invalidateTabData(r),a.refreshDataProviderAsync(r))})),de.UsageTelemetryHelper.publishCompletedWorkItemsViewOptionTelemetry(t,r,i)}},this.resolveWorkItemsHubView=e=>{e&&(this._workItemsHubShortcutGroup=new Ue.WorkItemsHubShortcutGroup(n.getWorkItemsHubCommandProvider(),e),this._workItemsHubShortcutGroup.ReRegisterWorkItemsHubShortcuts(this.context.pageContext))},n.mountCount++;const r=t.pageContext.getService("IVssHistoryService");let s=r.getState();const{filterText:a,viewOption:l}=s;(a||l)&&(i.forEach((e=>s[e]=void 0)),r.replaceState(s));const m=this.context.pageContext.getService("ITfsPageService").getData();this._project=m.project,this._initializeFlux(l),this._initView(),null!=a&&n.actionsCreator.updateFilterState(this._initialTabId,{text:{values:[a]}}),de.PerformanceTelemetryHelper.getInstance(this.context.pageContext).startPageLoad(),de.UsageTelemetryHelper.publishLoadWorkItemsHub(this.context.pageContext,this._initialTabId)}_initializeFlux(e){const t=new ne.ActionsHub,o=ce.WorkItemsHubDataProvider.getDataForCurrentTab(this.context.pageContext),i=o?o.processSettings.tabId:me.TabIdByTabEnumValueMap[le.WorkItemsHubTabs.AssignedToMe];this._setInitialViewAction(i);let r=null;e&&(a.equals(e,"showCompleted",!0)?r=!0:a.equals(e,"hideCompleted",!0)&&(r=!1),null!=r&&o&&o.userSettings&&o.userSettings.showCompleted!==r&&ve.updateShowCompletedForTab(this.context.pageContext,this._project.id,this._initialTabId,r)),n.store=new xe.WorkItemsHubStore(t,this.context.pageContext,this._initialTabId,o,null,r),n.actionsCreator=new ue.ActionsCreator(this.context.pageContext,t)}_initView(){n.hubViewState=new ee.VssHubViewState(this.context.pageContext,{defaultPivot:this._initialTabId,pivotNavigationParamName:le.WorkItemsHubRouteConstants.TabRouteParameterName,viewOptionNavigationParameters:[{key:z.HubViewOptionKeys.showFilterBar,behavior:0}]}),n.hubViewState.viewOptions.setViewOption(z.HubViewOptionKeys.showFilterBar,!0),n.hubViewState.viewOptions.setViewOption(le.WorkItemsHubRouteConstants.TabRouteParameterName,this._initialTabId),n.setViewOptions(this._initialTabId),n.workItemsHubCommandProvider=new Me.WorkItemsHubCommandProvider(this.context.pageContext,n.getStore(),n.hubViewState,n.getActionsCreator()),n.observableCommands=this._getObservableCommands({selectionIds:[],hasFilter:!1,tabId:this._initialTabId}),n.viewActions=n.getHubViewActions(this._initialTabId),n.observableViewActions=new X.ObservableArray([...n.viewActions]),n.hubViewState.subscribe(this._onPivotChanging,z.HubViewStateEventNames.pivotChanging),n.hubViewState.viewOptions.subscribe(this._onViewOptionsChanged,J.VIEW_OPTIONS_CHANGE_EVENT)}static getHubViewActions(e){if(!n.getStore().getHubDisplayData(e))return[];let t=n.viewActionCache[e];if(n.viewActionCache[e])return t;t=n.viewActionCache[e]=[];const i=e===me.TabIdByTabEnumValueMap[le.WorkItemsHubTabs.RecentlyCompleted];return t.push({key:o,name:ae.CompletedItemsViewOptionName,actionType:1,important:!1,actionProps:{onText:ae.CompletedItemsShown,offText:ae.CompletedItemsHidden,onAriaLabel:a.format(ae.CompletedWorkItemsToggleLabel,ae.CompletedWorkItemsOnText),offAriaLabel:a.format(ae.CompletedWorkItemsToggleLabel,ae.CompletedWorkItemsOffText)},disabled:i}),t}_setInitialViewAction(e){const t=this.context.pageContext.getService("IVssHistoryService"),o=t.getState(),i=o[le.WorkItemsHubRouteConstants.TabRouteParameterName];i&&null!==me.getTabIdByName(i)?this._initialTabId=me.getTabIdByName(i):(o[le.WorkItemsHubRouteConstants.TabRouteParameterName]=e,t.replaceState(o),this._initialTabId=e)}componentWillUnmount(){super.componentWillUnmount(),n.hubViewState&&(n.hubViewState.unsubscribe(this._onPivotChanging),n.hubViewState.viewOptions.unsubscribe(this._onViewOptionsChanged,J.VIEW_OPTIONS_CHANGE_EVENT)),n.mountCount--,0==n.mountCount&&(n.hubViewState&&(n.hubViewState.dispose(),n.hubViewState=null),n.store&&(n.store.dispose(),n.store=null))}static setViewOptions(e){const t=n.getStore();if(!t.isHubDataInitialized(e))return;const{viewOptions:i}=n.hubViewState,r=i.getViewOptions(),s=t.getHubFilterDataSource(e),a=e===me.TabIdByTabEnumValueMap[le.WorkItemsHubTabs.RecentlyCompleted]||s.shouldShowCompletedItems();r[o]=a,i.setViewOptions(r,!0)}_getObservableCommands(e){const{tabId:t}=e;n.workItemsHubCommandProvider.setTabData(e);const o=n.getStore();return new X.ObservableArray(n.workItemsHubCommandProvider.getCommands(o.getWorkItemsHubPermission(),o.isSupportedFeature(t)))}render(){return r.createElement(Ve.WorkItemsHubView,{pageContext:this.context.pageContext,hubViewState:n.hubViewState,store:n.getStore(),actionsCreator:n.getActionsCreator(),commands:n.observableCommands,viewActions:n.observableViewActions,ref:this.resolveWorkItemsHubView})}static getStore(){return n.store}static getActionsCreator(){return n.actionsCreator}static getHubViewState(){return n.hubViewState}static getWorkItemsHubCommandProvider(){return n.workItemsHubCommandProvider}static updateCommandsActionsAndViewOptions(e){const t=n.store,o=n.workItemsHubCommandProvider.getCommands(t.getWorkItemsHubPermission(),t.isSupportedFeature(e));(0,pe.shallowEquals)(n.observableCommands.value,o)||(n.observableCommands.value=o);const i=n.getHubViewActions(e);(0,pe.shallowEquals)(n.observableViewActions.value,i)||(n.observableViewActions.value=i),n.setViewOptions(e)}}t[e].WorkItemsHubViewProvider=n,n.mountCount=0,n.viewActionCache={},G.VssComponent.register("work-items-hub-view-component",s)}("WorkItemsHubViewProvider"),function(e){t[e]={};class o extends G.VssComponent{constructor(e,t){super(e,t),this._selectedIds=[],this._telemetrySent=!1,this._recreateColumns=!1,this._isDataCached=!1,this._onColumnClick=(e,t)=>{const o=e.shiftKey;let i;const r=t.key,s=this.getStore().getHubFilterDataSource(this.props.tabId);if(!s.isSortableField(r))return;const a=s.getSortOptions(),n=a.findIndex((e=>e.fieldReferenceName===r));if(o)i=a.slice(),n<0?i.push({fieldReferenceName:r,isAscending:!0}):i[n].isAscending=!a[n].isAscending;else{const e=n<0||!a[n].isAscending;i=[{fieldReferenceName:r,isAscending:e}]}this._actionsCreator.sortColumn(this.props.tabId,i);const l=s.getCurrentColumnOptions();de.UsageTelemetryHelper.publishColumnHeaderClick(this.context.pageContext,this.props.tabId,{sortedColumnCount:i.length,sortedColumns:i.map((e=>e.fieldReferenceName)).join(),sortedOrder:i.map((e=>e.isAscending)).join()});const m=s.getCurrentColumnSettingsVersion(),c=this.context.pageContext.getService("ITfsPageService").getData().project.id;(0,ve.updateColumnSettings)(this.context.pageContext,c,this.props.tabId,l,i,m),this._recreateColumns=!0},this._onColumnResize=(e,t)=>{const o=e.key,i=this._store.getHubFilterDataSource(this.props.tabId),r=i.getCurrentColumnOptions(),s=i.getSortOptions();t=Math.ceil(t),r.forEach((e=>{a.equals(e.fieldReferenceName,o,!0)&&(e.width=t)})),de.UsageTelemetryHelper.publishColumnResize(this.context.pageContext,this.props.tabId,{columnName:o,width:t});const n=i.getCurrentColumnSettingsVersion(),l=this.context.pageContext.getService("ITfsPageService").getData().project.id;(0,ve.updateColumnSettings)(this.context.pageContext,l,this.props.tabId,r,s,n)},this._onDetailsListRef=e=>{this._vssDetailsList=e},this._handleNavigateToEdit=e=>this._onOpenWorkItem(e.id),this._onOpenWorkItem=(e,t)=>{if(!t){const t=this._initTriageData(e);return void Oe.navigateToWorkEditWorkItemForm(this.context.pageContext,this._project.name,t)}const o=this._initTriageData(e,!0);Oe.navigateToWorkEditWorkItemForm(this.context.pageContext,this._project.name,o,t)&&(t.preventDefault(),t.stopPropagation())},this._getPageHeight=()=>o.ItemHeight*this._getItemCountForPage(),this._getItemCountForPage=()=>o.DetailsListPageSize,this._onRenderRow=e=>r.createElement(u.DetailsRow,Object.assign({},e,{className:he.TabContent_WorkItemsHubGridRowClassName,"data-item-key":e.item.key})),this._onRowDidMount=()=>{if(!this._vssDetailsList||!this._vssDetailsList.detailsList||!this.state.selection||-1===this._initialSelectedIndex)return;this._tryEndPerformanceScenario();const{selection:e}=this.state,t=this._initialSelectedIndex;this._trySetEffectiveScrollPosition(t)||this._vssDetailsList.detailsList.scrollToIndex(t),requestAnimationFrame((()=>e.setIndexSelected(t,!0,!0))),this._initialSelectedIndex=-1},this._fetchMoreItems=()=>{const{tabId:e}=this.props,t=this._store.getHubFilterDataSource(e);t.canPageMoreItems()&&this._actionsCreator.pageWorkItems(e,t)},this._loadLegacyEventHandlers=()=>{const e=this.context.pageContext.getService("ILegacyPlatformService");this._workItemEventHandler||e.requireModules(["WorkItemsHub/Scripts/LegacyPlatform/LegacyWorkItemEventHandler"]).then((([e])=>{this._workItemEventHandler=new e.LegacyWorkItemEventHandler({onSave:this._onSave,onDelete:this._onDelete,onFollowsStateChanged:this._onFollowsStateChanged})}))},this._onSave=()=>{const e=ce.WorkItemsHubDataProvider.getCurrentTabId(this.context.pageContext);this._actionsCreator.refreshDataProviderAsync(e,!0)},this._onDelete=e=>{const t=ce.WorkItemsHubDataProvider.getCurrentTabId(this.context.pageContext);this._actionsCreator.removeWorkItemFromDataProvider(t,[e])},this._onFollowsStateChanged=()=>{const e=me.TabIdByTabEnumValueMap[le.WorkItemsHubTabs.Following],t=ce.WorkItemsHubDataProvider.getCurrentTabId(this.context.pageContext);t===e?this._actionsCreator.refreshDataProviderAsync(t,!0):this._actionsCreator.invalidateTabData(e)},this._filterChanged=()=>{const{tabId:e}=this.props;this._actionsCreator.updateFilterState(e,(0,M.mapToFilterState)(this._filter.getState())),this._onTabContentChanged()},this._onStoreChange=()=>{const e=this.getState();this.setState(e)},this._onTabContentChanged=()=>{const{selection:e}=this.state,{tabId:t}=this.props,o=e.getSelection().map((e=>e.id)),i=this.getStore(),r=i.getHubFilterDataSource(t),s={selectionIds:o,hasFilter:!!r&&r.hasFilter(),tabId:t};this._lastContentData=s,this._workItemsHubCommandProvider.setTabData(s),i&&Ge.WorkItemsHubViewProvider.updateCommandsActionsAndViewOptions(t)},this._store=Ge.WorkItemsHubViewProvider.getStore(),this._actionsCreator=Ge.WorkItemsHubViewProvider.getActionsCreator(),this._filter=Ge.WorkItemsHubViewProvider.getHubViewState().filter,this._workItemsHubCommandProvider=Ge.WorkItemsHubViewProvider.getWorkItemsHubCommandProvider(),this._gridColumnFactory=new ye.WorkItemsGridColumnFactory,this._perfTelemetryHelper=de.PerformanceTelemetryHelper.getInstance(this.context.pageContext);const i=this.context.pageContext.getService("ITfsPageService").getData();this._project=i.project,this._timerManagement=new oe.TimerManagement(this),this._delayedOnColumnResize=this._timerManagement.debounce(this._onColumnResize,o.ColumnResizeDefaultDelayTimeInMilliseconds,{leading:!1,trailing:!0}),this.state=this.getState()}render(){const{initialized:e,totalItemCount:t,visibleItemCount:o,gridData:i,isError:s,isSupportedFeature:n,isFiltered:l}=this.state,{tabId:m}=this.props;let c;return s?c=je.ZeroDataFactory.createForMissingTabData(this.context.pageContext):e?0===o?(l&&(0,P.announce)(a.format(ae.MultipleWorkItemsFiltered,o)),c=je.ZeroDataFactory.createForEmptyData(m,n,t>0,this.context.pageContext)):(l&&(0,P.announce)(1==o?a.format(ae.SingleWorkItemFiltered,o):a.format(ae.MultipleWorkItemsFiltered,o)),c=r.createElement("div",{role:"navigation","aria-label":ae.WorkItemsHubGridLandmarkLabel},this._buildDetailList(i))):c=r.createElement(re.Spinner,{size:"large",className:"work-items-hub-spinner",label:ae.Loading}),r.createElement("div",{className:he.TabContent_BaseClassName},c)}_buildDetailList(e){const{columns:t,selection:o,isFiltered:i}=this.state;return r.createElement(ie.VssDetailsList,{className:(0,j.css)(he.TabContent_WorkItemsHubDetailsListClassName,`${this.props.tabId}-grid`),usePresentationStyles:!0,items:e,columns:t,isHeaderVisible:!0,ariaLabelForSelectionColumn:ae.SelectAllAriaLabel,onColumnHeaderClick:this._onColumnClick,onColumnResize:this._delayedOnColumnResize,constrainMode:u.ConstrainMode.unconstrained,selectionMode:u.SelectionMode.multiple,checkboxVisibility:u.CheckboxVisibility.onHover,checkButtonAriaLabel:ae.CheckButtonLabel,actionsColumnKey:g.CoreFieldRefNames.Title,getMenuItems:e=>this._workItemsHubCommandProvider.getContextMenuItems(this.context.pageContext,this._store.getWorkItemsHubPermission(),e),layoutMode:u.DetailsListLayoutMode.fixedColumns,selection:o,onItemInvoked:this._handleNavigateToEdit,listProps:{getPageHeight:this._getPageHeight,getItemCountForPage:this._getItemCountForPage,renderedWindowsAhead:i?0:void 0,renderedWindowsBehind:i?0:void 0},onRenderRow:this._onRenderRow,onRowDidMount:this._onRowDidMount,setKey:he.TabContent_GridBaseClassName,initialFocusedIndex:this._initialSelectedIndex,componentRef:this._onDetailsListRef})}_initTriageData(e,t=!1){if(this._lastContentData){const{tabId:o,selectionIds:i}=this._lastContentData,r=this.props.tabName;let s=i,a=this._scrollableContentContainer?this._scrollableContentContainer.scrollTop:0;const n=this._store.getHubFilterDataSource(o),l=n?n.getFilteredIds():null;if(!i||i.length<2?l&&(s=l):t||(e=i[0]),!s||0===s.length)return this._setWorkItemsHubNavigationData(null),e;(i&&0===i.length||-1===s.indexOf(e))&&(e=s[0],a=0);const m=(0,pe.findIndex)(l,(t=>t===e));this._setWorkItemsHubNavigationData({tabId:o,tabName:r,workItemIds:s,lastTriagedWorkItemId:e,selectedItemIndexInVisibleList:m,selectedIndexScrollTopValue:a})}else this._setWorkItemsHubNavigationData(null);return e}componentDidMount(){super.componentDidMount(),this._performanceScenarioSplit("TabContentDidMount"),this.getStore().addChangedListener(this._onStoreChange);const e=this._store.isHubDataInitialized(this.props.tabId);this._isDataCached=e,e?this._filter&&this._setFilterForTab():(this._performanceScenarioSplit("FetchData"),this._actionsCreator.refreshDataProviderAsync(this.props.tabId,!1,le.WorkItemsHubPaging.InitialPageSize)),setTimeout((()=>this._tryEndPerformanceScenario()),0),this._scrollableContentContainer=document.querySelector("[data-is-scrollable='true']"),this._loadLegacyEventHandlersAfterTTI(3e3)}componentWillUnmount(){super.componentWillUnmount(),this._unsubscribeFilter(),this.getStore().removeChangedListener(this._onStoreChange),this._timerManagement&&(this._timerManagement.dispose(),this._timerManagement=null),this._workItemEventHandler&&(this._workItemEventHandler.dispose(),this._workItemEventHandler=null)}_loadLegacyEventHandlersAfterTTI(e){let t=this.setTimeout((()=>{this._loadLegacyEventHandlers(),this.clearTimeout(t)}),e);this.context.pageContext.getService("IVssContributionEventService").subscribe((()=>{t&&(this._loadLegacyEventHandlers(),this.clearTimeout(t))}),"page-interactive")}componentWillUpdate(e,t){const{selection:o}=this.state;this._selectedIds=o.getSelectedCount()>0?o.getSelection().map((e=>e.id)):[],this.state.initialized&&!t.initialized?this._unsubscribeFilter():!this.state.initialized&&t.initialized&&this._setFilterForTab()}_trySetEffectiveScrollPosition(e){let t=!1;if(0!==e){const i=this._getWorkItemsHubNavigationData();if(this._scrollableContentContainer&&i&&i.lastTriagedWorkItemId){let r=i.selectedIndexScrollTopValue;r-=(i.selectedItemIndexInVisibleList-e)*o.ItemHeight,this._scrollableContentContainer.scrollTop=r,t=!0}}return t}_unsubscribeFilter(){this._filter.unsubscribe(this._filterChanged,se.FILTER_CHANGE_EVENT)}_setFilterForTab(){const e=this.getStore(),{tabId:t}=this.props,o=this._filter,i=e.getHubFilterFields(t),r=e.getHubFilterDataSource(t),s=r?r.getFilterState():null;o.setDefaultState((0,M.generateDefaultFilterState)(i)),o.reset(),(0,U.isFilterStateEmpty)(s)?o.subscribe(this._filterChanged,se.FILTER_CHANGE_EVENT):(0,M.resolveFilterState)(i,r,s).then((e=>{o.setState(e),o.subscribe(this._filterChanged,se.FILTER_CHANGE_EVENT)}),(()=>{o.reset()})),this._onTabContentChanged()}componentDidUpdate(){const{gridData:e,selection:t}=this.state;if(e&&(t.setItems(e,!0),this._selectedIds.length>0)){const o=[];e.forEach(((e,t)=>{this._selectedIds.indexOf(e.id)>-1&&o.push(t)})),requestAnimationFrame((()=>o.forEach((e=>t.setIndexSelected(e,!0,!0)))))}this._tryEndPerformanceScenario()}_buildColumns(e,t,o){let i=null;if(!e)return i;if(this.state&&this.state.columns&&!this._recreateColumns){const e=this.state.columns.map((e=>e.fieldName));if((0,j.arrayEquals)(e,o))return this.state.columns}return i=Se.WorkItemsGridDataProvider.buildColumns(this.context.pageContext,this._project.name,e,t,this._gridColumnFactory,new Date,this._onOpenWorkItem),this._recreateColumns=!1,i}getState(){const e=this.getStore(),t=this.props.tabId,i=e.isHubDataInitialized(t),r=e.isHubDataError(t),s=e.isSupportedFeature(t),n=e.getTotalItemsCount(t),l=e.getVisibleItemsCount(t),m=e.getHubFilterDataSource(t);let c=null,d=null,u=!1,h=null,p=null;m&&(c=m.getSortOptions(),d=m.getDisplayedFieldReferenceNames(),u=m.hasFilter()),i&&(h=e.getHubDisplayData(t),p=Se.WorkItemsGridDataProvider.getData(h,u));const g=this.state&&this.state.selection||new te.Selection({onSelectionChanged:this._onTabContentChanged});if(!(this.state&&this.state.initialized)&&p&&p.length>0){let e=0;const t=this._getWorkItemsHubNavigationData();t&&null!=t.lastTriagedWorkItemId&&(e=(0,pe.findIndex)(p,(e=>e.id===t.lastTriagedWorkItemId))),this._initialSelectedIndex=Math.max(0,e)}const I=this._buildColumns(h,c,d);return null!==p&&0===(0,a.localeIgnoreCaseComparer)(t,le.WorkItemsHubTabs[le.WorkItemsHubTabs.AssignedToMe])&&(p=p.filter((e=>"Removed"!==e.values[o.WorkItemStateIndex]))),{initialized:i,totalItemCount:n,visibleItemCount:l,gridData:p,columns:I,selection:g,isFiltered:u,isError:r,isSupportedFeature:s}}getStore(){return this._store}_getWorkItemsHubNavigationData(){return this.context.pageContext.getService("IWorkItemsHubNavDataService").getNavigationData()}_setWorkItemsHubNavigationData(e){this.context.pageContext.getService("IWorkItemsHubNavDataService").setNavigationData(e)}_tryEndPerformanceScenario(){if(this._telemetrySent)return;const e=this.getStore(),t=this.props.tabId;if(e.isHubDataInitialized(t)){const o=e.getHubFilterDataSource(t),i=o?o.getItemCount():-1,r=o?o.getPagedItemsCount():-1,s=o?o.getVisibleItemsCount():-1,a=!!o&&o.hasFilter(),n=o.getCurrentColumnOptions(),l={tabId:t,newWorkItemsHub:!0,isDataCached:this._isDataCached,totalWorkItemsCount:i,pageItemsCount:r,visibleItemsCount:s,hasFilters:a,completedItems:o.shouldShowCompletedItems(),columnCount:o.getDisplayedFieldReferenceNames().length,columnNames:n.map((e=>e.fieldReferenceName)),columnWidths:n.map((e=>e.width)),sortedColumnCount:o.getSortOptions().length,sortedColumnNames:o.getSortOptions().map((e=>e.fieldReferenceName))};this._perfTelemetryHelper.endScenario(l),this._telemetrySent=!0,setTimeout((()=>this._fetchMoreItems()),0)}}_performanceScenarioSplit(e){this._perfTelemetryHelper.split(e)}}t[e].WorkItemsTabContent=o,o.ItemHeight=41,o.DetailsListPageSize=10,o.WorkItemStateIndex=3,o.ColumnResizeDefaultDelayTimeInMilliseconds=500,G.VssComponent.register("work-items-tab-content",o)}("ComponentsWorkItemsTabContent")}),["Resources","DataContracts/IActionsDataContract","Actions/ActionsHub","Generated/Constants","Utils/WorkItemsHubTabUtils","DataProviders/WorkItemsHubDataProvider","Stores/IWorkItemsHubFilterDataSource","Utils/Telemetry","Actions/ActionsCreator","Components/IWorkItemsTabContentData","Constants","DataContracts/IWorkItemsGridData","Utils/Array","Components/Cells/WorkItemCommentCountCell","Components/Cells/WorkItemDateTimeCell","Utils/UrlUtils","Utils/NavigationUtils","Components/Cells/WorkItemIconTitleCell","Components/Cells/WorkItemSimpleCell","Utils/WorkItemsGridColumnFactory","Stores/WorkItemsHubFilterDataSource","Utils/WorkItemsHubDataUtils","DataProviders/WorkItemsGridDataProvider","External/NewWorkItem/WorkItemTypeColorAndIconsProvider","External/NewWorkItem/INewWorkItemData","External/NewWorkItem/NewWorkItem","Utils/WorkItemsHubTabSettings","Utils/ColumnOptionsPanelContracts","Utils/ColumnOptionsPanelLauncher","Utils/WorkItemsHubDeleteHelper","Utils/Clipboard","Utils/HtmlTableFormatter","Utils/WorkItemHtmlTableFormatter","Utils/WorkItemsHubReportUtils","Stores/WorkItemsHubStore","DataProviders/WorkItemsHubCommandProvider","Utils/Common","Utils/WorkItemsXhrNavigationUtils","Utils/WorkItemTempQueryUtils","Components/WorkItemsTabFilter","Components/WorkItemsHubView","WorkItemsHubShortcutGroup","ZeroData/IllustrationUrlUtils","ZeroData/WorkItemTrackingZeroDataUtils","ZeroData/GenericFilterZeroData","ZeroData/ZeroDataFactory","WorkItemsHubViewProvider","Components/WorkItemsTabContent"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-work-web.new-work-items-hub-content"}}));