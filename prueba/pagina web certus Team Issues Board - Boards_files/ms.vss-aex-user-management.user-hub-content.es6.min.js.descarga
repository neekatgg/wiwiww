"use strict";define("Aex/UserManagement/UserHub",["require","exports","Aex/Platform/UI/Contexts/AexPageContextService","Aex/Platform/UI/Contexts/GeneralErrorContext","Aex/Platform/UI/Hooks/useContributionData","react","VSS/Core/Util/Memoize","VSS/Platform/Layout","VSS/Platform/Location","VSSUI/Spinner","VSS/Platform/Context","VSS/Platform/RestClientBase","Aex/Platform/Utils/useAsyncState","Aex/Platform/UI/Components/TemplateString","Aex/Platform/UI/Hooks/useSelection","Aex/Platform/UI/Styling/Sizing","Aex/Platform/UI/Styling/Spacing","VSS/Core/Util/Accessibility","VSSUI/Dropdown","VSSUI/FormItem","VSSUI/Link","VSSUI/Util","VSSUI/Utilities/DropdownSelection","VSS/Features/Identities/IdentityPickerProvider","Aex/Platform/UI/Hooks/useMutableCallback","VSS/Core/Observable","VSSUI/Table","Aex/Platform/UI/Styling/CoreClassNames","VSSUI/Icon","VSSUI/Checkbox","VSSUI/List","VSSUI/ZeroData","Aex/Platform/Utils/useResolvedPromise","VSS/Core/Util/String","Aex/Platform/UI/Models/HandledError","Aex/Platform/UI/Hooks/useCollectionDataIterator","Aex/Platform/UI/Util/CollectionDataStore","Aex/Platform/Utils/useDependentState","VSS/Platform/Util/Serialization","Aex/Platform/UI/Styling/ColorClassNames","Aex/Platform/UI/Styling/CssClassNames","VSSUI/Button","VSSUI/ButtonGroup","VSSUI/Panel","VSS/Core/Util/Object","VSSUI/Dialog","VSSUI/Surface","Aex/Platform/Utils/useVersionKey","VSSUI/IdentityPicker","VSSUI/Pill","VSSUI/PillGroup","VSSUI/TooltipEx","VSSUI/VssPersona","VSSUI/MessageCard","VSSUI/Status","VSSUI/Clipboard","VSSUI/TextField","VSS/Core/Util/Promise","VSSUI/TreeEx","VSSUI/Utilities/TreeItemProvider","VSSUI/Tabs","Aex/Platform/Utils/useAsyncAction","VSSUI/Card","VSSUI/Utilities/Provider","VSSUI/Ago","VSSUI/FilterBar","VSSUI/TextFilterBarItem","VSSUI/Utilities/Filter","VSSUI/Header","VSSUI/HeaderCommandBar","VSSUI/Page","Aex/Platform/UI/Util/PerfUtil"],(function(e,t,s,n,r,i,a,o,l,c,u,m,d,p,g,b,C,v,h,f,S,y,E,A,x,T,U,I,P,N,M,L,_,D,F,R,k,w,G,B,j,H,O,V,z,q,W,K,$,J,Q,Y,Z,X,ee,te,se,ne,re,ie,ae,oe,le,ce,ue,me,de,pe,ge,be,Ce,ve){var he,fe,Se,ye,Ee,Ae,xe,Te,Ue,Ie,Pe,Ne,Me,Le,_e,De,Fe,Re,ke,we,Ge,Be,je,He,Oe,Ve,ze,qe,We,Ke,$e,Je,Qe,Ye,Ze,Xe,et,tt,st,nt,rt,it,at,ot,lt,ct,ut,mt,dt,pt,gt,bt,Ct,vt,ht,ft,St,yt,Et,At,xt,Tt,Ut,It,Pt,Nt,Mt,Lt,_t,Dt,Ft,Rt,kt,wt,Gt,Bt,jt,Ht,Ot,Vt,zt,qt,Wt,Kt,$t,Jt,Qt,Yt,Zt,Xt,es,ts,ss,ns,rs,is,as,os,ls,cs,us,ms,ds,ps,gs,bs,Cs,vs,hs,fs,Ss,ys,Es,As,xs,Ts,Us,Is,Ps,Ns,Ms,Ls,_s,Ds,Fs,Rs,ks,ws;he=t[ws="Resources"]={},t[ws].ActionDisplayName_AddUsers="Add users",t[ws].AccessLevel_IsDisabled="Access level is disabled",t[ws].AssetsReinstated="The previous user's assets have been reinstated to the current user.",t[ws].BulkStatusDialogColumnName_Action="Action",t[ws].BulkStatusDialogColumnName_Extension="Extension",t[ws].BulkStatusDialogColumnName_Message="Message",t[ws].BulkStatusDialogColumnName_Status="Status",t[ws].BulkStatusDialogColumnName_Project="Project",t[ws].BulkStatusDialogColumnName_User="User",t[ws].BulkStatusDialogText_LabelFailed="Failed",t[ws].BulkStatusDialogText_LabelSuccess="Success",t[ws].BulkStatusDialogText_LabelWarning="Warning",t[ws].BulkStatusDialogText_LabelCanceled="Canceled",t[ws].BulkStatusDialogText_LabelCanceling="Canceling",t[ws].BulkStatusDialogText_LabelRunning="Running",t[ws].BulkStatusDialogText_ActionStatus2="{0}: {1}",t[ws].BulkStatusDialogText_NumSuccessful1="{0} successful",t[ws].BulkStatusDialogText_NumFailed1="{0} failed",t[ws].BulkStatusDialogText_NumCanceled1="{0} canceled",t[ws].BulkStatusDialogText_NumWarning1="{0} completed with warnings",t[ws].BulkStatusDialogTitle_ViewStatus="View status",t[ws].BulkStatusDialogTitle_Action="Action",t[ws].BulkStatusDialogTitle_StatusSummary="Status summary",t[ws].BulkStatusMessage_ExtensionNotAssignedToAccessLevel2="{0} cannot be assigned to users with a {1} access level.",t[ws].BulkStatusMessage_ProjectMembershipInheritedWarning="If membership is given through a group, project membership was not removed.",t[ws].ButtonAnnounce_AddAll="All project added",t[ws].ButtonText_AddAll="Add all",t[ws].ButtonText_Assign="Assign",t[ws].ButtonText_Close="Close",t[ws].ButtonText_Details="Details",t[ws].ButtonText_MoreDetails="More details",t[ws].ButtonText_LessDetails="Less details",t[ws].ButtonText_Dismiss="Dismiss",t[ws].ButtonText_DismissAll="Dismiss all",t[ws].ButtonText_Manage="Manage",t[ws].ButtonText_ManageCount1="Manage ({0})",t[ws].ButtonText_Refresh="Refresh",t[ws].ButtonText_ResoveAllGroupRules="Re-evaluate rules",t[ws].ButtonText_Revoke="Revoke",t[ws].ButtonText_Summary="Summary",t[ws].ButtonText_ViewAll="View all",t[ws].ButtonText_Invite="Add users",t[ws].ButtonText_ReEvaluate="Re-evaluate",t[ws].ContextualMenuOptionExportCSV="Export users",t[ws].ContextualMenuOptionManageMembers="Manage members",t[ws].ContextualMenuOptionReinstateAssets="Reinstate Assets",t[ws].ContextualMenuOptionRemoveDirectAssignment="Remove direct assignments",t[ws].CantRemoveDirectAssignments="Can’t remove direct assignments",t[ws].ContextualMenuOptionResendInvite="Resend invite",t[ws].DescriptionText_NotificationsPanel="System issues are problems in the system that require admin attention. Session notifications are triggered by user activities in this session.",t[ws].DialogColProjectName="Projects",t[ws].DialogErrorMessage_Remove="during the removal process",t[ws].DialogErrorMessage_ServicePageLinkText="service page for updates",t[ws].DialogErrorMessage_Template2="Oops! Something went wrong {0}. Please check our {1}, and try again later.",t[ws].EditGroupMembers_DialogTitle="Manage group members",t[ws].EditGroupMembers_IdentityPickerAddMembersLabel="Add members",t[ws].EditGroupMembers_IdentityPickerRemoveMembersLabel="Remove members",t[ws].EditGroupMembers_LoadUsersButtonTitle="Load more members",t[ws].EditUserBulkDialog_RemoveFromAccount="Remove from organization",t[ws].ExtensionsListEmptyMessage="There are no extensions installed",t[ws].FilterBar_FilterUsers="Filter users",t[ws].FilterBar_FilterRules="Filter rules",t[ws].FormText_UserEditDialogBulk_AddToProjects="Select the projects you want the users to be added to",t[ws].FormText_UserEditDialogBulk_AssignExtensions="Select the extensions you want to assign to the users",t[ws].FormText_UserEditDialogBulk_ChangeAccessLevel="Select the access level to apply to the users",t[ws].FormText_UserEditDialogBulk_RemoveFromProjects="Select the projects you want the users to be removed from",t[ws].FormText_UserEditDialogBulk_RevokeExtensions="Select the extensions you want to revoke from the users",t[ws].GroupCommandBar_ReevaluateRules="Re-evaluate Rules",t[ws].GroupResolve_BuyMissingItemsAndRefreshHeader="Buy the missing items below and click Fix errors to update.",t[ws].GroupResolve_CalculatingMissingResources="calculating all missing resources",t[ws].GroupResolve_ClickFixErrorsToPerformActions="Click Fix errors to assign the items below to users.",t[ws].GroupResolve_FixAssignmentIssues="Fix assignment errors",t[ws].GroupResolve_FixErrors="Fix errors",t[ws].GroupResolve_FixingAssignmentErrors="fixing assignment errors",t[ws].GroupResolve_GroupTooLarge="This group is too large to calculate all possible missing resources.",t[ws].GroupResolve_NothingToFix="There are no missing group assignments or access level assignments at this time.",t[ws].GroupResolve_OneMoment="One moment... we're working on",t[ws].GroupResolve_RunningApplyJob="There is already a job running to apply all rules. Wait till job completes to resolve group rules",t[ws].GroupResolve_toAssign1="{0} to assign",t[ws].GroupResolve_Running="Applying group rule is currently in progress",t[ws].GroupResolve_Deleting="Deleting group rule is currently in progress",t[ws].GroupResolve_UsersMissingLicenses="Users are missing extensions and basic access levels.",t[ws].HubButtonTextCancel="Cancel",t[ws].HubButtonTextReinstate="Reinstate Assets",t[ws].HubButtonTextRemove="Remove",t[ws].HubColEmail="Email",t[ws].HubSummary_Assigned="Assigned",t[ws].HubSummary_Available="Available",t[ws].HubSummary_BrowseExtensions="Browse extensions",t[ws].HubSummary_Free="Free",t[ws].HubSummary_InvalidAccessLevelDropdownInformation="Some of these users have invalid access levels, and the Stakeholder experience",t[ws].HubSummary_NoExtensionsInstalled="There are no extensions installed",t[ws].HubSummary_Paid="Paid",t[ws].HubSummary_Total="Total",t[ws].HubSummary_TrialExtension1="Trial expires in {0} days",t[ws].HubSummary_TrialExtensionExpired="This trial has expired",t[ws].HubTitleManageUsers="Users",t[ws].LabelText_ProjectSecurityGroups="Azure DevOps Groups",t[ws].LabelText_VstsGroupName="Azure DevOps group name",t[ws].LabelText_WithUsers="With users...",t[ws].LabelText_SelectExtensions="Select extensions",t[ws].LabelText_Filtered="Filtered",t[ws].LabelText_Selected="Selected",t[ws].LabelText_Total="Total",t[ws].ListHeaderText_AssignedExtensions="Assigned extensions",t[ws].ListHeaderText_OtherExtensions="Other extensions",t[ws].ListItemSeparatorAlt=" | ",t[ws].ListItemSeparator_And=" and ",t[ws].ListItemSeparator_LastAnd=", and ",t[ws].NoResults_NoGroupRulesFound="No group rules found",t[ws].NoResults_NoGroupRulesMatchFilter="No group rules match your filter",t[ws].NoResults_NoUsersMatchFilter="No users match your filter",t[ws].NoResults_NoDirectMembersFound="No direct members found",t[ws].Notification_AddUsers_Action2="Add {0} {1}",t[ws].Notification_AddGroupRule_Action1="Add group rule {0}",t[ws].Notification_BulkChangeMembers_Action_AddToProjects4="Add {0} {1} to {2} {3}",t[ws].Notification_BulkChangeMembers_Action_RemoveFromProjects4="Remove {0} {1} from {2} {3}",t[ws].Notification_BulkChangeMembers_Action_AssignExtensions3="Assign {1} {2} to {0} users",t[ws].Notification_BulkChangeMembers_Action_RevokeExtensions3="Revoke {1} {2} for {0} users",t[ws].Notification_BulkChangeMembers_Action_ChangeAccessLevel3="Change access level to {0} for {1} {2}",t[ws].Notification_BulkChangeMembers_Action_RemoveUsers1="Remove {0} users",t[ws].Notification_BulkChangeMembers_Action_RemoveServicePrincipals1="Remove {0} service principals",t[ws].Notification_ChangeMember_Description_ChangeAccessLevel1="Change access level to {0}",t[ws].Notification_ChangeMember_Description_AddToProject2="Add to project {0} with Azure DevOps group of {1}",t[ws].Notification_ChangeMember_Description_Summary_AddToProject2="Add to {0} {1}",t[ws].Notification_ChangeMember_Description_RemoveFromProject1="Remove {0} from project",t[ws].Notification_ChangeMember_Description_Summary_RemoveFromProject2="Remove from {0} {1}",t[ws].Notification_ChangeMember_Description_Summary_ChangeProjectPermissions2="Change Azure DevOps group for {0} {1}",t[ws].Notification_ChangeMember_Description_ChangeProjectPermissions2="Change Azure DevOps group of project {0} to {1}",t[ws].Notification_ChangeMember_Description_Summary_AssignExtension2="Assign {0} {1}",t[ws].Notification_ChangeMember_Description_AssignExtension1="Assign extension: {0}",t[ws].Notification_ChangeMember_Description_Summary_RevokeExtension2="Revoke {0} {1}",t[ws].Notification_ChangeMember_Description_RevokeExtension1="Revoke extension: {0}",t[ws].Notification_ChangeSingleUser_Action1="Change {0}",t[ws].Notification_ChangeGroup_Action1="Change group rule {0}",t[ws].Notification_ReinstateAssets_Action1="Reinstate assets for user: {0}",t[ws].Notification_RemoveDirectAssignments_Action2="Remove direct assignments for {0} {1}",t[ws].Notification_RemoveGroup_Action1="Remove group rule {0}",t[ws].Notification_RemoveUser_Action1="Remove {0} from organization",t[ws].Num_Extensions_Plural1="{0} extensions",t[ws].Num_Extensions_Singular="1 extension",t[ws].Num_Projects_Plural1="{0} projects",t[ws].Num_Projects_Singular="1 project",t[ws].Num_Users_Plural1="{0} users",t[ws].OperationName_AddToProject1="Add to project: {0}",t[ws].OperationName_AssignExtension1="Assign extension: {0}",t[ws].OperationName_RemoveFromProject1="Remove from project: {0}",t[ws].OperationName_RemoveUser="Remove user",t[ws].OperationName_RemoveServicePrincipal="Remove service principal",t[ws].OperationName_RevokeExtension1="Revoke extension: {0}",t[ws].PickerStatusText_NoExtensionsFound="No extensions found.",t[ws].Project="project",t[ws].ProjectInviteDialog_AccessLevelAssigned2=" and assigned an access level to {0} {1}",t[ws].ProjectInviteDialog_AddToTeam1="Add to {0}.",t[ws].ProjectInviteDialog_AddToTeams="Add to team(s)",t[ws].ProjectInviteDialog_AddUsersTitleTemplate1="Invite members to {0}",t[ws].ProjectInviteDialog_AddUsersSubTitle1="Search and add users to your {0}",t[ws].ProjectInviteDialog_AddUsersAndSPsSubTitle2="Search and add users, service principals, or managed identities to your {0} {1}",t[ws].ProjectInviteDialog_AssignLicenseAndTeams="Assign license and add to selected teams.",t[ws].ProjectInviteDialog_UsersAdded4="Added {0} {1} to {2}{3}.",t[ws].ProjectInviteDialog_UserNotInAccountWarning1="{0} has not been assigned an access level, we will attempt to assign {1}.",t[ws].ProjectInviteDialog_UserNotInAccountWarning1_Fallback="default license.",t[ws].ProjectInviteDialog_UserNotInAccountAssignmentBillingWarning1="{0} will be assigned {1} access if available.",t[ws].ProjectInviteDialog_UserNotInAccountAssignmentBillingLinkText="Learn more about default access levels",t[ws].ReEvaluateRulesDialog_Description="Users' resources will be updated based on their latest AAD group memberships. If a user has no group memberships, they will remain unaffected. This process may take up to 10 minutes. User resources may change during this time.",t[ws].ReEvaluateRulesDialog_RunningJobExplaination="Users' resources will be updated based on their latest AAD group memberships. If a user has no group memberships, they will remain unaffected.",t[ws].ReinstateAssetsDialog_DialogTitleSingular="Reinstate Assets",t[ws].ReinstateAssetsDialog_LoseAssetsWarning="This action is not reversible.",t[ws].ReinstateAssetsDialog_ReinstateAssetsPrompt1='A previous user with the same signin address "{0}" existed in this organization. Reinstating assets will give the new user full ownership of these previous assets.',t[ws].RemoveDirectAssignmentDialog_NoChanges1="{0} will not lose access to any resources",t[ws].RemoveDirectAssignmentOnMoreThan100Users="You can't remove direct assignment from more than 100 users at the same time",t[ws].ResendInvite_NoAadAdminPermissions="You are trying to resend an invite to a user from outside your directory, but you don't have permission to do so. Please contact your directory admin.",t[ws].ResendInvite_GenericError="There was an error in resending your invite. Please wait and try again or contact your directory admin.",t[ws].ResendInviteSingle_ActionDisplayName="Resend organization invite.",t[ws].ResendInviteSingle_ActionDisplayNameFailure="Unable to resend invitation to 1 user. Please contact your directory admin.",t[ws].ResendInviteSingle_ActionDisplayNameSuccess="1 organization invite resent.",t[ws].RuleRunner_ErrorMessage="Something went wrong when performing the operation. Please try again later.",t[ws].SpinnerLabelText_RemoveDirectAssignmentsPreview="Collection preview data for removing direct assignments",t[ws].StatusText_ActionCanceling="Canceling, please wait...",t[ws].StatusText_ActionCompletionProgress2="{0}/{1} actions completed",t[ws].TabLabel_AllUsers="All users",t[ws].TabLabel_Groups="Group rules",t[ws].Team="team",t[ws].TextNumberOfUsersSelected="{0} users selected",t[ws].TextTeamPickerNoSuggestions="No Teams Found",t[ws].TextTeamsPlural1="{0} teams",t[ws].TextTeamSingular="1 team",t[ws].TitleText_EditUserBulkDialog_ChangeAccessLevels="Change access levels",t[ws].TitleText_EditUserBulkDialog_RemoveFromProjects="Remove from projects",t[ws].TitleText_EditUserBulkDialog_RevokeExtensions="Revoke extensions",t[ws].TitleText_EditUserBulkDialog_RemoveFromOrganization="Remove from organization",t[ws].TitleText_Issues="System issues",t[ws].TitleText_Messages="Session notifications",t[ws].TitleText_Notifications="Notifications",t[ws].TitleText_Users="Users",t[ws].TitleText_ReEvaluateRulesDialog_ReEvaluateRules="Re-evaluate group rules",t[ws].TextProjectPickerNoSuggestions="No Projects Found",t[ws].Text_Issue_Singular="system issue",t[ws].Text_Issue_Plural="system issues",t[ws].Text_Message_Singular="session notification",t[ws].Text_Message_Plural="session notifications",t[ws].Text_Project_Singular="project",t[ws].Text_Project_Plural="projects",t[ws].Text_Extension_Singular="extension",t[ws].Text_Extension_Plural="extensions",t[ws].Text_RunningTask_Singular="running task",t[ws].Text_RunningTask_Plural="running tasks",t[ws].Text_User_Singular="user",t[ws].Text_User_Plural="users",t[ws].Text_ServicePrincipal_Singular="service principal",t[ws].Text_ServicePrincipal_Plural="service principals",t[ws].TextTemplate_CountItems2="{0} {1}",t[ws].IdentityPickerText_AddUsers="Add users",t[ws].UserDialog_LearnMore="Learn more",t[ws].UserDialog_LearnMore_AriaLabel="Learn more about inviting users from oustside your directory",t[ws].UserManagemengMessageBar_ShouldBackMsaAccount="We suggest connecting your Azure DevOps organization to an Azure Active Directory tenant.",t[ws].UserInviteDialog_CreateAProject="Create a project",t[ws].UserInviteDialog_NoProjectsFound="No projects found.",t[ws].UserInviteDialog_NoProjectsFound1="No projects found. {0}",t[ws].UserRemoveDialog_AADWarning1="{0} will continue to have access even after removal if the user is a member of an AAD group that has been added to this organization.",t[ws].UserRemoveDialog_AADWarningLink_AriaLabel="Learn more about AAD groups",t[ws].UserRemoveDialog_ActionDisplayName1="Remove {0} users from organization.",t[ws].UserRemoveDialog_DialogTitlePlural="Remove existing users",t[ws].UserRemoveDialog_DialogTitleSingular="Remove existing user",t[ws].UserRemoveDialog_GenericWarning="Deleting a user from the organization will remove their permissions permanently.",t[ws].UserRemoveDialog_RemoveUserPrompt2="Are you sure you want to remove {0} from the organization {1}?",t[ws].UserRemoveDialog_SomeUsers="Some users",t[ws].UserRemoveDialog_TheseUsers="these users",t[ws].UserRemovedSingular="1 user removed.",t[ws].WarningMessageText_AccessLevelChange2="{0} will have access level changed to {1}.",t[ws].WarningMessageText_LoseAccessTo2="{0} will lose access to {1}.",t[ws].WarningMessageText_Missing1="{0}+ missing",t[ws].ExtensionDisabled_AccessLevelLimitation="This extension requires Basic access level for assignment",t[ws].Hub_AllUsersHaveTrialExtensions="trial available to all users",t[ws].Text_LicensesAvailableCount1="{0} available",t[ws].Text_LicensesMissingCount1="{0} missing",t[ws].Text_LicensesMissingCountPlus1="{0} or more missing",t[ws].ExtensionDisabled_MsdnInheritance1="from {0}",t[ws].UserBuyLink="Buy more",t[ws].RefreshIcon_ExtensionRefreshDescription="Refreshes extension license information for this organization with most recent data",t[ws].InviteDialog_ExtensionUnassignable="This extension has no licenses available to assign",t[ws].UserInviteDialog_Extensions="Extensions",t[ws].UserInviteDialog_SendEmailAriaLabel="Send email to invited users",t[ws].UserInviteDialog_AddButton="Add",t[ws].UserInviteDialog_SendEmails="Send email invites",t[ws].UserInviteDialog_SendEmailsToUsersOnly="Send email invites (to Users only)",t[ws].GroupRules_BuildGroupEntitlementFailed="The group rule was added successfully, but there was an error fetching the results. Please try reloading the page.",t[ws].ProjectInviteDialog_FailedToAddNoPermissions="You do not have permission to add users to this team.",t[ws].DialogErrorMessage_Generic1="Oops! Something went wrong. Please check our {0}, and try again later.",t[ws].UserInviteDialog_ValidRefreshTokenNotFound="When attempting to invite a guest user to the AAD tenant, a valid refresh token was not found. Please sign out and try again.",t[ws].DialogErrorMessage_AddUsers="when adding users",t[ws].GuestInviteError_GuestAadInviteGenericFailure1="You are trying to invite a user from outside your directory, but something went wrong. Please try again later. If the issue persists, please {0}.",t[ws].UserDialog_ContactSupport="contact support",t[ws].UserInviteDialog_AccessLevel="Access level",t[ws].TitleText_EditUserBulkDialog_AddToProjects="Add to projects",t[ws].SearchProjects_AriaLabel="Search projects",t[ws].UserInviteDialog_AddUserMessageSingle="Adding 1 user",t[ws].UserInviteDialog_AddUserMessagePlural1="Adding {0} users",t[ws].PunctuationPeriod=".",t[ws].PunctuationSuffix=" ",t[ws].ListItemSeparator=", ",t[ws].UserInviteDialog_AddUserStatusBarCommandTo="to",t[ws].UserInviteDialog_AddUserStatusBarCommandSingle2="Add 1 user with {0} access level{1}.",t[ws].UserInviteDialog_AddUserStatusBarCommandPlural3="Add {0} users with {1} access level{2}.",t[ws].UserInviteDialog_AddUserSuccess="Successfully added user.",t[ws].OperationName_AddUser="Add user",t[ws].TitleText_EditUserBulkDialog_AssignExtensions="Assign extensions",t[ws].UserInviteDialog_AccessLevelBasic="Basic",t[ws].UserInviteDialog_Users="Users",t[ws].UserInviteDialog_UsersOrServicePrincipals="Users or Service Principals",t[ws].UserInviteDialog_IdentityPickerPlaceholder="Use semicolons to separate multiple email addresses.",t[ws].UserInviteDialog_IdentityPickerPlaceholderMembers="Use semicolons to separate multiple members.",t[ws].UserInviteDialog_InviteUserToAadWarning1="You are inviting users from outside your directory. The user(s) {0} will need to click the link in their invitation e-mail to be able to access the organization and its resources. ",t[ws].UserInviteDialog_InviteUserFromGitHubWarning1="Invitation emails cannot be sent to GitHub user(s) {0}. To help them sign-in, share the Organization URL with them",t[ws].UserInviteDialog_MaxUsersToAdd1="There can not be more than {0} users added at once.",t[ws].UserInviteDialog_DialogTitle="Add new users",t[ws].GroupAssignmentIcon_CalloutTitle="Inheriting from Group Rules:",t[ws].GroupAssignmentIcon_CalloutNoMatchesExplaination="Missing resources granted by group rules. Please resolve assignments or re-evaluate rules.",t[ws].GroupAssignmentIcon_CalloutGroupTypeAad="AAD group",t[ws].GroupAssignmentIcon_CalloutGroupTypeVsts="Azure DevOps group",t[ws].AccessLevelIcon_CalloutLabel="Access level information regarding Visual Studio Subscriber",t[ws].AccessLevelInfo_StatusMessageTitle="Access level status message:",t[ws].AccessLevelIcon_HoverInfoLabel="Focus or hover for dialog regarding Visual Studio Subscriber",t[ws].CommandButtonText_AddSingleGroupRule="Add a group rule",t[ws].DialogErrorMessage_AddGroup="when adding the group rule",t[ws].ButtonText_CreateNewVstsGroup="Create a new Azure DevOps group",t[ws].ButtonText_SelectFromSingleExistingGroup="Select from an existing Azure DevOps or AAD group",t[ws].BulkStatusDialogColumnName_Group="Group",t[ws].AddGroupConfirmation1="Add {0} group rule.",t[ws].OperationName_AddGroup="Add group rule",t[ws].IdentityPickerLabelText_Group="Azure DevOps or AAD group",t[ws].UserInviteDialog_IdentityPickerGroupPlaceholder="Search groups",t[ws].ButtonText_SaveChanges="Save",t[ws].EditUserDialog_AccessLevelUnchangable="The access level is unchangeable because the user has a valid Visual Studio subscription.",t[ws].EditUserDialog_DowngradeWithExtensions="Downgrading access level to Stakeholder may cause some extensions to be removed.",t[ws].ContextualMenuButtonText_ChangeAccessLevel="Change access level",t[ws].ContextualMenuButtonText_ManageGroupRule="Manage group rule",t[ws].ContextualMenuButtonText_ManageUser="Manage user",t[ws].ContextualMenuButtonText_ManageAccess="Manage access",t[ws].TextLastAccessedDateNever="Never",t[ws].EditUserDialog_PendingSubscriber="This user’s subscription will be validated when the user signs in. At that time, they will be assigned an access level and/or set of extensions based on their subscription.",t[ws].EditUserDialog_InvalidSubscriber="We could not find a Visual Studio subscription assigned to this user. Please ensure that the user has properly linked their subscription or assign them a Basic access level.",t[ws].EditUserDialog_InvalidMsdnSubscription="The Visual Studio subscription associated with this user is no longer active. Please have the user sign-out and sign-in to revalidate the subscription or assign them a valid access level.",t[ws].UserInviteDialog_MoreInformation="More information.",t[ws].ProjectSelection_GroupOptionDropdownLabel1="Group Option for {0}",t[ws].RoleType_Custom="Custom",t[ws].GroupAssignmentIcon_HoverInfoLabel="Focus or hover for dialog regarding Group Assignment information",t[ws].ProjectInheritence_CalloutLabel="Project inheritance information",t[ws].ProjectInheritence_CalloutExplaination="This project membership is inherited from a group",t[ws].EditUserDialog_ProjectsTabTitle="Projects",t[ws].EditUserDialog_ExtensionsTabTitle="Extensions",t[ws].EditUserDialog_GroupRulesTabTitle="Group Rules",t[ws].EditGroupDialog_MembersTabTitle="Members",t[ws].EditUserDialog_ManageUser="Manage user",t[ws].EditUserDialog_ManageAccess="Manage access",t[ws].ButtonText_Preview="Preview",t[ws].GroupEdit_ChangeAccessLevels="Change access levels",t[ws].EditGroupDialog_DowngradeWithExtensions="Downgrading access level to Stakeholder may cause some extensions to be removed.",t[ws].EditGroupMembersDialog_CannotEditAadGroup="Members from an AAD group cannot be edited",t[ws].LabelText_TestLicensingRuleApplicationWait="We are collecting details....",t[ws].WarningMessageText_DowngradeAccessLevel_Plus2="{0}+ users will have access level changed to {1}.",t[ws].WarningMessageText_DowngradeAccessLevel_Singular1="1 user will have access level changed to {0}.",t[ws].WarningMessageText_DowngradeAccessLevel_Plural2="{0} users will have access level changed to {1}.",t[ws].GroupEdit_GroupTooLarge="This group is too large to calculate all potential changes. There may be changes to users after editing. After processing is complete, a notification will be sent summarizing modifications.",t[ws].WarningMessageText_DowngradeExtension_Plus2="{0}+ users will lose access to {1}.",t[ws].WarningMessageText_DowngradeExtension_Singular1="1 user will lose access to {0}.",t[ws].WarningMessageText_DowngradeExtension_Plural2="{0} users will lose access to {1}.",t[ws].GroupEdit_NoPreviewChanges="After collecting details, there will be no visible changes to users after editing.",t[ws].GroupEdit_ManageGroupRules="Manage group rules",t[ws].ContextualMenuOptionManageExtensions="Manage extensions",t[ws].ContextualMenuOptionManageProjects="Manage projects",t[ws].DialogTitle_RemoveAadGroupRule1="Remove {0} group rule",t[ws].DialogMessage_RemoveAadGroupRule1="Users in the group '{0}' will lose access to group resources unless they have been explicitly assigned to them or the resources have been made available to them through a group rule. The group will not be deleted.",t[ws].DialogCheckbox_RemoveGroupMembership1="Remove {0} from all project level groups",t[ws].GroupRules_RemovedRuleMessageBarMessage1="Removed group rule for {0}.",t[ws].EditGroupMembers_IdentityPickerSearchByName="Search by name",t[ws].AccessLevel_Invalid="Invalid",t[ws].MemberList_CheckboxLabel="Select user in row and add them to current list of users to edit",t[ws].MemberList_CheckboxAllLabel="Select all users in users list to edit",t[ws].SpinnerLabel_WorkingOnIt="Working on it...",t[ws].MemberList_ActionButtonLabel="Show actions for editing the selected users",t[ws].MemberList_LoadNextPage="Load more users",t[ws].DisplayNameWithAadDeleted1="{0} (Deleted from Azure AD)",t[ws].GroupRules_IncompatibleState="Some extensions could not be assigned because users in the group have insufficient licenses.",t[ws].GroupRules_UnableToApplyState="Group rule have assignment errors",t[ws].HubColName="Name",t[ws].HubColExtensions="Extensions",t[ws].HubColAccessLevel="Access Level",t[ws].HubColLastEvaluated="Last Evaluated",t[ws].HubColLastAccessed="Last Accessed",t[ws].HubColDateAdded="Date Added",t[ws].HubColLicenseSource="License Source",t[ws].EditUserDialog_ButtonTitle1="Edit {0}",t[ws].ContextualMenuButtonText_Remove="Remove",t[ws].SummaryHeader_Tooltip1="Filter list of users with {0}",t[ws].WarningIcon_UninstalledExtensionMessage="This extension is paid for or has some assignments and is not installed on the organization. Users will not have access to given extension without installation.",t[ws].HubSummary_TrialExtensionExpired1="Trial expired on {0}",t[ws].HubSummary_Title="Summary",t[ws].HubSummary_TotalUsers="Total Users",t[ws].HubSummary_Users="Users",t[ws].HubSummary_Extensions="Extensions",t[ws].HubSummary_ChangeQuantity="Change quantity",t[ws].HubSummary_Buy="Buy",t[ws].HubSummary_NextMonthMissing="Users will lose this access level next month",t[ws].HubSummary_NextMonthTotal="Next month total assignable",t[ws].HubSummary_NextMonthTotalInfo="Showing information to verify that next month's billing cycle will keep user status's healthy",t[ws].FilterLabel_Guest="Guest User",t[ws].FilterLabel_Member="Member User",t[ws].FilterLabel_Application="Application Service Principal",t[ws].FilterLabel_ManagedIdentity="Managed Identity",t[ws].FilterPlaceholder_AadUserType="AAD User Type",t[ws].CopyToClipBoard_Copy="Copy",t[ws].CopyToClipBoard_Copied="Copied",t[ws].GitHubSearchWarning_CalloutLabel="Warning information regarding GitHub search disabled",t[ws].GitHubSearchWarning_HoverInfoLabel="Focus or hover for callout regarding GitHub search disabled",t[ws].GitHubSearchWarning_TooltipContent="GitHub search is currently enabled only for GitHub users.",t[ws].UsersSummary_LearnMore="Learn more",t[ws].WarningMessage_GroupRulesAssignmentErrors="Group rules have assignment errors",t[ws].WarningMessage_BilingIssues="Billing issues",t[ws].UserInviteDialog_AadGuestAdminWarning="You are a Guest in the connected Azure AD and Guests may not be able to search users in the Azure AD. Please contact your Azure AD admin to make you a member of the connected Azure AD to enable searching for users.",t[ws].WarningMessage_CannotAddProjectGroup="Cannot add a project group rule. All group rules must be an organization level group.",t[ws].BillingCycle_OnDateWillHaveSingular3="On {0}, your organization will have {1} {2} access level.",t[ws].BillingCycle_OnDateWillHaveMultiple3="On {0}, your organization will have {1} {2} access levels.",t[ws].BillingCycle_NumberWillLoseAccessMultiple1="As is, {0} users will lose access to resources at the end of the month.",t[ws].BillingCycle_NumberWillLoseAccessSingular1="As is, {0} user will lose access to resources at the end of the month.",t[ws].ErrorTitle_ConfigurationError="We have trouble loading your user hub configuration",t[ws].ErrorMessage_ConfigurationError1="You might experience issues working with user hub. Please check our {0}, and try again later. If this problem persists, please contact support.",t[ws].AccessLevelAssignmentSourceDirect="Direct",t[ws].AccessLevelAssignmentSourceGroupRule="Group Rule",t[ws].UserTable_AriaLabel="User table",t[ws].GroupTable_AriaLabel="Group table",t.ComponentsCommoncommon={},function(e){fe=t[e]={};t[e].MemberEntitlements=class{constructor(){this.users=[],this.servicePrincipals=[]}static isServicePrincipal(e){return"servicePrincipal"in e}static isUser(e){return"user"in e}}}("ModelsMemberEntitlements"),function(e){Se=t[e]={},function(e){e.UserHubDataProviderContributionId="ms.vss-aex-user-management-web.aex-user-hub-data-provider"}(t[e].ContributionIds||(t[e].ContributionIds={})),function(e){e.UserManagementScripts="UserManagement/Scripts",e.AexScripts="Aex"}(t[e].ContributionPaths||(t[e].ContributionPaths={})),function(e){e.GroupId="groupId"}(t[e].DataProviderKeys||(t[e].DataProviderKeys={})),function(e){e.User="User",e.Group="Group",e.ServicePrincipal="ServicePrincipal"}(t[e].DirectoryEntityType||(t[e].DirectoryEntityType={})),function(e){e.VisualStudioDirectory="vsd",e.AzureActiveDirectory="aad",e.MicrosoftAccount="msa",e.GitHub="ghb"}(t[e].DirectoryName||(t[e].DirectoryName={})),function(e){e.General=5e3,e.IdentityNotFound=5001,e.InvalidIdentity=5002,e.InvalidProjectId=5003,e.RemoveUserFromAccountError=5004,e.AssignedLicenseFailed=5005,e.AssignedExtensionFailed=5006,e.UnassignExtensionFailed=5007,e.UnsupportedOperation=5008,e.RemoveIdentityFromSecurityGroupError=5009,e.GroupDoesNotExist=5010,e.MultipleErrors=5011,e.LicenseTypeConversionError=5012,e.ExportCSVFailed=5013,e.MemberNotInProject=5014,e.NotEnoughLicenses=5015,e.CannotDowngradeAccountAdmin=5016,e.InvalidLicenseType=5017,e.ExtensionUnassignable=5018,e.InvalidMemberEntitlement=5019,e.GroupAddJobFailed=5020,e.GroupRemoveOperationFailed=5021,e.GroupCreationFailed=5022,e.IdentityGetOrCreateError=5023,e.GroupGetOrCreateError=5024,e.InvalidGroupDisplayName=5025,e.InvalidGroupId=5026,e.GroupApplyAllOperationFailed=5028,e.GroupUpdateOperationFailed=5029,e.InvalidTeamId=5030,e.TeamsApiUnavailable=5031,e.AccessDenied=5032,e.InvalidEmail=5033,e.CannotChangeGroupAssignment=5034,e.NotEnoughExtensionLicenses=5035,e.SendInviteFailed=5036,e.BuildGroupEntitlementFailed=5037,e.BuildUserEntitlementFailed=5038,e.RemoveDirectAssignmentsForNewGroupMemebersFailed=5039,e.UserEntitlementNotFound=5040,e.NoMeterUsageReturned=5041,e.UnsupportedMemberEntitlement=5042,e.ExternalGuestAccessDenied=5101,e.GuestAadInviteGenericFailure=5102,e.GuestUserInviterError=5103,e.GuestUsersNotAllowedToPerfomAction=5104,e.InviteeHasSameDomain=5105,e.ValidRefreshTokenNotFound=5106,e.GuestUserBadRequest=5107,e.MemberAlreadyInProject=6001,e.SkippedAddInvalidGroup=6002,e.CannotCreateProjectLevelGroup=6003}(t[e].ErrorCodes||(t[e].ErrorCodes={})),function(e){e.UserManagementException="UserManagementException",e.MemberNotFoundException="UserNotFoundException",e.AccountAdminDowngradeLicenseException="AccountAdminDowngradeLicenseException",e.ChangeGroupAssignmentNotAllowedException="ChangeGroupAssignmentNotAllowedException",e.ExtensionUnassignableException="ExtensionUnassignableException",e.AssignLicenseNotAvailableException="AssignLicenseNotAvailableException",e.AssignExtensionsErrorException="AssignExtensionsErrorException",e.AssignExtensionLicenseNotAvailableException="AssignExtensionLicenseNotAvailableException"}(t[e].ExceptionTypeKeys||(t[e].ExceptionTypeKeys={})),function(e){e.ShowMsaShouldBeAadBackedMessageBar="VisualStudio.UserManagement.ShowMsaShouldBeAadBackedMessageBar",e.DisableCheckForInstalledExtensions="VisualStudio.UserManagement.Web.DisableCheckForInstalledExtensions",e.HideLicenseAndExtensionCounters="VisualStudio.UserManagement.Web.UserHub.HideLicenseAndExtensionCounters",e.ReinstateAssets="VisualStudio.UserManagement.Web.UserHub.ReinstateAssets",e.EnableDefaultLicensing="VisualStudio.UserManagement.EnableDefaultLicensing",e.EnableBillingTabLinks="VisualStudio.UserManagement.EnableBillingTabLinks",e.ForwardFrameworkRequestsToLps="VisualStudio.Services.Licensing.ForwardFrameworkRequestsToLps",e.EnableDateAddedColumn="AzureDevOps.Services.UserManagement.EnableDateAddedColumn"}(t[e].FeatureFlags||(t[e].FeatureFlags={})),function(e){e.User="me",e.Account="host"}(t[e].FeatureManagementScopeConstants||(t[e].FeatureManagementScopeConstants={})),function(e){e.MsaDomain="Windows Live ID",e.GitHubDomain="github.com"}(t[e].IdentityConstants||(t[e].IdentityConstants={})),function(e){e.PaidBasicLicenseId="ms.vss-vstsuser"}(t[e].LinkConstants||(t[e].LinkConstants={})),function(e){e.AccessLevel="accessLevel",e.ProjectEntitlements="projectEntitlements",e.Extensions="extensions",e.TeamRefs="teamRefs",e.ReinstateAssets="reinstateAssets"}(t[e].OperationTarget||(t[e].OperationTarget={})),function(e){e.AzureActiveDirectory="aad",e.MicrosoftAccount="msa",e.VisualStudioTeamServices="vsts",e.GitHubDirectory="ghb"}(t[e].OriginName||(t[e].OriginName={})),function(e){e.UserManagementFeatureArea="UserManagement",e.AddUsersFeatureName="Userhub.AddUsers",e.AddUsersToProjectFeatureName="Userhub.AddUsersToProject",e.AddGroupFeatureName="Userhub.AddGroup",e.GetUsersFirstFeatureName="Userhub.GetUsersFirstBatch",e.GetAllUsersFeatureName="Userhub.GetAllUsers",e.GetUserExtendedFeatureName="Userhub.GetUserWithExtendedProperties",e.EditUserFeatureName="Userhub.EditUser",e.EditUsersFeatureName="Userhub.EditUsers",e.EditGroupFeatureName="Userhub.EditGroup",e.RemoveUserFeatureName="Userhub.RemoveUser",e.RemoveGroupFeatureName="Userhub.RemoveGroup",e.PageLoadInteractiveFeatureName="Userhub.PageLoadInteractive",e.PageLoadCompleteFeatureName="Userhub.PageLoadComplete"}(t[e].PerformanceScenarioConstants||(t[e].PerformanceScenarioConstants={})),function(e){e.GalleryServiceInstanceId="00000029-0000-8888-8000-000000000000",e.AexServiceInstanceId="00000041-0000-8888-8000-000000000000"}(t[e].ServiceInstanceIds||(t[e].ServiceInstanceIds={})),function(e){e.Group="group",e.User="user",e.ServicePrincipal="servicePrincipal"}(t[e].SubjectKind||(t[e].SubjectKind={})),function(e){e.AadUser="aad",e.MsaUser="msa",e.AadGroup="aadgp",e.AadServicePrincipal="aadsp",e.VstsGroup="vssgp",e.BindPendingUser="bnd"}(t[e].SubjectType||(t[e].SubjectType={})),function(e){e.LicenseId="licenseId",e.LicenseStatus="licenseStatus",e.AssignmentSource="assignmentSource",e.UserType="userType",e.Name="name"}(t[e].UserEntitlementFilterNames||(t[e].UserEntitlementFilterNames={})),function(e){e.Projects="projects",e.GroupRules="grouprules"}(t[e].UserEntitlementPropertyNames||(t[e].UserEntitlementPropertyNames={})),function(e){e.DisplayName="DisplayName",e.Name="name",e.DateAdded="dateAdded",e.DateCreated="dateCreated",e.LastAccessDate="LastAccessDate",e.LastAccessed="lastAccessed"}(t[e].UserEntitlementSortColumns||(t[e].UserEntitlementSortColumns={})),function(e){e.DefaultGetUsersPageSize=1e4,e.DefaultGetUsersFirstPageSize=100,e.DefaultGetUsersPageSizeServerSideSearch=500,e.DefaultGetUsersFirstPageSizeServerSideSearch=100,e.DefaultMaxIdentitiesToAdd=50,e.BulkEditMaxBatchSize=20,e.BulkEditMaxBatchWorker=10,e.BulkMaxGetExtensionsMembersCount=50,e.ResolveGroupsResultRetrievalDelayTime=2e3,e.GroupMembersBatchSize=100}(t[e].UserHubConstants||(t[e].UserHubConstants={})),function(e){e.AadGroupHelpLink="https://go.microsoft.com/fwlink/?linkid=835749",e.AadGuestPermissionsHelpLink="https://go.microsoft.com/fwlink/?linkid=2219532",e.StakeholderInformation="https://www.visualstudio.com/docs/work/connect/work-as-a-stakeholder",e.ExternalGuestAccessDeniedHelpLink="https://aka.ms/external-guest-access",e.GenericFailureSupport="https://azure.microsoft.com/support/devops/",e.GuestUserInviterErrorHelpLink="https://docs.microsoft.com/azure/active-directory/active-directory-b2b-troubleshooting",e.InvitedSubscriberInformationLink="https://go.microsoft.com/fwlink/?LinkID=733421",e.GuestUserInviteLearnMore="https://aka.ms/invite-outside-users",e.AddTeamProjectMemberLink="https://go.microsoft.com/fwlink/?linkid=858235",e.UsersWillLoseAccessLevelsLink="https://go.microsoft.com/fwlink/?linkid=860985",e.UsersWillLostSignInUnlessAadBackedLink="https://go.microsoft.com/fwlink/?linkid=869519",e.AccountChangeLink="https://docs.microsoft.com/azure/devops/organizations/accounts/change-organization-ownership?view=azure-devops",e.ReinstateAssetsHelpLink="https://go.microsoft.com/fwlink/?linkid=2007012",e.DefaultAccessLevelLink="https://aka.ms/defaultaccesslevel",e.BasicPlusTestPlansLearnMoreLink="https://aka.ms/testmanagerfaq"}(t[e].UserManagementLinks||(t[e].UserManagementLinks={})),function(e){e.Member="member",e.Guest="guest",e.Application="application",e.ManagedIdentity="managedIdentity"}(t[e].UserMetaType||(t[e].UserMetaType={})),function(e){e.Projects="projects",e.Groups="groups",e.Licenses="licenses",e.AccessLevels="accesslevels",e.DefaultAccessLevel="defaultAccessLevel"}(t[e].UsersSummaryPropertyNames||(t[e].UsersSummaryPropertyNames={}))}("GeneratedConstants"),function(e){ye=t[e]={};class u{constructor(e,t){this.telemetryService=e,this.telemetryArea=t}publishBuyMoreLinkClickEvent(e){const t={extensionTitle:e};this.telemetryService.publishEvent(this.telemetryArea,u.features.summaryFeature,t)}publishClickUserInvitationEvent(e,t){const s=e?e.length:0,n=e&&e.length>0?e[0]:void 0,r={AccessLevel:n?n.accessLevel.licenseDisplayName:void 0,Extensions:n?n.extensions:void 0,NumberExtensions:n&&n.extensions?n.extensions.length:0,NumberFailed:t,NumberProjectEntitlements:n&&n.projectEntitlements?n.projectEntitlements.length:0,NumberSucceeded:s-t,NumberUsers:s,UserType:n?n.user.origin:void 0,ProjectEntitlements:n?n.projectEntitlements:void 0};this.telemetryService.publishEvent(this.telemetryArea,u.features.accountInvitationFeature,r)}publishClickMemberInvitationEvent(e,t){const s=e?e.length:0,n=e&&e.length>0?e[0]:void 0;let r,i,a,o;if(n)if(r=n.accessLevel.licenseDisplayName,a=n.projectEntitlements,fe.MemberEntitlements.isServicePrincipal(n))o=n.servicePrincipal.origin;else{const e=n;i=e.extensions,o=e.user.origin}const l={AccessLevel:r,Extensions:i,NumberExtensions:i?i.length:0,NumberFailed:t,ProjectEntitlements:a,NumberProjectEntitlements:a?a.length:0,NumberSucceeded:s-t,NumberUsers:s,UserType:o};this.telemetryService.publishEvent(this.telemetryArea,u.features.accountInvitationFeature,l)}publishCloseInvitationEvent(e){const t={CloseInvitation:!0,type:e?u.constants.userType:u.constants.groupType};this.telemetryService.publishEvent(this.telemetryArea,e?u.features.accountInvitationFeature:u.features.accountGroupInvitationFeature,t)}publishClickResendInviteEvent(e,t){const s={invitedUserId:e,invitedUserIsAadGuest:t};this.telemetryService.publishEvent(this.telemetryArea,u.features.resendInvitationFeature,s)}publishResendInvitationsError(e,t){const s={invitedUserId:e,resendError:t};this.telemetryService.publishEvent(this.telemetryArea,u.features.resendInvitationFeature,s)}}t[e].UserHubPageContextTelemetries=u,u.features={accountInvitationFeature:"Account Invitation",accountGroupInvitationFeature:"Account Group Invitation",accountUserDetailsFeature:"Account User Details",accountGroupDetailsFeature:"Account Group Details",summaryFeature:"Summary",resendInvitationFeature:"Resend Invitation"},u.constants={userType:"user",groupType:"group"};class m extends s.AexPageContextService{constructor(e,t,s,n){super(e,t,s),this.perfRef=n,this.userListMaxInflight=10,this.getCreateProjectLink=(0,a.memoizeFunction)((()=>{try{const e=this.getPageData(),t=e&&e.hostPath;if(!t)return;const s="ms.vss-tfs-web.suite-me-page-route",n="_a",r="newProject";return(0,l.routeUrl)(this.pageContext,s,{[n]:r},t)}catch(e){this.telemetry.trackException(e,"e")}})),this.ciTelemetry=new u(this.getService("IVssTelemetryService"),t)}get isShowMsaShouldBeAadBackedMessageBar(){return this.isFeatureFlagEnabled(Se.FeatureFlags.ShowMsaShouldBeAadBackedMessageBar)}get contributionService(){return this.getService("IVssContributionService")}get pageService(){return this.getService("IVssPageService")}get isHideLicenseAndExtensionCountersEnabled(){return this.isFeatureFlagEnabled(Se.FeatureFlags.HideLicenseAndExtensionCounters)}get orgName(){const e=this.getPageData();return e&&e.hostName}get orgHostUri(){const e=this.getPageData();if(e&&e.hostPath)return new URL(e.hostPath,window.location.href).href}get browseExtensionsLink(){const e=this.galleryDeploymentUrl;return e&&e+"vsts"}get billingTabRoute(){return(0,l.routeUrl)(this.pageContext,"ms.vss-admin-web.collection-admin-hub-route",{adminPivot:"billing"})}get globalMessagesService(){return this.getService("IGlobalMessagesService")}get galleryDeploymentUrl(){try{return this.getServiceLocation(Se.ServiceInstanceIds.GalleryServiceInstanceId,1)}catch(e){this.telemetry.trackException(e)}}getImageUrl(e){return this.getAssetLocation(e)}assembleLicenseLink(e){const t=this.isFeatureFlagEnabled("VisualStudio.UserManagement.EnableBillingTabLinks");if(!t||"ms.feed"!==e&&"ms.vss-testmanager-web"!==e&&e!==Se.LinkConstants.PaidBasicLicenseId){if(t&&"berichthaus.tfstimetracker"===e.toLowerCase())return"Berichthaus.TfsTimetracker.OrganizationSettings#Upgrade";{const t=this.getPageData(),s=t&&t.hostId,n=this.galleryDeploymentUrl;return s&&n&&n+"items?itemName="+encodeURIComponent(e)+"&install=true&accountId="+s+"&referrer="+encodeURIComponent(window.location.href)+"&source=UserHub&wt.mc_id=UserHub"}}return this.billingTabRoute}shouldUseLicensingService(){return this.isFeatureFlagEnabled("VisualStudio.Services.Licensing.ForwardFrameworkRequestsToLps")}async isGroupIdValidForGroupRule(e){try{const t=await this.pageContext.getService("IVssContributionService").getDataAsync(m.groupRuleValidationDataProviderId,{[Se.DataProviderKeys.GroupId]:e});if(!0===t||!1===t)return t}catch(e){this.telemetry.trackException(e,"UserHubPageContextService.isGroupValidForGroupRule")}return!0}}t[e].UserHubPageContextService=m,m.noResultsAssetsId="ms.vss-aex-user-management/user-hub-content/content/NoResults.svg",m.noResultsMatchedAssetsId="ms.vss-aex-user-management/user-hub-content/content/NoResultsMatched.svg",m.serviceContextDataProviderId="ms.vss-aex-user-management.aex-user-management-service-context",m.groupRuleValidationDataProviderId="ms.vss-aex-user-management.group-rule-validation-data-provider";const d=i.createContext(void 0);function p(){return i.useContext(d)}t[e].UserHubContextProvider=function(e){const{pageContext:t}=(0,o.useComponentContext)(),[s]=(0,r.useContributionData)(t,void 0,m.serviceContextDataProviderId),a=i.useMemo((()=>new m(t,e.telemetryArea,e.telemetryFeature,e.perfRef)),[t,e.telemetryArea,e.telemetryFeature,s,e.perfRef]);return void 0===s?i.createElement("div",{className:"absolute-fill flex flex-column flex-center justify-center"},i.createElement(c.Spinner,{size:"large"})):i.createElement(d.Provider,{value:a},i.createElement(n.GeneralErrorContextProvider,{telemetry:a.telemetry},i.createElement(C,null,e.children)))},t[e].useUserHubContext=p;class g{}g.dataProviderId="ms.vss-aex-user-management.aex-user-hub-data-provider";const b=i.createContext(void 0);function C(e){const t=p(),[s,n]=(0,r.useContributionData)(t.pageContext,t.telemetry,g.dataProviderId),a=i.useMemo((()=>({configurationError:n,isAdmin:!(!s||!s.isAdmin),isAadAccount:!(!s||!s.isAadAccount),isAadGuest:!(!s||!s.isGuest),isGitHubInviteEnabled:!(!s||!s.isGitHubInviteEnabled),isGitHubUser:!(!s||!s.isGitHubUser),isGitHubSearchEnabled:!(!s||!s.isGitHubSearchEnabled),isReadonly:!(!s||!s.isReadonly),shouldUseServerSideSearch:!(!s||!s.shouldUseServerSideSearch),shouldUseSearchApis:!(!s||!s.shouldUseSearchApis),useUpdatedSearchQuery:!(!s||!s.useUpdatedSearchQuery),supportServicePrincipals:!(!s||!s.supportServicePrincipals),getUsersPageSizeServerSideSearch:s?s.getUsersPageSizeServerSideSearch:Se.UserHubConstants.DefaultGetUsersPageSizeServerSideSearch,getUsersFirstPageSizeServerSideSearch:s?s.getUsersFirstPageSizeServerSideSearch:Se.UserHubConstants.DefaultGetUsersFirstPageSizeServerSideSearch,getUsersPageSize:s?s.getUsersPageSize:Se.UserHubConstants.DefaultGetUsersPageSize,getUsersFirstPageSize:s?s.getUsersFirstPageSize:Se.UserHubConstants.DefaultGetUsersFirstPageSize,bulkMaxBatchSize:s?s.bulkMaxBatchSize:Se.UserHubConstants.BulkEditMaxBatchSize,bulkMaxBatchWorker:s?s.bulkMaxBatchSize:Se.UserHubConstants.BulkEditMaxBatchWorker,groupMembersBatchSize:s?s.groupMembersBatchSize:100,maxIdentitiesToAdd:s?s.maxIdentitiesToAdd:Se.UserHubConstants.DefaultMaxIdentitiesToAdd})),[s,n]);return i.createElement(b.Provider,{value:a},e.children)}t[e].UserHubConfigurationContextProvider=C,t[e].useUserHubConfiguration=function(){return i.useContext(b)}}("ContextUserHubContext"),function(e){Ee=t[e]={},t[e].useTrackedAsyncCallback=function(e,t,s,n){return i.useCallback((async(...r)=>{let i,a={properties:{},measurements:{}};if(!e)return t(...r);try{return e.telemetry.startTrackEvent(s),i=await t(...r),i}catch(t){throw e.telemetry.trackException(t),t}finally{n&&(a=n(a,i,...r)),e.telemetry.stopTrackEvent(s,a.properties,a.measurements)}}),[e,t,s])}}("ComponentsControlsuseTrackedAsyncCallback"),function(e){Ae=t[e]={};class s extends m.RestClientBase{constructor(e){super(e)}async addGroupEntitlement(e,t){const s={ruleOption:t};return this.beginRequest({apiVersion:"7.1-preview.1",method:"POST",routeTemplate:"_apis/GroupEntitlements/{groupId}",queryParams:s,body:e})}async deleteGroupEntitlement(e,t,s){const n={ruleOption:t,removeGroupMembership:s};return this.beginRequest({apiVersion:"7.1-preview.1",method:"DELETE",routeTemplate:"_apis/GroupEntitlements/{groupId}",routeValues:{groupId:e},queryParams:n})}async getGroupEntitlement(e){return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/GroupEntitlements/{groupId}",routeValues:{groupId:e}})}async updateGroupEntitlement(e,t,s){const n={ruleOption:s};return this.beginRequest({apiVersion:"7.1-preview.1",method:"PATCH",routeTemplate:"_apis/GroupEntitlements/{groupId}",routeValues:{groupId:t},customHeaders:{"Content-Type":"application/json-patch+json"},queryParams:n,body:e})}async getGroupEntitlements(){return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/GroupEntitlements/{groupDescriptor}"})}async addMemberEntitlement(e){return this.beginRequest({apiVersion:"7.1-preview.2",method:"POST",routeTemplate:"_apis/MemberEntitlements/{memberId}",body:e})}async deleteMemberEntitlement(e){return this.beginRequest({apiVersion:"7.1-preview.2",method:"DELETE",routeTemplate:"_apis/MemberEntitlements/{memberId}",routeValues:{MemberId:e}})}async getMemberEntitlement(e){return this.beginRequest({apiVersion:"7.1-preview.2",routeTemplate:"_apis/MemberEntitlements/{memberId}",routeValues:{MemberId:e}})}async searchMemberEntitlements(e,t,s,n){const r={continuationToken:e,select:t,$filter:s,$orderBy:n};return this.beginRequest({apiVersion:"7.1-preview.2",routeTemplate:"_apis/MemberEntitlements/{memberId}",queryParams:r})}async updateMemberEntitlement(e,t){return this.beginRequest({apiVersion:"7.1-preview.2",method:"PATCH",routeTemplate:"_apis/MemberEntitlements/{memberId}",routeValues:{MemberId:t},customHeaders:{"Content-Type":"application/json-patch+json"},body:e})}async updateMemberEntitlements(e,t){const s={doNotSendInviteForNewUsers:t};return this.beginRequest({apiVersion:"7.1-preview.2",method:"PATCH",routeTemplate:"_apis/MemberEntitlements/{memberId}",customHeaders:{"Content-Type":"application/json-patch+json"},queryParams:s,body:e})}async addMemberToGroup(e,t){return this.beginRequest({apiVersion:"7.1-preview.1",method:"PUT",routeTemplate:"_apis/GroupEntitlements/{groupId}/Members/{memberId}",routeValues:{groupId:e,memberId:t}})}async getGroupMembers(e,t,s){const n={maxResults:t,pagingToken:s};return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/GroupEntitlements/{groupId}/Members/{memberId}",routeValues:{groupId:e},queryParams:n})}async removeMemberFromGroup(e,t){return this.beginRequest({apiVersion:"7.1-preview.1",method:"DELETE",routeTemplate:"_apis/GroupEntitlements/{groupId}/Members/{memberId}",routeValues:{groupId:e,memberId:t}})}async addServicePrincipalEntitlement(e){return this.beginRequest({apiVersion:"7.1-preview.1",method:"POST",routeTemplate:"_apis/ServicePrincipalEntitlements",body:e})}async updateServicePrincipalEntitlements(e){return this.beginRequest({apiVersion:"7.1-preview.1",method:"PATCH",routeTemplate:"_apis/ServicePrincipalEntitlements",customHeaders:{"Content-Type":"application/json-patch+json"},body:e})}async deleteServicePrincipalEntitlement(e){return this.beginRequest({apiVersion:"7.1-preview.1",method:"DELETE",routeTemplate:"_apis/ServicePrincipalEntitlements/{servicePrincipalId}",routeValues:{servicePrincipalId:e}})}async getServicePrincipalEntitlement(e){return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/ServicePrincipalEntitlements/{servicePrincipalId}",routeValues:{servicePrincipalId:e}})}async updateServicePrincipalEntitlement(e,t){return this.beginRequest({apiVersion:"7.1-preview.1",method:"PATCH",routeTemplate:"_apis/ServicePrincipalEntitlements/{servicePrincipalId}",routeValues:{servicePrincipalId:t},customHeaders:{"Content-Type":"application/json-patch+json"},body:e})}async addUserEntitlement(e){return this.beginRequest({apiVersion:"7.1-preview.4",method:"POST",routeTemplate:"_apis/UserEntitlements/{userDescriptor}",body:e})}async searchUserEntitlements(e,t,s,n){const r={continuationToken:e,select:t,$filter:s,$orderBy:n};return this.beginRequest({apiVersion:"7.1-preview.4",routeTemplate:"_apis/UserEntitlements/{userDescriptor}",queryParams:r})}async updateUserEntitlements(e,t){const s={doNotSendInviteForNewUsers:t};return this.beginRequest({apiVersion:"7.1-preview.4",method:"PATCH",routeTemplate:"_apis/UserEntitlements/{userDescriptor}",customHeaders:{"Content-Type":"application/json-patch+json"},queryParams:s,body:e})}async deleteUserEntitlement(e){return this.beginRequest({apiVersion:"7.1-preview.4",method:"DELETE",routeTemplate:"_apis/UserEntitlements/{userId}",routeValues:{userId:e}})}async getUserEntitlement(e){return this.beginRequest({apiVersion:"7.1-preview.4",routeTemplate:"_apis/UserEntitlements/{userId}",routeValues:{userId:e}})}async updateUserEntitlement(e,t){return this.beginRequest({apiVersion:"7.1-preview.4",method:"PATCH",routeTemplate:"_apis/UserEntitlements/{userId}",routeValues:{userId:t},customHeaders:{"Content-Type":"application/json-patch+json"},body:e})}async getUsersSummary(e){const t={select:e};return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/UserEntitlementSummary",queryParams:t})}}t[e].MemberEntitlementManagementClientName="AexMemberEntitlementManagement.IMemberEntitlementManagementRestClient",t[e].getMemberEntitlementManagementClient=function(s,n){return s.getRestClient(t[e].MemberEntitlementManagementClientName,n)},u.RestClients.add(t[e].MemberEntitlementManagementClientName,{factory:s,options:{resourceAreaId:"68ddce18-2501-45f1-a17b-7931a9922690"}})}("RestClientMemberEntitlementManagement"),function(e){xe=t[e]={},t[e].UsersSummaryContext=i.createContext({refresh:()=>Promise.resolve(void 0)});class s{static async refresh(e,t){const n=(0,Ae.getMemberEntitlementManagementClient)(e.pageContext);let r;t&&(r=t.map((e=>s.keyToSelectMapping[e])).join(","));const i=await n.getUsersSummary(r),a={};if(t)for(const e of t)switch(e){case"groupOptions":a.groupOptions=i.groupOptions;break;case"licenses":a.licenses=i.licenses,a.availableAccessLevels=i.availableAccessLevels;break;case"projectRefs":a.projectRefs=i.projectRefs;break;case"defaultAccessLevel":a.defaultAccessLevel=i.defaultAccessLevel}else a.groupOptions=i.groupOptions,a.licenses=i.licenses,a.availableAccessLevels=i.availableAccessLevels,a.projectRefs=i.projectRefs,a.defaultAccessLevel=i.defaultAccessLevel;return a}}s.keyToSelectMapping={licenses:Se.UsersSummaryPropertyNames.Licenses+","+Se.UsersSummaryPropertyNames.AccessLevels,groupOptions:Se.UsersSummaryPropertyNames.Groups,projectRefs:Se.UsersSummaryPropertyNames.Projects,defaultAccessLevel:Se.UsersSummaryPropertyNames.DefaultAccessLevel},t[e].UsersSummaryContextProvider=function(n){const r=(0,ye.useUserHubContext)(),[a,o]=(0,d.useAsyncState)({projectRefs:void 0,availableAccessLevels:void 0,licenses:void 0,groupOptions:void 0,defaultAccessLevel:void 0}),l={projectRefs:a.projectRefs,availableAccessLevels:a.availableAccessLevels,groupOptions:a.groupOptions,licenses:a.licenses,defaultAccessLevel:a.defaultAccessLevel,refresh:async(...e)=>{let t;t=0===e.length?await s.refresh(r):await s.refresh(r,e),o((e=>Object.assign(Object.assign({},e),t)))}};return i.useEffect((()=>{n.summarykeys?l.refresh(n.summarykeys):l.refresh()}),[]),i.createElement(t[e].UsersSummaryContext.Provider,{value:l},n.children)},t[e].useProjectRefsMapping=function(){const s=i.useContext(t[e].UsersSummaryContext);return i.useMemo((()=>{const{projectRefs:e}=s;if(!e)return;const t={};for(const s of e)t[s.id]=s;return t}),[s.projectRefs])},t[e].useGroupOptionNames=function(){const s=i.useContext(t[e].UsersSummaryContext);return i.useMemo((()=>{const e={4:he.RoleType_Custom};if(s.groupOptions)for(const t of s.groupOptions)e[t.group.groupType]=t.group.displayName;return e}),[s.groupOptions])}}("ContextUsersSummaryContexts"),function(e){Te=t[e]={},t[e].L2ClassNames={userManagementHub:"user-management-hub",userSummary:"user-hub-summary",userList:"user-list",groupList:"group-rule-list",userSearch:"user-list-search",userPivotHeader:"user-pivot-item-header",groupPivotHeader:"group-pivot-item-header",dropdowns:{accessLevel:{callout:"access-level-dropdown-callout"},projectGroupType:{callout:"project-group-type-dropdown-callout",itemPrefix:"project-group-type-item-"},bulkManageUsers:{callout:"bulk-manage-users-dropdown-callout"}},callouts:{actionButton:"callout-action-button",dismissButton:"callout-dismiss-button",previewButton:"callout-preview-button"},commandItems:{exportUsers:"export-users-command",addUsers:"add-users-command",bulkManageUsers:"bulk-manage-users-command",addGroupRule:"add-group-rule-command",usersSummary:"users-summary-command",changeAccessLevel:"change-access-level-command",removeFromOrganization:"remove-from-organization-command",createNewAzureDevOpsGroup:"create-new-azure-devops-group-rule-command",manageMember:"manage-member-command",removeDirectAssignment:"remove-direct-assignment-command"},formItems:{userIdentityPicker:"user-identity-picker-form-item",groupIdentityPicker:"group-identity-picker-form-item",accessLevelsDropdown:"access-levels-dropdown-form-item",createNewAzureDevOpsGroupName:"create-new-azure-devops-group-name-form-item"},checkBoxes:{editMemberProject:"edit-member-project-checkbox"},lists:{usersTable:"users-table",groupsTable:"groups-table",memberProjects:"member-projects-list"},cards:{users:"users-card",groups:"groups-card"},menus:{editUser:"edit-user-menu",editGroup:"edit-group-menu"},memberTable:{accessLevel:"member-table-access-level",groupStatusPrefix:"member-table-group-status-"},tableColumnHeaders:{accessLevel:"table-header-access-level",displayName:"table-header-display-name",dateAdded:"table-header-date-added",licenseSource:"table-header-license-source",lastAccess:"table-header-last-access"},FilterItems:{accesslevels:"filterbar-accesslevels",usertypes:"filterbar-usertype",licenseSource:"filterbar-licenseSource",accesslevelPickList:"picklist-filterbar-accesslevels",usertypePickList:"picklist-filterbar-usertype",licenseSourcePickList:"picklist-filterbar-licenseSource"},ListHeaders:{displayName:"listHeader-displayName",accessLevel:"listHeader-access-level",lastAccessedDate:"listHeader-last-accessed-date"},ListRow:{baseRow:"member-list-row",displayName:"member-list-display-name",accessLevel:"member-list-accesslevel",dateAdded:"member-list-dateAdded",licenseSource:"member-list-licenseSource",licenseSourceText:"member-list-licenseSource-text",lastAccess:"member-list-lastAccessed",lastAccessText:"member-list-lastAccessed-text"},SummaryAreas:{accesslevel:"summary-access-level",accessLevelItem:"summary-access-level-item",accessLevelTotal:"summary-access-level-total"},panels:{addUsers:{root:"add-users-panel"},addGroupRule:{root:"add-group-rule-panel"},summary:{root:"users-summary-panel",accessLevels:"summary-access-levels",accessLevelItem:"summary-access-level-item",accessLevelTotal:"summary-access-level-total"},changeAccessLevel:{root:"change-access-level-panel"},bulkChangeAccessLevel:{root:"bulk-change-access-level-panel"},editGroupRule:{root:"edit-group-rule-panel"}},dialogs:{removeUser:{root:"remove-user-dialog"},removeGroup:{root:"remove-group-dialog"},removeDirectAssignment:{root:"remove-direct-assignment-dialog"}},Dialogs:{CancelButton:"dialog-cancel-button",AddUser:{SendInviteCheckbox:"add-user-dialog-send-invite-checkbox"},AddGroupRule:{DialogContainer:"add-group-dialog-container",AddGroupButton:"add-group-dialog-add-button",SelectFromExistingGroupButton:"add-group-dialog-select-exisiting-group"},RemoveGroup:{DialogContainer:"remove-group-dialog-container",RemoveGroupButton:"remove-group-dialog-remove-button"},EditUserSingle:{ChangeAccessLevelContainer:"change-user-accesslevel-dialog-container",ChangeAccessConfirmationButton:"change-user-accesslevel-change-button",EditUserDialogContainer:"edit-user-dialog-container",EditSaveButton:"edit-user-dialog-remove-button"},ManageGroupMembers:{DialogContainer:"manage-members-dialog-container",AddButton:"manage-members-add-button",AddMemberContainer:"manage-members-add-member-container",AddMemberTab:"manage-members-add-member-tab",RemoveButton:"manage-members-remove-button",RemoveMemberContainer:"manage-members-remove-member-container",RemoveMemberTab:"manage-members-remove-member-tab",MemberRow:"manage-members-row"},EditBulk:{ChangeAccessLevelContainer:"bulk-change-user-accesslevel-dialog-container",ChangeAccessConfirmationButton:"bulk-change-user-accesslevel-change-button",AddToProjectsContainer:"bulk-add-to-projects-dialog-container",AddToProjectsConfirmationButton:"bulk-add-to-projects-confirmation-button",RemoveFromProjectsContainer:"bulk-remove-from-projects-dialog-container",RemoveFromProjectsConfirmationButton:"bulk-remove-from-projects-confirmation-button",RemoveUserDialogContainer:"bulk-remove-user-dialog-container",RemoveUserConfirmationButton:"bulk-remove-user-dialog-remove-confirmation-button"}},EditItems:{accessLevelDropDown:"access-level-drop-down",accessLevelInfoIcon:"access-level-info-icon",accessLevelInfoContainer:"access-level-info-container",accessLevelGroupInheritenceContainer:"access-level-group-inherit-container",accessLevelGroupInheritenceGroup:"access-level-group-inherit-group",editProjectGroupDropDown:"project-group-drop-down",editProjectCheckBox:"edit-member-projects-checkbox",addToProjectsComboBox:"add-to-projects-combobox",bulkEditProjectsPickList:"bulk-edit-projects-pick-list",bulkEditProjectsPicker:"bulk-edit-projects-picker",groupPreviewMessageContainer:"edit-group-preview-message-container",groupPreviewMessage:"edit-group-preview-message"}},t[e].L2DataAttributeKeys={memberDescriptor:"data-member-descriptor",memberAccessLevel:"data-member-access-level",projectId:"data-project-id"},t[e].L2Keys={removeUser:"remove-user-button",changeAccessLevel:"change-access-level-button",manageProjects:"manage-projects",removeDirectAssignmentSingle:"remove-direct-assignment",reinstateAssetsSingle:"reinstate-assets",addToProjectsBulk:"add-to-projects",removeFromProjectsBulk:"remove-from-projects",exportUsers:"export-users",addGroupRule:"add-group-rule",removeGroupRule:"remove-group-rule",reEvaluateGroupRules:"reEvaluate-group-rules",manageGroupMembers:"manage-group-rule-members"},t[e].L2Constants={license:{basic:"Basic",vsSubscriber:"Visual Studio Subscriber",stakeholder:"Stakeholder"},projectGroups:{readers:"Project Readers",contributors:"Project Contributors",administrators:"Project Administrators"}}}("Constants"),function(e){Ue=t[e]={};t[e].GroupOptions=class{static getDefaultGroupType(e){return e&&e.length>=1?e.some((e=>2===e.group.groupType))?2:e[0].group.groupType:2}}}("ModelsGroupOption"),function(e){Ie=t[e]={};class s{static getStyles(){return{addProjectsFormRoot:(0,C.getSpacingContainerClassName)("y",20),projectGroupTypeDropdown:(0,y.css)(b.SizeClassNames.width100,(0,C.getSpacingClassName)("margin","top",8))}}static getPermissionGroups(e,t){const s=[];if(e&&s.push(...e.map((e=>e.group))),t&&s.push({groupType:4,displayName:he.RoleType_Custom}),0!==s.length)return s}static permissionGroupEquals(e,t){return e.groupType===t}static getGroupType(e){return e.groupType}static projectRefEquals(e,t){return!!e.data&&e.data.id===t}static projectRefOnGetValue(e){return e.data.id}static teamRefEquals(e,t){return!!e.data&&e.data.id===t}static teamRefOnGetValue(e){return e.data.id}}function n(e){return Te.L2ClassNames.dropdowns.projectGroupType.itemPrefix+e.toString()}function r(e){const t=i.useContext(xe.UsersSummaryContext),{groupOptions:r}=t,{hasCustom:a}=e,o=s.getStyles(),l=i.useMemo((()=>s.getPermissionGroups(r,!!a)),[r,!!a]),[c,u]=(0,g.useSingleSelectedItem)(l,e.selectedGroupType,e.onChange,s.permissionGroupEquals,s.getGroupType),m=(0,g.useSelectionFactory)((()=>new E.DropdownSelection),c,u),d=i.useMemo((()=>{if(void 0!==l)return l.map((e=>({data:e,id:e.groupType.toString(),text:e.displayName,className:n(e.groupType)})))}),[l]);return d?i.createElement(f.FormItem,{label:e.hideLabel?void 0:he.LabelText_ProjectSecurityGroups},i.createElement(h.Dropdown,{disabled:e.disabled,ariaLabel:e.projectName,className:o.projectGroupTypeDropdown,calloutContentClassName:Te.L2ClassNames.dropdowns.projectGroupType.callout,selection:m,items:d})):null}function o(){const e=(0,ye.useUserHubContext)().getCreateProjectLink();return i.createElement(p.TemplateString,{template:he.UserInviteDialog_NoProjectsFound1},i.createElement(S.Link,{href:e,target:"_blank",rel:"noopener noreferrer",underline:!0},he.UserInviteDialog_CreateAProject))}function l(e){const t=i.useContext(xe.UsersSummaryContext),{projectRefs:n}=t,r=i.useMemo((()=>n?n.map((e=>({id:e.id,text:e.name,data:e}))):[{id:"_loading",type:4}]),[n]),[a,l]=(0,g.useSelectedItems)(r,e.selected,e.onChange,s.projectRefEquals,s.projectRefOnGetValue),c=(0,g.useSelectionFactory)((()=>new E.DropdownMultiSelection),a,l),u=!!n&&0===n.length;return i.createElement("div",{className:e.className},i.createElement(h.Dropdown,{ariaLabel:he.TitleText_EditUserBulkDialog_AddToProjects,disabled:u,items:r,selection:c,loading:!n,noItemsText:he.UserInviteDialog_NoProjectsFound,actions:[{text:he.ButtonText_AddAll,onClick:()=>{c.select(0,r.length)}}]}),u&&i.createElement(o,null),e.children)}__decorate([a.memoize],s,"getStyles",null),t[e].useSelectedGroupType=function(){const e=i.useContext(xe.UsersSummaryContext);return i.useState(Ue.GroupOptions.getDefaultGroupType(e.groupOptions))},t[e].getProjectGroupTypeDropdownItemClassName=n,t[e].ProjectGroupTypeDropdown=r,t[e].ProjectsDropdown=l,t[e].AddToProjectsForm=function(e){const t=s.getStyles();return i.createElement(l,{selected:e.selected,onChange:e.onChange,className:t.addProjectsFormRoot},e.selected&&e.selected.length>0&&i.createElement(r,{onChange:e.onSelectedGroupTypeChange,selectedGroupType:e.selectedGroupType}))},t[e].TeamsDropdown=function(e){const{teams:t}=e,n=i.useMemo((()=>t?t.map((e=>({id:e.id,text:e.name,data:e}))):[{id:"_loading",type:4}]),[t]),[r,a]=(0,g.useSelectedItems)(n,e.selected,e.onChange,s.teamRefEquals,s.teamRefOnGetValue),o=(0,g.useSelectionFactory)((()=>new E.DropdownMultiSelection),r,a);return i.createElement(h.Dropdown,{items:n,selection:o,loading:!t,noItemsText:he.TextTeamPickerNoSuggestions,actions:[{text:he.ButtonText_AddAll,onClick:()=>{(0,v.announce)(he.ButtonAnnounce_AddAll),o.select(0,n.length)}}]})}}("ComponentsHubFormsProjectForms"),function(e){function s(){const e=(0,i.useContext)(xe.UsersSummaryContext),{availableAccessLevels:t}=e,s=(0,i.useMemo)((()=>t&&t[0]),[t]),[n=s,r]=(0,i.useState)(void 0);return[n,r]}Pe=t[e]={},t[e].useSelectedAccessLevel=s,t[e].useAddMemberFields=function(){const[e,t]=s(),[n,r]=(0,Ie.useSelectedGroupType)(),[a,o]=(0,i.useState)(void 0);return{selectedAccessLevel:e,setSelectedAccessLevel:t,selectedGroupType:n,setSelectedGroupType:r,selectedProjectIds:a,setSelectedProjectIds:o}}}("ComponentsHubCalloutsAddMemberuseAddMemberFields"),function(e){Ne=t[e]={};class s{constructor(e){this.entityId=e}get displayName(){return this.entityId}}t[e].AddIdentity=s;class n{constructor(e){this.filter=e,this.entityType="custom",this.originDirectory="",this.addIdentityNames=e.split(";").map((e=>e.trim())).filter((e=>e))}get displayName(){return""}toAddIdentities(){return this.addIdentityNames.map((e=>new s(e)))}get entityId(){return this.filter}}t[e].AddPendingIdentities=n;t[e].AddUserIdentityPickerProvider=class{constructor(e,t,r=!1){this.isSingleAdd=r,this.onFilterIdentities=async(e,t)=>{const r=await this.baseProvider.onFilterIdentities(e,t);return 0===r.length&&""!==e?this.isSingleAdd?[new s(e.trim())]:[new n(e.trim())]:(r.forEach((e=>e.image=void 0)),r)},this.addIdentitiesToMRU=async e=>{const t=e.filter((e=>!(e instanceof n||e instanceof s)));return t.length>0&&this.baseProvider.addIdentitiesToMRU(t)};const i=t.supportServicePrincipals?["user","servicePrincipal"]:["user"];this.baseProvider=new A.PeoplePickerProvider(e.pageContext,{identityTypes:i,operationScopes:t.isGitHubInviteEnabled?["source","ims","ghb"]:["source","ims"]})}updateIdentityTypes(e){this.baseProvider.updateIdentityTypes(e)}onEmptyInputFocus(){return this.baseProvider.onEmptyInputFocus()}get onRequestConnectionInformation(){return this.baseProvider.onRequestConnectionInformation}get getEntityFromUniqueAttribute(){return this.baseProvider.getEntityFromUniqueAttribute}get removeIdentitiesFromMRU(){return this.baseProvider.removeIdentitiesFromMRU}}}("ModelsUserIdentityPickerProvider"),function(e){function s(e,t,s){return(0,i.useMemo)((()=>e&&new Ne.AddUserIdentityPickerProvider(e,t,s)),[e,t,s])}Me=t[e]={},t[e].useAddUserIdentityPickerProvider=s,t[e].useAddUserIdentityPicker=function(e,t){const n=s(e,t),[r,a]=(0,i.useState)([]);return n&&{pickerProvider:n,selectedIdentities:r,onChange:a}},t[e].hasValidIdentities=function(e,t){const s=t.length;return s>0&&s<=e.maxIdentitiesToAdd}}("ComponentsHubCalloutsAddMemberuseUserIdentityPicker"),function(e){Le=t[e]={};class s{static equals(e,t){return e===t||!(!e||!t)&&s.getLicenseKey(e)===s.getLicenseKey(t)}static isInvalid(e){return 0!==e.status&&1!==e.status&&4!==e.status}static compareByPermission(e,t){return s.equals(e,t)?0:e?t?e.licensingSource!==t.licensingSource?2===e.licensingSource?1:2===t.licensingSource?-1:e.licensingSource>t.licensingSource?1:-1:1===e.licensingSource?5===e.accountLicenseType||0===e.accountLicenseType?-1:0:(t.licensingSource,0):1:-1}static hasValidMsdnSubscription(e){return 2===e.licensingSource&&1!==e.msdnLicenseType&&1===e.status}static hasInvitedMsdnSubscription(e){return this.matchesSourceAndType(e,2,1)&&4===e.status}static hasInvalidInvitedMsdnSubscription(e){return this.matchesSourceAndType(e,2,1)&&1===e.status}static hasInvalidMsdnSubscription(e){return 2===e.licensingSource&&1!==e.msdnLicenseType&&(2===e.status||6===e.status||5===e.status)}static isPossibleAccessLevelDowngrade(e,t){const n=s.accessLevelTuplesOrderedByUpgrade.findIndex((t=>s.equals(t,e))),r=s.accessLevelTuplesOrderedByUpgrade.findIndex((e=>s.equals(e,t)));return r<0||n<0||n>r}static fromAccountUserLicense(e){const{source:t,license:s}=e;switch(t){case 1:return{licensingSource:1,status:1,accountLicenseType:s,msdnLicenseType:0};case 2:return{licensingSource:2,status:1,accountLicenseType:0,msdnLicenseType:s}}}static fromLicenseSummaryData(e){return{licensingSource:e.source,status:1,accountLicenseType:e.accountLicenseType,msdnLicenseType:e.msdnLicenseType}}static matchesSourceAndType(e,t,s){return e.licensingSource===t&&(1===t?e.accountLicenseType===s:2===t&&e.msdnLicenseType===s)}static mapToAvailableAccessLevel(e,t){if(e)for(const n of e)if(s.equals(n,t))return n}static getLicenseKey(e){const t=s.normalizeEnum(e.licensingSource),n=s.normalizeEnum(e.accountLicenseType),r=s.normalizeEnum(e.msdnLicenseType);switch(t){case 1:return`${t}-${n}`;case 2:return`${t}-${r}`;default:return t.toString()}}static getLicenseId(e){return s.getLicensingSourceString(e.licensingSource)+"-"+(1===e.licensingSource?s.getAccountLicenseTypeString(e.accountLicenseType):s.getMsdnLicenseTypeString(e.msdnLicenseType))}static normalizeEnum(e){return"number"!=typeof e?0:e}static getLicensingSourceString(e){switch(e){case 0:return"None";case 1:return"Account";case 2:return"Msdn";case 3:return"Profile";case 4:return"Auto";case 5:return"Trial"}}static getAccountLicenseTypeString(e){switch(e){case 0:return"None";case 1:return"EarlyAdopter";case 2:return"Express";case 3:return"Professional";case 4:return"Advanced";default:return"Stakeholder"}}static getMsdnLicenseTypeString(e){switch(e){case 0:return"None";case 2:return"Professional";case 3:return"Platforms";case 4:return"TestProfessional";case 5:return"Premium";case 6:return"Ultimate";case 7:return"Enterprise";default:return"Eligible"}}}t[e].AccessLevels=s,s.accessLevelTuplesOrderedByUpgrade=[{licensingSource:1,status:1,accountLicenseType:5,msdnLicenseType:0},{licensingSource:1,accountLicenseType:2,status:1,msdnLicenseType:0},{licensingSource:2,status:1,accountLicenseType:0,msdnLicenseType:1}]}("ModelsAccessLevel"),function(e){_e=t[e]={};class s{constructor(e){this.graphMember=e,this.graphMember=e,this.displayNameMatchString=(this.displayName+" "+this.principalName).toLocaleLowerCase()}static getAvatarUrl(e,t){const s=e.getPageData();if(s)return s.hostPath+"_api/_common/IdentityImage?id="+t}static isMemberAad(e){return e.origin===Se.DirectoryName.AzureActiveDirectory}get descriptor(){return this.graphMember.descriptor}getSortKey(e){if("displayName"===e)return this.displayName}getAvatarUrl(e){return s.getAvatarUrl(e,this.id)}get key(){return this.id}get displayName(){return this.graphMember.displayName}get principalName(){return this.graphMember.principalName}get isAad(){return s.isMemberAad(this.graphMember)}get accessLevelDisplayName(){return 2===this.accessLevel.licensingSource?he.UserInviteDialog_AccessLevelBasic:this.accessLevel.licenseDisplayName}get accessLevelLicenseDisplayName(){if(2===this.accessLevel.licensingSource)return this.accessLevel.licenseDisplayName}get hasInvalidLicense(){return 1!==this.accessLevel.licensingSource&&2!==this.accessLevel.licensingSource}get hasLegacyLicense(){return!s.defaultAccountLicenseTypes.some((e=>this.accessLevel.accountLicenseType===e))}}t[e].Member=s,s.memberSortComparisonFunction=(e,t,s,n)=>"displayName"===s?n*e.getSortKey(s).localeCompare(t.getSortKey(s)):0,s.defaultAccountLicenseTypes=[2,5,0]}("ModelsMember"),function(e){De=t[e]={},t[e].updatePartialArray=function(e,t,s,n=!1){n&&(e=[...e]);const r=e.length;for(let t=r;t<s;++t)e.push(void 0);for(let n=0;n<t.length;++n,++s)r<=s?e.push(t[n]):e[s]=t[n];return e},t[e].mergeObject=function(e,t){for(const s in t)e[s]=t[s]},t[e].replaceItemsInArray=function(e,t,s){let n=!1;const r=e.map((e=>t(e)?(n=!0,s(e)):e));return n||r.push(s()),r},t[e].isEmptyObject=function(e){for(const t in e)return!1;return!0},t[e].objectHasTruthyValue=function(e){for(const t in e)if(e[t])return!0;return!1},t[e].getMemoizedIncrementVersionFunction=function(){let e=0;return(0,a.memoizeFunction)(((...t)=>++e))},t[e].unionByKey=function(e,t,s){const n={};for(const t of e)n[s(t)]=!0;const r=[...e];for(const e of t){const t=s(e);n[t]||(n[t]=!0,r.push(e))}return r},t[e].intersectionByKey=function(e,t,s){const n={};for(const t of e)n[s(t)]=!0;const r=[];for(const e of t)n[s(e)]&&r.push(e);return r},t[e].updateItems=function(e,t,s,n=!0){const r={};for(const e of t)r[s(e)]=e;const i=e.map((e=>{const t=s(e);if(r.hasOwnProperty(t)){const e=r[t];return delete r[t],e}return e}));if(n)for(const e in r)i.push(r[e]);return i},t[e].deleteItemsByKey=function(e,t,s){const n={};for(const e of t)n[e]=!0;const r=[];for(const t of e)n[s(t)]||r.push(t);return r},t[e].toKeyedObject=function(e,t){const s={};for(const n of e)s[t(n)]=n;return s},t[e].toKeyMapping=function(e,t){const s={};for(const n of e)s[n]=t;return s},t[e].toTupleArray=function(e,t){const s=[];for(let n=0;n<e.length;++n)s.push([e[n],t[n]]);return s}}("UtilsObjectUtils"),function(e){Fe=t[e]={};class s{}t[e].AsyncIteratorBase=s;class n extends s{constructor(e){super(),this.iterators=e}static async mapToContextPromise(e,t){const s=await e.next();return{index:t,iterator:e,result:s}}async next(){let e;for(this.activeContextPromises||(this.activeContextPromises={},this.iterators.map(n.mapToContextPromise).forEach(((e,t)=>{this.activeContextPromises[t]=e})));;){const t=[];for(const e in this.activeContextPromises)t.push(this.activeContextPromises[e]);if(t.length<=0)return{done:!0,value:void 0};const s=await Promise.race(t),{result:r,index:i,iterator:a}=s;if(e=r.value,!r.done){this.activeContextPromises[i]=n.mapToContextPromise(a,i);break}delete this.activeContextPromises[i]}return{done:!1,value:e}}}t[e].RacedAsyncIterator=n;t[e].CancelableAsyncIterator=class extends s{constructor(e){super(),this.isPendingCanceled=!1,this.innerIterator=e}next(){return this.isPendingCanceled?new Promise((e=>{e({done:!0,value:void 0})})):this.innerIterator.next()}cancelPending(){this.isPendingCanceled=!0}}}("UtilsPromiseUtils"),function(e){Re=t[e]={};class s extends Fe.AsyncIteratorBase{constructor(e,t){super(),this.onBatchHandler=e,this.batchesIterator=t}async next(){const e=this.batchesIterator.next(),{done:t,value:s}=e;if(t)return{done:t,value:s};return{done:t,value:{batchData:await this.onBatchHandler(s),metadata:s}}}}class n extends Fe.AsyncIteratorBase{constructor(e,t){super(),this.batchMetadataIterator=e,this.result=[],this.maxInFlight=t;const n=[];for(let t=0;t<this.maxInFlight;++t)n.push(new s((e=>this.onBatchHandler(e)),e));this.racedAsyncIterator=new Fe.RacedAsyncIterator(n)}async next(){const e=await this.racedAsyncIterator.next(),{value:t,done:s}=e;if(s)return{done:s,value:void 0};const{batchData:n,metadata:r}=t;return(0,De.updatePartialArray)(this.result,n,r.beginIndex),{done:s,value:this.result}}}t[e].BatchOrchestratorIterator=n}("UtilsBatchUtils"),function(e){ke=t[e]={};class s{constructor(e,t){this.isCanceled=!1,this.innerIterator=s.getBatches(e,t)}static*getBatches(e,t){for(let s=0;s<e;s+=t){let n=s+t;n=n>e?e:n,yield{batchSize:n-s,beginIndex:s}}}next(){return this.isCanceled?{done:!0,value:void 0}:this.innerIterator.next()}cancel(){this.isCanceled=!0}}t[e].BatchMetadataIterator=s;class n extends Re.BatchOrchestratorIterator{constructor(e,t=Se.UserHubConstants.BulkEditMaxBatchSize,n=Se.UserHubConstants.BulkEditMaxBatchWorker){super(new s(e.length,t),n),this.batch=e}cancelPending(){this.batchMetadataIterator.cancel()}async onBatchHandler(e){const{beginIndex:t,batchSize:s}=e,n=await this.sendClientRequest(this.batch.slice(t,t+s));return this.convertResponse(n)}}t[e].JsonBatchRequestIterator=n}("UtilsJsonBatchUtils"),function(e){function s(e,t,s,r){const i=t?"/"+t:"";switch(e){case 0:return r?{from:"",op:e,path:i+n(r),value:s}:{from:"",op:e,path:"",value:s};case 1:return r?{from:"",op:e,path:i+n(r),value:""}:{from:"",op:e,path:i,value:""};case 2:return{from:"",op:e,path:i+n(r),value:s};default:return}}function n(e){let t="";if(e)for(const s of e){const[e,n]=s;t+="/"+e,n&&(t+="/"+n)}return t}we=t[e]={};class r{constructor(){this.patchOperations=[],this.metadata=[],this.patchOperations=[]}build(){return[this.patchOperations,this.metadata]}get length(){return this.patchOperations.length}appendProjectOperation(e,t,n,r){const i=s(t,e&&e.id,{projectRef:{id:n},group:{groupType:r}},[[Se.OperationTarget.ProjectEntitlements,1===t?n:void 0]]);return i&&(this.patchOperations.push(i),this.metadata.push([0,e,t,n,r])),this}appendTeamOperation(e,t,n,r){const i=s(t,e&&e.id,{id:r},[[Se.OperationTarget.ProjectEntitlements,n],[Se.OperationTarget.TeamRefs,1===t?r:void 0]]);return i&&(this.patchOperations.push(i),this.metadata.push([1,e,t,n,r])),this}appendReplaceAccessLevel(e,t){const n=s(2,e&&e.id,{accountLicenseType:t.accountLicenseType,licensingSource:t.licensingSource},[[Se.OperationTarget.AccessLevel,void 0]]);return n&&(this.patchOperations.push(n),this.metadata.push([2,e,t])),this}appendAddMemberEntitlementOperation(e){const t=s(0,void 0,e);return t&&(this.patchOperations.push(t),this.metadata.push([3,e])),this}appendRemoveMemberEntitlementOperation(e){const t=s(1,e.id);return t&&(this.patchOperations.push(t),this.metadata.push([4,e])),this}appendReinstateAssets(){const e=s(2,void 0,{},[["reinstateAssets",void 0]]);return e&&(this.patchOperations.push(e),this.metadata.push([5])),this}}t[e].MemberEntitlementsJsonPatchOperationsBuilder=r;class i extends r{replaceAccessLevel(e){return this.appendReplaceAccessLevel(void 0,e)}addProject(e,t){return this.appendProjectOperation(void 0,0,e,t)}replaceMembersGroupInProject(e,t){return this.appendProjectOperation(void 0,2,e,t),this}removeProject(e){return this.appendProjectOperation(void 0,1,e)}addToTeam(e,t){return this.appendTeamOperation(void 0,0,e,t)}removeFromTeam(e,t){return this.appendTeamOperation(void 0,1,e,t)}}t[e].SingleMemberEntitlementJsonDocumentBuilder=i;t[e].SingleUserEntitlementJsonDocumentBuilder=class extends i{reinstateAssets(){return this.appendReinstateAssets()}};t[e].BulkEditMemberEntitlementJsonDocumentBuilder=class extends r{addToProject(e,t,s){return this.appendProjectOperation(e,0,t,s)}removeFromProject(e,t){return this.appendProjectOperation(e,1,t)}addToTeam(e,t,s){return this.appendTeamOperation(e,0,t,s)}removeFromTeam(e,t,s){return this.appendTeamOperation(e,1,t,s)}replaceAccessLevel(e,t){return this.appendReplaceAccessLevel(e,t)}addMemberEntitlement(e){return this.appendAddMemberEntitlementOperation(e)}removeMemberEntitlement(e){return this.appendRemoveMemberEntitlementOperation(e)}};class a extends ke.JsonBatchRequestIterator{constructor(e,t,s,n,r){super(t,n,r),this.client=e,this.doNotSendInviteForNewUsers=s,this.client=e}sendClientRequest(e){return this.client.updateUserEntitlements(e,this.doNotSendInviteForNewUsers)}convertResponse(e){return e.results}}class o extends ke.JsonBatchRequestIterator{constructor(e,t,s,n){super(t,s,n),this.client=e,this.client=e}sendClientRequest(e){return this.client.updateServicePrincipalEntitlements(e)}convertResponse(e){return e.results}}class l extends ke.JsonBatchRequestIterator{constructor(e,t,s,n){super(t,n,1),this.client=e,this.memberId=s,this.client=e,this.memberId=s}sendClientRequest(e){return this.client.updateUserEntitlement(e,this.memberId).then((e=>e))}convertResponse(e){return e.operationResults}}class c extends ke.JsonBatchRequestIterator{constructor(e,t,s,n){super(t,n,1),this.client=e,this.memberId=s,this.client=e,this.memberId=s}sendClientRequest(e){return this.client.updateServicePrincipalEntitlement(e,this.memberId).then((e=>e))}convertResponse(e){return e.operationResults}}class u extends ke.JsonBatchRequestIterator{constructor(e,t,s,n){super(t,n,1),this.client=e,this.memberId=s,this.client=e,this.memberId=s}sendClientRequest(e){return this.client.updateGroupEntitlement(e,this.memberId).then((e=>e))}convertResponse(e){return e.results}}async function m(e){let t=await e.next(),s=t.value;for(;!t.done;)s=t.value,t=await e.next();return s}t[e].processBulkUserActions=async function(e,t,s,n,r){const i=(0,Ae.getMemberEntitlementManagementClient)(e.pageContext),o=new a(i,s,r,t.bulkMaxBatchSize,t.bulkMaxBatchWorker),l=await m(o);return(0,De.toTupleArray)(l,n)},t[e].processSingleUserActions=async function(e,t,s,n,r){const i=(0,Ae.getMemberEntitlementManagementClient)(e.pageContext),a=new l(i,s,r,t.bulkMaxBatchSize),o=await m(a);return(0,De.toTupleArray)(o,n)},t[e].processBulkServicePrincipalActions=async function(e,t,s,n){const r=(0,Ae.getMemberEntitlementManagementClient)(e.pageContext),i=new o(r,s,t.bulkMaxBatchSize,t.bulkMaxBatchWorker),a=await m(i);return(0,De.toTupleArray)(a,n)},t[e].processSingleServicePrincipalActions=async function(e,t,s,n,r){const i=(0,Ae.getMemberEntitlementManagementClient)(e.pageContext),a=new c(i,s,r,t.bulkMaxBatchSize),o=await m(a);return(0,De.toTupleArray)(o,n)},t[e].processSingleGroupActions=async function(e,t,s,n,r){const i=(0,Ae.getMemberEntitlementManagementClient)(e.pageContext),a=new u(i,s,r,t.bulkMaxBatchSize),o=await m(a);return(0,De.toTupleArray)(o,n)}}("UtilsMemberEntitlementJsonPatchBuilder"),function(e){Ge=t[e]={};class s extends _e.Member{constructor(e,t){super(e.group),this.groupEntitlement=e,this.isPendingDeleteCompletion=t,this.groupEntitlement=e}static getDefaultGroupAvatarUrl(e){return(0,l.getAssetLocation)(e.pageContext,"ms.vss-aex-user-management/user-hub-content/content/ip-content-aad-group-default.png")}get id(){return this.groupEntitlement.id}get accessLevel(){return this.groupEntitlement.licenseRule}get extensions(){return this.groupEntitlement.extensionRules}get projectEntitlements(){return this.groupEntitlement.projectEntitlements}get status(){return this.groupEntitlement.status}getAvatarUrl(e){return this.groupEntitlement.group.origin===Se.OriginName.AzureActiveDirectory?s.getDefaultGroupAvatarUrl(e):super.getAvatarUrl(e)}get lastExecuted(){return this.groupEntitlement.lastExecuted}getSortKey(e){return"lastExecutedDate"===e?this.lastExecuted.getTime():super.getSortKey(e)}}s.groupSortComparisonFunction=(e,t,s,n)=>"lastExecutedDate"===s?n*(e.getSortKey(s)-t.getSortKey(s)):_e.Member.memberSortComparisonFunction(e,t,s,n),__decorate([a.memoize],s,"getDefaultGroupAvatarUrl",null),t[e].Group=s}("ModelsGroup"),function(e){Be=t[e]={};class s{constructor(e,t,n){this.items=e,this.isFetchDone=t,this.onScheduleFetchNextBatch=n,this.getItem=e=>{if(!(e>=this.length))return this.isFetchDone||e!==this.length-1?this.items[e]:(this.onScheduleFetchNextBatch&&this.onScheduleFetchNextBatch(),s.observableValueUndefined)}}get length(){return this.isFetchDone?this.value.length:this.value.length+1}get value(){return this.items}}t[e].AutoLoadingTableItemProvider=s,s.observableValueUndefined=new T.ObservableValue(void 0),t[e].useAutoLoadingTableProps=function(e,t,n){const r=i.useRef([void 0,!1]),a=i.useRef(!1),o=i.useMemo((()=>n&&(()=>{const[t]=r.current;e!==t&&(r.current=[e,!1],a.current&&(a.current=!1,r.current[1]=!0,n()))})),[n,e,r]),l=i.useMemo((()=>n&&(()=>{r.current[1]||(r.current[1]=!0,n())})),[n,r]),c=i.useMemo((()=>new s(e||[],t,o)),[e,t,o]);return i.useEffect((()=>(a.current=!0,l&&l(),()=>{a.current=!1}))),{itemProvider:c,behavior:i.useMemo((()=>({componentDidMount:l,componentDidUpdate:l})),[l]),isFetchDone:t,fetchedCount:c.value.length}},t[e].useColumnSorting=function(e,t){const s=(0,x.useMutableCallback)(e,t);return i.useMemo((()=>new U.ColumnSorting(s)),[])}}("UtilsTableUtils"),function(e){je=t[e]={};class s extends i.Component{static getStyles(){return{container:(0,y.css)(I.FlexClassNames.flexColumn,b.SizeClassNames.height100,b.SizeClassNames.width100,I.FlexClassNames.alignItemsCenter,I.FlexClassNames.justifyContentCenter),content:I.LayoutClassNames.overflowHidden}}render(){const e=s.getStyles();return i.createElement("div",{className:e.container},i.createElement("div",{className:e.content},this.props.children))}}__decorate([a.memoize],s,"getStyles",null),t[e].FlexCenterBlock=s}("ComponentsControlsFlexCenterBlock"),function(e){He=t[e]={};class s extends i.Component{static getStyles(){return{title:I.FontClassNames.fontSizeMm}}render(){const e=s.getStyles(),{groupsInheritedFrom:t,promiseFulfilled:n}=this.props;return i.createElement("div",{className:Te.L2ClassNames.EditItems.accessLevelGroupInheritenceContainer},i.createElement("div",{className:e.title},he.GroupAssignmentIcon_CalloutTitle),n?!t||t.length<1?he.GroupAssignmentIcon_CalloutNoMatchesExplaination:t&&t.map((e=>i.createElement("div",{key:e.id,className:Te.L2ClassNames.EditItems.accessLevelGroupInheritenceGroup},i.createElement("span",null,e.displayName," (",_e.Member.isMemberAad(e.groupEntitlement.group)?he.GroupAssignmentIcon_CalloutGroupTypeAad:he.GroupAssignmentIcon_CalloutGroupTypeVsts,")")))):i.createElement(je.FlexCenterBlock,null,i.createElement(c.Spinner,{size:"large"})))}}__decorate([a.memoize],s,"getStyles",null),t[e].GroupMembershipToolTipContent=s,t[e].GroupMembershipToolTip=function(e){return i.createElement(P.Icon,{tooltipProps:{renderContent:()=>i.createElement(s,Object.assign({},e)),showOnFocus:!0},className:e.className,iconName:"Info",ariaLabel:he.GroupAssignmentIcon_HoverInfoLabel})}}("ComponentsControlsTooltipGroupMembership"),function(e){Oe=t[e]={};class s{constructor(e,t,s){this.projectRef=e,this.memberProjectEntitlement=t,this.delta=s}get memberProjectEntitlementGroup(){return this.memberProjectEntitlement&&this.memberProjectEntitlement.group}}function n(){return i.createElement(P.Icon,{iconName:"Info",ariaLabel:he.ProjectInheritence_CalloutLabel,tooltipProps:{text:he.ProjectInheritence_CalloutExplaination}})}function r(e,t,s){return e?i.createElement(He.GroupMembershipToolTip,{groupsInheritedFrom:s,promiseFulfilled:!0}):2===t?i.createElement(n,null):null}t[e].ProjectSelectionItem=s;class o{static getStyles(){return{checkboxLabel:(0,y.css)(I.FlexClassNames.flexRow,I.FlexClassNames.alignItemsCenter,(0,C.getSpacingContainerClassName)("x",8)),projectsListItem:(0,y.css)((0,C.getSpacingClassName)("padding","y",8))}}static getInitialState(e,t){const{memberProjectEntitlement:s}=e;if(!s)return{checked:!1,groupType:void 0};const n=s.group.groupType;return{checked:!0,groupType:void 0===n?Ue.GroupOptions.getDefaultGroupType(t):n}}static mergeRenderState(e,t){return t?!0===t.checked?t:!1===t.checked?{checked:!1,groupType:void 0===t.groupType?e.groupType:t.groupType}:{checked:e.checked,groupType:t.groupType}:e}}function l(e){const{selectionItem:t,selectedGroupType:s,inheritsFromGroups:n,projectName:r,onGroupTypeChange:a}=e,{memberProjectEntitlement:o,memberProjectEntitlementGroup:l}=t;let c=!1;if(o){const{projectPermissionInherited:e}=o;if(2===e){const e=l&&(l.displayName?l.displayName:he.RoleType_Custom);return i.createElement("div",null,e)}l&&4===l.groupType&&(c=!0)}return i.createElement(Ie.ProjectGroupTypeDropdown,{disabled:n,selectedGroupType:s,hasCustom:c,onChange:a,hideLabel:!0,projectName:r})}function c(e){const t=i.useContext(xe.UsersSummaryContext),{groupOptions:s}=t,{selectionItem:n,delta:a}=e,{projectRef:c,memberProjectEntitlement:u}=n,m=u&&e.groupAssignments&&e.groupAssignments.filter((e=>e.projectEntitlements.filter((e=>e.projectRef.id===c.id)).length>0)),d=n.memberProjectEntitlement&&2===n.memberProjectEntitlement.assignmentSource&&m&&m.length>0,p=o.getInitialState(n,s),g=o.mergeRenderState(p,a),C=o.getStyles();return i.createElement("div",Object.assign({className:(0,y.css)(b.SizeClassNames.width100,C.projectsListItem)},{[Te.L2DataAttributeKeys.projectId]:c.id}),i.createElement(N.Checkbox,{className:(0,y.css)(Te.L2ClassNames.checkBoxes.editMemberProject),disabled:u?2===u.projectPermissionInherited||d:void 0,checked:g.checked,label:i.createElement("div",{className:C.checkboxLabel},i.createElement("span",null,c.name),u&&r(!!d,u.projectPermissionInherited,m)),onChange:(t,n)=>{t.preventDefault(),n===p.checked?g.groupType===p.groupType?e.onChange(void 0):e.onChange({checked:void 0,groupType:g.groupType}):e.onChange({checked:n,groupType:g.groupType||Ue.GroupOptions.getDefaultGroupType(s)})}}),g.checked&&i.createElement("div",null,i.createElement(l,{selectionItem:n,inheritsFromGroups:d,selectedGroupType:g.groupType,projectName:c.name,onGroupTypeChange:t=>{p.checked?p.groupType!==t?e.onChange({checked:void 0,groupType:t}):e.onChange(void 0):e.onChange({checked:!0,groupType:t})}})))}__decorate([a.memoize],o,"getStyles",null),t[e].EditMemberProjectsForm=function(e){const t=(0,ye.useUserHubContext)(),n=i.useContext(xe.UsersSummaryContext),{projectRefs:r}=n,{memberProjectEntitlements:a,selectionDelta:o}=e,l=function(e,t,n){const r=i.useMemo((()=>{if(!e)return[];const r={};for(const e of t)r[e.projectRef.id]=e;return e.map((e=>new s(e,r[e.id],n[e.id])))}),[e,t,n]);return i.useMemo((()=>new Be.AutoLoadingTableItemProvider(r,!!e,void 0)),[r,e])}(r,a,o),u=i.useCallback(((t,s)=>{e.onChange((e=>Object.assign(Object.assign({},e),{[t]:s})))}),[e.onChange]),m=i.useMemo((()=>l),[l,u]);if(r&&0===l.length){const e=t.getCreateProjectLink();return i.createElement(L.ZeroData,{imagePath:t.getImageUrl(ye.UserHubPageContextService.noResultsAssetsId),imageAltText:"",primaryText:he.UserInviteDialog_NoProjectsFound,actionText:e?he.UserInviteDialog_CreateAProject:void 0,actionHref:e})}return i.createElement(M.List,{className:(0,y.css)(b.SizeClassNames.width100,Te.L2ClassNames.lists.memberProjects),itemProvider:m,renderRow:(t,s,n)=>{const r=s.projectRef.id;return i.createElement(M.ListItem,{key:t,index:t,details:n},i.createElement(c,{selectionItem:s,groupAssignments:e.groupAssignments,delta:s.delta,onChange:e=>{u(r,e)}}))}})}}("ComponentsHubCalloutsEditMemberProjectsForm"),function(e){function s(e,t,s){const n=new we.SingleMemberEntitlementJsonDocumentBuilder;var r,i;if(r=e.accessLevel,!(i=t)||Le.AccessLevels.equals(r,i)&&!Le.AccessLevels.isInvalid(r)||n.replaceAccessLevel(t),s)for(const e in s){const t=s[e];if(t)if(!0===t.checked){const s=t;n.addProject(e,s.groupType)}else if(!1===t.checked)n.removeProject(e);else{const s=t;n.replaceMembersGroupInProject(e,s.groupType)}}return n}Ve=t[e]={},t[e].useEditMemberBuilder=function(e,t,n){return(0,i.useMemo)((()=>s(e,t,n)),[e,t,n])}}("ComponentsHubCalloutsEditMemberuseEditMemberInput"),function(e){ze=t[e]={},t[e].useRefreshedMember=function(e,t){const s=(0,i.useMemo)((()=>t&&t(e)),[e]),[n]=(0,_.useResolvedPromise)(s);return n}}("ComponentsHubCalloutsEditMemberuseRefreshedMember"),function(e){function s(){return i.createElement(S.Link,{href:Se.UserManagementLinks.GenericFailureSupport,target:"_blank",rel:"noopener noreferrer",underline:!0},he.DialogErrorMessage_ServicePageLinkText)}qe=t[e]={},t[e].GenericErrorSupportLink=s,t[e].GenericErrorMessage=function(e){return e.scenario?i.createElement(p.TemplateString,{template:he.DialogErrorMessage_Template2},e.scenario,i.createElement(s,null)):i.createElement(p.TemplateString,{template:he.DialogErrorMessage_Generic1},i.createElement(s,null))}}("ComponentsControlsGenericErrors"),function(e){We=t[e]={},t[e].UserHubNotificationsContext=i.createContext({notifications:{},createNotification:()=>"",dismissNotification:()=>{},dismissAllNotifications:()=>{},setNotification:()=>{},clearActiveNotification:()=>{}}),t[e].UserHubNotificationsContextProvider=function(s){const n=(0,ye.useUserHubContext)(),[r,a]=(0,d.useAsyncState)({}),[o,l]=(0,d.useAsyncState)(void 0),c=i.useRef({}),u=i.useRef(0),m=i.useCallback((e=>{a((t=>{if(r.hasOwnProperty(e)&&!c.current.hasOwnProperty(e)){const s=Object.assign({},t);return delete s[e],s}return t}))}),[a,r]),g=i.useCallback((()=>{a((e=>{const t=Object.assign({},e);for(const s in e)t.hasOwnProperty(s)&&!c.current.hasOwnProperty(s)&&delete t[s];return t}))}),[a,r]),b=n.globalMessagesService,C=i.useCallback(((e,t,s={})=>{const n=c.current.hasOwnProperty(e);let r;if(t&&(r=n?Object.assign(Object.assign({},t),{isPersistent:!0}):Object.assign(Object.assign({},t),{lastUpdated:new Date}),s.addToast)){let n;switch(t.statusType){case"Success":n=he.BulkStatusDialogText_LabelSuccess;break;case"Warning":n=he.BulkStatusDialogText_LabelWarning;break;case"Failed":n=he.BulkStatusDialogText_LabelFailed}const r=n?i.createElement(p.TemplateString,{template:he.BulkStatusDialogText_ActionStatus2},n,t.title):t.title;b.addToast(Object.assign({message:r,callToAction:t.details?he.ButtonText_Details:void 0,onCallToActionClick:t.details?()=>{l(e)}:void 0,forceOverrideExisting:!0},s.addToast))}a((t=>Object.assign(Object.assign({},t),{[e]:r})))}),[a]),v=i.useCallback((e=>{const t=(++u.current).toString();return e&&(c.current[t]=e),t}),[]);return i.createElement(t[e].UserHubNotificationsContext.Provider,{value:{notifications:r,createNotification:v,dismissNotification:m,setNotification:C,dismissAllNotifications:g,activeNotificationId:o,clearActiveNotification:()=>{l(void 0)}}},s.children)},t[e].usePersistentUserHubNotification=function(s){const n=i.useContext(t[e].UserHubNotificationsContext),r=i.useMemo((()=>n.createNotification(s)),[s]),{notifications:a}=n,o=a[r],l=i.useCallback((e=>{const t="function"==typeof e?e(o):e;t!==a[r]&&(t&&(t.isPersistent=!0),n.setNotification(r,t))}),[r,a]);return[o,l]},t[e].useNotificationAsyncCallback=function(s,n){const r=i.useContext(t[e].UserHubNotificationsContext);return i.useCallback((async(...e)=>{const{onGetDisplayName:t,onGetErrorNotification:a,onGetDescription:o,onGetResultNotification:l}=n,c=t(...e),u=o&&o(...e),m=r.createNotification();r.setNotification(m,{statusType:"Running",title:c,description:u});try{const t=await s(...e),n=l?Object.assign({title:c},l(t,...e)):{statusType:"Success",title:c,description:u};return r.setNotification(m,n,{addToast:{duration:"Success"===n.statusType?5e3:1e4}}),t}catch(t){throw r.setNotification(m,a?Object.assign({title:c},a(t,...e)):{statusType:"Failed",title:c,description:i.createElement("div",null,i.createElement("div",null,u),i.createElement(qe.GenericErrorMessage,null))},{addToast:{duration:5e3}}),t}}),[r,s,n])}}("ContextNotificationContexts"),function(e){Ke=t[e]={};class s extends _e.Member{constructor(e){var t,s;super(null!==(s=null!==(t=e.user)&&void 0!==t?t:e.servicePrincipal)&&void 0!==s?s:e.member),this.userEntitlement=e,this._groupAssignments=[],this._groupAssignments=e.groupAssignments?e.groupAssignments.map((e=>new Ge.Group(e,!1))):[]}get directoryAlias(){return this.graphMember.directoryAlias?this.graphMember.directoryAlias:this.isGitHubUser?this.isBindPending?this.computeGitHubHandleFromPrincipalName():`(${this.principalName})`:void 0}get displayName(){return this.graphMember.displayName}get principalName(){return this.isServicePrincipal?this.graphMember.applicationId:this.graphMember.mailAddress||this.graphMember.principalName}get id(){return this.userEntitlement.id}get accessLevel(){return this.userEntitlement.accessLevel}get dateAdded(){return this.userEntitlement.dateCreated}get lastAccessedDate(){return this.userEntitlement.lastAccessedDate}get projectEntitlements(){return this.userEntitlement.projectEntitlements}get groupAssignments(){return this._groupAssignments}get isAADGuest(){return this.graphMember.subjectKind===Se.SubjectKind.User&&this.graphMember.metaType===Se.UserMetaType.Guest}get isGitHubUser(){return this.graphMember.origin===Se.OriginName.GitHubDirectory}get isAADDeleted(){return this.graphMember.isDeletedInOrigin}get isServicePrincipal(){return this.graphMember.subjectKind===Se.SubjectKind.ServicePrincipal}getAvatarUrl(e){if(this.isGitHubUser&&this.isBindPending){if(this.computeGitHubHandleFromPrincipalName())return`https://avatars.githubusercontent.com/u/${this.graphMember.originId}?v=4`}return _e.Member.getAvatarUrl(e,this.id)}get isBindPending(){return(0,D.caseInsensitiveContains)(this.graphMember.descriptor,Se.SubjectType.BindPendingUser)}get metaType(){return this.graphMember.metaType}getSortKey(e){switch(e){case"dateAdded":return this.dateAdded.getTime();case"lastAccessDate":return this.lastAccessedDate.getTime()}return super.getSortKey(e)}computeGitHubHandleFromPrincipalName(){return this.graphMember.principalName.split("@")[0]}}t[e].User=s,s.userSortComparisonFunction=(e,t,s,n)=>{switch(s){case"dateAdded":case"lastAccessDate":return n*(e.getSortKey(s)-t.getSortKey(s))}return _e.Member.memberSortComparisonFunction(e,t,s,n)}}("ModelsUser"),function(e){$e=t[e]={};class s extends m.RestClientBase{constructor(e){super(e)}async sendInvitation(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PUT",routeTemplate:"_apis/Invitations/{userId}",routeValues:{userId:t},body:e})}async sendInvitations(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/Invitations/{userId}",body:e})}}t[e].InvitationClientName="AexInvitation.IInvitationRestClient",t[e].getInvitationClient=function(s,n){return s.getRestClient(t[e].InvitationClientName,n)},u.RestClients.add(t[e].InvitationClientName,{factory:s,options:{serviceInstanceType:"951917ac-a960-4999-8464-e3f0aa25b381"}})}("RestClientInvitation"),function(e){Je=t[e]={},t[e].useResendUserInvitation=function(){const e=(0,ye.useUserHubContext)(),t=i.useCallback((t=>{const s=e.getRestClient($e.InvitationClientName);return e.ciTelemetry.publishClickResendInviteEvent(t.id,t.isAADGuest),s.sendInvitation({},t.id)}),[e]);return(0,We.useNotificationAsyncCallback)(t,{onGetDisplayName:()=>he.ResendInviteSingle_ActionDisplayName,onGetErrorNotification:t=>{const s=new F.HandledError(t);return s&&"InvalidInviterPermissionsException"===s.typeKey?{statusType:"Failed",title:he.ResendInviteSingle_ActionDisplayName,description:he.ResendInvite_NoAadAdminPermissions}:(e.telemetry.trackException(t,"ResendUserInvitation"),{statusType:"Failed",title:he.ResendInviteSingle_ActionDisplayName,description:s?s.message:he.ResendInviteSingle_ActionDisplayNameFailure})}})}}("ComponentsHubCalloutsResendUserInvitation"),function(e){Qe=t[e]={};class s{static summarizeNotifications(e){const t=[],n=[];let r="Info",i=0;for(const s in e){const a=e[s];if(a)switch(a.isPersistent?t.push(s):n.push(s),a.statusType){case"Running":++i;break;case"Failed":r=this.getHigherSeverity(r,"Error");break;case"Warning":r=this.getHigherSeverity(r,"Warning")}}return t.sort(),n.sort(((t,n)=>s.compareNotification(t,n,e[t],e[n]))),{persistentNotificationsIds:t,sortedMessageIds:n,runningTaskCount:i,severity:r}}static getHigherSeverity(e,t){return"Error"===e||"Error"===t?"Error":"Warning"===e||"Warning"===t?"Warning":"Info"}static compareNotification(e,t,s,n){return void 0===s.lastUpdated||void 0===n.lastUpdated?e<t?-1:e>t?1:0:n.lastUpdated.getTime()-s.lastUpdated.getTime()}}t[e].NotificationUtils=s}("ComponentsHubNotificationsNotificationUtils"),function(e){Ye=t[e]={};const s={[Se.ErrorCodes.AssignedExtensionFailed]:!0,[Se.ErrorCodes.MemberAlreadyInProject]:!0,[Se.ErrorCodes.SkippedAddInvalidGroup]:!0,[Se.ErrorCodes.NotEnoughExtensionLicenses]:!0,[Se.ErrorCodes.BuildUserEntitlementFailed]:!0,[Se.ErrorCodes.BuildGroupEntitlementFailed]:!0};t[e].PatchResponseUtils=class{static hasFailedOperation(e){return e.some((e=>void 0!==e&&!e.isSuccess))}static containsErrors(e){return e.some((e=>!s[e.key]))}static getStatus(e,t){if(t)return 0;if(!e)return 3;if(e.isSuccess)return 2;if(e.errors)for(const t of e.errors)if(!s[t.key])return 0;return 1}}}("UtilsPatchResponseUtils"),function(e){Ze=t[e]={};t[e].PatchResponseStatusNotification=class{constructor(e,t){this.results=e,this.handledError=t,this.summarized=this.summarizeItems(e,t);let s=3,n=!1;for(const[e]of this.summarized)e<s&&(s=e),3===e&&(n=!0);let r="Success";switch(s){case 0:r="Failed";break;case 1:r="Warning";break;case 3:r="Canceled";break;default:n&&(r="Warning")}this.statusType=r}summarizeItems(e,t){const s=[[0,[]],[1,[]],[2,[]],[3,[]]];return e.forEach((e=>{const[n]=e,r=Ye.PatchResponseUtils.getStatus(n,t),[,i]=s[r];i.push(e)})),s.filter((e=>e[1].length>0))}}}("ComponentsHubNotificationsPatchResponseNotifications"),function(e){t[e]={};t[e].UserHubPageCommon=class{static getSingleSelectedMember(e,t){if(!e)return;const s=t.value[0];return s?e[s.beginIndex]:void 0}static getMultiSelectedMember(e,t){if(!e)return;const s=[];for(const n of t.value)for(let t=n.beginIndex;t<=n.endIndex;++t)s.push(e[t]);return s}}}("ComponentsHubUserHubPageCommon"),t.ContextCommandContext={},function(e){Xe=t[e]={};class s{static createFilterPropertyString(e,t){if(t&&0!==t.length)return e+" eq '"+t.join(",")+"'"}static matchMap(e,t){for(const s in e)if(e[s]&&!t[s])return!1;for(const s in t)if(t[s]&&!e[s])return!1;return!0}}class n{constructor(e){this.filterState=e,this.AssignmentSourceEnumToString={2:"GroupRule",0:"None",1:"Unknown"},this.filterItems=n.getFilterItems(e)}static getFilterItems(e){switch(e){case 1:case 2:return[e];case 0:return[1,2]}return[]}get isActive(){return void 0!==this.filterState&&0!==this.filterState}matches(e){const t=e.accessLevel.assignmentSource;switch(this.filterState){case 1:return 0===t||1===t;case 2:return 2===t}return!0}get searchFilterClause(){if(!this.isActive)return;const e=`${Se.UserEntitlementFilterNames.AssignmentSource} eq`;let t="";switch(this.filterState){case 1:t=`(${e} '${this.AssignmentSourceEnumToString[0]}' or ${e} '${this.AssignmentSourceEnumToString[1]}')`;break;case 2:t=`${e} '${this.AssignmentSourceEnumToString[2]}'`;break;default:return}return t}get filterClause(){}clear(){return void 0!==this.filterState?new n(void 0):this}withFilter(e){let t;for(const s of e)switch(s){case 1:case 2:void 0===t?t=s:t!==s&&(t=0)}return t===this.filterState?this:new n(t)}}t[e].LicenseSourceFilter=n;class r{constructor(e,t){this.availableFilterItems=e,this.filteredKeys=t;const s=[];for(const e in this.filteredKeys)if(this.filteredKeys[e]){const t=this.availableFilterItems[e];t&&s.push(t)}this.filterItems=s}static getUserTypeFilterValue(e){switch(e){case 1:return Se.UserMetaType.Guest;case 3:return Se.UserMetaType.Application;case 4:return Se.UserMetaType.ManagedIdentity;default:return Se.UserMetaType.Member}}get isActive(){return(0,De.objectHasTruthyValue)(this.filteredKeys)&&Object.keys(this.filteredKeys).length!==Object.keys(this.availableFilterItems).length}matches(e){return this.filteredKeys[e.metaType]}get searchFilterClause(){if(!this.isActive)return;let e=[];for(const t of this.filteredUserTypes){let s=`${Se.UserEntitlementFilterNames.UserType} eq '${r.getUserTypeFilterValue(t)}'`;e=[...e,s]}return e.length>1?`(${e.join(" or ")})`:e[0]}get filteredUserTypes(){const e=[];for(const t in this.filteredKeys)if(this.filteredKeys[t]){const s=this.availableFilterItems[t];s&&e.push(s)}return e}get filterClause(){if(this.isActive)return s.createFilterPropertyString(Se.UserEntitlementFilterNames.LicenseId,this.filteredUserTypes.map((e=>r.getUserTypeFilterValue(e))))}clear(){return this.isActive?new r(this.availableFilterItems,{}):this}withFilter(e){for(const t of e){const e=r.getUserTypeFilterValue(t);this.availableFilterItems[e]||(this.availableFilterItems[e]=t)}const t={};for(const s of e)t[r.getUserTypeFilterValue(s)]=!0;return s.matchMap(t,this.filteredKeys)?this:new r(this.availableFilterItems,t)}}t[e].UserTypeFilter=r;class i{constructor(e){this.filter=i.getFilterValue(e)}static getFilterValue(e){return e&&e.trim()||void 0}get isActive(){return!!this.filter}matches(e){return!!this.filter&&e.displayNameMatchString.indexOf(this.filter.toLocaleLowerCase())>-1}get searchFilterClause(){const e=this.filter&&this.filter.replace("'","''");if(e)return`${Se.UserEntitlementFilterNames.Name} eq '${e}'`}get filterClause(){const e=this.filter&&this.filter.replace("'","\\'");return s.createFilterPropertyString(Se.UserEntitlementFilterNames.Name,e?[e]:void 0)}clear(){return this.isActive?new i:this}withFilter(e){const t=i.getFilterValue(e);return t!==this.filter?new i(t):this}}t[e].MemberNameFilter=i;class a{constructor(e,t,s){this.disabled=s,this.genericAccessLevel=Le.AccessLevels.fromLicenseSummaryData(e),this.key=a.getKey(this.genericAccessLevel,s),this.displayName=t+(this.disabled?` (${he.AccessLevel_Invalid})`:""),this.licenseId=Le.AccessLevels.getLicenseId(this.genericAccessLevel)}static getKey(e,t){return Le.AccessLevels.getLicenseKey(e)+(t?"!":"")}filterValueEquals(e,t){const s=Le.AccessLevels.fromLicenseSummaryData(e);return Le.AccessLevels.equals(s,this.genericAccessLevel)&&t===this.disabled}}t[e].MemberAccessLevelFilterItem=a;class o{constructor(e,t){this.availableFilterItems=e,this.filteredKeys=t;const s=[];for(const e in this.filteredKeys)if(this.filteredKeys[e]){const t=this.availableFilterItems[e];t&&s.push(t)}this.filterItems=s}static getMemberAccessLevelKey(e){const t=Le.AccessLevels.getLicenseKey(e.accessLevel),{status:s}=e.accessLevel;return 1===s||4===s||5===s?t:t+"!"}get isActive(){return(0,De.objectHasTruthyValue)(this.filteredKeys)}matches(e){return!!this.filteredKeys[o.getMemberAccessLevelKey(e)]}get searchFilterClause(){let e=[];for(const t of this.filteredMemberAccessLevelItem){let s=`${Se.UserEntitlementFilterNames.LicenseId} eq '${t.licenseId}'`;t.disabled&&(s=`(${s} and ${Se.UserEntitlementFilterNames.LicenseStatus} eq 'Disabled')`),e=[...e,s]}return e.length>1?`(${e.join(" or ")})`:e[0]}get filterClause(){if(this.isActive)return s.createFilterPropertyString(Se.UserEntitlementFilterNames.LicenseId,this.filteredMemberAccessLevelItem.map((e=>e.licenseId)))}get filteredMemberAccessLevelItem(){const e=[];for(const t in this.filteredKeys)if(this.filteredKeys[t]){const s=this.availableFilterItems[t];s&&e.push(s)}return e}clear(){return this.isActive?new o(this.availableFilterItems,{}):this}withFilter(e){for(const t of e){const e=t.key;this.availableFilterItems[e]||(this.availableFilterItems[e]=t)}const t={};for(const s of e)t[s.key]=!0;return s.matchMap(t,this.filteredKeys)?this:new o(this.availableFilterItems,t)}}function l(e){return e.filter((e=>!!e)).map((e=>e)).join(" and ")}function c(e){return 1===e?"Descending":"Ascending"}t[e].MemberAccessLevelsFilter=o,t[e].createSearchFilterString=function(e,t,s,n){return l([t.searchFilterClause,s&&s.searchFilterClause,e.searchFilterClause,n&&n.searchFilterClause])},t[e].createFilterString=function(e,t,s){return l([t.filterClause,s&&s.filterClause,e.filterClause])},t[e].getSortOrderString=c,t[e].createSortString=function(e,t){return function(e){switch(e){case"dateAdded":return Se.UserEntitlementSortColumns.DateCreated;case"lastAccessDate":return Se.UserEntitlementSortColumns.LastAccessed;default:return Se.UserEntitlementSortColumns.Name}}(e)+" "+c(t)}}("ModelsUserManagementFilters"),function(e){et=t[e]={},t[e].membersContextFilterStateIsActive=function(e){return e.nameFilter.isActive||e.accessLevelsFilter.isActive||!!e.userTypeFilter&&e.userTypeFilter.isActive||!!e.licenseSourceFilter&&e.licenseSourceFilter.isActive},t[e].useRefreshableMembersFetcherAndStore=function(e,t){const[[s,n],r]=(0,w.useAsyncDependentState)((()=>[e(),new k.CollectionDataStore((e=>e.id))]),t);return[s,n,i.useCallback((()=>{r([e(),new k.CollectionDataStore((e=>e.id))])}),[e,r])]},t[e].useMembersFetcher=function(e,t){const{value:s,isDone:n,fetchNext:r,upsert:i,deleteItems:a}=(0,R.useContinuationTokenCollectionDataIterator)(e,t);return{value:s,upsert:i,deleteItems:a,isDone:n,fetchNext:r}},t[e].useMembersFilter=function(e){const[t,n]=i.useState(e);return{filterState:t,setAccessLevelsFilter:i.useCallback((e=>{n((t=>new s(t).withAccessLevelFilter(e).build()))}),[n]),setUserTypesFilter:i.useCallback((e=>{n((t=>new s(t).withUserTypeFilter(e).build()))}),[n]),setLicenseSourcesFilter:i.useCallback((e=>{n((t=>new s(t).withLicenseSourceFilter(e).build()))}),[n]),setNameFilter:i.useCallback((e=>{n((t=>new s(t).withNameFilter(e).build()))}),[n])}};class s{constructor(e){this.filterState=e,this.nextFilterState=Object.assign({},e)}static getAvailableAccessLevelFilters(e,t){const s=[];return e.forEach((e=>{t?(e.assigned>=0&&s.push(new Xe.MemberAccessLevelFilterItem(e,e.licenseName,!1)),e.disabled>0&&s.push(new Xe.MemberAccessLevelFilterItem(e,e.licenseName,!0))):(e.assigned>=0||e.disabled>0)&&s.push(new Xe.MemberAccessLevelFilterItem(e,e.licenseName,!1))})),s}withAccessLevelFilter(e,t=!1){const s=this.nextFilterState.accessLevelsFilter.withFilter(e);return this.nextFilterState.accessLevelsFilter=s,t&&(this.nextFilterState.nameFilter=this.nextFilterState.nameFilter.clear(),this.nextFilterState.userTypeFilter&&(this.nextFilterState.userTypeFilter=this.nextFilterState.userTypeFilter.clear()),this.nextFilterState.licenseSourceFilter&&(this.nextFilterState.licenseSourceFilter=this.nextFilterState.licenseSourceFilter.clear())),this}withNameFilter(e,t=!1){const s=this.nextFilterState.nameFilter.withFilter(e);return this.nextFilterState.nameFilter=s,t&&(this.nextFilterState.accessLevelsFilter=this.nextFilterState.accessLevelsFilter.clear(),this.nextFilterState.userTypeFilter&&(this.nextFilterState.userTypeFilter=this.nextFilterState.userTypeFilter.clear())),this}withUserTypeFilter(e){const t=this.nextFilterState.userTypeFilter&&this.nextFilterState.userTypeFilter.withFilter(e);return this.nextFilterState.userTypeFilter=t,this}withLicenseSourceFilter(e){const t=this.nextFilterState.licenseSourceFilter&&this.nextFilterState.licenseSourceFilter.withFilter(e);return this.nextFilterState.licenseSourceFilter=t,this}build(){return this.nextFilterState.accessLevelsFilter===this.filterState.accessLevelsFilter&&this.nextFilterState.nameFilter===this.filterState.nameFilter&&this.nextFilterState.userTypeFilter===this.filterState.userTypeFilter&&this.nextFilterState.licenseSourceFilter===this.filterState.licenseSourceFilter?this.filterState:this.nextFilterState}}t[e].MemberFilterStateBuilder=s}("ContextMembersContext"),function(e){tt=t[e]={};class s{static getAllMembers(e,t){const s=[];for(const n of e){const e=t[n.id];e?s.push(e):!1===e||s.push(n)}return s}static filterAndSort(e,t,s,n,r){let i=t?n(e,t):e;return i=s&&i?r(i,s):i,i}static getFilteredMembers(e,t){if(!t)return e;let s=e;const{nameFilter:n,accessLevelsFilter:r}=t;return n.isActive&&(s=s.filter((e=>!e||n.matches(e)))),r.isActive&&(s=s.filter((e=>!e||r.matches(e)))),s}static getSortedMembers(e,t,s){const{sortByKey:n,sortOrder:r}=t,i=[...e];return i.sort(((e,t)=>void 0===e?-1:void 0===t?1:s(e,t,n,0===r?1:-1))),i}}t[e].MembersClientContextProviderUtils=s,t[e].useMembersClientContextProvider=function(e,t,n,r,a){const{filterState:o,setAccessLevelsFilter:l,setNameFilter:c,setUserTypesFilter:u,setLicenseSourcesFilter:m}=(0,et.useMembersFilter)(n),[d,p]=i.useState({sortByKey:"displayName",sortOrder:0}),[g,b]=(0,w.useAsyncDependentState)(void 0,[e]),{isDone:C,fetchNext:v,value:h,upsert:f,deleteItems:S}=(0,et.useMembersFetcher)(e,t),y=(0,ye.useUserHubContext)(),E=i.useCallback((e=>{y.telemetry.trackException(e,"useMembersClientContextProvider.fetchAllMembers"),b(e)}),[y.telemetry]);(0,R.useContinuationTokenCollectionDataIteratorAutoLoadingEffect)(C||!!g,v,E);const A=i.useMemo((()=>s.filterAndSort(h,o,d,r,a)),[r,a,h,o,d]),x=i.useContext(xe.UsersSummaryContext);return{isDone:C,upsert:f,deleteItems:S,availableAccessLevelFilters:i.useMemo((()=>x.licenses&&et.MemberFilterStateBuilder.getAvailableAccessLevelFilters(x.licenses,!0)),[x.licenses]),allMembers:h,filterState:o,sortState:d,displayMembers:A,setAccessLevelsFilter:l,setLicenseSourcesFilter:m,setNameFilter:c,setUserTypesFilter:u,setSort:p,fetchError:g}}}("ContextMembersContextClient"),function(e){st=t[e]={};class s{static async fetchGroupsList(e){const t=e.getRestClient(Ae.MemberEntitlementManagementClientName);return(await t.getGroupEntitlements()).map((e=>new Ge.Group(e)))}static sortGroupsList(e,t){return tt.MembersClientContextProviderUtils.getSortedMembers(e,t,Ge.Group.groupSortComparisonFunction)}}t[e].GroupsContext=i.createContext(void 0);class n{constructor(e){this.client=(0,Ae.getMemberEntitlementManagementClient)(e.pageContext)}async next(){return{done:!0,value:[(await this.client.getGroupEntitlements()).map((e=>new Ge.Group(e)))]}}}t[e].GroupsContextProvider=function(r){const a=(0,ye.useUserHubContext)(),[o,l,c]=(0,et.useRefreshableMembersFetcherAndStore)((()=>new n(a)),[a]),u=(0,tt.useMembersClientContextProvider)(o,l,{nameFilter:new Xe.MemberNameFilter,accessLevelsFilter:new Xe.MemberAccessLevelsFilter({},{})},tt.MembersClientContextProviderUtils.getFilteredMembers,s.sortGroupsList),{isDone:m,upsert:d,deleteItems:p}=u,g=i.useCallback((async e=>{const t=a.getRestClient(Ae.MemberEntitlementManagementClientName),s=await t.getGroupEntitlement(e),n=new Ge.Group(s);return d([n]),n}),[d,a]),b={availableAccessLevelFilters:u.availableAccessLevelFilters,allMembers:u.allMembers,refreshMembersList:c,displayMembers:u.displayMembers,fetchError:u.fetchError,filterState:u.filterState,sortState:u.sortState,setAccessLevelsFilter:u.setAccessLevelsFilter,setNameFilter:u.setNameFilter,setUserTypesFilter:u.setUserTypesFilter,setLicenseSourcesFilter:u.setLicenseSourcesFilter,setSort:u.setSort,isFetchDone:m,refreshGroup:g,upsert:d,deleteMembers:p};return i.createElement(t[e].GroupsContext.Provider,{value:b},r.children)}}("ContextGroupsContext"),function(e){nt=t[e]={};class s extends m.RestClientBase{constructor(e){super(e)}async exportUsersToCSV(){return this.beginRequest({apiVersion:"5.0-preview.1",httpResponseType:"text/csv",routeTemplate:"_apis/MEMInternal/Export"})}async getUserEntitlements(e,t){const s={select:t};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/GetMemberEntitlementsBatch",queryParams:s,body:e})}async reApplyAllGroupEntitlementsToUsers(e){const t={ruleOption:e};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/MEMInternal/GroupEntitlementUserApplication",queryParams:t})}async removeExplicitAssignments(e,t,s){const n={select:t,ruleOption:s};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/MEMInternal/RemoveExplicitAssignment",queryParams:n,body:e})}async getUsersSummary(e){const t={select:e};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/MEMInternal/UserManagementSummary",queryParams:t})}}t[e].MEMInternalClientName="AexMEMInternal.IMEMInternalRestClient",t[e].getMEMInternalClient=function(s,n){return s.getRestClient(t[e].MEMInternalClientName,n)},u.RestClients.add(t[e].MEMInternalClientName,{factory:s,options:{resourceAreaId:"6d1800d2-db34-4956-88b4-fad14617d011",serviceInstanceType:"00000041-0000-8888-8000-000000000000"}})}("RestClientMEMInternal"),function(e){rt=t[e]={};class s extends m.RestClientBase{constructor(e){super(e)}async addGroupEntitlement(e,t){const s={ruleOption:t};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/GroupEntitlements/{groupId}",queryParams:s,body:e})}async deleteGroupEntitlement(e,t,s){const n={ruleOption:t,removeGroupMembership:s};return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"_apis/GroupEntitlements/{groupId}",routeValues:{groupId:e},queryParams:n})}async getGroupEntitlement(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/GroupEntitlements/{groupId}",routeValues:{groupId:e}})}async updateGroupEntitlement(e,t,s){const n={ruleOption:s};return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"_apis/GroupEntitlements/{groupId}",routeValues:{groupId:t},customHeaders:{"Content-Type":"application/json-patch+json"},queryParams:n,body:e})}async getGroupEntitlements(){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/GroupEntitlements/{groupDescriptor}"})}async addMemberEntitlement(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/MemberEntitlements/{memberId}",body:e})}async deleteMemberEntitlement(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"_apis/MemberEntitlements/{memberId}",routeValues:{memberId:e}})}async getMemberEntitlement(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/MemberEntitlements/{memberId}",routeValues:{memberId:e}})}async getMemberEntitlements(e,t,s,n){const r={top:e,skip:t,filter:s,select:n};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/MemberEntitlements/{memberId}",queryParams:r})}async updateMemberEntitlement(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"_apis/MemberEntitlements/{memberId}",routeValues:{memberId:t},customHeaders:{"Content-Type":"application/json-patch+json"},body:e})}async updateMemberEntitlements(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"_apis/MemberEntitlements/{memberId}",customHeaders:{"Content-Type":"application/json-patch+json"},body:e})}async addMemberToGroup(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PUT",routeTemplate:"_apis/GroupEntitlements/{groupId}/Members/{memberId}",routeValues:{groupId:e,memberId:t}})}async getGroupMembers(e,t,s){const n={maxResults:t,pagingToken:s};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/GroupEntitlements/{groupId}/Members/{memberId}",routeValues:{groupId:e},queryParams:n})}async removeMemberFromGroup(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"_apis/GroupEntitlements/{groupId}/Members/{memberId}",routeValues:{groupId:e,memberId:t}})}async addUserEntitlement(e){return this.beginRequest({apiVersion:"5.0-preview.2",method:"POST",routeTemplate:"_apis/UserEntitlements/{userDescriptor}",body:e})}async getUserEntitlements(e,t,s,n){const r={top:e,skip:t,filter:s,sortOption:n};return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"_apis/UserEntitlements/{userDescriptor}",queryParams:r})}async updateUserEntitlements(e,t){const s={doNotSendInviteForNewUsers:t};return this.beginRequest({apiVersion:"5.0-preview.2",method:"PATCH",routeTemplate:"_apis/UserEntitlements/{userDescriptor}",customHeaders:{"Content-Type":"application/json-patch+json"},queryParams:s,body:e})}async deleteUserEntitlement(e){return this.beginRequest({apiVersion:"5.0-preview.2",method:"DELETE",routeTemplate:"_apis/UserEntitlements/{userId}",routeValues:{userId:e}})}async getUserEntitlement(e){return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"_apis/UserEntitlements/{userId}",routeValues:{userId:e}})}async updateUserEntitlement(e,t){return this.beginRequest({apiVersion:"5.0-preview.2",method:"PATCH",routeTemplate:"_apis/UserEntitlements/{userId}",routeValues:{userId:t},customHeaders:{"Content-Type":"application/json-patch+json"},body:e})}async getUsersSummary(e){const t={select:e};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/UserEntitlementSummary",queryParams:t})}}t[e].MemberEntitlementManagementClientName="AexMemberEntitlementManagementLegacy.IMemberEntitlementManagementRestClient",t[e].getMemberEntitlementManagementClient=function(s,n){return s.getRestClient(t[e].MemberEntitlementManagementClientName,n)},u.RestClients.add(t[e].MemberEntitlementManagementClientName,{factory:s,options:{resourceAreaId:"68ddce18-2501-45f1-a17b-7931a9922690"}})}("RestClientLegacyMemberEntitlementManagement"),function(e){it=t[e]={};class s{static getUsers(e){return e.filter((e=>e&&!Ye.PatchResponseUtils.containsErrors(e.errors))).map((e=>new Ke.User(e.result)))}static async refreshUsers(e,t,s,n){const r=e.getRestClient(nt.MEMInternalClientName);let i=0;const a=t.bulkMaxBatchSize;let o=[];for(;i<s.length;){const e=s.slice(i,i+a);o=o.concat(r.getUserEntitlements(e,n&&n.join(","))),i+=a}const l=await Promise.all(o),c=[];return l.forEach((e=>{e.forEach((e=>{c.push(new Ke.User(e))}))})),c}static exportUsers(e){const t=e.getServiceLocation("00000041-0000-8888-8000-000000000000",4);window.open(t+"/_apis/MEMInternal/Export?api-version=3.1-preview")}static async removeDirectAssignments(e,t,s){const n=e.getRestClient(nt.MEMInternalClientName);return(await n.removeExplicitAssignments(t,Se.UserEntitlementPropertyNames.GroupRules,s)).map((e=>new Ke.User(e)))}static toUsers(e){return e.filter((e=>!!e)).map((e=>new Ke.User(e)))}static getInitialFilterState(e){const t={};return t[Se.UserMetaType.Guest]=1,t[Se.UserMetaType.Member]=2,e&&(t[Se.UserMetaType.Application]=3,t[Se.UserMetaType.ManagedIdentity]=4),{nameFilter:new Xe.MemberNameFilter,accessLevelsFilter:new Xe.MemberAccessLevelsFilter({},{}),userTypeFilter:new Xe.UserTypeFilter(t,{}),licenseSourceFilter:new Xe.LicenseSourceFilter(void 0)}}static addUsersToCollection(e,t,s,n){const r=new we.BulkEditMemberEntitlementJsonDocumentBuilder;for(const e of s)r.addMemberEntitlement(e);const[i,a]=r.build();return(0,we.processBulkUserActions)(e,t,i,a,n)}static addServicePrincipalsToCollection(e,t,s){const n=new we.BulkEditMemberEntitlementJsonDocumentBuilder;for(const e of s)n.addMemberEntitlement(e);const[r,i]=n.build();return(0,we.processBulkServicePrincipalActions)(e,t,r,i)}static executeBulkServicePrincipalActions(e,t,s,n){const r=new we.BulkEditMemberEntitlementJsonDocumentBuilder;for(const e of n)if(4===s)r.removeMemberEntitlement(e);const[i,a]=r.build();return(0,we.processBulkServicePrincipalActions)(e,t,i,a)}}t[e].UsersContextUtils=s;t[e].UsersFetcher=class{constructor(e,t,s,n){if(this.pageContextService=e,this.userHubConfiguration=t,this.getUsersPageCounter=0,this.total=0,this.client=(0,Ae.getMemberEntitlementManagementClient)(e.pageContext),this.firstPageSize=t.getUsersFirstPageSize,this.pageSize=t.getUsersPageSize,s){const{nameFilter:e,accessLevelsFilter:n,userTypeFilter:r,licenseSourceFilter:i}=s;this.filterString=t.useUpdatedSearchQuery&&t.shouldUseSearchApis?(0,Xe.createSearchFilterString)(e,n,r,i):(0,Xe.createFilterString)(e,n,r)}n&&(this.sortString=(0,Xe.createSortString)(n.sortByKey,n.sortOrder))}async next(e){const t=!e&&0===this.total;t?this.pageContextService.telemetry.startTrackEvent(Se.PerformanceScenarioConstants.GetUsersFirstFeatureName):this.pageContextService.telemetry.startTrackEvent(Se.PerformanceScenarioConstants.GetAllUsersFeatureName);const n=await(this.userHubConfiguration.supportServicePrincipals?this.client.searchMemberEntitlements(e,void 0,this.filterString,this.sortString):this.client.searchUserEntitlements(e,void 0,this.filterString,this.sortString));t?this.pageContextService.telemetry.stopTrackEvent(Se.PerformanceScenarioConstants.GetUsersFirstFeatureName,{},{"First Page Size":this.firstPageSize}):this.pageContextService.telemetry.stopTrackEvent(Se.PerformanceScenarioConstants.GetAllUsersFeatureName,{ConinuationToken:e||""},{"Page Size":this.pageSize,["Page "+ ++this.getUsersPageCounter]:window.performance.now()});const{continuationToken:r,totalCount:i}=n,a=n.items;return this.total+=a.length,r?{done:!1,value:[s.toUsers(a),r,[i]]}:{done:!0,value:[s.toUsers(a)]}}};t[e].LegacyUsersFetcher=class{constructor(e,t,s,n){if(this.pageContextService=e,this.getUsersPageCounter=0,this.client=(0,rt.getMemberEntitlementManagementClient)(e.pageContext),this.firstPageSize=t.shouldUseServerSideSearch?t.getUsersFirstPageSizeServerSideSearch:t.getUsersFirstPageSize,this.pageSize=t.shouldUseServerSideSearch?t.getUsersPageSizeServerSideSearch:t.getUsersPageSize,s){const{nameFilter:e,accessLevelsFilter:n,userTypeFilter:r,licenseSourceFilter:i}=s;this.filterString=t.useUpdatedSearchQuery&&t.shouldUseSearchApis?(0,Xe.createSearchFilterString)(e,n,r,i):(0,Xe.createFilterString)(e,n,r)}n&&(this.sortString=(0,Xe.createSortString)(n.sortByKey,n.sortOrder))}async next(e=0){const t=0===e?this.firstPageSize:this.pageSize;let n;0===e?(this.pageContextService.telemetry.startTrackEvent(Se.PerformanceScenarioConstants.GetUsersFirstFeatureName),n=await this.client.getUserEntitlements(t,e,this.filterString,this.sortString),this.pageContextService.telemetry.stopTrackEvent(Se.PerformanceScenarioConstants.GetUsersFirstFeatureName,{},{"First Page Size":this.firstPageSize})):(this.pageContextService.telemetry.startTrackEvent(Se.PerformanceScenarioConstants.GetAllUsersFeatureName),n=await this.client.getUserEntitlements(t,e,this.filterString,this.sortString),this.pageContextService.telemetry.stopTrackEvent(Se.PerformanceScenarioConstants.GetAllUsersFeatureName,{},{"Page Size":this.pageSize,["Page "+ ++this.getUsersPageCounter]:window.performance.now()}));const{members:r,totalCount:i}=n;return r.length<t?{done:!0,value:[s.toUsers(r)]}:{done:!1,value:[s.toUsers(r),e+t,[i]]}}},t[e].UsersContext=i.createContext({availableAccessLevelFilters:[],filterState:{nameFilter:new Xe.MemberNameFilter,accessLevelsFilter:new Xe.MemberAccessLevelsFilter({},{}),userTypeFilter:new Xe.UserTypeFilter({},{})},sortState:{sortByKey:"displayName",sortOrder:0},displayMembers:[],allMembers:[],isFetchDone:!1,refreshMembersList:()=>{},setAccessLevelsFilter:()=>{},setNameFilter:()=>{},setUserTypesFilter:()=>{},setLicenseSourcesFilter:()=>{},setSort:()=>{},upsert:()=>{},deleteMembers:()=>{},exportUsers:()=>{},refreshUsers:()=>Promise.resolve([])}),t[e].useUsersContextApiActions=function(){const n=(0,ye.useUserHubContext)(),r=(0,ye.useUserHubConfiguration)(),a=i.useContext(t[e].UsersContext),o=i.useContext(xe.UsersSummaryContext);return{addUsersToCollection:i.useCallback((async(e,t)=>{const i=await s.addUsersToCollection(n,r,e,t),l=i.filter((([e])=>e&&!Ye.PatchResponseUtils.containsErrors(e.errors))).map((([e])=>new Ke.User(e.result)));return l.length>0&&(a.upsert(l),o.refresh("licenses")),i}),[n,r,a.upsert,o.refresh]),addServicePrincipalsToCollection:i.useCallback((async e=>{const t=await s.addServicePrincipalsToCollection(n,r,e),i=t.filter((([e])=>e&&!Ye.PatchResponseUtils.containsErrors(e.errors))).map((([e])=>new Ke.User(e.result)));return i.length>0&&(a.upsert(i),o.refresh("licenses")),t}),[n,r,a.upsert,o.refresh]),removeUsers:i.useCallback((async e=>{const t=new we.BulkEditMemberEntitlementJsonDocumentBuilder;for(const s of e)t.removeMemberEntitlement(s);const[s,i]=t.build(),l=await(0,we.processBulkUserActions)(n,r,s,i),c=l.filter((([e])=>e&&e.isSuccess)).map((([e])=>e.userId));return c.length>0&&(a.deleteMembers(c),o.refresh("licenses")),l}),[n,r,o.refresh,a.deleteMembers]),removeServicePrincipals:i.useCallback((async e=>{const t=await s.executeBulkServicePrincipalActions(n,r,4,e),i=t.filter((([e])=>e&&e.isSuccess)).map((([e])=>e.servicePrincipalId));return i.length>0&&(a.deleteMembers(i),o.refresh("licenses")),t}),[n,r,o.refresh,a.deleteMembers]),bulkChangeUserAccessLevel:i.useCallback((async(e,t)=>{const s=new we.BulkEditMemberEntitlementJsonDocumentBuilder;for(const n of e)s.replaceAccessLevel(n,t);const[i,l]=s.build(),c=await(0,we.processBulkUserActions)(n,r,i,l),u=e.map((e=>e.id));return a.refreshUsers(u),o.refresh("licenses"),c}),[n,r,a.refreshUsers,o.refresh]),bulkChangeServicePrincipalAccessLevel:i.useCallback((async(e,t)=>{const s=new we.BulkEditMemberEntitlementJsonDocumentBuilder;for(const n of e)s.replaceAccessLevel(n,t);const[i,l]=s.build(),c=await(0,we.processBulkServicePrincipalActions)(n,r,i,l),u=e.map((e=>e.id));return a.refreshUsers(u),o.refresh("licenses"),c}),[n,r,a.refreshUsers,o.refresh]),addUsersToProjects:i.useCallback((async(e,t,s)=>{const i=new we.BulkEditMemberEntitlementJsonDocumentBuilder;for(const n of e)for(const e of t)i.addToProject(n,e,s);const[a,o]=i.build();return await(0,we.processBulkUserActions)(n,r,a,o)}),[n,r]),removeUsersFromProjects:i.useCallback((async(e,t)=>{const s=new we.BulkEditMemberEntitlementJsonDocumentBuilder;for(const n of e)for(const e of t)s.removeFromProject(n,e);const[i,a]=s.build();return await(0,we.processBulkUserActions)(n,r,i,a)}),[n,r]),addServicePrincipalsToProjects:i.useCallback((async(e,t,s)=>{const i=new we.BulkEditMemberEntitlementJsonDocumentBuilder;for(const n of e)for(const e of t)i.addToProject(n,e,s);const[a,o]=i.build();return await(0,we.processBulkServicePrincipalActions)(n,r,a,o)}),[n,r]),removeServicePrincipalsFromProjects:i.useCallback((async(e,t)=>{const s=new we.BulkEditMemberEntitlementJsonDocumentBuilder;for(const n of e)for(const e of t)s.removeFromProject(n,e);const[i,a]=s.build();return await(0,we.processBulkServicePrincipalActions)(n,r,i,a)}),[n,r]),removeDirectAssignments:i.useCallback((async(e,t)=>{const s=(0,nt.getMEMInternalClient)(n.pageContext),r=(await s.removeExplicitAssignments(e,Se.UserEntitlementPropertyNames.GroupRules,t)).map((e=>new Ke.User(e)));return 0===t&&r.length>0&&a.upsert(r),r}),[a.upsert,n.pageContext]),updateUser:i.useCallback((async(e,t,s)=>{const i=e.id,l=await(0,we.processSingleUserActions)(n,r,t,s,i);return a.refreshUsers([e.id]),o.refresh("licenses"),l}),[n,r,a.refreshUsers,o.refresh]),updateServicePrincipal:i.useCallback((async(e,t,s)=>{const i=e.id,l=await(0,we.processSingleServicePrincipalActions)(n,r,t,s,i);return a.refreshUsers([e.id]),o.refresh("licenses"),l}),[n,r,a.refreshUsers,o.refresh]),reinstateAssets:i.useCallback((async e=>{const t=new we.SingleUserEntitlementJsonDocumentBuilder;t.reinstateAssets();const[s,i]=t.build(),o=e.id,l=await(0,we.processSingleUserActions)(n,r,s,i,o);return a.refreshUsers([e.id]),l}),[n,r,a.refreshUsers])}}}("ContextUsersContext"),function(e){at=t[e]={},t[e].useGroupsContextApiActions=function(){const e=(0,ye.useUserHubContext)(),t=(0,ye.useUserHubConfiguration)(),s=i.useContext(it.UsersContext),n=i.useContext(xe.UsersSummaryContext),r=i.useContext(st.GroupsContext);return{addGroupRule:i.useCallback((async t=>{const i=(0,Ae.getMemberEntitlementManagementClient)(e.pageContext),a=await i.addGroupEntitlement(t),o=a.results&&a.results[0],l=o.result;if(o.isSuccess&&l){if(r){const e=new Ge.Group(l);r.upsert([e])}l.members&&l.members.length>0&&(s.refreshUsers(l.members.map((e=>e.id))),n.refresh("licenses"))}return[[o,[3,t]]]}),[e.pageContext,s.refreshUsers,n.refresh,r&&r.upsert]),updateGroupRule:i.useCallback((async(s,n,i)=>{const a=s.id,o=await(0,we.processSingleGroupActions)(e,t,n,i,a);return r&&r.refreshGroup(a),o}),[e,t,r&&r.refreshGroup]),deleteGroupRule:i.useCallback((async(t,s)=>{const n=e.getRestClient(Ae.MemberEntitlementManagementClientName),i=(await n.deleteGroupEntitlement(t.id,0,s)).results[0];return i.isSuccess&&r&&r.upsert([new Ge.Group(t.groupEntitlement,!0)]),i}),[e,r&&r.upsert])}}}("ContextuseGroupsContextApiActions"),t.GeneratedInterfaces={},function(e){ot=t[e]={};class s extends A.PeoplePickerProvider{constructor(e){super(e,{identityTypes:["group"]})}}t[e].GroupIdentityPickerProvider=s}("ModelsGroupIdentityPickerProvider"),function(e){lt=t[e]={},t[e].isOperationStatusCompleted=function(e){switch(e){case 3:case 5:case 4:case 0:return!0;default:return!1}}}("ModelsLicensingRuleApplicationStatus"),function(e){ct=t[e]={};t[e].ProjectEntitlements=class{static toProjectEntitlements(e,t){return e&&e.map((e=>({group:void 0===t?void 0:{groupType:t},projectRef:{id:e}})))}}}("ModelsProjectEntitlement"),function(e){ut=t[e]={};t[e].MemberEntitlementsList=class{static createMemberEntitlementList(e,t,s,n){const r=new fe.MemberEntitlements,i=s&&ct.ProjectEntitlements.toProjectEntitlements(s,n);for(const s of e)if(s.entityType===Se.DirectoryEntityType.ServicePrincipal){const e=this.buildServicePrincipalEntitlement(s,t,i);r.servicePrincipals.push(e)}else{const e=this.buildUserEntitlementsFromIdentities(s,t,i);r.users.push(e)}return r}static buildServicePrincipalEntitlement(e,t,s){const n=this.identityAlreadyExistsInCollection(e)?{displayName:e.entityId,principalName:e.entityId,subjectKind:Se.SubjectKind.ServicePrincipal}:{displayName:e.displayName,origin:e.originDirectory,originId:e.originId?e.originId:void 0,subjectKind:Se.SubjectKind.ServicePrincipal};return{accessLevel:t||void 0,id:e.localId?e.localId:void 0,projectEntitlements:s,servicePrincipal:n}}static buildUserEntitlementsFromIdentities(e,t,s){const n=this.identityAlreadyExistsInCollection(e)?{displayName:e.entityId,principalName:e.entityId,subjectKind:Se.SubjectKind.User}:{displayName:e.displayName,origin:e.originDirectory,originId:e.originId?e.originId:void 0,principalName:e.signInAddress,subjectKind:Se.SubjectKind.User};return{accessLevel:t,id:e.localId?e.localId:void 0,projectEntitlements:s,user:n}}static identityAlreadyExistsInCollection(e){return e instanceof Ne.AddIdentity}}}("ModelsMemberEntitlementsList"),function(e){mt=t[e]={};t[e].UserEntitlements=class{static buildUserEntitlements(e,t,s,n,r){const i=[];if(e)for(const t of e)switch(t.originDirectory){case Se.DirectoryName.VisualStudioDirectory:case Se.DirectoryName.AzureActiveDirectory:case Se.DirectoryName.GitHub:const e={displayName:t.displayName,origin:t.originDirectory,originId:t.originId,principalName:t.signInAddress,subjectKind:Se.SubjectKind.User};i.push({accessLevel:s,extensions:n&&n.map((e=>({id:e.extensionId,name:e.extensionName}))),id:t.localId||void 0,projectEntitlements:r,user:e})}if(t)for(const e of t){const t={principalName:e,subjectKind:Se.SubjectKind.User};i.push({accessLevel:s,extensions:n&&n.map((e=>({id:e.extensionId,name:e.extensionName}))),projectEntitlements:r,user:t})}return i}static buildUserEntitlementsFromIdentities(e,t,s){return e.map((e=>{if(e instanceof Ne.AddIdentity){const n={principalName:e.entityId,subjectKind:Se.SubjectKind.User};return{accessLevel:t,projectEntitlements:s,user:n}}{const n={displayName:e.displayName,origin:e.originDirectory,originId:e.originId,principalName:e.signInAddress,subjectKind:Se.SubjectKind.User};return{accessLevel:t,id:e.localId||void 0,projectEntitlements:s,user:n}}}))}}}("ModelsUserEntitlement"),function(e){dt=t[e]={};class s extends m.RestClientBase{constructor(e){super(e)}async setupDataImport(e){return this.beginRequest({apiVersion:"5.1-preview.1",method:"POST",routeTemplate:"{organizationId}/_apis/AzComm/AzCommDataImport",routeValues:{organizationId:e}})}async getAzureSubscriptionDetails(e,t,s){const n={organizationId:t,tenantId:s};return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/AzComm/AzureSubscription/{subscriptionId}",routeValues:{subscriptionId:e},queryParams:n})}async getAzureSubscriptionsForUser(e){const t={payload:e};return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/AzComm/AzureSubscription/{subscriptionId}",queryParams:t})}async getBillingInfo(e){return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"{organizationId}/_apis/AzComm/BillingSetup",routeValues:{organizationId:e}})}async removeBilling(e){return this.beginRequest({apiVersion:"5.1-preview.1",method:"DELETE",routeTemplate:"{organizationId}/_apis/AzComm/BillingSetup",routeValues:{organizationId:e}})}async setupBilling(e,t){return this.beginRequest({apiVersion:"5.1-preview.1",method:"PUT",routeTemplate:"{organizationId}/_apis/AzComm/BillingSetup",routeValues:{organizationId:t},body:e})}async updateBillingMode(e,t){return this.beginRequest({apiVersion:"5.1-preview.1",method:"PATCH",routeTemplate:"{organizationId}/_apis/AzComm/BillingSetup",routeValues:{organizationId:t},body:e})}async getDefaultLicenseType(e){return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"{organizationId}/_apis/AzComm/DefaultLicenseType",routeValues:{organizationId:e}})}async updateDefaultLicenseType(e,t){return this.beginRequest({apiVersion:"5.1-preview.1",method:"PUT",routeTemplate:"{organizationId}/_apis/AzComm/DefaultLicenseType",routeValues:{organizationId:t},body:e})}async getAllMeterResources(e){return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"{organizationId}/_apis/AzComm/MeterResource",routeValues:{organizationId:e}})}async updateMeterResource(e,t){return this.beginRequest({apiVersion:"5.1-preview.1",method:"PATCH",routeTemplate:"{organizationId}/_apis/AzComm/MeterResource",routeValues:{organizationId:t},body:e})}async getMeterUsage(e){const t={payload:e};return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/AzComm/MeterUsage",queryParams:t})}async reportUsage(e,t){const s={organizationId:t};return this.beginRequest({apiVersion:"5.1-preview.1",method:"POST",routeTemplate:"_apis/AzComm/MeterUsage",queryParams:s,body:e})}async getAllMeterUsages(e){return this.beginRequest({apiVersion:"5.1-preview.2",routeTemplate:"{organizationId}/_apis/AzComm/MeterUsage2/{meterId}",routeValues:{organizationId:e}})}async getSubscriptionInformation(e){return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/AzComm/Subscription/{subscriptionId}",routeValues:{subscriptionId:e}})}async getAllSubscriptionMeterResources(e){return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"{subscriptionId}/_apis/AzComm/SubscriptionMeterResource",routeValues:{subscriptionId:e}})}async updateSubscriptionMeterResource(e,t){return this.beginRequest({apiVersion:"5.1-preview.1",method:"PATCH",routeTemplate:"{subscriptionId}/_apis/AzComm/SubscriptionMeterResource",routeValues:{subscriptionId:t},body:e})}}t[e].AzCommClientName="AexAzComm.IAzCommRestClient",t[e].getAzCommClient=function(s,n){return s.getRestClient(t[e].AzCommClientName,n)},u.RestClients.add(t[e].AzCommClientName,{factory:s,options:{resourceAreaId:"ed1325fd-71e8-4623-89f3-485951654312"}})}("RestClientAzComm"),function(e){pt=t[e]={};class s extends m.RestClientBase{constructor(e){super(e)}async createConnectedService(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/projects/{projectId}/connectedServices/{name}",routeValues:{projectId:t},body:e})}async getConnectedServiceDetails(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/projects/{projectId}/connectedServices/{name}",routeValues:{projectId:e,name:t}})}async getConnectedServices(e,t){const s={kind:t};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/projects/{projectId}/connectedServices/{name}",routeValues:{projectId:e},queryParams:s})}async createIdentityMru(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/core/identityMru/{mruName}",routeValues:{mruName:t},body:e})}async deleteIdentityMru(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"_apis/core/identityMru/{mruName}",routeValues:{mruName:t}})}async getIdentityMru(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/core/identityMru/{mruName}",routeValues:{mruName:e}})}async updateIdentityMru(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"_apis/core/identityMru/{mruName}",routeValues:{mruName:t},body:e})}async getTeamMembersWithExtendedProperties(e,t,s,n){const r={$top:s,$skip:n};return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"_apis/projects/{projectId}/teams/{teamId}/members",routeValues:{projectId:e,teamId:t},queryParams:r})}async getProcessById(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/process/processes/{*processId}",routeValues:{processId:e}})}async getProcesses(){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/process/processes/{*processId}"})}async getProjectCollection(e){return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"_apis/projectCollections/{collectionId}",routeValues:{collectionId:e}})}async getProjectCollections(e,t){const s={$top:e,$skip:t};return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"_apis/projectCollections/{collectionId}",queryParams:s})}async getProjectHistoryEntries(e){const t={minRevision:e};return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"_apis/projectHistory",queryParams:t})}async getProject(e,t,s){const n={includeCapabilities:t,includeHistory:s};return this.beginRequest({apiVersion:"5.0-preview.4",routeTemplate:"_apis/projects/{*projectId}",routeValues:{projectId:e},queryParams:n})}async getProjects(e,t,s,n,r){const i={stateFilter:e,$top:t,$skip:s,continuationToken:n,getDefaultTeamImageUrl:r};return this.beginRequest({apiVersion:"5.0-preview.4",routeTemplate:"_apis/projects/{*projectId}",queryParams:i,returnRawResponse:!0}).then((async e=>{const t=await e.text().then(G.deserializeVssJsonObject);return t.continuationToken=e.headers.get("x-ms-continuationtoken"),t}))}async queueCreateProject(e){return this.beginRequest({apiVersion:"5.0-preview.4",method:"POST",routeTemplate:"_apis/projects/{*projectId}",body:e})}async queueDeleteProject(e){return this.beginRequest({apiVersion:"5.0-preview.4",method:"DELETE",routeTemplate:"_apis/projects/{*projectId}",routeValues:{projectId:e}})}async updateProject(e,t){return this.beginRequest({apiVersion:"5.0-preview.4",method:"PATCH",routeTemplate:"_apis/projects/{*projectId}",routeValues:{projectId:t},body:e})}async getProjectProperties(e,t){const s={keys:t&&t.join(",")};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/projects/{projectId}/properties",routeValues:{projectId:e},queryParams:s})}async setProjectProperties(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"_apis/projects/{projectId}/properties",routeValues:{projectId:e},customHeaders:{"Content-Type":"application/json-patch+json"},body:t})}async createOrUpdateProxy(e){return this.beginRequest({apiVersion:"5.0-preview.2",method:"PUT",routeTemplate:"_apis/proxies",body:e})}async deleteProxy(e,t){const s={proxyUrl:e,site:t};return this.beginRequest({apiVersion:"5.0-preview.2",method:"DELETE",routeTemplate:"_apis/proxies",queryParams:s})}async getProxies(e){const t={proxyUrl:e};return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"_apis/proxies",queryParams:t})}async createTeam(e,t){return this.beginRequest({apiVersion:"5.0-preview.2",method:"POST",routeTemplate:"_apis/projects/{projectId}/teams/{*teamId}",routeValues:{projectId:t},body:e})}async deleteTeam(e,t){return this.beginRequest({apiVersion:"5.0-preview.2",method:"DELETE",routeTemplate:"_apis/projects/{projectId}/teams/{*teamId}",routeValues:{projectId:e,teamId:t}})}async getTeam(e,t){return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"_apis/projects/{projectId}/teams/{*teamId}",routeValues:{projectId:e,teamId:t}})}async getTeams(e,t,s,n){const r={$mine:t,$top:s,$skip:n};return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"_apis/projects/{projectId}/teams/{*teamId}",routeValues:{projectId:e},queryParams:r})}async updateTeam(e,t,s){return this.beginRequest({apiVersion:"5.0-preview.2",method:"PATCH",routeTemplate:"_apis/projects/{projectId}/teams/{*teamId}",routeValues:{projectId:t,teamId:s},body:e})}async getAllTeams(e,t,s){const n={$mine:e,$top:t,$skip:s};return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"_apis/teams",queryParams:n})}}t[e].CoreClientName="AexUserHubCore.ICoreRestClient",t[e].getCoreClient=function(s,n){return s.getRestClient(t[e].CoreClientName,n)},u.RestClients.add(t[e].CoreClientName,{factory:s,options:{resourceAreaId:"79134c72-4a58-4b42-976c-04e7115f32bf",serviceInstanceType:"00025394-6065-48ca-87d9-7f5672854ef7"}})}("RestClientCore"),function(e){gt=t[e]={};class s extends m.RestClientBase{constructor(e){super(e)}async addGroupLicensingRule(e,t){const s={ruleOption:t};return this.beginRequest({apiVersion:"5.0-preview.1",method:"PUT",routeTemplate:"_apis/LicensingRule/GroupLicensingRules/{subjectDescriptor}",queryParams:s,body:e})}async deleteGroupLicenseRule(e,t){const s={ruleOption:t};return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"_apis/LicensingRule/GroupLicensingRules/{subjectDescriptor}",routeValues:{subjectDescriptor:e},queryParams:s})}async getGroupLicensingRule(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/LicensingRule/GroupLicensingRules/{subjectDescriptor}",routeValues:{subjectDescriptor:e}})}async getGroupLicensingRules(e,t){const s={top:e,skip:t};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/LicensingRule/GroupLicensingRules/{subjectDescriptor}",queryParams:s})}async updateGroupLicensingRule(e,t){const s={ruleOption:t};return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"_apis/LicensingRule/GroupLicensingRules/{subjectDescriptor}",queryParams:s,body:e})}async applyGroupLicensingRulesToAllUsers(e){const t={ruleOption:e};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/LicensingRule/GroupLicensingRulesApplication/",queryParams:t})}async getApplicationStatus(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/LicensingRule/GroupLicensingRulesApplicationStatus/{operationId}",routeValues:{operationId:e}})}async retrieveFile(e){const t={fileId:e};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/LicensingRule/GroupLicensingRulesEvaluationLog",queryParams:t})}async lookupGroupLicensingRules(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/LicensingRule/GroupLicensingRulesLookup/",body:e})}async applyGroupLicensingRulesToUser(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/LicensingRule/GroupLicensingRulesUserApplication/{userId}",routeValues:{userId:e}})}async removeDirectAssignment(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"_apis/LicensingRule/GroupLicensingRulesUserApplication/{userId}",routeValues:{userId:e}})}}t[e].LicensingRuleClientName="AexLicensingRule.ILicensingRuleRestClient",t[e].getLicensingRuleClient=function(s,n){return s.getRestClient(t[e].LicensingRuleClientName,n)},u.RestClients.add(t[e].LicensingRuleClientName,{factory:s})}("RestClientLicensingRule"),function(e){bt=t[e]={},t[e].toLocaleDateString=function(e,t){return!e||e.getTime()<0?t:e.toLocaleDateString()}}("UtilsDateUtils"),function(e){Ct=t[e]={},t[e].useSaveFocusElement=function(){const e=i.useRef(null);return[i.useCallback((t=>{t&&(e.current=t)}),[e]),()=>{try{e.current&&e.current.focus()}catch(e){}}]}}("UtilsFocusUtils"),function(e){function s(e){return`access-level-dropdown-item-${Le.AccessLevels.getLicenseKey(e)}`}vt=t[e]={},t[e].getAccessLevelDropdownItemClassName=s;class n{static selectionItemEquals(e,t){return Le.AccessLevels.equals(e.data,t)}static selectionOnGetValue(e){return e.data}}t[e].AccessLevelDropdown=function(e){const t=i.useContext(xe.UsersSummaryContext),r=e.availableAccessLevels||t.availableAccessLevels,a=i.useMemo((()=>r?r.map((e=>({id:Le.AccessLevels.getLicenseKey(e),text:e.licenseDisplayName,data:e,className:s(e)}))):[{id:"_loading",type:4}]),[r]),{selectedAccessLevel:o,onChange:l}=e,c=i.useCallback((e=>{void 0!==e&&l(e)}),[l]),[u,m]=(0,g.useSingleSelectedItem)(a,o,c,n.selectionItemEquals,n.selectionOnGetValue),d=(0,g.useSelectionFactory)((()=>new E.DropdownSelection),u,m);return i.createElement(f.FormItem,{className:Te.L2ClassNames.formItems.accessLevelsDropdown,label:e.label},i.createElement(h.Dropdown,{className:"access-level-dropdown",calloutContentClassName:Te.L2ClassNames.dropdowns.accessLevel.callout,items:a,loading:void 0===r,disabled:e.disabled||0===a.length,selection:d}))}}("ComponentsControlsAccessLevelDropdown"),function(e){ht=t[e]={};class s extends i.Component{static getStyle(){return(0,y.css)(I.FlexClassNames.alignSelfStretch,j.CssClassNames.border.top.style.solid,j.CssClassNames.border.top.width1,(0,B.getColorClassName)("neutral",8,"border-top-color"))}render(){return i.createElement("div",{className:s.getStyle()})}}__decorate([a.memoize],s,"getStyle",null),t[e].FlexDividerCell=s}("ComponentsControlsFlexDividerCell"),function(e){ft=t[e]={};class s{static getStyles(){return{labelContainer:(0,y.css)(I.FlexClassNames.flexRow,I.FlexClassNames.alignItemsCenter,(0,C.getSpacingContainerClassName)("x",8)),statusMessage:(0,C.getSpacingContainerClassName)("y",8),tooltipContainer:I.FlexClassNames.alignSelfCenter}}}__decorate([a.memoize],s,"getStyles",null),t[e].AccessLevelDropdownWithGroupAssignmentsInternal=s,t[e].AccessLevelDropdownWithGroupAssignments=function(e){const{groupAssignments:t,selectedAccessLevel:n,disabled:r}=e,a=!!n&&1!==n.status&&!!n.statusMessage,o=!!n&&2===n.assignmentSource,l=o&&t&&t.length>0&&n?t.filter((e=>Le.AccessLevels.compareByPermission(n,e.accessLevel)>=0)):void 0,c=a||o,u=o&&(e.memberPromiseFulfilled?l&&l.length>0&&n&&5!==n.accountLicenseType:n&&5!==n.accountLicenseType&&1!==n.msdnLicenseType),m=s.getStyles(),d=c?i.createElement("div",{className:m.labelContainer},i.createElement("div",null,e.label),(a&&n||o)&&i.createElement("div",{className:m.tooltipContainer},i.createElement(P.Icon,{className:(0,y.css)(Te.L2ClassNames.EditItems.accessLevelInfoIcon),iconName:n&&a&&2!==n.licensingSource&&1!==n.msdnLicenseType?"Warning":"Info",ariaLabel:he.AccessLevelIcon_HoverInfoLabel,tabIndex:0,tooltipProps:{renderContent:()=>i.createElement("div",{className:Te.L2ClassNames.EditItems.accessLevelInfoContainer},a&&n&&i.createElement("div",{className:m.statusMessage},i.createElement("div",null,he.AccessLevelInfo_StatusMessageTitle),i.createElement("div",null,n.statusMessage)),a&&n&&o&&i.createElement(ht.FlexDividerCell,null),o&&i.createElement(He.GroupMembershipToolTipContent,{promiseFulfilled:e.memberPromiseFulfilled,groupsInheritedFrom:l}))}}))):e.label;return i.createElement(vt.AccessLevelDropdown,Object.assign({},e,{label:d,disabled:r||u}))}}("ComponentsControlsAccessLevelDropdownGroupAssignments"),function(e){function s(e){const{isPrimary:t=!0,className:s}=e,n=__rest(e,["isPrimary","className"]);return i.createElement(H.Button,Object.assign({},n,{className:(0,y.css)(s,Te.L2ClassNames.callouts.actionButton),primary:t}))}St=t[e]={},t[e].CommonPanelFooter=function(e){return e.onDismiss||e.actionButtonProps?i.createElement(V.PanelFooter,null,i.createElement(O.ButtonGroup,{className:"bolt-panel-footer-buttons flex-grow"},e.onDismiss&&i.createElement(H.Button,{className:Te.L2ClassNames.callouts.dismissButton,text:he.HubButtonTextCancel,onClick:e.onDismiss}),e.actionButtonProps&&i.createElement(s,Object.assign({},e.actionButtonProps)))):null}}("ComponentsControlsCommonCallout"),function(e){yt=t[e]={},t[e].CommonDialog=function(e){const{className:t,onDismiss:s,title:n}=e,r=i.useMemo((()=>e.id||(0,z.getId)("dialog")),[e.id]),a=n?`${r}-title`:void 0;return i.createElement(q.CustomDialog,{ariaLabelledBy:a,className:(0,y.css)("bolt-dialog",t),id:r,onDismiss:s,contentSize:e.contentSize},i.createElement(V.PanelHeader,{onDismiss:s,closeButtonSize:0,showCloseButton:!0,showSeparator:!1,titleProps:{text:n,size:2,id:a}}),i.createElement(W.SurfaceContext.Consumer,null,(t=>i.createElement("div",{className:(0,y.css)("bolt-dialog-content flex-column flex-grow","bolt-dialog-content-bottom-padding",t.horizontalClassName)},e.children))),i.createElement(St.CommonPanelFooter,{onDismiss:e.onDismiss,actionButtonProps:e.actionButtonProps}))}}("ComponentsControlsCommonDialog"),function(e){Et=t[e]={},t[e].CommonPanel=function(e){const{backButtonProps:t,description:s,onDismiss:n,title:r}=e,a=i.useMemo((()=>e.id||(0,z.getId)("panel")),[e.id]),o=r?`${a}-title`:void 0;return i.createElement(V.CustomPanel,{className:e.className,ariaLabelledBy:o,onDismiss:n,id:a,defaultActiveElement:e.defaultActiveElement},i.createElement(V.PanelHeader,{backButtonProps:t,description:s,onDismiss:n,titleProps:{id:o,text:r}}),i.createElement(V.PanelContent,null,i.createElement("div",{className:(0,y.css)(b.SizeClassNames.width100,I.FlexClassNames.flexColumn,e.contentClassName)},e.children)),i.createElement(St.CommonPanelFooter,{onDismiss:e.hideDismissButton?void 0:e.onDismiss,actionButtonProps:e.actionButtonProps}))}}("ComponentsControlsCommonPanel"),function(e){At=t[e]={},t[e].identityPickerDropdownClass="identity-picker-dropdown",t[e].identityPickerDropdownInputSelector=".identity-picker-dropdown input",t[e].UserIdentityPicker=function(e){const t=(0,K.useVersionKey)(e.pickerProvider),s=i.useCallback((t=>{let s;s=t instanceof Ne.AddPendingIdentities?(0,De.unionByKey)(e.selectedIdentities,t.toAddIdentities(),(e=>e.entityId)):(0,De.unionByKey)(e.selectedIdentities,[t],(e=>e.entityId)),e.onChange(s)}),[e.selectedIdentities,e.onChange]);return i.createElement($.IdentityPicker,{placeholderText:e.placeholderText,pickerProvider:e.pickerProvider,onBlur:e=>{(e=e&&e.trim())&&s(new Ne.AddPendingIdentities(e))},onIdentityAdded:s,onIdentitiesRemoved:t=>{const s={};for(const e of t)s[e.entityId]=!0;const n=e.selectedIdentities.filter((e=>!s[e.entityId]));e.onChange(n)},onIdentityRemoved:t=>{const s=e.selectedIdentities.filter((e=>e.entityId!==t.entityId));e.onChange(s)},selectedIdentities:e.selectedIdentities,renderCustomIdentitySuggestion:e=>e instanceof Ne.AddPendingIdentities?i.createElement("div",{className:"bolt-picker-suggesteditem-text flex-row flex-grow flex-center text-ellipsis"},i.createElement("div",{className:(0,y.css)("bolt-picker-persona-name flex-column flex-grow",(0,C.getSpacingContainerClassName)("y",4))},i.createElement("div",null,he.IdentityPickerText_AddUsers),i.createElement(Q.PillGroup,{className:"flex-row",overflow:1},e.addIdentityNames.map(((e,t)=>i.createElement(J.Pill,{key:t,variant:1,size:0},e)))))):i.createElement(i.Fragment,null),key:t})},t[e].IdentityPickerDropdown=function(e){const t=(0,K.useVersionKey)(e.pickerProvider);return i.createElement($.IdentityPickerDropdown,Object.assign({},e,{key:t}))}}("ComponentsControlsIdentityPickers"),function(e){function s(e,t){switch(e){case Se.ErrorCodes.RemoveUserFromAccountError:return i.createElement("div",null,t,he.PunctuationPeriod,he.PunctuationSuffix,i.createElement(S.Link,{href:Se.UserManagementLinks.GenericFailureSupport,target:"_blank",rel:"noopener noreferrer",tabIndex:0,underline:!0},he.UserDialog_LearnMore),he.PunctuationPeriod,he.PunctuationSuffix);case Se.ErrorCodes.BuildGroupEntitlementFailed:return i.createElement("div",null,he.GroupRules_BuildGroupEntitlementFailed);case Se.ErrorCodes.AccessDenied:return i.createElement("div",null,he.ProjectInviteDialog_FailedToAddNoPermissions,he.PunctuationSuffix,i.createElement(S.Link,{href:Se.UserManagementLinks.AddTeamProjectMemberLink,target:"_blank",rel:"noopener noreferrer",underline:!0},he.UserDialog_LearnMore));case Se.ErrorCodes.ExternalGuestAccessDenied:return i.createElement("div",null,t,he.PunctuationSuffix,i.createElement(S.Link,{href:Se.UserManagementLinks.ExternalGuestAccessDeniedHelpLink,target:"_blank",rel:"noopener noreferrer",underline:!0},he.UserDialog_LearnMore));case Se.ErrorCodes.GuestUserInviterError:return i.createElement("div",null,t,he.PunctuationSuffix,i.createElement(S.Link,{href:Se.UserManagementLinks.GuestUserInviterErrorHelpLink,target:"_blank",rel:"noopener noreferrer",underline:!0},he.UserDialog_LearnMore));case Se.ErrorCodes.GuestAadInviteGenericFailure:return i.createElement(p.TemplateString,{template:he.GuestInviteError_GuestAadInviteGenericFailure1},i.createElement(S.Link,{href:Se.UserManagementLinks.GenericFailureSupport,target:"_blank",rel:"noopener noreferrer",underline:!0},he.UserDialog_ContactSupport));case Se.ErrorCodes.ValidRefreshTokenNotFound:return i.createElement("div",null,"Resources.UserInviteDialog_ValidRefreshTokenNotFound")}return i.createElement("div",{dangerouslySetInnerHTML:{__html:t}})}function n(e){const{onRender:t=s}=e;return t(e.errorKey,e.errorValue,s)}xt=t[e]={},t[e].defaultRender=s,t[e].OperationError=n,t[e].OperationErrors=function(e){return i.createElement("div",{className:e.className},e.errors.map(((t,s)=>i.createElement(n,{key:s,errorKey:t.key,errorValue:t.value,onRender:e.onRender}))))}}("ComponentsControlsNotifications"),function(e){Tt=t[e]={};class s extends i.PureComponent{static getStyles(e){let t="aex-user-hub-persona-size-32";if("large"===e)t="aex-user-hub-persona-size-48";return{root:(0,y.css)(I.FontClassNames.fontSizeM,I.FontClassNames.fontWeightNormal,B.ColorClassNames.primaryText,I.FlexClassNames.flexRow,I.FlexClassNames.alignItemsCenter),imageArea:(0,y.css)(j.CssClassNames.flex.none,I.TextClassNames.alignCenter,t),details:(0,y.css)((0,C.getSpacingClassName)("padding","left",16),(0,C.getSpacingClassName)("padding","right",20),j.CssClassNames.flex.auto,I.FlexClassNames.flexColumn,j.CssClassNames.jusitfyContent.spaceAround,I.FlexClassNames.alignItemsStretch,I.LayoutClassNames.overflowHidden),primaryText:(0,y.css)(I.TextClassNames.ellipsis,I.FontClassNames.fontSizeM,B.ColorClassNames.primaryText),secondaryText:(0,y.css)(I.TextClassNames.ellipsis,I.FontClassNames.fontSizeDefault,B.ColorClassNames.secondaryText)}}render(){const{member:e,onRenderImage:t,size:n="medium",pageContext:r,defaultToMemberTextField:a=!0,defaultToMemberSecondaryTextField:o=!0}=this.props,{text:l=(a?e.displayName:void 0),secondaryText:c=(o?e.principalName:void 0)}=this.props,u=s.getStyles(n);return i.createElement("div",Object.assign({className:(0,y.css)(u.root,this.props.className)},{[Te.L2DataAttributeKeys.memberDescriptor]:e.descriptor}),i.createElement("div",{className:(0,y.css)(u.imageArea,this.props.imageContainerClassName)},t?t():i.createElement(Z.VssPersona,{suppressPersonaCard:!0,imageUrl:e.getAvatarUrl(r),showInitialsOnImageError:!0,size:n})),i.createElement("div",{className:u.details},l&&i.createElement(Y.Tooltip,{overflowOnly:!0},i.createElement("div",{className:u.primaryText},l)),c&&i.createElement(Y.Tooltip,{overflowOnly:!0},i.createElement("div",{className:u.secondaryText},c))))}}__decorate([a.memoize],s,"getStyles",null),t[e].MemberPersona=s;class n extends i.PureComponent{static getStyles(){return{githubIcon:(0,C.getSpacingClassName)("margin","right",4),baseIconContainer:(0,y.css)(j.CssClassNames.border.radius50,I.FlexClassNames.flexRow,I.FlexClassNames.alignItemsCenter,I.FlexClassNames.justifyContentCenter),aadDeletedIconContainer:B.BackgroundColorClassNames.statusErrorBackground,aadGuestIconContainer:B.BackgroundColorClassNames.communicationBackground}}render(){const e=n.getStyles(),{member:t}=this.props;if(t.isGitHubUser){const n=Object.assign(Object.assign({},this.props),{defaultToMemberTextField:!1,defaultToMemberSecondaryTextField:!1});return t.isBindPending?n.text=i.createElement(i.Fragment,null,i.createElement(P.Icon,{className:e.githubIcon,iconName:"GitHubLogo"}),t.directoryAlias||t.displayName):(n.text=t.displayName,n.secondaryText=t.directoryAlias&&i.createElement(i.Fragment,null,i.createElement(P.Icon,{className:e.githubIcon,iconName:"GitHubLogo"}),t.directoryAlias)),i.createElement(s,Object.assign({},n))}return t.isAADDeleted&&this.props.pageContext.isFeatureFlagEnabled(Se.FeatureFlags.ReinstateAssets)?i.createElement(s,Object.assign({},this.props,{imageContainerClassName:(0,y.css)(e.baseIconContainer,e.aadDeletedIconContainer),onRenderImage:()=>i.createElement(P.Icon,{className:(0,y.css)(I.FontClassNames.fontSizeL,B.ColorClassNames.statusErrorForeground),iconName:"Warning"}),text:(0,D.format)(he.DisplayNameWithAadDeleted1,t.displayName)})):t.isAADGuest?i.createElement(s,Object.assign({},this.props,{imageContainerClassName:(0,y.css)(e.baseIconContainer,e.aadGuestIconContainer),onRenderImage:()=>i.createElement(P.Icon,{className:(0,y.css)(I.FontClassNames.fontSizeL,B.ColorClassNames.textOnCommunicationBackground),iconName:"Contact"})})):i.createElement(s,Object.assign({},this.props))}}__decorate([a.memoize],n,"getStyles",null),t[e].UserPersona=n}("ComponentsControlsPersona"),function(e){Ut=t[e]={};class s{static getMessageCardInfo(e){let t="Info";switch(e){case"Failed":t="Error";break;case"Warning":t="Warning"}return{severity:t,iconProps:{render:t=>i.createElement(ee.Status,Object.assign({},ee.Statuses[e],{className:(0,y.css)(t,(0,C.getSpacingClassName)("margin","all",8)),size:"16"}))}}}}t[e].StatusMessageCard=function(e){const t=i.useMemo((()=>s.getMessageCardInfo(e.statusType)),[e.statusType]),{severity:n=t.severity,iconProps:r=t.iconProps}=e;return i.createElement(X.MessageCard,Object.assign({},e,{severity:n,iconProps:r}),e.children)}}("ComponentsControlsStatusMessageCard"),function(e){It=t[e]={},t[e].OneLineSimpleTableCell=function(e){return i.createElement(U.SimpleTableCell,{columnIndex:e.columnIndex,tableColumn:e.tableColumn},i.createElement(Y.Tooltip,{overflowOnly:!0},i.createElement("div",{className:(0,y.css)(I.TextClassNames.ellipsis,e.contentClassName)},e.children)))}}("ComponentsControlsTableCells"),function(e){Pt=t[e]={};class s{static getStyles(){return{content:(0,y.css)(I.FlexClassNames.flexRow,I.FlexClassNames.alignItemsCenter),textContainer:I.FlexClassNames.flexGrow}}}__decorate([a.memoize],s,"getStyles",null),t[e].TextFieldWithCopy=function(e){const[t,n]=i.useState(void 0),r=s.getStyles(),{text:a}=e,o=i.useMemo((()=>({text:t===a?he.CopyToClipBoard_Copied:he.CopyToClipBoard_Copy,anchorOrigin:{horizontal:"center",vertical:"end"},tooltipOrigin:{horizontal:"center",vertical:"start"}})),[a,t]);return i.createElement("div",{className:r.content},i.createElement(se.TextField,{containerClassName:r.textContainer,value:a,readOnly:!0}),i.createElement(te.ClipboardButton,{getContent:()=>e.text,onCopy:()=>{n(e.text)},tooltipProps:o}))}}("ComponentsControlsTextFieldWithCopy"),function(e){Nt=t[e]={};class s extends Fe.AsyncIteratorBase{constructor(e,t,s){super(),this.client=e,this.operationId=t,this.intervalInMs=s,this.client=e,this.operationId=t,this.intervalInMs=s}async next(){if(this.latestValue){if((0,lt.isOperationStatusCompleted)(this.latestValue.status))return{done:!0,value:void 0};const e=Math.floor(Math.random()*this.intervalInMs/2);await(0,ne.wait)(this.intervalInMs+e)}return this.latestValue=await this.client.getApplicationStatus(this.operationId),{done:!1,value:this.latestValue}}get value(){return this.latestValue}get initialApplicationStatusPromise(){return this._initialApplicationStatusPromise||(this._initialApplicationStatusPromise=(async()=>(this.latestValue||await this.next(),this.latestValue))()),this._initialApplicationStatusPromise}get pollUntilCompletePromise(){return this._pollUntilCompletePromise||(this._pollUntilCompletePromise=(async()=>{const e=await this.initialApplicationStatusPromise;if((0,lt.isOperationStatusCompleted)(e.status))return e;let t=await this.next();for(;!t.done;)t=await this.next();return this.latestValue})()),this._pollUntilCompletePromise}}function n(e){const t=e&&e.value,[,s]=i.useState(0);let n=!(!e||void 0!==t&&(0,lt.isOperationStatusCompleted)(t.status));return i.useEffect((()=>(e&&n&&(void 0===t?(async()=>{await e.initialApplicationStatusPromise,n&&s((e=>e+1))})():(async()=>{await e.pollUntilCompletePromise,n&&s((e=>e+1)),n=!1})()),()=>{n=!1}))),[t,n]}t[e].LicensingRulesContext=i.createContext({allRulesPoller:void 0,rulePollers:{},startPollLicensingRule:()=>{}}),t[e].LicensingRulesContextProvider=function(n){const r=(0,ye.useUserHubContext)(),a=i.useContext(st.GroupsContext),o=i.useContext(it.UsersContext),l=i.useContext(xe.UsersSummaryContext),c=r.shouldUseLicensingService()?"00000043-0000-8888-8000-000000000000":"951917ac-a960-4999-8464-e3f0aa25b381",u=i.useMemo((()=>(0,gt.getLicensingRuleClient)(r.pageContext,{serviceInstanceType:c})),[r.pageContext]),[m,p]=(0,d.useAsyncState)(void 0),[g,b]=(0,d.useAsyncState)({}),C=i.useCallback(((e,t,n)=>{const r=new s(u,e,3e3);return(async()=>{if(await r.pollUntilCompletePromise,t){const t=r.value;if(t&&0===t.option&&4===t.status){t.licenses&&t.licenses.filter((e=>e.assigned>0)).length>0&&(o.refreshMembersList(),l.refresh("licenses")),a&&(e&&!n?a.refreshGroup(e):a.refreshMembersList())}}})(),e?b((t=>Object.assign(Object.assign({},t),{[e]:r}))):p(r),r}),[u,o,a,l]),v=i.useMemo((()=>({allRulesPoller:m,rulePollers:g,startPollLicensingRule:C})),[m,g,C]);return i.createElement(t[e].LicensingRulesContext.Provider,{value:v},n.children)},t[e].useAllLicensingRulesApplicaitonStatus=function(){const s=i.useContext(t[e].LicensingRulesContext),[r,a]=n(s.allRulesPoller);return[r,a,i.useCallback((e=>s.startPollLicensingRule(void 0,e)),[s.startPollLicensingRule])]},t[e].useLicensingRuleApplicationStatus=function(s){const r=i.useContext(t[e].LicensingRulesContext),a=i.useCallback((e=>r.startPollLicensingRule(s,e)),[s,r.startPollLicensingRule]),[o,l]=n(r.rulePollers[s]);return[o,l,a]}}("ContextLicensingRulesContext"),function(e){Mt=t[e]={};class s{static getStyles(){return{githubWarning:(0,C.getSpacingContainerClassName)("y",4)}}static checkHasValidUsers(e,t,n,r,i,a){n=n||[],r=r||[],i=i&&i.trim();const o={userCount:n.length+r.length+(i?1:0)};return t.isAadAccount&&(o.warningMessageOfAadGuestUsers=s.checkForAADGuestWarning(r,i,a)),t.isGitHubInviteEnabled&&(o.warningMessageOfGitHubUsers=s.checkForGitHubWarning(n,e.orgHostUri)),o}static getWarning(e,t,n){const r={userCount:n.length};return t.isAadAccount&&(t.isAadGuest?r.warningMessageforAadGuestAdmin=s.getAadGuestAdminWarning():r.warningMessageOfAadGuestUsers=s.getAADGuestWarning(n)),t.isGitHubInviteEnabled&&(r.warningMessageOfGitHubUsers=s.checkForGitHubWarning(n.filter((e=>!(e instanceof Ne.AddIdentity))),e.orgHostUri)),r}static getAddUserDisplayWarning(e,t){return t.userCount>e.maxIdentitiesToAdd?i.createElement(p.TemplateString,{template:he.UserInviteDialog_MaxUsersToAdd1},e.maxIdentitiesToAdd):t.warningMessageforAadGuestAdmin?t.warningMessageforAadGuestAdmin:t.warningMessageOfAadGuestUsers?t.warningMessageOfAadGuestUsers:t.warningMessageOfGitHubUsers?t.warningMessageOfGitHubUsers:void 0}static checkForAADGuestWarning(e,t,n){const r=s.getNewUnresolvedUsers(t,n,e);if(r.length>0)return i.createElement("span",{role:"alert"},i.createElement(p.TemplateString,{template:he.UserInviteDialog_InviteUserToAadWarning1},r.join(he.ListItemSeparator)),i.createElement(S.Link,{href:Se.UserManagementLinks.GuestUserInviteLearnMore,target:"_blank",rel:"noopener noreferrer",ariaLabel:he.UserDialog_LearnMore_AriaLabel,underline:!0},he.UserDialog_LearnMore))}static getAADGuestWarning(e){const t=e.filter((e=>e instanceof Ne.AddIdentity)).map((e=>e.entityId));if(t.length>0)return i.createElement("span",{role:"alert"},i.createElement(p.TemplateString,{template:he.UserInviteDialog_InviteUserToAadWarning1},t.join(he.ListItemSeparator)),i.createElement(S.Link,{href:Se.UserManagementLinks.GuestUserInviteLearnMore,target:"_blank",rel:"noopener noreferrer",ariaLabel:he.UserDialog_LearnMore_AriaLabel,underline:!0},he.UserDialog_LearnMore))}static checkForGitHubWarning(e,t){if(e&&e.length>0){const n=s.getStyles(),r=e.filter((e=>e.originDirectory===Se.DirectoryName.GitHub));if(r.length>0)return i.createElement("div",{className:n.githubWarning},i.createElement("div",{role:"alert"},i.createElement(p.TemplateString,{template:he.UserInviteDialog_InviteUserFromGitHubWarning1},r.map((e=>e.signInAddress)).join(he.ListItemSeparator))),t&&i.createElement(Pt.TextFieldWithCopy,{text:t}))}}static getAadGuestAdminWarning(){return i.createElement("span",{role:"alert"},he.UserInviteDialog_AadGuestAdminWarning,i.createElement(S.Link,{href:Se.UserManagementLinks.AadGuestPermissionsHelpLink,target:"_blank",rel:"noopener noreferrer",underline:!0},he.UserDialog_LearnMore))}static isValidEmailAddress(e){return s.VALID_EMAIL_ADDRESS_PATTERN.test(e)}static getNewUnresolvedUsers(e,t,n){if(!t)return[];const r=s.isValidEmailAddress(e||"")?e:"";let i=n.filter((e=>s.isValidEmailAddress(e)));const a=i.indexOf(r);return-1!==a&&i.splice(a,1),i.length>0||r&&t.length<=0?(r&&t.length<=0&&(i=i.concat(r)),i):[]}}s.VALID_EMAIL_ADDRESS_PATTERN=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i,__decorate([a.memoize],s,"getStyles",null),__decorate([a.memoize],s,"getWarning",null),t[e].UserValidationUtils=s}("UtilsIdentityUtils"),function(e){Lt=t[e]={};class s{static getStyles(){return{summaryCellContent:(0,y.css)(I.FlexClassNames.flexRow,I.FlexClassNames.alignItemsCenter,(0,C.getSpacingContainerClassName)("x",8))}}static getTreeItemProvider(e){const t=e.map((([e,t])=>({data:{isSummary:!0,status:e,summaryCount:t.length,resultItem:void 0},childItems:t.map((e=>({data:{isSummary:!1,status:void 0,summaryCount:void 0,resultItem:e}}))),expanded:0===e||1===e})));return new ie.TreeItemProvider(t)}static renderNameCell(e,t,n,r){const{data:a}=r.underlyingItem,{isSummary:o}=a;let l;if(o)l=s.renderSummaryCellContent(a);else{const[,e]=a.resultItem,[t]=e;if(3===t){const t=e[1];let s;s=fe.MemberEntitlements.isServicePrincipal(t)?t.servicePrincipal.displayName:t.user.principalName,l=i.createElement(Y.Tooltip,{overflowOnly:!0},i.createElement("div",{className:I.TextClassNames.ellipsis},s))}else{const t=e[1];l=t&&i.createElement("div",null,t.displayName)}}return i.createElement(re.ExpandableTreeCell,{className:(0,y.css)(j.CssClassNames.whiteSpace.normal),key:t,columnIndex:t,treeItem:r,contentClassName:n.className,colspan:o?2:void 0,treeColumn:n},l)}static renderSimpleCell(e,t,s){return i.createElement(U.SimpleTableCell,{key:t,columnIndex:t,tableColumn:s,contentClassName:s.className},i.createElement("div",null,e))}static renderMessageCell(e,t,n,r){const{data:a}=r.underlyingItem,{isSummary:o}=a;if(o)return i.createElement(i.Fragment,{key:t});const l=a,{resultItem:c}=l,[u]=c;return s.renderSimpleCell(u&&u.errors&&i.createElement(xt.OperationErrors,{className:j.CssClassNames.whiteSpace.normal,errors:u.errors,onRender:e&&((t,s)=>e(c,t,s))}),t,n)}static getDefaultWidthes(e){switch(e){case 2:return[-50,-50];case 3:return[-30,-30,-40]}}static renderSummaryCellContent(e){const t=s.getStyles();let n=he.BulkStatusDialogText_LabelSuccess,r="Success";switch(e.status){case 3:n=he.BulkStatusDialogText_LabelCanceled,r="Canceled";break;case 0:n=he.BulkStatusDialogText_LabelFailed,r="Failed";break;case 1:n=he.BulkStatusDialogText_LabelWarning,r="Warning"}return i.createElement("div",{className:t.summaryCellContent},i.createElement(ee.Status,Object.assign({},ee.Statuses[r],{size:"16"})),i.createElement("div",null,n),i.createElement(J.Pill,{size:0},e.summaryCount))}}function n(e){const[t,n]=i.useState(s.getDefaultWidthes(e.centerColumn?3:2));i.useEffect((()=>{e.centerColumn&&2===t.length?n(s.getDefaultWidthes(3)):e.centerColumn||3!==t.length||n(s.getDefaultWidthes(2))}));const r=i.useCallback(((e,t,s)=>{n((e=>{const n=[...e];return n[t]=s,n}))}),[]),a=i.useMemo((()=>s.getTreeItemProvider(e.groupedItems)),[e.groupedItems]),o=(0,K.useVersionKey)(a),l=i.useCallback(((t,n,r,i)=>s.renderMessageCell(e.onRenderError,n,r,i)),[e.onRenderError]),c=i.useMemo((()=>[{id:"name",renderCell:s.renderNameCell,name:he.BulkStatusDialogColumnName_User,width:t[0],onSize:r},...e.centerColumn?[Object.assign(Object.assign({},e.centerColumn),{width:t[1],onSize:r})]:[],{id:"message",renderCell:l,name:he.BulkStatusDialogColumnName_Message,width:t[e.centerColumn?2:1],onSize:r}]),[t,r,e.centerColumn]);return i.createElement(re.Tree,{onToggle:(e,t)=>{a.toggle(t.underlyingItem)},showLines:!0,columns:c,itemProvider:a,key:o})}__decorate([a.memoize],s,"getStyles",null),t[e].BulkStatusTree=n,t[e].BulkProjectStatusTree=function(e){const t=(0,xe.useProjectRefsMapping)(),r={id:"project",renderCell:i.useCallback(((e,n,r,a)=>{const{data:o}=a.underlyingItem,{isSummary:l}=o;if(l)return i.createElement(i.Fragment,{key:n});const[,c]=o.resultItem,[,,,u]=c,m=t&&t[u]&&t[u].name;return s.renderSimpleCell(m,n,r)}),[]),name:he.BulkStatusDialogColumnName_Project,width:-100};return i.createElement(n,{centerColumn:r,groupedItems:e.groupedItems})}}("ComponentsHubNotificationsBulkStatusTree"),function(e){_t=t[e]={};class s extends Ze.PatchResponseStatusNotification{constructor(e,t=Lt.BulkStatusTree){super(e),this.details=i.createElement(t,{groupedItems:this.summarized})}}t[e].BulkStatusResultNotification=s;class n extends Ze.PatchResponseStatusNotification{constructor(e,t){super(e,t),this.description=i.createElement(i.Fragment,null,t&&t.message&&i.createElement("div",null,t.message),e.map((([e],t)=>void 0===e||e.isSuccess?null:i.createElement(xt.OperationErrors,{key:t,errors:e.errors,className:(0,C.getSpacingClassName)("margin","left",8)}))))}}t[e].SingleMemberStatusResultNotification=n,t[e].useBulkUserApiNotificationCallback=function(e,t,n){const r=i.useMemo((()=>({onGetDisplayName:t,onGetResultNotification:(e,...t)=>new s(e,n)})),[t]);return(0,We.useNotificationAsyncCallback)(e,r)},t[e].useBulkMemberApiNotificationCallback=function(e,t,n){const r=i.useMemo((()=>({onGetDisplayName:t,onGetResultNotification:(e,...t)=>new s(e,n)})),[t]);return(0,We.useNotificationAsyncCallback)(e,r)}}("ComponentsHubNotificationsMemberOperationStatusNotifications"),function(e){function s(e){const t=(0,ye.useUserHubConfiguration)(),s=n.getStyles(),r=i.createElement(i.Fragment,null,he.LabelText_WithUsers,!t.isGitHubUser&&t.isGitHubSearchEnabled&&i.createElement(P.Icon,{tooltipProps:{renderContent:()=>i.createElement("span",null,he.GitHubSearchWarning_TooltipContent)},iconName:"Warning",ariaLabel:he.GitHubSearchWarning_HoverInfoLabel}));return i.createElement("div",{className:s.innerFormGroupSpacing},i.createElement("div",{className:s.spacingContainer12},i.createElement(f.FormItem,{className:Te.L2ClassNames.formItems.createNewAzureDevOpsGroupName,label:he.LabelText_VstsGroupName},i.createElement(se.TextField,{autoFocus:!0,required:!0,value:e.groupName,onChange:(t,s)=>{e.onGroupNameChange(s)}})),e.onSelectFromExistingGroups&&i.createElement(H.Button,{className:Te.L2ClassNames.Dialogs.AddGroupRule.SelectFromExistingGroupButton,onClick:e.onSelectFromExistingGroups,text:he.ButtonText_SelectFromSingleExistingGroup})),i.createElement("div",null,i.createElement(f.FormItem,{label:r,className:Te.L2ClassNames.formItems.userIdentityPicker},i.createElement(At.UserIdentityPicker,{pickerProvider:e.userIdentityPicker.pickerProvider,selectedIdentities:e.userIdentityPicker.selectedIdentities,onChange:e.userIdentityPicker.onChange}))))}Dt=t[e]={};class n{static getStyles(){return{innerFormGroupSpacing:(0,C.getSpacingContainerClassName)("y",8),spacingContainer4:(0,C.getSpacingContainerClassName)("y",4),spacingContainer12:(0,C.getSpacingContainerClassName)("y",12),labelContainer:(0,y.css)(I.FlexClassNames.flexRow,I.FlexClassNames.alignItemsCenter),content:(0,C.getSpacingContainerClassName)("y",16)}}static buildGroupEntitlementFromInput(e,t,s,r,i){const a=n.buildCreateGroupFromInput(e,t);if(!a)return;const[o,l,c]=a;return{extensionRules:[],group:o,id:l,licenseRule:s,members:c,projectEntitlements:r&&ct.ProjectEntitlements.toProjectEntitlements(r,i)}}static buildCreateGroupFromInput(e,t){if(e.isCreatingGroup){const{createGroupName:s}=e,n=t&&mt.UserEntitlements.buildUserEntitlementsFromIdentities(t);return[{displayName:s?s.trim():void 0,origin:Se.OriginName.VisualStudioTeamServices,subjectKind:Se.SubjectKind.Group},void 0,n]}{const{selectedGroupIdentity:t}=e;if(!t)return;return[{displayName:t.displayName,origin:t.originDirectory,originId:t.originId,subjectKind:Se.SubjectKind.Group},t.localId,void 0]}}}n.addToProjectsItemKey="projects-form",__decorate([a.memoize],n,"getStyles",null),t[e].AddGroupPanel=function(e){const t=(0,ye.useUserHubContext)(),r=(0,ye.useUserHubConfiguration)(),{isAdmin:a}=(0,ye.useUserHubConfiguration)(),o=i.useContext(st.GroupsContext),l=i.useMemo((()=>new ot.GroupIdentityPickerProvider(t.pageContext)),[t.pageContext]),c=(0,Me.useAddUserIdentityPicker)(t,r),[u,m]=i.useState({isCreatingGroup:!1,selectedGroupIdentity:void 0,createGroupName:void 0}),d=i.useContext(Nt.LicensingRulesContext),{selectedAccessLevel:g,setSelectedAccessLevel:b,selectedGroupType:C,setSelectedGroupType:v,selectedProjectIds:h,setSelectedProjectIds:S}=(0,Pe.useAddMemberFields)(),y=i.useMemo((()=>{const e=c&&c.selectedIdentities;if(e){return Mt.UserValidationUtils.getWarning(t,r,e).warningMessageOfAadGuestUsers}}),[c&&c.selectedIdentities,t,r]),E=i.useMemo((()=>{if(!u.isCreatingGroup&&u.selectedGroupIdentity)return t.isGroupIdValidForGroupRule(u.selectedGroupIdentity.originId)}),[u.isCreatingGroup,u.selectedGroupIdentity,t]),[A]=(0,_.useResolvedPromise)(E),x=i.useMemo((()=>{if(!1===A)return!0;if(u.isCreatingGroup){const{createGroupName:e}=u;return!e||0===e.trim().length}return!u.selectedGroupIdentity}),[u,A]),T=i.createElement(p.TemplateString,{template:he.Notification_AddGroupRule_Action1},u.isCreatingGroup?u.createGroupName:u.selectedGroupIdentity&&u.selectedGroupIdentity.displayName),{addGroupRule:U}=(0,at.useGroupsContextApiActions)(),I=(0,Ee.useTrackedAsyncCallback)(t,(0,We.useNotificationAsyncCallback)(U,{onGetDisplayName:()=>T,onGetResultNotification:e=>new _t.SingleMemberStatusResultNotification(e),onGetErrorNotification:(e,t)=>new _t.SingleMemberStatusResultNotification([[void 0,[3,t]]],new F.HandledError(e))}),Se.PerformanceScenarioConstants.AddGroupFeatureName);if(!o||!t||!c)return null;const P=n.getStyles();return i.createElement(Et.CommonPanel,{className:Te.L2ClassNames.panels.addGroupRule.root,contentClassName:P.content,onDismiss:()=>{t.ciTelemetry.publishCloseInvitationEvent(!1),e.onDismiss()},title:he.CommandButtonText_AddSingleGroupRule,defaultActiveElement:At.identityPickerDropdownInputSelector,actionButtonProps:{disabled:x,text:he.UserInviteDialog_AddButton,onClick:async()=>{const t=g&&n.buildGroupEntitlementFromInput(u,c.selectedIdentities,g,h,C);if(t){e.onDismiss();try{const[[e]]=await I(t);e&&e.result&&d.startPollLicensingRule(e.result.id,!0)}catch(e){}}}}},u.isCreatingGroup?i.createElement(s,{groupName:u.createGroupName,onGroupNameChange:e=>{m((t=>Object.assign(Object.assign({},t),{createGroupName:e})))},userIdentityPicker:c,onSelectFromExistingGroups:a?()=>{m((e=>Object.assign(Object.assign({},e),{isCreatingGroup:!1})))}:void 0}):i.createElement("div",{className:P.spacingContainer12},i.createElement(f.FormItem,{label:he.IdentityPickerLabelText_Group,className:Te.L2ClassNames.formItems.groupIdentityPicker,required:!0},i.createElement(At.IdentityPickerDropdown,{className:At.identityPickerDropdownClass,pickerProvider:l,onChange:e=>{m((t=>Object.assign(Object.assign({},t),{selectedGroupIdentity:e})))},value:u.selectedGroupIdentity,placeholder:he.UserInviteDialog_IdentityPickerGroupPlaceholder})),a&&i.createElement(H.Button,{text:he.ButtonText_CreateNewVstsGroup,iconProps:{iconName:"Add"},className:Te.L2ClassNames.commandItems.createNewAzureDevOpsGroup,onClick:()=>{m((e=>Object.assign(Object.assign({},e),{isCreatingGroup:!0})))}})),i.createElement(vt.AccessLevelDropdown,{label:he.UserInviteDialog_AccessLevel,onChange:b,selectedAccessLevel:g}),i.createElement(f.FormItem,{label:he.DialogColProjectName},i.createElement(Ie.AddToProjectsForm,{selectedGroupType:C,selected:h,onSelectedGroupTypeChange:v,onChange:S})),y&&i.createElement(X.MessageCard,{severity:"Warning"},i.createElement("div",null,y)),!1===A&&i.createElement(X.MessageCard,{severity:"Warning"},i.createElement("div",null,he.WarningMessage_CannotAddProjectGroup)))}}("ComponentsHubCalloutsAddMemberAddGroupPanel"),function(e){Ft=t[e]={};class s{static buildUserEntitlementsFromInput(e,t,s,n){const r=s&&ct.ProjectEntitlements.toProjectEntitlements(s,n);return mt.UserEntitlements.buildUserEntitlementsFromIdentities(e,t,r)}static getStyles(){return{content:(0,C.getSpacingContainerClassName)("y",16),projectsLabelContainer:I.FlexClassNames.flexColumn}}}__decorate([a.memoize],s,"getStyles",null),t[e].AddUsersToCollectionPanel=function(e){const t=(0,ye.useUserHubContext)(),n=(0,ye.useUserHubConfiguration)(),r=(0,Me.useAddUserIdentityPicker)(t,n),a=i.useContext(xe.UsersSummaryContext),o=r&&r.selectedIdentities,{selectedAccessLevel:l,setSelectedAccessLevel:c,selectedGroupType:u,setSelectedGroupType:m,selectedProjectIds:d,setSelectedProjectIds:g}=(0,Pe.useAddMemberFields)(),[b,C]=i.useState(!0),{addUsersToCollection:v,addServicePrincipalsToCollection:h}=(0,it.useUsersContextApiActions)(),S=(0,_t.useBulkUserApiNotificationCallback)((async(e,s)=>{const n=await v(e,s);let r=0;for(const[e]of n)e&&e.errors&&Ye.PatchResponseUtils.containsErrors(e.errors)&&++r;return r>0&&t&&t.ciTelemetry.publishClickUserInvitationEvent(n.map((e=>e[1][1])),r),n}),(e=>{const t=e.length;return i.createElement(p.TemplateString,{template:he.Notification_AddUsers_Action2},t,t<2?he.Text_User_Singular:he.Text_User_Plural)})),y=(0,_t.useBulkMemberApiNotificationCallback)((async(e,s)=>{const n=await v(e,s);let r=0;for(const[e]of n)e&&e.errors&&Ye.PatchResponseUtils.containsErrors(e.errors)&&++r;return r>0&&t&&t.ciTelemetry.publishClickMemberInvitationEvent(n.map((e=>e[1][1])),r),n}),(e=>{const t=e.length;return i.createElement(p.TemplateString,{template:he.Notification_AddUsers_Action2},t,t<2?he.Text_User_Singular:he.Text_User_Plural)})),E=(0,_t.useBulkMemberApiNotificationCallback)((async e=>{const s=await h(e);let n=0;for(const[e]of s)e&&e.errors&&Ye.PatchResponseUtils.containsErrors(e.errors)&&++n;return n>0&&t&&t.ciTelemetry.publishClickMemberInvitationEvent(s.map((e=>e[1][1])),n),s}),(e=>{const t=e.length;return i.createElement(p.TemplateString,{template:he.Notification_AddUsers_Action2},t,t<2?he.Text_ServicePrincipal_Singular:he.Text_ServicePrincipal_Plural)})),A=(0,Ee.useTrackedAsyncCallback)(t,n.supportServicePrincipals?y:S,Se.PerformanceScenarioConstants.AddUsersFeatureName,((e,t)=>(e.measurements=Object.assign(Object.assign({},e.measurements),{Projects:d?d.length:0,Users:t?t.length:0}),e))),x=(0,Ee.useTrackedAsyncCallback)(t,E,Se.PerformanceScenarioConstants.AddUsersFeatureName,((e,t)=>(e.measurements=Object.assign(Object.assign({},e.measurements),{Projects:d?d.length:0,Users:t?t.length:0}),e)));if(!t||!r)return null;const T=s.getStyles(),U=Mt.UserValidationUtils.getAddUserDisplayWarning(n,Mt.UserValidationUtils.getWarning(t,n,r.selectedIdentities)),I=(0,Me.hasValidIdentities)(n,r.selectedIdentities),M=i.createElement(i.Fragment,null,n.supportServicePrincipals?he.UserInviteDialog_UsersOrServicePrincipals:he.UserInviteDialog_Users,!n.isGitHubUser&&n.isGitHubSearchEnabled&&i.createElement(P.Icon,{tooltipProps:{text:he.GitHubSearchWarning_TooltipContent},iconName:"Warning",ariaLabel:he.GitHubSearchWarning_HoverInfoLabel}));return i.createElement(Et.CommonPanel,{title:he.UserInviteDialog_DialogTitle,className:Te.L2ClassNames.panels.addUsers.root,onDismiss:()=>{t.ciTelemetry.publishCloseInvitationEvent(!0),e.onDismiss()},actionButtonProps:{disabled:!I||!l,text:he.UserInviteDialog_AddButton,onClick:()=>{if(o&&l)if(n.supportServicePrincipals){const t=ut.MemberEntitlementsList.createMemberEntitlementList(o,l,d,u);let s=!1;if(t.users.length>0&&(s=!0,A(t.users,!b)),t.servicePrincipals.length>0){s=!0;const e=!0;x(t.servicePrincipals,e)}s&&e.onDismiss()}else{const t=s.buildUserEntitlementsFromInput(o,l,d,u);t&&t.length>0&&(e.onDismiss(),A(t,!b))}}},contentClassName:T.content,defaultActiveElement:`${Te.L2ClassNames.formItems.userIdentityPicker} input`},i.createElement(f.FormItem,{label:M,className:Te.L2ClassNames.formItems.userIdentityPicker,required:!0},i.createElement(At.UserIdentityPicker,{pickerProvider:r.pickerProvider,onChange:r.onChange,selectedIdentities:r.selectedIdentities,placeholderText:n.supportServicePrincipals?he.UserInviteDialog_UsersOrServicePrincipals:he.UserInviteDialog_Users})),i.createElement(vt.AccessLevelDropdown,{disabled:!a.availableAccessLevels,label:he.UserInviteDialog_AccessLevel,onChange:c,selectedAccessLevel:l}),i.createElement("div",{className:s.getStyles().projectsLabelContainer},i.createElement("label",{className:"bolt-formitem-label body-m"},he.TitleText_EditUserBulkDialog_AddToProjects),i.createElement(Ie.AddToProjectsForm,{selected:d,selectedGroupType:u,onChange:g,onSelectedGroupTypeChange:m})),i.createElement("div",null,i.createElement(N.Checkbox,{className:Te.L2ClassNames.Dialogs.AddUser.SendInviteCheckbox,ariaLabel:he.UserInviteDialog_SendEmailAriaLabel,label:n.supportServicePrincipals?he.UserInviteDialog_SendEmailsToUsersOnly:he.UserInviteDialog_SendEmails,checked:b,onChange:()=>{C((e=>!e))}})),U&&i.createElement(X.MessageCard,{severity:"Info"},i.createElement("div",null,U)))}}("ComponentsHubCalloutsAddMemberAddUsersToCollection"),t.ComponentsHubCalloutsBulkStatus={},t.ComponentsHubCalloutsBulkStatusMember={},function(e){Rt=t[e]={};class s{static getDefaultSelectedTeams(e,t){const s=e&&e.defaultTeam&&e.defaultTeam.id,n=s&&t?t.find((e=>e.id===s)):void 0;return n&&[n]}static async getProjectAndTeamsPromise(e,t){const s=e.getRestClient(pt.CoreClientName);try{return await Promise.all([s.getProject(t),s.getTeams(t,void 0,500)])}catch(t){return e.telemetry.trackException(t,"AddUsersToProject.getProjectAndTeams"),[void 0,void 0]}}static createMembersActionDisplayName(e,t,s,n,r){const a=s>1?i.createElement(p.TemplateString,{template:he.TextTeamsPlural1},s.toLocaleString()):he.TextTeamSingular;let o="";return t>0&&(o=i.createElement(p.TemplateString,{template:he.ProjectInviteDialog_AccessLevelAssigned2},t.toLocaleString(),t>1?r:n)),i.createElement(p.TemplateString,{template:he.ProjectInviteDialog_UsersAdded4},t+e,e+t>1?r:n,a,o)}static getStyles(){return{content:(0,C.getSpacingContainerClassName)("y",16),addToProjectsLabel:(0,y.css)(I.FontClassNames.fontSizeL,(0,C.getSpacingClassName)("padding","top",12)),defaultLicenseLink:(0,C.getSpacingClassName)("margin","left",4)}}static getUnlicensedInfo(e){const t=e.filter((e=>!e.localId)),n=i.useContext(xe.UsersSummaryContext),{defaultAccessLevel:r}=n;let a=he.ProjectInviteDialog_UserNotInAccountWarning1_Fallback;if(r&&(a=r.licenseDisplayName),t.length>0)return s.buildInfoMessageForNotLicensedUsers(t.map((e=>e.displayName)),a)}static buildUsersInput(e,t,s){const n=s&&s.map((e=>({id:e}))),r=[],a=new we.BulkEditMemberEntitlementJsonDocumentBuilder,o={projectRef:{id:t},teamRefs:n,assignmentSource:void 0,group:void 0,isProjectPermissionInherited:void 0,projectPermissionInherited:void 0};let l=0,c=0;e.forEach((e=>{e.localId?++l:++c;const s=e instanceof Ne.AddIdentity?{displayName:e.entityId,principalName:e.entityId,subjectKind:Se.SubjectKind.User}:{displayName:e.displayName,origin:e.originDirectory,originId:e.originId?e.originId:void 0,principalName:e.signInAddress,subjectKind:Se.SubjectKind.User},u={id:e.localId?e.localId:void 0,projectEntitlements:[o],user:s},m=new Ke.User(u),d=e.localId;n&&d?n.forEach((s=>{a.addToTeam({displayName:e.displayName,id:d,accessLevelDisplayName:""},t,s.id),r.push({operationDisplayName:i.createElement(p.TemplateString,{template:he.ProjectInviteDialog_AddToTeam1},s.name),user:m})})):(a.addMemberEntitlement(u),r.push({operationDisplayName:he.ProjectInviteDialog_AssignLicenseAndTeams,user:new Ke.User(u)}))}));const[u,m]=a.build();if(u.length>0)return{jsonPatchDocument:u,metadata:m,existingUsersCount:l,newUsersCount:c,teamsCount:n?n.length:0}}static buildMembersInput(e,t,s){const n=s&&s.map((e=>({id:e}))),r=[],a=new we.BulkEditMemberEntitlementJsonDocumentBuilder,o={projectRef:{id:t},teamRefs:n,assignmentSource:void 0,group:void 0,isProjectPermissionInherited:void 0,projectPermissionInherited:void 0};let l=0,c=0;e.forEach((e=>{let s;e.localId?++l:++c,s=e.entityType===Se.DirectoryEntityType.ServicePrincipal?ut.MemberEntitlementsList.buildServicePrincipalEntitlement(e,void 0,[o]):ut.MemberEntitlementsList.buildUserEntitlementsFromIdentities(e,void 0,[o]);const u=new Ke.User(s),m=e.localId;n&&m?n.forEach((s=>{a.addToTeam({displayName:e.displayName,id:m,accessLevelDisplayName:""},t,s.id),r.push({operationDisplayName:i.createElement(p.TemplateString,{template:he.ProjectInviteDialog_AddToTeam1},s.name),user:u})})):(a.addMemberEntitlement(s),r.push({operationDisplayName:he.ProjectInviteDialog_AssignLicenseAndTeams,user:u}))}));const[u,m]=a.build();if(u.length>0)return{jsonPatchDocument:u,metadata:m,existingMembersCount:l,newMembersCount:c,teamsCount:n?n.length:0}}static buildAddMembersInputs(e,t,s){const n=e.filter((e=>e.entityType==Se.DirectoryEntityType.User||Mt.UserValidationUtils.VALID_EMAIL_ADDRESS_PATTERN.test(e.entityId))),r=e.filter((e=>e.entityType==Se.DirectoryEntityType.ServicePrincipal));return{users:this.buildMembersInput(n,t,s),servicePrincipals:this.buildMembersInput(r,t,s)}}static buildInfoMessageForNotLicensedUsers(e,t){return i.createElement(i.Fragment,null,i.createElement(p.TemplateString,{template:he.ProjectInviteDialog_UserNotInAccountWarning1},e.filter(Boolean).join(he.ListItemSeparator),t),i.createElement(S.Link,{href:Se.UserManagementLinks.DefaultAccessLevelLink,target:"_blank",rel:"noopener noreferrer",underline:!0},he.UserDialog_LearnMore))}}__decorate([a.memoize],s,"getProjectAndTeamsPromise",null),__decorate([a.memoize],s,"getStyles",null),t[e].AddUsersToProjectPanel=function(e){const t=(0,ye.useUserHubContext)(),n=(0,ye.useUserHubConfiguration)(),r=(0,Me.useAddUserIdentityPicker)(t,n),[a]=(0,_.useResolvedPromise)(e.teamId?void 0:s.getProjectAndTeamsPromise(t,e.projectId)),{projectOrTeamDisplayName:o}=e,l=(0,_t.useBulkUserApiNotificationCallback)(i.useCallback((async s=>{const r=await(0,we.processBulkUserActions)(t,n,s.jsonPatchDocument,s.metadata,!1);return e.onUsersAdded(),r}),[t,n,e.onUsersAdded]),(e=>s.createMembersActionDisplayName(e.existingUsersCount,e.newUsersCount,e.teamsCount,he.Text_User_Singular,he.Text_User_Plural))),c=(0,_t.useBulkMemberApiNotificationCallback)(i.useCallback((async s=>{const r=await(0,we.processBulkUserActions)(t,n,s.jsonPatchDocument,s.metadata,!1);return e.onUsersAdded(),r}),[t,n,e.onUsersAdded]),(e=>s.createMembersActionDisplayName(e.existingMembersCount,e.newMembersCount,e.teamsCount,he.Text_User_Singular,he.Text_User_Plural))),u=(0,_t.useBulkMemberApiNotificationCallback)(i.useCallback((async s=>{const r=await(0,we.processBulkServicePrincipalActions)(t,n,s.jsonPatchDocument,s.metadata);return e.onUsersAdded(),r}),[t,n,e.onUsersAdded]),(e=>s.createMembersActionDisplayName(e.existingMembersCount,e.newMembersCount,e.teamsCount,he.Text_ServicePrincipal_Singular,he.Text_ServicePrincipal_Plural)));let m,d;a&&([m,d]=a);const p=i.useMemo((()=>{const e=s.getDefaultSelectedTeams(m,d);return e&&e.map((e=>e.id))}),[m,d]),[g=p,b]=i.useState(void 0);if(!t||!r)return null;const{selectedIdentities:C}=r,v=(0,Me.hasValidIdentities)(n,C),h=s.getStyles(),S=Mt.UserValidationUtils.getAddUserDisplayWarning(n,Mt.UserValidationUtils.getWarning(t,n,C)),y=s.getUnlicensedInfo(C);return i.createElement(Et.CommonPanel,{actionButtonProps:{disabled:!v,text:he.UserInviteDialog_AddButton,onClick:()=>{if(n.supportServicePrincipals){let t=!1;const n=s.buildAddMembersInputs(C,e.projectId,e.teamId?[e.teamId]:g);n.users&&(c(n.users),t=!0),n.servicePrincipals&&(u(n.servicePrincipals),t=!0),t&&e.onDismiss()}else{const t=s.buildUsersInput(C,e.projectId,e.teamId?[e.teamId]:g);t&&(l(t),e.onDismiss())}}},title:(0,D.format)(he.ProjectInviteDialog_AddUsersTitleTemplate1,o),description:(0,D.format)(n.supportServicePrincipals?he.ProjectInviteDialog_AddUsersAndSPsSubTitle2:he.ProjectInviteDialog_AddUsersSubTitle1,o,e.teamId?he.Team:he.Project),onDismiss:()=>{t.ciTelemetry.publishCloseInvitationEvent(!0),e.onDismiss()},contentClassName:h.content},i.createElement(f.FormItem,{label:he.UserInviteDialog_Users},i.createElement(At.UserIdentityPicker,{pickerProvider:r.pickerProvider,onChange:r.onChange,selectedIdentities:r.selectedIdentities,placeholderText:n.supportServicePrincipals?he.UserInviteDialog_IdentityPickerPlaceholderMembers:he.UserInviteDialog_IdentityPickerPlaceholder})),d&&!e.teamId&&i.createElement(f.FormItem,{label:he.ProjectInviteDialog_AddToTeams},i.createElement(Ie.TeamsDropdown,{teams:d,onChange:b,selected:g})),S&&i.createElement(X.MessageCard,{severity:"Info"},S),y&&i.createElement(X.MessageCard,{severity:"Info"},y))}}("ComponentsHubCalloutsAddMemberAddUsersToProject"),function(e){kt=t[e]={},t[e].GroupCommandContext=i.createContext(void 0);class s{static reduce(e,t){return{operation:t.operation,group:t.group}}}s.initialState={operation:void 0,group:void 0},t[e].GroupCommandContextProvider=function(n){const[r,a]=i.useReducer(s.reduce,s.initialState),[o,l]=(0,Ct.useSaveFocusElement)(),c=i.useCallback(((e,t)=>{a({operation:e,group:t})}),[a]),u=i.useCallback((e=>{a({operation:e,group:void 0})}),[a]),m={operation:r.operation,group:r.group,onOpenModifyGroupCallout:c,onOpenIndependentCallout:u,saveFocusElement:o,onClose:()=>{a({operation:void 0,group:void 0}),l()}};return i.createElement(t[e].GroupCommandContext.Provider,{value:m},n.children)},t[e].groupCommandItems={add:{id:"add",text:he.CommandButtonText_AddSingleGroupRule,className:Te.L2ClassNames.commandItems.addGroupRule},reEvaluateAllRules:{id:"reEvaluateAllRules",text:he.GroupCommandBar_ReevaluateRules},fixAssignmentErrors:{id:"fixAssignmentErrors",text:he.GroupResolve_FixAssignmentIssues},manageGroup:{id:"manageGroup",text:he.ContextualMenuButtonText_ManageGroupRule,className:Te.L2ClassNames.commandItems.manageMember},manageMembers:{id:"manageMembers",text:he.ContextualMenuOptionManageMembers},remove:{id:"remove",className:Te.L2ClassNames.commandItems.removeFromOrganization,text:he.ContextualMenuButtonText_Remove}}}("ContextCommandContextGroup"),function(e){function s(e,t){if(0===t){const t=e[0];return t?i.createElement(J.Pill,{size:0,excludeTabStop:!0},i.createElement(p.TemplateString,{template:he.Notification_ChangeMember_Description_ChangeAccessLevel1},t.licenseDisplayName)):null}const s=e[t];if(0===s)return null;let n,r;switch(t){case 1:n=he.Notification_ChangeMember_Description_Summary_AddToProject2;break;case 2:n=he.Notification_ChangeMember_Description_Summary_RemoveFromProject2;break;case 3:n=he.Notification_ChangeMember_Description_Summary_ChangeProjectPermissions2;break;default:throw new Error("Unknown operationType: "+t)}if(s<2)switch(t){case 1:case 2:case 3:r=he.Text_Project_Singular;break;default:throw new Error("Unknown operationType: "+t)}else switch(t){case 1:case 2:case 3:r=he.Text_Project_Plural;break;default:throw new Error("Unknown operationType: "+t)}return i.createElement(J.Pill,{size:0,excludeTabStop:!0},i.createElement(p.TemplateString,{template:n},s,r))}function n(e){const t=(0,xe.useProjectRefsMapping)();return t&&t[e.projectId]?i.createElement(p.TemplateString,{template:e.template1},t[e.projectId].name):null}function r(e){const t=(0,xe.useProjectRefsMapping)(),s=(0,xe.useGroupOptionNames)();return t&&t[e.projectId]&&s[e.groupType]?i.createElement(p.TemplateString,{template:e.template2},t[e.projectId].name,s[e.groupType]):null}function a(e){const{results:t}=e;return i.createElement(i.Fragment,null,e.description,t.map((([e,t],s)=>{if(void 0===e||e.isSuccess)return null;const a=function(e){const[t]=e;switch(t){case 2:const[,,t]=e;return i.createElement("div",null,i.createElement(p.TemplateString,{template:he.Notification_ChangeMember_Description_ChangeAccessLevel1},t.licenseDisplayName));case 0:const[,,s,a,o]=e;switch(s){case 0:return i.createElement("div",null,i.createElement(r,{template2:he.Notification_ChangeMember_Description_AddToProject2,projectId:a,groupType:o}));case 2:return i.createElement("div",null,i.createElement(r,{template2:he.Notification_ChangeMember_Description_ChangeProjectPermissions2,projectId:a,groupType:o}));case 1:return i.createElement("div",null,i.createElement(n,{template1:he.Notification_ChangeMember_Description_RemoveFromProject1,projectId:a}))}}return null}(t);return i.createElement("div",{key:s,className:(0,C.getSpacingClassName)("margin","left",8)},a,i.createElement(xt.OperationErrors,{errors:e.errors,className:(0,C.getSpacingClassName)("margin","left",8)}))})))}wt=t[e]={},t[e].EditMemberNotificationDescription=function(e){const t=i.useMemo((()=>function(e){const t=[void 0,0,0,0];for(const s of e){const[e,,n]=s;switch(e){case 2:t[0]=n;break;case 0:0===n?++t[1]:1===n?++t[2]:2===n&&++t[3]}}return t}(e.metadata)),[e.metadata]);return i.createElement(Q.PillGroup,null,s(t,0),s(t,1),s(t,2),s(t,3))},t[e].EditMemberNotificationResultDescription=a;class o extends Ze.PatchResponseStatusNotification{constructor(e,t){super(e),this.description=i.createElement(a,{results:e,description:t})}}t[e].EditMemberStatusResultNotification=o}("ComponentsHubCalloutsEditMemberEditMemberNotifications"),function(e){Gt=t[e]={},t[e].EditMemberAccessLevelForm=function(e){const{memberAccessLevelDisplayName:t}=e;if(t)return i.createElement(f.FormItem,{label:he.HubColAccessLevel},t);const{validAccessLevels:s,selectedAccessLevel:n=e.member.accessLevel,groupAssignments:r}=e;return i.createElement(ft.AccessLevelDropdownWithGroupAssignments,{memberPromiseFulfilled:e.memberPromiseFulfilled,label:he.UserInviteDialog_AccessLevel,availableAccessLevels:s,selectedAccessLevel:n,onChange:e.onChange,groupAssignments:r})}}("ComponentsHubCalloutsEditMemberAccessLevelForm"),function(e){Bt=t[e]={},t[e].EditMemberPersona=function(e){const t=(0,ye.useUserHubContext)(),{member:s}=e;return i.createElement(Tt.MemberPersona,{pageContext:t,size:"large",member:s,secondaryText:e.isGroup?s.isAad?he.GroupAssignmentIcon_CalloutGroupTypeAad:he.GroupAssignmentIcon_CalloutGroupTypeVsts:s.principalName})}}("ComponentsHubCalloutsEditMemberMemberPersona"),function(e){jt=t[e]={};class s extends i.Component{static getValidAccessLevelMessageCardContent(e,t){if(t&&e&&e.length<2)return he.EditUserDialog_AccessLevelUnchangable}static getStyles(){return{accessLevelDropdown:(0,y.css)(j.CssClassNames.flex.auto),formUpper:(0,y.css)(I.FlexClassNames.flexRow,(0,C.getSpacingContainerClassName)("x",20)),formExtraInfo:j.CssClassNames.flex.auto,panelContent:(0,C.getSpacingContainerClassName)("y",20)}}static getValidAccessLevelOptions(e,t){const{accessLevel:s}=e;let n=[];return(t||[]).forEach((e=>{Le.AccessLevels.equals(e,s)?n=n.concat(s):2===s.licensingSource&&2===e.licensingSource||(n=n.concat(e))})),n.filter((e=>Le.AccessLevels.equals(e,s))).length<1&&(n=[s].concat(n)),n}static getMemberAccessLevelDisplayName(e,t){if(e.accessLevel&&t.length<2){const t=e.accessLevelLicenseDisplayName?"("+e.accessLevelLicenseDisplayName+")":"";return e.accessLevelDisplayName+" "+t}}}__decorate([a.memoize],s,"getStyles",null),t[e].EditMemberAccessLevelPanel=function(e){const{isAccessLevelOnly:t,member:n,extraInfo:r,memberPromiseFulfilled:a,selectedAccessLevel:o,groupAssignments:l}=e,c=i.useContext(xe.UsersSummaryContext),u=i.useMemo((()=>s.getValidAccessLevelOptions(n,c.availableAccessLevels)),[c.availableAccessLevels,n]),m=i.useMemo((()=>s.getMemberAccessLevelDisplayName(n,u)),[n,u]),d=i.useMemo((()=>s.getValidAccessLevelMessageCardContent(u,!!t)),[u,t]),p=s.getStyles();return i.createElement(Et.CommonPanel,{className:(0,y.css)(e.className,Te.L2ClassNames.panels.changeAccessLevel.root),title:e.title,onDismiss:e.onDismiss,size:t?1:2,actionButtonProps:e.actionButtonProps,contentClassName:p.panelContent,defaultActiveElement:".access-level-dropdown input"},i.createElement(Bt.EditMemberPersona,{member:n,isGroup:e.isGroup}),i.createElement("div",{className:p.formUpper},i.createElement("div",{className:p.accessLevelDropdown},i.createElement(Gt.EditMemberAccessLevelForm,{memberPromiseFulfilled:!!a,member:n,selectedAccessLevel:o,groupAssignments:l,validAccessLevels:u,memberAccessLevelDisplayName:m,onChange:e.onSelectedAccessLevelChanged})),r&&i.createElement("div",{className:p.formExtraInfo},r)),e.children,d&&i.createElement("div",null,i.createElement(X.MessageCard,{severity:"Info"},i.createElement("div",null,d))))}}("ComponentsHubCalloutsEditMemberEditMemberPanelAccessLevel"),function(e){Ht=t[e]={};class s{static getStyles(){return{content:(0,y.css)((0,C.getSpacingContainerClassName)("y",20)),noTabBarTitle:(0,y.css)(I.TextClassNames.ellipsis,I.FontClassNames.fontSizeMm)}}}__decorate([a.memoize],s,"getStyles",null),t[e].EditMemberPanelTabGroup=function(e){const{tabs:t,renderAdditionalContent:n,defaultTabId:r}=e;if(0===t.length)return null;const a=s.getStyles();if(1===t.length&&!n){const e=t[0];return i.createElement(i.Fragment,null,i.createElement("span",{className:a.noTabBarTitle,id:e.id||"singleTab"},e.name),e.content)}const o=i.useMemo((()=>{const t={};return e.tabs.forEach((e=>{t[e.id]=e})),t}),e.tabs),[l,c]=i.useState(r||t[0].id);return i.createElement(i.Fragment,null,i.createElement(ae.TabBar,{onSelectedTabChanged:e=>{c(e)},selectedTabId:l,renderAdditionalContent:n},...t.map((e=>i.createElement(ae.Tab,{name:e.name,id:e.id,key:e.id})))),i.createElement("div",{className:a.content},o[l]?o[l].content:void 0))}}("ComponentsHubCalloutsEditMemberEditMemberPanelTabGroup"),function(e){function s(e){const{member:t,memberPromiseFulfilled:s,initialTab:n}=e;return s?e.isGroupRuleInFlight?i.createElement(c.Spinner,{className:(0,y.css)(I.FlexClassNames.flexRow,(0,C.getSpacingContainerClassName)("x",12)),size:"large",label:he.LabelText_TestLicensingRuleApplicationWait}):i.createElement(Ht.EditMemberPanelTabGroup,{tabs:[{id:"projects",name:he.EditUserDialog_ProjectsTabTitle,content:i.createElement(Oe.EditMemberProjectsForm,{memberProjectEntitlements:t.projectEntitlements,groupAssignments:e.groupAssignments,onChange:e.onProjectSelectionChange,selectionDelta:e.projectSelectionDelta})},...e.additionalTabs||[]],defaultTabId:n}):i.createElement(c.Spinner,{size:"large"})}Ot=t[e]={},t[e].EditMemberPanel=function(e){return i.createElement(jt.EditMemberAccessLevelPanel,{actionButtonProps:e.actionButtonProps,className:e.className,member:e.member,onDismiss:e.onDismiss,isGroup:e.isGroup,memberPromiseFulfilled:e.memberPromiseFulfilled,onSelectedAccessLevelChanged:e.onSelectedAccessLevelChanged,selectedAccessLevel:e.selectedAccessLevel,groupAssignments:e.groupAssignments,title:e.title,extraInfo:e.extraInfo},i.createElement(s,Object.assign({},e)),e.children)}}("ComponentsHubCalloutsEditMemberEditMemberPanel"),function(e){function s(e,t,s){const[,,n]=(0,Nt.useLicensingRuleApplicationStatus)(t.id),r=i.useCallback((async()=>{await s();return n().pollUntilCompletePromise}),[s,n]),[a,o]=(0,oe.useAsyncAction)(r);return a?{previewResult:a}:e?{preview:o}:{}}Vt=t[e]={},t[e].PreviewDowngradeLicenseMessageCard=function(e){const t=i.useContext(xe.UsersSummaryContext),{group:s,applicationStatus:n}=e,r=[];return 4===n.status&&e.hasDowngrade&&(n.licenses.forEach((e=>{const a=Le.AccessLevels.fromAccountUserLicense(e.accountUserLicense);if(a&&Le.AccessLevels.isPossibleAccessLevelDowngrade(s.accessLevel,a)){const s=a&&Le.AccessLevels.mapToAvailableAccessLevel(t.availableAccessLevels,a),o=s?s.licenseDisplayName:e.license.toString();n.isTruncated?r.push(i.createElement(p.TemplateString,{template:he.WarningMessageText_DowngradeAccessLevel_Plus2},e.assigned,o)):r.push(e.assigned<=1?i.createElement(p.TemplateString,{template:he.WarningMessageText_DowngradeAccessLevel_Singular1},o):i.createElement(p.TemplateString,{template:he.WarningMessageText_DowngradeAccessLevel_Plural2},e.assigned,o))}})),r.length<1&&n.isTruncated?r.push(he.GroupEdit_GroupTooLarge):r.length<1&&r.push(he.GroupEdit_NoPreviewChanges)),0===r.length?null:i.createElement(X.MessageCard,{severity:"Warning"},i.createElement("div",null,r.map(((e,t)=>i.createElement("div",{key:t},e)))))},t[e].TestApplyGroupRuleInflightStatusMessageCard=function(){return i.createElement(Ut.StatusMessageCard,{statusType:"Running"},i.createElement("div",null,he.LabelText_TestLicensingRuleApplicationWait))},t[e].useEditOrRemoveGroup=s,t[e].useEditGroup=function(e,t,n){const r=(0,ye.useUserHubContext)(),a=Le.AccessLevels.isPossibleAccessLevelDowngrade(e.accessLevel,t),[o]=n.build(),l=i.useCallback((()=>r.getRestClient(Ae.MemberEntitlementManagementClientName).updateGroupEntitlement(o,e.groupEntitlement.id,1)),[e,t,r,o]),c=s(a,e,l);return Object.assign(Object.assign({},c),{hasDowngrade:a})}}("ComponentsHubCalloutsEditMemberuseEditGroup"),function(e){zt=t[e]={},t[e].EditGroupPanel=function(e){let{member:t}=e;const s=(0,ye.useUserHubContext)(),n=i.useContext(st.GroupsContext),[r,a]=i.useState(t.accessLevel),[o,l]=i.useState({}),c=(0,Ve.useEditMemberBuilder)(t,r,o),{preview:u,previewResult:m,hasDowngrade:d}=(0,Vt.useEditGroup)(t,r,c),g=i.useContext(Nt.LicensingRulesContext),b=(0,ze.useRefreshedMember)(t.id,n&&n.refreshGroup);t=b||t;const v=!!b,{updateGroupRule:h}=(0,at.useGroupsContextApiActions)(),f=(0,We.useNotificationAsyncCallback)(h,{onGetDisplayName:()=>i.createElement(p.TemplateString,{template:he.Notification_ChangeGroup_Action1},t.displayName),onGetDescription:(e,t,s)=>i.createElement(wt.EditMemberNotificationDescription,{metadata:s}),onGetResultNotification:(e,t,s,n)=>new wt.EditMemberStatusResultNotification(e,i.createElement(wt.EditMemberNotificationDescription,{metadata:n}))}),S=(0,Ee.useTrackedAsyncCallback)(s,f,Se.PerformanceScenarioConstants.EditGroupFeatureName,((e,t,s,n)=>(e.measurements["operation Count"]=n.length,e))),y=m&&0===m.state;return n?i.createElement(Ot.EditMemberPanel,{onDismiss:e.onDismiss,member:t,memberPromiseFulfilled:v,className:Te.L2ClassNames.panels.editGroupRule.root,actionButtonProps:{disabled:0===c.length||m&&0===m.state,text:u?he.ButtonText_Preview:he.ButtonText_SaveChanges,onClick:u||(()=>{e.onDismiss();const[s,n]=c.build();(async()=>{await S(t,s,n),g.startPollLicensingRule(t.id,!0)})()}),className:u?Te.L2ClassNames.callouts.previewButton:void 0,isPrimary:!m||0!==m.state},isGroup:!0,selectedAccessLevel:r,title:he.ContextualMenuButtonText_ManageGroupRule,projectSelectionDelta:o,onSelectedAccessLevelChanged:a,onProjectSelectionChange:l,isGroupRuleInFlight:y},i.createElement("div",{className:(0,C.getSpacingClassName)("margin","bottom",8),style:{marginTop:"auto"}},m&&m.value&&i.createElement(Vt.PreviewDowngradeLicenseMessageCard,{applicationStatus:m.value,group:t,hasDowngrade:d}))):null}}("ComponentsHubCalloutsEditMemberEditGroupPanel"),function(e){qt=t[e]={};class s{static getStyles(){return{root:(0,y.css)("aex-user-hub-edit-group-membership-bar"),actionContainer:(0,y.css)(I.FlexClassNames.flexRow,I.FlexClassNames.alignItemsCenter,(0,C.getSpacingContainerClassName)("x",4)),label:(0,y.css)(I.FlexClassNames.flexRow,I.FlexClassNames.alignItemsCenter,(0,C.getSpacingContainerClassName)("x",8)),footer:I.FlexClassNames.justifyContentFlexEnd}}}__decorate([a.memoize],s,"getStyles",null),t[e].EditGroupMembershipBar=function(e){const t=s.getStyles(),n=(0,ye.useUserHubConfiguration)(),{actionButtonText:r,selectedIdentity:a}=e,o=i.createElement("div",{className:t.label},he.BulkStatusDialogColumnName_User,!n.isGitHubUser&&n.isGitHubSearchEnabled&&i.createElement(P.Icon,{tooltipProps:{text:he.GitHubSearchWarning_TooltipContent},iconName:"Info",ariaLabel:he.GitHubSearchWarning_HoverInfoLabel}));return i.createElement(W.Surface,{background:1},i.createElement(le.CustomCard,{className:(0,y.css)(t.root,e.className)},i.createElement(le.CardContent,null,i.createElement("div",{className:b.SizeClassNames.width100},i.createElement(f.FormItem,{label:o},i.createElement(At.IdentityPickerDropdown,{pickerProvider:e.identityPickerProvider,value:a,onChange:e.onSelectedIdentityChange})))),i.createElement(le.CardFooter,{className:t.footer},i.createElement(H.Button,{onClick:e.onActionButtonClick,disabled:!a||e.isActionInProgress,primary:!0,className:e.actionButtonClassName},i.createElement("div",{className:t.actionContainer},e.isActionInProgress&&i.createElement(c.Spinner,{size:"small"}),i.createElement("span",null,r))))))}}("ComponentsHubCalloutsEditMemberEditGroupFormEditMembershipBar"),function(e){Wt=t[e]={};class s{static async addMember(e,t,n,r,i){let a=i.localId;if(!a){const e=s.buildUserEntitlements(n,i);if(!e)return;const[[r]]=await t.addUsersToCollection([e],!0);if(!r||!r.isSuccess)return r;a=r.userId}const o=e.getRestClient(Ae.MemberEntitlementManagementClientName);await o.addMemberToGroup(r.id,a),await t.removeDirectAssignments([a],0)}static buildUserEntitlements(e,t){const s=e?e.filter((e=>5===e.accountLicenseType)):void 0,n=s&&s.length>0?s[0]:e&&e.length>0?e[0]:{accountLicenseType:5,licensingSource:1,msdnLicenseType:0},[r]=mt.UserEntitlements.buildUserEntitlementsFromIdentities([t],n);return r}}t[e].EditGroupAddMembers=function(e){const t=(0,ye.useUserHubContext)(),n=(0,ye.useUserHubConfiguration)(),r=i.useContext(xe.UsersSummaryContext),a=(0,it.useUsersContextApiActions)(),o=(0,Me.useAddUserIdentityPickerProvider)(t,n,!0),[l,c]=i.useState(void 0),[u,m]=(0,oe.useAsyncAction)((async()=>{const n=r.availableAccessLevels;l&&n&&(await s.addMember(t,a,n,e.group,l),r.refresh("licenses"),e.onAddComplete())})),d=l&&Mt.UserValidationUtils.getWarning(t,n,[l]);if(!o)return null;const p=u&&u.error&&new F.HandledError(u.error);return i.createElement("div",{className:(0,C.getSpacingContainerClassName)("y",8)},i.createElement(qt.EditGroupMembershipBar,{className:Te.L2ClassNames.Dialogs.ManageGroupMembers.AddMemberContainer,actionButtonText:he.UserInviteDialog_AddButton,identityPickerProvider:o,selectedIdentity:l,onSelectedIdentityChange:c,onActionButtonClick:m,isActionInProgress:!!u&&0===u.state}),d&&d.warningMessageOfAadGuestUsers&&i.createElement(X.MessageCard,{severity:"Warning"},d.warningMessageOfAadGuestUsers),p&&i.createElement(X.MessageCard,{severity:"Error"},p.isUserError?p.message:i.createElement(qe.GenericErrorMessage,null)))}}("ComponentsHubCalloutsEditMemberEditGroupFormAddMembers"),function(e){Kt=t[e]={},t[e].EditGroupRemoveMembers=function(e){const t=(0,ye.useUserHubContext)(),s=i.useRef(new A.PeoplePickerProvider(t.pageContext,{operationScopes:["ims"],identityTypes:["user"]})),[n,r]=i.useState(void 0),[a,o]=(0,oe.useAsyncAction)((async()=>{if(n){const{group:s}=e,r=n.localId;if(!r)return;const i=t.getRestClient(Ae.MemberEntitlementManagementClientName);await i.removeMemberFromGroup(s.id,r),e.onRemoveComplete()}}));if(!s)return null;const l=a&&a.error&&new F.HandledError(a.error);return i.createElement("div",{className:(0,C.getSpacingContainerClassName)("y",8)},i.createElement(qt.EditGroupMembershipBar,{className:Te.L2ClassNames.Dialogs.ManageGroupMembers.RemoveMemberContainer,actionButtonClassName:Te.L2ClassNames.Dialogs.ManageGroupMembers.RemoveButton,actionButtonText:he.HubButtonTextRemove,identityPickerProvider:s.current,selectedIdentity:n,onSelectedIdentityChange:r,onActionButtonClick:o,isActionInProgress:!!a&&0===a.state}),l&&i.createElement(X.MessageCard,{severity:"Error"},l.isUserError?l.message:i.createElement(qe.GenericErrorMessage,null)))}}("ComponentsHubCalloutsEditMemberEditGroupFormRemoveMembers"),function(e){$t=t[e]={};class s{static getStyles(){return{persona:(0,y.css)(I.FlexClassNames.flexRow,I.FlexClassNames.alignItemsCenter,(0,C.getSpacingContainerClassName)("x",8)),personaName:j.CssClassNames.flex.auto,zeroDataImage:(0,C.getSpacingClassName)("margin","all",40)}}}__decorate([a.memoize],s,"getStyles",null),t[e].GroupMembersTable=function(e){const{group:t}=e,n=(0,ye.useUserHubContext)(),r=(0,ye.useUserHubConfiguration)(),[[a,o],l]=(0,d.useAsyncState)([[],!1]),c=!o&&!1!==o,u=s.getStyles(),m=n.getRestClient(Ae.MemberEntitlementManagementClientName),p=i.useCallback((async()=>{const e=await m.getGroupMembers(t.id,r.groupMembersBatchSize,!1===o?void 0:o);l((([t])=>[t.concat(e.members),e.continuationToken]))}),[l,m,t.id,o,r.groupMembersBatchSize]),{itemProvider:g,behavior:b}=(0,Be.useAutoLoadingTableProps)(a,c,c?void 0:p),C=i.useMemo((()=>[{readonly:!0,id:"name",width:-50,name:he.HubColName,renderCell:(e,t,s,r)=>i.createElement(U.SimpleTableCell,{columnIndex:t,tableColumn:s,key:t},i.createElement("div",{className:u.persona},i.createElement(Z.VssPersona,{size:"small",imageUrl:_e.Member.getAvatarUrl(n,r.id)}),i.createElement("span",{className:u.personaName},r.user.displayName)))},{id:"email",width:-50,name:he.HubColEmail,renderCell:(e,t,s,n)=>i.createElement(U.SimpleTableCell,{columnIndex:t,tableColumn:s,key:t},n.user.principalName)}]),[n,u]);return 0!==a.length||o||!1===o?i.createElement(U.Table,{itemProvider:g,behaviors:[b],columns:C}):i.createElement(L.ZeroData,{className:u.zeroDataImage,imagePath:n.getImageUrl(ye.UserHubPageContextService.noResultsAssetsId),imageAltText:"",primaryText:he.NoResults_NoDirectMembersFound})}}("ComponentsHubCalloutsEditMemberGroupMembersTable"),function(e){Jt=t[e]={},t[e].EditGroupManageMembersPanel=function(e){const{group:t}=e,[s,n]=i.useState("addMember"),[r,a]=i.useState(0);return i.createElement(V.Panel,{size:2,onDismiss:e.onDismiss,titleProps:{text:he.EditGroupMembers_DialogTitle},contentClassName:Te.L2ClassNames.Dialogs.ManageGroupMembers.DialogContainer},i.createElement("div",{className:(0,y.css)(b.SizeClassNames.width100)},i.createElement(Bt.EditMemberPersona,{isGroup:!0,member:t}),t.isAad?i.createElement(X.MessageCard,{className:(0,C.getSpacingClassName)("margin","top",32),severity:"Warning"},he.EditGroupMembersDialog_CannotEditAadGroup):i.createElement("div",{className:(0,y.css)(b.SizeClassNames.width100,(0,C.getSpacingContainerClassName)("y",8))},i.createElement(ae.TabBar,{selectedTabId:s,onSelectedTabChanged:n},i.createElement(ae.Tab,{name:he.EditGroupMembers_IdentityPickerAddMembersLabel,id:"addMember"}),i.createElement(ae.Tab,{name:he.EditGroupMembers_IdentityPickerRemoveMembersLabel,id:"removeMember"})),"addMember"===s&&i.createElement(Wt.EditGroupAddMembers,{group:t,onAddComplete:()=>{a((e=>e+1))}}),"removeMember"===s&&i.createElement(Kt.EditGroupRemoveMembers,{group:t,onRemoveComplete:()=>{a((e=>e+1))}}),i.createElement($t.GroupMembersTable,{group:t,key:t.id+"-"+r}))))}}("ComponentsHubCalloutsEditMemberEditGroupPanelManageMembers"),function(e){Qt=t[e]={},t[e].ReEvaluateRulesDialog=function(e){const t=(0,ye.useUserHubContext)(),[,,s]=(0,Nt.useAllLicensingRulesApplicaitonStatus)(),n=i.useCallback((async()=>{e.onDismiss();const n=(0,nt.getMEMInternalClient)(t.pageContext);await n.reApplyAllGroupEntitlementsToUsers(0),s(!0)}),[t.pageContext]);return i.createElement(yt.CommonDialog,{title:he.TitleText_ReEvaluateRulesDialog_ReEvaluateRules,onDismiss:e.onDismiss,actionButtonProps:{text:he.ButtonText_ReEvaluate,onClick:n}},he.ReEvaluateRulesDialog_Description)}}("ComponentsHubCalloutsReEvaluateRulesDialog"),function(e){Yt=t[e]={};t[e].RemoveMemberDialogUtils=class{static getMemberTitle(e){const{displayName:t,principalName:s}=e;return s&&t!==s?t?t+" ("+s+")":s:t}};class s extends i.Component{static getStyles(){return{title:I.FontClassNames.fontSizeL,content:(0,C.getSpacingContainerClassName)("y",20)}}render(){const e=s.getStyles(),{memberTitleForPrompt:t,pageContext:n}=this.props;return i.createElement("div",{className:e.content},i.createElement("div",{className:e.title},i.createElement(p.TemplateString,{template:he.UserRemoveDialog_RemoveUserPrompt2},t,n.orgName)),this.props.children)}}__decorate([a.memoize],s,"getStyles",null),t[e].RemoveMemberDialogContent=s}("ComponentsHubCalloutsRemoveMemberRemoveMemberDialog"),function(e){Zt=t[e]={},t[e].RemoveGroupDialog=function(e){const t=(0,ye.useUserHubContext)(),s=i.useContext(xe.UsersSummaryContext),n=i.useContext(st.GroupsContext),r=i.useContext(We.UserHubNotificationsContext),a=i.useContext(it.UsersContext),o=i.useContext(Nt.LicensingRulesContext),[l,c]=i.useState(!1),{member:u}=e,m=i.useCallback((()=>t.getRestClient(Ae.MemberEntitlementManagementClientName).deleteGroupEntitlement(u.groupEntitlement.id,1)),[t,u]),d=(0,Vt.useEditOrRemoveGroup)(!0,u,m),{preview:g,previewResult:b}=d,C=b&&0===b.state,v=(0,at.useGroupsContextApiActions)(),h=(0,Ee.useTrackedAsyncCallback)(t,(async()=>{if(e.onDismiss(),!n)return;const t=r.createNotification(),c=i.createElement(p.TemplateString,{template:he.Notification_RemoveGroup_Action1},u.displayName);r.setNotification(t,{title:c,statusType:"Running"});const m=await v.deleteGroupRule(u,l);if(m.isSuccess){const e=o.startPollLicensingRule(u.id,!0,!0);await e.pollUntilCompletePromise,r.setNotification(t,{title:c,statusType:"Success"}),a.refreshMembersList(),s.refresh("licenses")}else r.setNotification(t,{title:c,statusType:"Failed",description:i.createElement(xt.OperationErrors,{errors:m.errors})})}),Se.PerformanceScenarioConstants.RemoveGroupFeatureName);return n?i.createElement(yt.CommonDialog,{onDismiss:e.onDismiss,className:Te.L2ClassNames.dialogs.removeGroup.root,title:(0,D.format)(he.DialogTitle_RemoveAadGroupRule1,u.displayName),actionButtonProps:{text:g?he.ButtonText_Preview:he.HubButtonTextRemove,onClick:g||h,disabled:C,className:g?Te.L2ClassNames.callouts.previewButton:void 0}},i.createElement(Yt.RemoveMemberDialogContent,{pageContext:t,memberTitleForPrompt:Yt.RemoveMemberDialogUtils.getMemberTitle(u)},i.createElement("div",null,i.createElement(X.MessageCard,{severity:"Warning"},i.createElement("div",null,i.createElement(p.TemplateString,{template:he.DialogMessage_RemoveAadGroupRule1},u.displayName)))),i.createElement("div",null,i.createElement(N.Checkbox,{checked:l,label:(0,D.format)(he.DialogCheckbox_RemoveGroupMembership1,u.displayName),onChange:(e,t)=>{c(t)}})),b&&0===b.state&&i.createElement(Vt.TestApplyGroupRuleInflightStatusMessageCard,null),b&&b.value&&i.createElement(Vt.PreviewDowngradeLicenseMessageCard,{applicationStatus:b.value,group:u,hasDowngrade:!0}))):null}}("ComponentsHubCalloutsRemoveMemberRemoveGroupDialog"),function(e){Xt=t[e]={},t[e].LicenseBuyLink=function(e){const t=(0,ye.useUserHubContext)();return i.createElement(S.Link,{href:t.assembleLicenseLink(e.marketplaceId),target:"_blank",rel:"noopener noreferrer",underline:!0},he.UserBuyLink)},t[e].LicenseMissingCountMessage=function(e){const t=e.numLicensesNeeded-e.extensionSummary.available;return i.createElement(p.TemplateString,{template:e.isTruncated?he.Text_LicensesMissingCountPlus1:he.Text_LicensesMissingCount1},t<0?0:t.toLocaleString(),";")},t[e].RefreshLicensesButton=function(){const e=function(){const e=i.useContext(xe.UsersSummaryContext);return i.useMemo((()=>({iconProps:{iconName:"Refresh"},onClick:()=>{e.refresh("licenses")},text:he.ButtonText_Refresh,tooltipProps:{text:he.RefreshIcon_ExtensionRefreshDescription}})),[e.refresh])}();return i.createElement(H.Button,Object.assign({},e))}}("ComponentsHubFormsExtensionForms"),function(e){es=t[e]={};class s{static hasApplicationDiff(e){return e.licenses&&e.licenses.length>0}static getStyles(){return{content:(0,C.getSpacingContainerClassName)("y",16)}}static applicationStatusHasErrorsInRules(e){return 0===e.option&&e.licenses&&e.licenses.some((e=>e.failed>0||e.insufficientResources>0))}static convertFailedApplicationStatusToPerformingApplicationStatus(e){if(4!==e.status)return e;return{licenses:e.licenses.map((e=>({accountUserLicense:e.accountUserLicense,assigned:e.insufficientResources+e.failed,failed:0,insufficientResources:0,license:e.license}))),option:e.option,status:e.status}}static extractLicenseFromLicenseSummaryListUsingLicenseSourceAndType(e,t,s,n){return e.find((e=>!(e.source!==t||null!=s&&e.accountLicenseType!==s||null!=n&&e.msdnLicenseType!==n)))}static getResolveSummaryItems(e,t){const n=[],r=[],{isTruncated:i}=e;if(t&&e.licenses)for(const a of e.licenses){const e=Le.AccessLevels.fromAccountUserLicense(a.accountUserLicense);if(!e)break;const{licensingSource:o,accountLicenseType:l=0,msdnLicenseType:c=0}=e,u=s.extractLicenseFromLicenseSummaryListUsingLicenseSourceAndType(t,o,l,c);if(u){if(a.assigned>u.available){const e=1===a.accountUserLicense.source&&2===a.accountUserLicense.license?Se.LinkConstants.PaidBasicLicenseId:a.accountUserLicense.source+"-"+a.accountUserLicense.license;n.push({isValid:!1,name:u.licenseName,needed:a.assigned,summary:u,summaryLinkId:e,isTruncated:i})}else r.push({isValid:!0,name:u.licenseName,needed:a.assigned,summary:u,isTruncated:i})}}return n.concat(r)}static getResolveTableColumns(){return[{id:"status",renderCell:(e,t,s,n)=>i.createElement(It.OneLineSimpleTableCell,{columnIndex:t,tableColumn:s,key:t},i.createElement(ee.Status,Object.assign({},n.isValid?ee.Statuses.Success:ee.Statuses.Failed,{size:"12"}))),width:40},{id:"name",renderCell:(e,t,s,n)=>i.createElement(It.OneLineSimpleTableCell,{columnIndex:t,tableColumn:s,key:t},i.createElement("span",null,n.name)),width:-40},{id:"missing-count",renderCell:(e,t,s,n)=>i.createElement(It.OneLineSimpleTableCell,{columnIndex:t,tableColumn:s,key:t},n.needed>0&&i.createElement(Xt.LicenseMissingCountMessage,{extensionSummary:n.summary,numLicensesNeeded:n.needed,isTruncated:n.isTruncated})),width:-30},{id:"buy-more",renderCell:(e,t,s,n)=>i.createElement(It.OneLineSimpleTableCell,{columnIndex:t,tableColumn:s,key:t},n.summaryLinkId&&i.createElement(Xt.LicenseBuyLink,{marketplaceId:n.summaryLinkId})),width:-30}]}}function n(e){const t=i.useContext(xe.UsersSummaryContext);let{applicationStatus:n}=e;s.applicationStatusHasErrorsInRules(n)&&(n=s.convertFailedApplicationStatusToPerformingApplicationStatus(n));const{isTruncated:r}=n,a=i.useMemo((()=>new ce.ArrayItemProvider(s.getResolveSummaryItems(n,t.licenses))),[n,t.licenses]),o=i.useMemo((()=>s.getResolveTableColumns()),[]);return e.hasApplicationDiff?i.createElement("div",null,i.createElement(Xt.RefreshLicensesButton,null),i.createElement(U.Table,{showHeader:!1,itemProvider:a,columns:o})):i.createElement(X.MessageCard,{severity:"Info"},i.createElement("div",null,r?he.GroupResolve_GroupTooLarge:he.GroupResolve_NothingToFix))}__decorate([a.memoize],s,"getStyles",null),t[e].ResolveGroupsDialog=function(e){const t=(0,ye.useUserHubContext)(),[r,a,o]=(0,Nt.useAllLicensingRulesApplicaitonStatus)(),l=void 0!==r&&1!==r.option,c=!!r&&(0,lt.isOperationStatusCompleted)(r.status),u=i.useRef(a);i.useEffect((()=>{u.current||(a?u.current=!0:void 0===r?o():(0,lt.isOperationStatusCompleted)(r.status)&&(u.current=!0,(async()=>{const e=(0,nt.getMEMInternalClient)(t.pageContext);await e.reApplyAllGroupEntitlementsToUsers(1),o()})()))}));const m=i.useCallback((async()=>{e.onDismiss();const s=(0,nt.getMEMInternalClient)(t.pageContext);await s.reApplyAllGroupEntitlementsToUsers(),o(!0)}),[t.pageContext]),d=u.current,p=s.getStyles();let g,b=!1,C=!1;return d&&r&&(l||c)?l&&!c?(g=i.createElement(Ut.StatusMessageCard,{statusType:"Running"},i.createElement("div",null,he.GroupResolve_RunningApplyJob)),b=!0):(C=s.hasApplicationDiff(r),g=i.createElement(n,{applicationStatus:r,hasApplicationDiff:C})):g=i.createElement(Ut.StatusMessageCard,{statusType:"Running"},i.createElement("div",null,i.createElement("div",{className:B.ColorClassNames.secondaryText},he.GroupResolve_OneMoment),i.createElement("div",{className:I.FontClassNames.fontWeightSemiBold},he.GroupResolve_CalculatingMissingResources))),i.createElement(yt.CommonDialog,{actionButtonProps:{disabled:b,text:C?he.GroupResolve_FixErrors:he.ButtonText_ResoveAllGroupRules,onClick:m,isPrimary:C},contentSize:2,onDismiss:e.onDismiss,title:he.GroupResolve_FixAssignmentIssues},i.createElement("div",{className:p.content},g))}}("ComponentsHubCalloutsResolveGroupsDialog"),function(e){ts=t[e]={},t[e].GroupCallouts=function(){const e=i.useContext(kt.GroupCommandContext);if(!e)return null;const{onClose:t,group:s,operation:n}=e;switch(n){case"add":return i.createElement(Dt.AddGroupPanel,{onDismiss:t});case"reEvaluateAllRules":return i.createElement(Qt.ReEvaluateRulesDialog,{onDismiss:t});case"fixAssignmentErrors":return i.createElement(es.ResolveGroupsDialog,{onDismiss:t})}if(!s)return null;switch(n){case"manageGroup":return i.createElement(zt.EditGroupPanel,{onDismiss:t,member:s});case"manageMembers":return i.createElement(Jt.EditGroupManageMembersPanel,{onDismiss:t,group:s});case"remove":return i.createElement(Zt.RemoveGroupDialog,{onDismiss:t,member:s})}return null}}("ComponentsHubCalloutsCalloutsGroup"),function(e){ss=t[e]={},t[e].BulkUserCommandContext=i.createContext(void 0);class s{static reduce(e,t){return{operation:t.operation,users:t.users,flowId:e.flowId+1}}}s.initialState={operation:void 0,flowId:0,users:void 0},t[e].BulkUserCommandContextProvider=function(n){const[r,a]=i.useReducer(s.reduce,s.initialState),o=i.useCallback(((e,t)=>{a({operation:e,users:t})}),[a]),l={operation:r.operation,flowId:r.flowId,onOpenBulkModifyUserCallout:o,users:r.users,onClose:()=>{a({operation:void 0,users:void 0})}};return i.createElement(t[e].BulkUserCommandContext.Provider,{value:l},n.children)},t[e].userBulkCommandItems={changeAccessLevel:{id:"changeAccessLevel",text:he.ContextualMenuButtonText_ChangeAccessLevel,className:Te.L2ClassNames.commandItems.changeAccessLevel},addToProjects:{id:"addToProjects",text:he.TitleText_EditUserBulkDialog_AddToProjects},removeFromProjects:{id:"removeFromProjects",text:he.TitleText_EditUserBulkDialog_RemoveFromProjects},remove:{id:"remove",text:he.EditUserBulkDialog_RemoveFromAccount},removeDirectAssignment:{id:"removeDirectAssignment",text:he.ContextualMenuOptionRemoveDirectAssignment}}}("ContextCommandContextUserBulk"),function(e){ns=t[e]={},t[e].BulkEditUserPanelDescription=function(e){return i.createElement(p.TemplateString,{template:he.TextNumberOfUsersSelected},e.usersCount)}}("ComponentsHubCalloutsEditUserBulkCommon"),function(e){rs=t[e]={},t[e].BulkEditUserAddToProjectsPanel=function(e){const{users:t}=e,[s,n]=(0,Ie.useSelectedGroupType)(),[r,a]=i.useState([]),o=r.length,l=(e,t)=>i.createElement(p.TemplateString,{template:he.Notification_BulkChangeMembers_Action_AddToProjects4},e,t,o,o<2?he.Text_Project_Singular:he.Text_Project_Plural),{supportServicePrincipals:c}=(0,ye.useUserHubConfiguration)(),{addUsersToProjects:u,addServicePrincipalsToProjects:m}=(0,it.useUsersContextApiActions)(),d=(0,_t.useBulkUserApiNotificationCallback)(u,(e=>l(e.length,1===e.length?he.Text_User_Singular:he.Text_User_Plural)),Lt.BulkProjectStatusTree),g=(0,_t.useBulkMemberApiNotificationCallback)(u,(e=>l(e.length,1===e.length?he.Text_User_Singular:he.Text_User_Plural)),Lt.BulkProjectStatusTree),b=(0,_t.useBulkMemberApiNotificationCallback)(m,(e=>l(e.length,1===e.length?he.Text_ServicePrincipal_Singular:he.Text_ServicePrincipal_Plural)),Lt.BulkProjectStatusTree);return i.createElement(Et.CommonPanel,{actionButtonProps:{disabled:0===o,text:he.UserInviteDialog_AddButton,className:Te.L2ClassNames.Dialogs.EditBulk.AddToProjectsConfirmationButton,onClick:()=>{if(r&&r.length>0)if(e.onDismiss(),c){const e=t.filter((e=>e.isServicePrincipal)),n=t.filter((e=>!e.isServicePrincipal));e.length>0&&b(e,r,s),n.length>0&&g(n,r,s)}else d(t,r,s)}},title:he.TitleText_EditUserBulkDialog_AddToProjects,description:i.createElement(ns.BulkEditUserPanelDescription,{usersCount:e.users.length}),onDismiss:e.onDismiss,contentClassName:(0,C.getSpacingContainerClassName)("y",20)},i.createElement(Ie.AddToProjectsForm,{selectedGroupType:s,selected:r,onSelectedGroupTypeChange:n,onChange:a}))}}("ComponentsHubCalloutsEditUserBulkAddToProjectsPanel"),function(e){is=t[e]={},t[e].BulkEditUserChangeAccessLevelPanel=function(e){const{users:t}=e,[s,n]=i.useState(t[0].accessLevel),r=i.createElement(p.TemplateString,{template:he.Notification_BulkChangeMembers_Action_ChangeAccessLevel3},s.licenseDisplayName,t.length,he.Text_User_Plural),{supportServicePrincipals:a}=(0,ye.useUserHubConfiguration)(),{bulkChangeUserAccessLevel:o,bulkChangeServicePrincipalAccessLevel:l}=(0,it.useUsersContextApiActions)(),c=(0,_t.useBulkUserApiNotificationCallback)(o,(()=>r)),u=(0,_t.useBulkMemberApiNotificationCallback)(o,((e,t)=>i.createElement(p.TemplateString,{template:he.Notification_BulkChangeMembers_Action_ChangeAccessLevel3},t.licenseDisplayName,e.length,1===e.length?he.Text_User_Singular:he.Text_User_Plural))),m=(0,_t.useBulkMemberApiNotificationCallback)(l,((e,t)=>i.createElement(p.TemplateString,{template:he.Notification_BulkChangeMembers_Action_ChangeAccessLevel3},t.licenseDisplayName,e.length,1===e.length?he.Text_ServicePrincipal_Singular:he.Text_ServicePrincipal_Plural)));return i.createElement(Et.CommonPanel,{className:Te.L2ClassNames.panels.bulkChangeAccessLevel.root,actionButtonProps:{text:he.ButtonText_SaveChanges,onClick:async()=>{if(e.onDismiss(),a){const e=t.filter((e=>e.isServicePrincipal)),n=t.filter((e=>!e.isServicePrincipal));e.length>0&&m(e,s),n.length>0&&u(n,s)}else c(t,s)}},title:he.TitleText_EditUserBulkDialog_ChangeAccessLevels,description:i.createElement(ns.BulkEditUserPanelDescription,{usersCount:e.users.length}),onDismiss:e.onDismiss,contentClassName:(0,C.getSpacingContainerClassName)("y",20)},i.createElement(vt.AccessLevelDropdown,{selectedAccessLevel:s,onChange:n,label:he.FormText_UserEditDialogBulk_ChangeAccessLevel}))}}("ComponentsHubCalloutsEditUserBulkChangeAccessLevelPanel"),function(e){function s(e){return i.createElement(Yt.RemoveMemberDialogContent,{pageContext:e.pageContext,memberTitleForPrompt:e.memberTitleForWarning},i.createElement(X.MessageCard,{severity:"Warning"},i.createElement("div",null,e.isAad?i.createElement(i.Fragment,null,i.createElement(p.TemplateString,{template:he.UserRemoveDialog_AADWarning1},e.memberTitleForWarning)," ",i.createElement(S.Link,{href:Se.UserManagementLinks.AadGroupHelpLink,target:"_blank",rel:"noopener noreferrer",ariaLabel:he.UserRemoveDialog_AADWarningLink_AriaLabel,underline:!0},he.UserDialog_LearnMore)):he.UserRemoveDialog_GenericWarning)))}as=t[e]={},t[e].RemoveUserDialogContent=s,t[e].RemoveUserDialog=function(e){const t=(0,ye.useUserHubContext)(),{user:n}=e,r=Yt.RemoveMemberDialogUtils.getMemberTitle(n),{supportServicePrincipals:a}=(0,ye.useUserHubConfiguration)(),{removeUsers:o,removeServicePrincipals:l}=(0,it.useUsersContextApiActions)(),c=i.createElement(p.TemplateString,{template:he.Notification_RemoveUser_Action1},n.displayName),u=(0,Ee.useTrackedAsyncCallback)(t,(0,We.useNotificationAsyncCallback)((async()=>(e.onDismiss(),l([n]))),{onGetDisplayName:()=>c,onGetResultNotification:e=>new _t.SingleMemberStatusResultNotification(e)}),Se.PerformanceScenarioConstants.RemoveUserFeatureName),m=(0,Ee.useTrackedAsyncCallback)(t,(0,We.useNotificationAsyncCallback)((async()=>(e.onDismiss(),o([n]))),{onGetDisplayName:()=>c,onGetResultNotification:e=>new _t.SingleMemberStatusResultNotification(e)}),Se.PerformanceScenarioConstants.RemoveUserFeatureName);return i.createElement(yt.CommonDialog,{onDismiss:e.onDismiss,title:he.UserRemoveDialog_DialogTitleSingular,className:Te.L2ClassNames.dialogs.removeUser.root,actionButtonProps:{text:he.HubButtonTextRemove,onClick:a&&n.isServicePrincipal?u:m}},i.createElement(s,{pageContext:t,isAad:e.user.isAad,memberTitleForPrompt:r,memberTitleForWarning:r}))}}("ComponentsHubCalloutsRemoveMemberRemoveUserDialog"),function(e){os=t[e]={},t[e].BulkEditUserRemoveFromAccountDialog=function(e){const t=(0,ye.useUserHubContext)(),{users:s}=e,n=i.useMemo((()=>s.some((e=>e.isAad))),[s]),{supportServicePrincipals:r}=(0,ye.useUserHubConfiguration)(),a=i.createElement(p.TemplateString,{template:he.Notification_BulkChangeMembers_Action_RemoveUsers1},s.length),{removeUsers:o,removeServicePrincipals:l}=(0,it.useUsersContextApiActions)(),c=(0,_t.useBulkUserApiNotificationCallback)(o,(()=>a)),u=(0,_t.useBulkMemberApiNotificationCallback)((e=>o(e)),(e=>{const t=e.length,s=1===t?he.OperationName_RemoveUser:he.Notification_BulkChangeMembers_Action_RemoveUsers1;return i.createElement(p.TemplateString,{template:s},t)})),m=(0,_t.useBulkMemberApiNotificationCallback)((e=>l(e)),(e=>{const t=e.length,s=1===t?he.OperationName_RemoveServicePrincipal:he.Notification_BulkChangeMembers_Action_RemoveServicePrincipals1;return i.createElement(p.TemplateString,{template:s},t)}));return i.createElement(yt.CommonDialog,{actionButtonProps:{className:Te.L2ClassNames.Dialogs.EditBulk.RemoveUserConfirmationButton,text:he.HubButtonTextRemove,onClick:()=>{if(e.onDismiss(),r){const e=s.filter((e=>e.isServicePrincipal)),t=s.filter((e=>!e.isServicePrincipal));e.length>0&&m(e),t.length>0&&u(t)}else c(s)}},title:he.TitleText_EditUserBulkDialog_RemoveFromOrganization,description:i.createElement(ns.BulkEditUserPanelDescription,{usersCount:e.users.length}),onDismiss:e.onDismiss},i.createElement(as.RemoveUserDialogContent,{pageContext:t,isAad:n,memberTitleForPrompt:he.UserRemoveDialog_TheseUsers,memberTitleForWarning:he.UserRemoveDialog_SomeUsers}))}}("ComponentsHubCalloutsEditUserBulkRemoveFromAccountDialog"),function(e){ls=t[e]={},t[e].BulkEditUserRemoveFromProjectsPanel=function(e){const{users:t}=e,[s,n]=i.useState([]),r=s.length,a=(e,t)=>i.createElement(p.TemplateString,{template:he.Notification_BulkChangeMembers_Action_RemoveFromProjects4},e,t,r,r<2?he.Text_Project_Singular:he.Text_Project_Plural),{supportServicePrincipals:o}=(0,ye.useUserHubConfiguration)(),{removeUsersFromProjects:l,removeServicePrincipalsFromProjects:c}=(0,it.useUsersContextApiActions)(),u=(0,_t.useBulkUserApiNotificationCallback)(l,(()=>a),Lt.BulkProjectStatusTree),m=(0,_t.useBulkMemberApiNotificationCallback)(l,(e=>a(e.length,1===e.length?he.Text_User_Singular:he.Text_User_Plural)),Lt.BulkProjectStatusTree),d=(0,_t.useBulkMemberApiNotificationCallback)(c,(e=>a(e.length,1===e.length?he.Text_ServicePrincipal_Singular:he.Text_ServicePrincipal_Plural)),Lt.BulkProjectStatusTree);return i.createElement(Et.CommonPanel,{actionButtonProps:{disabled:0===r,text:he.HubButtonTextRemove,className:Te.L2ClassNames.Dialogs.EditBulk.RemoveFromProjectsConfirmationButton,onClick:()=>{if(e.onDismiss(),s&&s.length>0)if(o){const e=t.filter((e=>e.isServicePrincipal)),n=t.filter((e=>!e.isServicePrincipal));e.length>0&&d(e,s),n.length>0&&m(n,s)}else u(t,s)}},title:he.TitleText_EditUserBulkDialog_RemoveFromProjects,description:i.createElement(ns.BulkEditUserPanelDescription,{usersCount:e.users.length}),onDismiss:e.onDismiss,contentClassName:(0,C.getSpacingContainerClassName)("y",20)},i.createElement(Ie.ProjectsDropdown,{selected:s,onChange:n}))}}("ComponentsHubCalloutsEditUserBulkRemoveFromProjectsPanel"),function(e){function s(e){const[t,s]=i.useMemo((()=>{const t=[],s=[];for(const n of e.users){const r=e.previewResult[n.id];if(!r)continue;const i=r&&!Le.AccessLevels.equals(n.accessLevel,r.accessLevel);i?t.push([n,r,i]):s.push(n)}return[t,s]}),[e.users,e.previewResult]);return i.createElement(i.Fragment,null,t.length>0&&i.createElement(X.MessageCard,{severity:"Warning"},t.map((([e,t,s],n)=>i.createElement("div",{key:n},s&&i.createElement("div",null,i.createElement(p.TemplateString,{template:he.WarningMessageText_AccessLevelChange2},e.displayName,t.accessLevel.licenseDisplayName)))))),s.length>0&&i.createElement(X.MessageCard,{severity:"Info"},s.map(((e,t)=>i.createElement("div",{key:t},i.createElement(p.TemplateString,{template:he.RemoveDirectAssignmentDialog_NoChanges1},e.displayName))))))}cs=t[e]={},t[e].RemoveDirectAssignmentsDialog=function(e){const{users:t}=e,n=i.useContext(xe.UsersSummaryContext),r=(0,it.useUsersContextApiActions)(),[a,o]=(0,d.useAsyncState)(void 0);i.useEffect((()=>{(async()=>{const e=await r.removeDirectAssignments(t.map((e=>e.id)),1),s={};e&&e.forEach((e=>{s[e.id]=e})),o(s)})()}),[]);const l=i.createElement(p.TemplateString,{template:he.Notification_RemoveDirectAssignments_Action2},t.length,t.length<2?he.Text_User_Singular:he.Text_User_Plural),c=(0,We.useNotificationAsyncCallback)((async()=>{e.onDismiss(),await r.removeDirectAssignments(t.map((e=>e.id)),0),n.refresh("licenses")}),{onGetDisplayName:()=>l});return i.createElement(yt.CommonDialog,{onDismiss:e.onDismiss,actionButtonProps:{text:he.HubButtonTextRemove,onClick:c,disabled:t.length>100},className:Te.L2ClassNames.dialogs.removeDirectAssignment.root,title:t.length<=100?he.ContextualMenuOptionRemoveDirectAssignment:he.CantRemoveDirectAssignments},t.length<=100?i.createElement("div",null,i.createElement("div",{className:(0,C.getSpacingClassName)("margin","bottom",16)},a?i.createElement(s,{users:t,previewResult:a}):i.createElement(X.MessageCard,{iconProps:{render:e=>i.createElement(ee.Status,Object.assign({},ee.Statuses.Running,{className:(0,y.css)(e,(0,C.getSpacingClassName)("margin","all",8)),size:"16"}))}},he.SpinnerLabelText_RemoveDirectAssignmentsPreview)),i.createElement("div",{className:I.FontClassNames.fontSizeL},he.ReEvaluateRulesDialog_RunningJobExplaination)):i.createElement(X.MessageCard,{severity:"Info"},he.RemoveDirectAssignmentOnMoreThan100Users))}}("ComponentsHubCalloutsRemoveMemberRemoveDirectAssignmentsDialog"),function(e){us=t[e]={},t[e].BulkUserCallouts=function(){const e=i.useContext(ss.BulkUserCommandContext),{onClose:t,operation:s,users:n,flowId:r}=e;if(!n)return null;switch(s){case"changeAccessLevel":return i.createElement(is.BulkEditUserChangeAccessLevelPanel,{users:n,onDismiss:t});case"addToProjects":return i.createElement(rs.BulkEditUserAddToProjectsPanel,{users:n,onDismiss:t});case"removeFromProjects":return i.createElement(ls.BulkEditUserRemoveFromProjectsPanel,{users:n,onDismiss:t});case"remove":return i.createElement(os.BulkEditUserRemoveFromAccountDialog,{users:n,onDismiss:t});case"removeDirectAssignment":return i.createElement(cs.RemoveDirectAssignmentsDialog,{key:r,users:n,onDismiss:t})}return null}}("ComponentsHubCalloutsCalloutsUserBulk"),function(e){ms=t[e]={},t[e].UserCommandContext=i.createContext(void 0);class s{static reduce(e,t){return{operation:t.operation,user:t.user}}}s.initialState={operation:void 0,user:void 0},t[e].UserCommandContextProvider=function(n){const[r,a]=i.useReducer(s.reduce,s.initialState),[o,l]=(0,Ct.useSaveFocusElement)(),c=(0,ye.useUserHubContext)(),u=i.useContext(We.UserHubNotificationsContext),m=i.useCallback(((e,t)=>{a({operation:e,user:t})}),[a]),d=i.useCallback((e=>{a({operation:e,user:void 0})}),[a]),p=(0,Je.useResendUserInvitation)(),g=i.useCallback(((e,t)=>{if("resendInvite"===e)p(t)}),[c,u]),b={operation:r.operation,user:r.user,onOpenModifyUserCallout:m,onOpenIndependentCallout:d,saveFocusElement:o,onUserOperation:g,onClose:()=>{a({operation:void 0,user:void 0}),l()}};return i.createElement(t[e].UserCommandContext.Provider,{value:b},n.children)},t[e].userCommandItems={add:{id:"add",text:he.ButtonText_Invite},export:{id:"export",text:he.ContextualMenuOptionExportCSV},changeAccessLevel:{id:"changeAccessLevel",text:he.ContextualMenuButtonText_ChangeAccessLevel,className:Te.L2ClassNames.commandItems.changeAccessLevel},manageUser:{id:"manageUser",text:he.ContextualMenuButtonText_ManageUser,className:Te.L2ClassNames.commandItems.manageMember},resendInvite:{id:"resendInvite",text:he.ContextualMenuOptionResendInvite},reinstateAssets:{id:"reinstateAssets",text:he.ContextualMenuOptionReinstateAssets},remove:{id:"remove",text:he.EditUserBulkDialog_RemoveFromAccount,className:Te.L2ClassNames.commandItems.removeFromOrganization},removeDirectAssignment:{id:"removeDirectAssignment",text:he.ContextualMenuOptionRemoveDirectAssignment,className:Te.L2ClassNames.commandItems.removeDirectAssignment}}}("ContextCommandContextUser"),function(e){function s(e,t){return i.createElement(f.FormItem,{label:he.HubColLastAccessed},(0,bt.toLocaleDateString)(e.lastAccessedDate,he.TextLastAccessedDateNever))}function n(e,t){if(2===e.licensingSource&&Le.AccessLevels.equals(t,e)){if(Le.AccessLevels.hasValidMsdnSubscription(e))return;if(Le.AccessLevels.hasInvitedMsdnSubscription(e))return[i.createElement("span",null,he.EditUserDialog_PendingSubscriber," ",i.createElement(S.Link,{href:Se.UserManagementLinks.InvitedSubscriberInformationLink,target:"_blank",underline:!0},he.UserInviteDialog_MoreInformation)),"Info"];if(Le.AccessLevels.hasInvalidInvitedMsdnSubscription(e))return[i.createElement("span",null,he.EditUserDialog_InvalidSubscriber," ",i.createElement(S.Link,{href:Se.UserManagementLinks.InvitedSubscriberInformationLink,target:"_blank",underline:!0},he.UserInviteDialog_MoreInformation)),"Error"];if(Le.AccessLevels.hasInvalidMsdnSubscription(e))return[i.createElement("span",null,he.EditUserDialog_InvalidMsdnSubscription," ",i.createElement(S.Link,{href:Se.UserManagementLinks.InvitedSubscriberInformationLink,target:"_blank",underline:!0},he.UserInviteDialog_MoreInformation)),"Error"]}}function r(e){const[t,s]=i.useState(e.accessLevel),r=i.useMemo((()=>n(e.accessLevel,t)),[e.accessLevel,t]);return[t,s,r]}ds=t[e]={},t[e].renderLastAccessed=s,t[e].getUserMsdnAccessLevelMessageBarContentAndType=n,t[e].useUserSelectAccessLevel=r,t[e].EditUserAccessLevelPanel=function(e){i.useMemo((()=>(0,z.getId)("last-accessed")),[]);const t=(0,ye.useUserHubContext)();let{member:n}=e;const[a,o,l]=r(n),c=(0,Ve.useEditMemberBuilder)(n,a),u=i.useContext(it.UsersContext),{supportServicePrincipals:m}=(0,ye.useUserHubConfiguration)(),d=(0,ze.useRefreshedMember)(n.id,2===n.accessLevel.assignmentSource?async e=>{const[t]=await u.refreshUsers([e],[Se.UserEntitlementPropertyNames.GroupRules]);return t}:void 0);n=d||n;const g=!!d,{updateUser:b,updateServicePrincipal:C}=(0,it.useUsersContextApiActions)(),v=(0,We.useNotificationAsyncCallback)(b,{onGetDisplayName:()=>i.createElement(p.TemplateString,{template:he.Notification_ChangeSingleUser_Action1},n.displayName),onGetDescription:(e,t,s)=>i.createElement(wt.EditMemberNotificationDescription,{metadata:s}),onGetResultNotification:(e,t,s,n)=>new wt.EditMemberStatusResultNotification(e,i.createElement(wt.EditMemberNotificationDescription,{metadata:n}))}),h=(0,We.useNotificationAsyncCallback)(C,{onGetDisplayName:()=>i.createElement(p.TemplateString,{template:he.Notification_ChangeSingleUser_Action1},n.displayName),onGetDescription:(e,t,s)=>i.createElement(wt.EditMemberNotificationDescription,{metadata:s}),onGetResultNotification:(e,t,s,n)=>new wt.EditMemberStatusResultNotification(e,i.createElement(wt.EditMemberNotificationDescription,{metadata:n}))}),f=(0,Ee.useTrackedAsyncCallback)(t,v,Se.PerformanceScenarioConstants.EditUserFeatureName,((e,t,s,n)=>(e.measurements["Operation Count"]=n.length,e))),S=(0,Ee.useTrackedAsyncCallback)(t,h,Se.PerformanceScenarioConstants.EditUserFeatureName,((e,t,s,n)=>(e.measurements["Operation Count"]=n.length,e)));return i.createElement(jt.EditMemberAccessLevelPanel,{actionButtonProps:{disabled:0===c.length,className:Te.L2ClassNames.Dialogs.EditUserSingle.ChangeAccessConfirmationButton,onClick:()=>{const[t,s]=c.build();t.length>0&&(e.onDismiss(),m&&n.isServicePrincipal?S(n,t,s):f(n,t,s))},text:he.ButtonText_SaveChanges},className:Te.L2ClassNames.Dialogs.EditUserSingle.ChangeAccessLevelContainer,member:n,isGroup:!1,onDismiss:e.onDismiss,memberPromiseFulfilled:g,extraInfo:s(e.member),isAccessLevelOnly:!0,groupAssignments:n.groupAssignments,selectedAccessLevel:a,onSelectedAccessLevelChanged:o,title:he.ContextualMenuButtonText_ChangeAccessLevel},l&&i.createElement(X.MessageCard,{severity:l[1]},l[0]))}}("ComponentsHubCalloutsEditMemberEditUserPanelAccessLevel"),function(e){function s(e){const{hasFilter:t,displayMembers:s}=e,n=(0,ye.useUserHubContext)();if(s){const{noResultsText:s,noResultsMatchFilterText:r}=e;return i.createElement("div",{className:(0,y.css)(j.CssClassNames.flex.auto),role:"alert"},i.createElement(L.ZeroData,{className:(0,y.css)(j.CssClassNames.flex.auto,(0,C.getSpacingClassName)("margin","all",40)),imagePath:n.getImageUrl(t?ye.UserHubPageContextService.noResultsMatchedAssetsId:ye.UserHubPageContextService.noResultsAssetsId),primaryText:t?r:s,imageAltText:""}))}return i.createElement("div",{className:j.CssClassNames.flex.auto},i.createElement(c.Spinner,{size:"large",label:he.SpinnerLabel_WorkingOnIt}))}ps=t[e]={},t[e].MemberTable=function(e){const{columns:t,columnSorting:n}=e,{perfRef:r}=(0,ye.useUserHubContext)(),{itemProvider:a,behavior:o,fetchedCount:l,isFetchDone:c}=(u={displayMembers:e.displayMembers,fetchNextBatch:e.fetchNextBatch,isFetchDone:e.isFetchDone},(0,Be.useAutoLoadingTableProps)(u.displayMembers,u.isFetchDone,u.fetchNextBatch));var u;i.useEffect((()=>{(c||l>0)&&r.current.markInteractive()}),[c,l]);const m=n?i.useMemo((()=>[n,o]),[n,o]):void 0;return 0===a.length?i.createElement(s,Object.assign({},e)):i.createElement("div",{className:I.LayoutClassNames.overflowXAuto},i.createElement(U.Table,{itemProvider:a,className:e.className,selection:e.selection,columns:t,behaviors:m,ariaLabel:e.ariaLabel}))}}("ComponentsHubMemberListMemberTable"),function(e){gs=t[e]={};class s{static getStyles(){return{accessLevelDisplay:(0,y.css)(I.FlexClassNames.flexRow,I.FlexClassNames.alignItemsCenter,(0,C.getSpacingContainerClassName)("x",8))}}}__decorate([a.memoize],s,"getStyles",null);class n{constructor(e){this.onSize=(e,t,s,n)=>{n.id===this.id&&(this.width.value=s)},this.width=new T.ObservableValue(e)}}t[e].MemberResizableColumn=n;t[e].MemberPersonaColumn=class extends n{constructor(e,t,s){super(e),this.onRenderPersona=s,this.id="persona",this.headerClassName=Te.L2ClassNames.tableColumnHeaders.displayName,this.className=Te.L2ClassNames.ListRow.displayName,this.minWidth=288,this.name=he.HubColName,this.renderCell=(e,t,s,n)=>i.createElement(U.SimpleTableCell,{columnIndex:t,tableColumn:s,key:t},this.onRenderPersona(n)),this.sortProps={sortOrder:t}}};t[e].MemberAccessLevelColumn=class extends n{constructor(e,t){super(e),this.hideStatusIcon=t,this.id="access-level",this.headerClassName=Te.L2ClassNames.tableColumnHeaders.accessLevel,this.className=Te.L2ClassNames.memberTable.accessLevel,this.minWidth=216,this.name=he.HubColAccessLevel,this.renderCell=(e,t,n,r)=>{const a=s.getStyles(),{accessLevel:o}=r,l=this.hideStatusIcon&&!!o.statusMessage,c={[Te.L2DataAttributeKeys.memberAccessLevel]:Le.AccessLevels.getLicenseKey(o)};return i.createElement(It.OneLineSimpleTableCell,{columnIndex:t,tableColumn:n,contentClassName:a.accessLevelDisplay,key:t},i.createElement("div",Object.assign({},c),o.licenseDisplayName),l&&i.createElement(P.Icon,{iconName:4===o.status?"Info":"Warning",title:o.statusMessage}))}}}}("ComponentsHubMemberListMemberTableColumns"),function(e){bs=t[e]={},t[e].EditMemberGroupEntitlementsForm=function(e){const t=(0,ye.useUserHubContext)(),{groupAssignments:s}=e,n=i.useMemo((()=>[new gs.MemberPersonaColumn(-50,void 0,(e=>i.createElement(Tt.MemberPersona,{member:e,pageContext:t,defaultToMemberSecondaryTextField:!1}))),new gs.MemberAccessLevelColumn(-50,!0)].map((e=>Object.assign(Object.assign({},e),{minWidth:10})))),[]);return i.createElement(ps.MemberTable,{displayMembers:s||[],isFetchDone:!0,noResultsText:he.NoResults_NoGroupRulesFound,hasFilter:!1,columns:n})}}("ComponentsHubCalloutsEditMemberGroupEntitlementsForm"),function(e){Cs=t[e]={},t[e].EditUserPanel=function(e){const t=(0,ye.useUserHubContext)();let{member:s}=e;const n=i.useContext(it.UsersContext),{supportServicePrincipals:r}=(0,ye.useUserHubConfiguration)(),a=(0,ze.useRefreshedMember)(s.id,(async e=>{const[t]=await n.refreshUsers([e],[Se.UserEntitlementPropertyNames.Projects,Se.UserEntitlementPropertyNames.GroupRules]);return t}));if(r&&a&&s.isServicePrincipal)try{a.graphMember.subjectKind=Se.SubjectKind.ServicePrincipal}catch(e){}s=a||s;const o=!!a,[l,c,u]=(0,ds.useUserSelectAccessLevel)(s),m=i.useMemo((()=>(0,z.getId)("last-accessed")),[]),[d,g]=i.useState({}),b=(0,Ve.useEditMemberBuilder)(s,l,d),{updateUser:C,updateServicePrincipal:v}=(0,it.useUsersContextApiActions)(),h=(0,We.useNotificationAsyncCallback)(C,{onGetDisplayName:()=>i.createElement(p.TemplateString,{template:he.Notification_ChangeSingleUser_Action1},s.displayName),onGetDescription:(e,t,s)=>i.createElement(wt.EditMemberNotificationDescription,{metadata:s}),onGetResultNotification:(e,t,s,n)=>new wt.EditMemberStatusResultNotification(e,i.createElement(wt.EditMemberNotificationDescription,{metadata:n}))}),f=(0,We.useNotificationAsyncCallback)(v,{onGetDisplayName:()=>i.createElement(p.TemplateString,{template:he.Notification_ChangeSingleUser_Action1},s.displayName),onGetDescription:(e,t,s)=>i.createElement(wt.EditMemberNotificationDescription,{metadata:s}),onGetResultNotification:(e,t,s,n)=>new wt.EditMemberStatusResultNotification(e,i.createElement(wt.EditMemberNotificationDescription,{metadata:n}))}),S=(0,Ee.useTrackedAsyncCallback)(t,h,Se.PerformanceScenarioConstants.EditUserFeatureName,((e,t,s,n)=>(e.measurements["Operation Count"]=n.length,e))),y=(0,Ee.useTrackedAsyncCallback)(t,f,Se.PerformanceScenarioConstants.EditUserFeatureName,((e,t,s,n)=>(e.measurements["Operation Count"]=n.length,e)));return i.createElement(Ot.EditMemberPanel,{onDismiss:e.onDismiss,member:s,memberPromiseFulfilled:o,className:Te.L2ClassNames.Dialogs.EditUserSingle.EditUserDialogContainer,actionButtonProps:{disabled:0===b.length,className:Te.L2ClassNames.Dialogs.EditUserSingle.EditSaveButton,text:he.ButtonText_SaveChanges,onClick:()=>{const[t,n]=b.build();t.length>0&&(e.onDismiss(),r&&s.isServicePrincipal?y(s,t,n):S(s,t,n))}},additionalTabs:2===s.accessLevel.assignmentSource||s.groupAssignments&&s.groupAssignments.length>0?[{id:"GroupRules",name:he.EditUserDialog_GroupRulesTabTitle,content:i.createElement(bs.EditMemberGroupEntitlementsForm,{groupAssignments:s.groupAssignments})}]:void 0,initialTab:e.initialTab,isGroup:!1,selectedAccessLevel:l,groupAssignments:s.groupAssignments,extraInfo:(0,ds.renderLastAccessed)(s,m),title:r&&s.isServicePrincipal?he.EditUserDialog_ManageAccess:he.EditUserDialog_ManageUser,projectSelectionDelta:d,onSelectedAccessLevelChanged:c,onProjectSelectionChange:g},u&&i.createElement(X.MessageCard,{severity:u[1]},u[0]))}}("ComponentsHubCalloutsEditMemberEditUserPanel"),function(e){vs=t[e]={};class s{static getStyles(){return{contentRoot:(0,C.getSpacingContainerClassName)("y",20)}}}__decorate([a.memoize],s,"getStyles",null),t[e].ReinstateAssetsDialog=function(e){const{user:t}=e,n=i.createElement(p.TemplateString,{template:he.Notification_ReinstateAssets_Action1},t.displayName),{reinstateAssets:r}=(0,it.useUsersContextApiActions)(),a=(0,We.useNotificationAsyncCallback)(r,{onGetDisplayName:()=>n,onGetResultNotification:e=>new _t.SingleMemberStatusResultNotification(e)}),o=s.getStyles(),l=t.principalName?t.principalName:t.displayName;return i.createElement(yt.CommonDialog,{actionButtonProps:{text:he.HubButtonTextReinstate,onClick:()=>{e.onDismiss(),a(t)}},onDismiss:e.onDismiss,title:he.ReinstateAssetsDialog_DialogTitleSingular},i.createElement("div",{className:o.contentRoot},i.createElement("div",{className:I.FontClassNames.fontSizeL},i.createElement(p.TemplateString,{template:he.ReinstateAssetsDialog_ReinstateAssetsPrompt1},l)),i.createElement(X.MessageCard,{iconProps:{iconName:"Warning"}},i.createElement("div",null,he.ReinstateAssetsDialog_LoseAssetsWarning," ",i.createElement(S.Link,{href:Se.UserManagementLinks.ReinstateAssetsHelpLink,target:"_blank",rel:"noopener noreferrer",underline:!0},he.UserDialog_LearnMore)))))}}("ComponentsHubCalloutsEditMemberReinstateAssetsDialog"),function(e){hs=t[e]={},t[e].UserCallouts=function(){const e=i.useContext(ms.UserCommandContext),{onClose:t,user:s,operation:n}=e;if("add"===e.operation)return i.createElement(Ft.AddUsersToCollectionPanel,{onDismiss:t});if(!s)return null;switch(n){case"changeAccessLevel":return i.createElement(ds.EditUserAccessLevelPanel,{member:s,onDismiss:t});case"manageUser":return i.createElement(Cs.EditUserPanel,{onDismiss:t,member:s});case"removeDirectAssignment":return i.createElement(cs.RemoveDirectAssignmentsDialog,{onDismiss:t,users:[s],key:s.id});case"reinstateAssets":return i.createElement(vs.ReinstateAssetsDialog,{user:s,onDismiss:t});case"remove":return i.createElement(as.RemoveUserDialog,{onDismiss:t,user:s})}return null}}("ComponentsHubCalloutsCalloutsUser"),function(e){fs=t[e]={};class s extends gs.MemberResizableColumn{constructor(e,t){super(e),this.id="lastExecuted",this.headerClassName=Te.L2ClassNames.ListHeaders.lastAccessedDate,this.className=Te.L2ClassNames.ListRow.lastAccess,this.minWidth=144,this.name=he.HubColLastEvaluated,this.renderCell=(e,t,s,n)=>{const{lastExecuted:r}=n;return i.createElement(It.OneLineSimpleTableCell,{columnIndex:t,tableColumn:s,key:t},r?i.createElement("time",{dateTime:r.toISOString()},r.toLocaleDateString()," ",r.toLocaleTimeString()):i.createElement("div",{className:Te.L2ClassNames.ListRow.lastAccessText}))},this.sortProps={sortOrder:t}}}function n(e){return Te.L2ClassNames.memberTable.groupStatusPrefix+e}t[e].getGroupStatusClassName=n;class r{constructor(){this.id="status",this.width=40,this.renderCell=(e,t,s,r)=>{let a=null;switch(r.status){case 0:a=i.createElement(P.Icon,{render:()=>i.createElement(ee.Status,Object.assign({},ee.Statuses.Running,{size:"16"})),tooltipProps:{text:he.GroupResolve_Running}});break;case 5:a=i.createElement(P.Icon,{iconName:"Info",title:he.GroupRules_IncompatibleState});break;case 10:a=i.createElement(P.Icon,{iconName:"Info",title:he.GroupRules_UnableToApplyState,"data-groupStatus":""})}return r.isPendingDeleteCompletion&&(a=i.createElement(P.Icon,{render:()=>i.createElement(ee.Status,Object.assign({},ee.Statuses.Running,{size:"16"})),tooltipProps:{text:he.GroupResolve_Deleting}})),i.createElement(U.SimpleTableCell,{columnIndex:t,tableColumn:s,key:t,className:n(r.status)},a)}}}t[e].GroupTable=function(e){const t=(0,ye.useUserHubContext)(),n=function(){const e=i.useContext(kt.GroupCommandContext);return i.useCallback((t=>({id:"edit-group-menu",className:Te.L2ClassNames.menus.editGroup,items:e?[Object.assign(Object.assign({},kt.groupCommandItems.manageGroup),{onActivate:()=>e.onOpenModifyGroupCallout("manageGroup",t)}),Object.assign(Object.assign({},kt.groupCommandItems.manageMembers),{disabled:!!t.isAad,onActivate:()=>e.onOpenModifyGroupCallout("manageMembers",t)}),{id:"divider1",itemType:1},Object.assign(Object.assign({},kt.groupCommandItems.remove),{onActivate:()=>e.onOpenModifyGroupCallout("remove",t)})]:[]})),[e])}(),a=i.useContext(kt.GroupCommandContext),{groupsContext:o}=e,[l,c]=function(e,t,n,a){const[o,l,c]=i.useMemo((()=>{const e={},t={},s=[];return s.push(0,1),e[s.length-1]="displayName",t[s.length-1]=-7/12*100,s.push(2,3),t[s.length-2]=-25,t[s.length-1]=-2/12*100,e[s.length-1]="lastExecutedDate",s.push(4),[s,t,e]}),[a]),u=n&&n.sortState;return[i.useMemo((()=>o.map(((n,o)=>{switch(n){case 0:return new r;case 1:return new gs.MemberPersonaColumn(l[o],u&&"displayName"===u.sortByKey?u.sortOrder:void 0,(t=>i.createElement(Tt.MemberPersona,{member:t,pageContext:e,defaultToMemberSecondaryTextField:!1})));case 2:return new gs.MemberAccessLevelColumn(l[o],!0);case 3:return new s(l[o],u&&"lastExecutedDate"===u.sortByKey?u.sortOrder:void 0);case 4:return new U.ColumnMore(a,void 0,((e,s)=>{t&&t.saveFocusElement(document.activeElement)}))}}))),[o,l,a,e,u]),c]}(t,a,o,n),u=(0,Be.useColumnSorting)(((e,t)=>{const s=c[e];s&&o.setSort({sortByKey:s,sortOrder:t})}),[o.setSort,c]);return i.createElement(ps.MemberTable,{className:e.className,ariaLabel:he.GroupTable_AriaLabel,displayMembers:o.displayMembers,fetchNextBatch:o.fetchNextBatch,isFetchDone:o.isFetchDone,noResultsText:he.NoResults_NoGroupRulesFound,noResultsMatchFilterText:he.NoResults_NoGroupRulesMatchFilter,hasFilter:e.hasFilter,columns:l,columnSorting:u})}}("ComponentsHubMemberListGroupTable"),function(e){Ss=t[e]={};class s{static getStyles(){return{root:(0,y.css)(I.FlexClassNames.flexRow,I.FlexClassNames.alignItemsCenter,(0,C.getSpacingContainerClassName)("x",16),I.FontClassNames.fontSizeM),pillLabel:(0,y.css)(I.FlexClassNames.flexRow,I.FlexClassNames.alignItemsCenter,(0,C.getSpacingContainerClassName)("x",4)),pillContent:I.TextClassNames.alignCenter}}}__decorate([a.memoize],s,"getStyles",null),t[e].tableCardClassName="bolt-table-card",t[e].MembersTableCardTitle=function(e){const t=s.getStyles();return i.createElement("div",{className:t.root,"aria-live":"polite"},void 0!==e.totalCount&&i.createElement("div",{className:t.pillLabel},i.createElement("span",null,he.LabelText_Total),i.createElement(J.Pill,{tabIndex:-1,size:0,className:t.pillContent,"aria-live":"polite"},e.totalCount)),void 0!==e.estimatedFilterCount&&i.createElement("div",{className:t.pillLabel},i.createElement("span",null,he.LabelText_Filtered),i.createElement(J.Pill,{tabIndex:-1,size:0,className:t.pillContent,"aria-live":"polite"},e.estimatedFilterCount+(0===e.estimatedFilterCount||!e.hasExactFilterCountEstimate&&void 0!==e.hasExactFilterCountEstimate?"+":""))),void 0!==e.selectedCount&&i.createElement("div",{className:t.pillLabel},i.createElement("span",null,he.LabelText_Selected),i.createElement(J.Pill,{tabIndex:-1,size:0,className:t.pillContent,"aria-live":"polite"},e.selectedCount)))}}("ComponentsHubMemberListMembersTableCard"),function(e){ys=t[e]={};class s{static getCommandBarItems(e,t){return e.isAdmin?[Object.assign(Object.assign({},kt.groupCommandItems.add),{isPrimary:!0,important:!0,onActivate:()=>{t("add")}}),Object.assign(Object.assign({},kt.groupCommandItems.reEvaluateAllRules),{important:!0,onActivate:()=>{t("reEvaluateAllRules")}})]:[]}}t[e].GroupTableCard=function(){const e=(0,ye.useUserHubConfiguration)(),t=i.useContext(st.GroupsContext),n=i.useContext(kt.GroupCommandContext),r=i.useMemo((()=>t&&n&&s.getCommandBarItems(e,n.onOpenIndependentCallout)),[e,n&&n.onOpenIndependentCallout]);if(!t)return null;const a=(0,et.membersContextFilterStateIsActive)(t.filterState);return i.createElement(i.Fragment,null,i.createElement(le.Card,{titleProps:{text:i.createElement(Ss.MembersTableCardTitle,{totalCount:t.isFetchDone?t.allMembers.length:void 0,estimatedFilterCount:a&&t.isFetchDone?t.displayMembers.length:void 0})},headerCommandBarItems:r,className:(0,y.css)(Ss.tableCardClassName,Te.L2ClassNames.cards.groups)},i.createElement(fs.GroupTable,{hasFilter:a,groupsContext:t})))}}("ComponentsHubMemberListGroupTableCard"),function(e){Es=t[e]={};class s extends gs.MemberResizableColumn{constructor(e,t){super(e),this.id="lastExecuted",this.headerClassName=Te.L2ClassNames.tableColumnHeaders.lastAccess,this.className=Te.L2ClassNames.ListRow.lastAccess,this.minWidth=144,this.name=he.HubColLastAccessed,this.renderCell=(e,t,s,n)=>{const r=(0,bt.toLocaleDateString)(n.lastAccessedDate,he.TextLastAccessedDateNever);return i.createElement(It.OneLineSimpleTableCell,{columnIndex:t,tableColumn:s,key:t},r===he.TextLastAccessedDateNever?i.createElement("div",{className:Te.L2ClassNames.ListRow.lastAccessText},r):i.createElement("time",{dateTime:n.lastAccessedDate.toISOString()},r))},this.sortProps={sortOrder:t}}}class n extends gs.MemberResizableColumn{constructor(e,t){super(e),this.id="dateAdded",this.headerClassName=Te.L2ClassNames.tableColumnHeaders.dateAdded,this.className=Te.L2ClassNames.ListRow.dateAdded,this.minWidth=144,this.name=he.HubColDateAdded,this.renderCell=(e,t,s,n)=>{const r=n.dateAdded.toLocaleDateString();return i.createElement(It.OneLineSimpleTableCell,{columnIndex:t,tableColumn:s,key:t},i.createElement("time",{dateTime:n.dateAdded.toISOString()},r))},this.sortProps={sortOrder:t}}}t[e].UserDateAddedColumn=n;class r extends gs.MemberResizableColumn{constructor(e){super(e),this.id="licenseSource",this.headerClassName=Te.L2ClassNames.tableColumnHeaders.licenseSource,this.className=Te.L2ClassNames.ListRow.licenseSource,this.minWidth=144,this.name=he.HubColLicenseSource,this.renderCell=(e,t,s,n)=>{let r="";if(2===n.accessLevel.assignmentSource)r=he.AccessLevelAssignmentSourceGroupRule;else r=he.AccessLevelAssignmentSourceDirect;return i.createElement(It.OneLineSimpleTableCell,{columnIndex:t,tableColumn:s,key:t},i.createElement("div",{className:Te.L2ClassNames.ListRow.licenseSourceText},r))}}}t[e].UserLicenseSourceColumn=r,t[e].UserTable=function(e){const t=(0,ye.useUserHubContext)(),a=function(){const e=(0,ye.useUserHubContext)(),t=(0,ye.useUserHubConfiguration)(),s=i.useContext(ms.UserCommandContext),n=i.useContext(st.GroupsContext),r=i.useCallback((t=>({id:"edit-user-menu",className:Te.L2ClassNames.menus.editUser,items:[Object.assign(Object.assign({},ms.userCommandItems.changeAccessLevel),{onActivate:()=>s.onOpenModifyUserCallout("changeAccessLevel",t)}),Object.assign(Object.assign({},ms.userCommandItems.manageUser),{text:t.isServicePrincipal?he.ContextualMenuButtonText_ManageAccess:he.ContextualMenuButtonText_ManageUser,onActivate:()=>s.onOpenModifyUserCallout("manageUser",t)}),...t.isServicePrincipal?[]:[{id:"divider-1",itemType:1},Object.assign(Object.assign({},ms.userCommandItems.resendInvite),{onActivate:()=>s.onUserOperation("resendInvite",t)})],{id:"divider-2",itemType:1},...n?[Object.assign(Object.assign({},ms.userCommandItems.removeDirectAssignment),{onActivate:()=>s.onOpenModifyUserCallout("removeDirectAssignment",t)})]:[],Object.assign(Object.assign({},ms.userCommandItems.remove),{onActivate:()=>s.onOpenModifyUserCallout("remove",t)}),...e.isFeatureFlagEnabled(Se.FeatureFlags.ReinstateAssets)&&t.isAADDeleted?[Object.assign(Object.assign({},ms.userCommandItems.reinstateAssets),{onActivate:()=>s.onOpenModifyUserCallout("reinstateAssets",t)})]:[]]})),[s,e,n]);if(t.isAdmin)return r}(),o=i.useContext(it.UsersContext),l=i.useContext(st.GroupsContext),c=i.useContext(ms.UserCommandContext),[u,m]=function(e,t,a,o,l){const{sortState:c}=t,u=!!o&&o.allMembers.length>0,m=!!l,d=i.useMemo((()=>new U.ColumnSelect),[]),[p,g,b]=i.useMemo((()=>{const e={},t={},s=[];return m&&s.push(0),s.push(1),e[s.length-1]="displayName",t[s.length-1]=u?-4/12*100:-50,s.push(2),t[s.length-1]=-2/12*100,u&&(s.push(5),t[s.length-1]=-2/12*100),s.push(3,4),t[s.length-2]=-2/12*100,e[s.length-2]="dateAdded",t[s.length-1]=-2/12*100,e[s.length-1]="lastAccessDate",m&&s.push(6),[s,t,e]}),[m,u]);return[i.useMemo((()=>p.map(((t,o)=>{switch(t){case 0:return d;case 1:return new gs.MemberPersonaColumn(g[o],"displayName"===c.sortByKey?c.sortOrder:void 0,(t=>i.createElement(Tt.UserPersona,{member:t,pageContext:e})));case 2:return new gs.MemberAccessLevelColumn(g[o],!0);case 5:return new r(g[o]);case 3:return new n(g[o],"dateAdded"===c.sortByKey?c.sortOrder:void 0);case 4:return new s(g[o],"lastAccessDate"===c.sortByKey?c.sortOrder:void 0);case 6:return new U.ColumnMore(l,void 0,((e,t)=>{a.saveFocusElement(document.activeElement)}))}}))),[p,g,l,e,c]),b]}(t,o,c,l,a),d=(0,Be.useColumnSorting)(((e,t)=>{const s=m[e];s&&o.setSort({sortByKey:s,sortOrder:t})}),[o.setSort,m]);return i.createElement(ps.MemberTable,{className:Te.L2ClassNames.lists.usersTable,ariaLabel:he.UserTable_AriaLabel,displayMembers:o.displayMembers,fetchNextBatch:o.fetchNextBatch,isFetchDone:o.isFetchDone,noResultsText:he.NoResults_NoUsersMatchFilter,noResultsMatchFilterText:he.NoResults_NoUsersMatchFilter,hasFilter:e.hasFilter,columns:u,selection:e.selection,columnSorting:d})}}("ComponentsHubMemberListUserTable"),function(e){As=t[e]={},t[e].BillingContext=i.createContext({});class s{}s.TokenProvierNameAzCommDeploymentProfile="AzCommDeploymentProfile",t[e].BillingContextProvider=function(n){const r=(0,ye.useUserHubContext)(),a=i.useMemo((async()=>{const e=r.getService("IAuthenticationService").getNamedTokenProvider(s.TokenProvierNameAzCommDeploymentProfile),t=r.getRestClient(dt.AzCommClientName,{hostType:1,authTokenProvider:e}),n=r.getPageData(),i=n&&n.hostId;return(await t.getBillingInfo(i)).isAssignmentBillingEnabled}),[r]),[o]=(0,_.useResolvedPromise)(a,void 0,(e=>{r.telemetry.trackException(e,"AzCommBillingContextProvider")})),l=i.useMemo((()=>({isAssignmentBilling:o})),[o]);return i.createElement(t[e].BillingContext.Provider,{value:l},n.children)}}("ContextBillingContext"),function(e){xs=t[e]={};class s{static getAssignedSum(e){return e.length>0?e.reduce(((e,t)=>e+t.assigned+t.disabled),0):0}}t[e].UserSummaryPanelUtils=s;class n{static getStyles(){return{content:(0,y.css)(b.SizeClassNames.width100,I.FlexClassNames.flexColumn,(0,C.getSpacingContainerClassName)("y",20)),sectionTitle:(0,y.css)(I.TypographyClassNames.titleS,(0,C.getSpacingContainerClassName)("x",8),I.FlexClassNames.flexRow,I.FlexClassNames.alignItemsCenter,(0,C.getSpacingClassName)("margin","bottom",16)),statusTreeCellContent:(0,y.css)(I.TextClassNames.ellipsis,j.CssClassNames.flex.auto,I.FlexClassNames.flexRow,I.FlexClassNames.alignItemsCenter,(0,C.getSpacingContainerClassName)("x",8)),extensionsTitleRow:(0,y.css)(I.FlexClassNames.flexRow,I.FlexClassNames.alignItemsCenter,j.CssClassNames.jusitfyContent.spaceBetween,(0,C.getSpacingClassName)("margin","bottom",16))}}static getLicensesInfoItemProvider(e,t,s){const r=[];if(e&&void 0!==t)for(const i of e){const e=s?void 0:n.getLicenseChildItems(i,t);r.push({childItems:e,expanded:!e&&void 0,data:{label:i.licenseName,count:i.assigned,labelSuffixIcon:!e&&i.disabled>0?{iconName:"Warning",title:he.HubSummary_InvalidAccessLevelDropdownInformation}:void 0,summaryData:i}})}else r.push({data:void 0});return new ie.TreeItemProvider(r)}static hasBuyLink(e,t){return e.isAdmin&&(2===t||4===t)}static getLicenseChildItems(e,t){const s=[];let n=e.total-e.includedQuantity;if(t&&(n=e.assigned-e.includedQuantity),e.disabled>0&&s.push({data:{label:he.AccessLevel_Invalid,count:e.disabled,labelSuffixIcon:{iconName:"Warning"}}}),e.isPurchasable&&(e.includedQuantity>0?s.push({data:{label:he.HubSummary_Free,count:e.includedQuantity}},{data:{label:he.HubSummary_Paid,count:n}}):4!==e.accountLicenseType&&s.push({data:{label:he.HubSummary_Total,count:e.total}})),(e.isPurchasable||e.disabled>0)&&s.push({data:{label:he.HubSummary_Assigned,count:e.assigned}}),e.isPurchasable&&!t&&4!==e.accountLicenseType){s.push({data:{label:he.HubSummary_Available,count:e.available<0?0:e.available}});if(0!==e.accountLicenseType&&void 0!==e.totalAfterNextBillingDate&&null!==e.totalAfterNextBillingDate&&e.total!==e.totalAfterNextBillingDate){const t=e.assigned-e.totalAfterNextBillingDate;t>0?s.push({data:{label:he.HubSummary_NextMonthMissing,count:t,labelSuffixIcon:{iconName:"Warning"}}}):s.push({data:{label:he.HubSummary_NextMonthTotal,count:e.totalAfterNextBillingDate,labelSuffixIcon:{iconName:"Info",title:he.HubSummary_NextMonthTotalInfo}}})}}return s.length>0?s:void 0}}function r(e){const t=n.getStyles(),{data:s,childItems:r}=e.treeItem.underlyingItem;if(!s)return i.createElement(i.Fragment,null);const a=r&&e.onGetLinks&&s.summaryData&&e.onGetLinks(s.summaryData);return i.createElement(re.ExpandableTreeCell,{columnIndex:e.columnIndex,treeItem:e.treeItem,className:Te.L2ClassNames.panels.summary.accessLevelItem,role:"presentation"},i.createElement("div",{className:t.statusTreeCellContent},i.createElement("div",{className:t.statusTreeCellContent},i.createElement(Y.Tooltip,{overflowOnly:!0},i.createElement("div",{className:(0,y.css)(I.TextClassNames.ellipsis,j.CssClassNames.flexShrink1)},s.label)),s.labelSuffixIcon&&i.createElement(P.Icon,Object.assign({},s.labelSuffixIcon))),a&&a.length>0&&i.createElement("div",null,i.createElement(p.TemplateJoinedString,{delimiter:" | "},...a.map((([e,t],s)=>i.createElement(S.Link,Object.assign({key:s,target:"_blank",rel:"noopener noreferrer",underline:!0},e,{onClick:t=>{t.stopPropagation(),e.onClick&&e.onClick(t)}}),t))))),void 0!==s.count&&i.createElement(J.Pill,{tabIndex:-1},s.count>=0?s.count.toLocaleString():0)))}__decorate([a.memoize],n,"getStyles",null);class o{constructor(){this.id="licenses",this.width=-100,this.renderCell=(e,t,s,n)=>i.createElement(r,{key:t,columnIndex:t,treeItem:n,onGetLinks:this.onGetLinks}),this.onGetLinks=e=>{const t=[];return 4===e.accountLicenseType&&t.push([{href:Se.UserManagementLinks.BasicPlusTestPlansLearnMoreLink},he.UsersSummary_LearnMore]),t}}}function l(){const e=n.getStyles(),t=i.useContext(As.BillingContext),{isAssignmentBilling:r}=t,a=i.useContext(xe.UsersSummaryContext),{licenses:l}=a,c=i.useContext(it.UsersContext),u=l&&s.getAssignedSum(l),m=(0,ye.useUserHubContext)(),d=(0,ye.useUserHubConfiguration)(),p=m.isFeatureFlagEnabled(Se.FeatureFlags.HideLicenseAndExtensionCounters),g=i.useMemo((()=>n.getLicensesInfoItemProvider(l,r,p)),[l,r,p]),b=i.useMemo((()=>[new o]),[m,d]);return i.createElement("div",{className:Te.L2ClassNames.panels.summary.accessLevels},i.createElement("div",{className:e.sectionTitle},i.createElement("div",null,he.HubSummary_TotalUsers),void 0!==u&&i.createElement(J.Pill,{tabIndex:-1,excludeFocusZone:!0,className:Te.L2ClassNames.panels.summary.accessLevelTotal},u)),i.createElement(re.Tree,{showHeader:!1,showLines:!1,columns:b,itemProvider:g,onToggle:(e,t)=>{g.toggle(t.underlyingItem)},onSelect:(e,t)=>{const s=t.data.underlyingItem.data;if(s&&s.summaryData){const e=new Xe.MemberAccessLevelFilterItem(s.summaryData,s.summaryData.licenseName,!1);c.setAccessLevelsFilter([e])}}}))}t[e].UsersSummaryPanel=function(e){const t=n.getStyles();return i.createElement(V.Panel,{titleProps:{text:he.HubSummary_Title},onDismiss:e.onDismiss,className:Te.L2ClassNames.panels.summary.root},i.createElement("div",{className:t.content},i.createElement(l,null)))}}("ComponentsHubSummaryUsersSummaryPanel"),function(e){Ts=t[e]={};class s{static getCommandBarItems(e,t,s,n,r,i){const{onOpenIndependentCallout:a}=s,o=e&&t&&t.length>1?[Object.assign(Object.assign({},ss.userBulkCommandItems.changeAccessLevel),{onActivate:()=>{r("changeAccessLevel",t)}}),{id:"divider-1",itemType:1},Object.assign(Object.assign({},ss.userBulkCommandItems.addToProjects),{onActivate:()=>{r("addToProjects",t)}}),Object.assign(Object.assign({},ss.userBulkCommandItems.removeFromProjects),{onActivate:()=>{r("removeFromProjects",t)}}),{id:"divider-2",itemType:1},...n?[Object.assign(Object.assign({},ss.userBulkCommandItems.removeDirectAssignment),{onActivate:()=>{r("removeDirectAssignment",t)}})]:[],Object.assign(Object.assign({},ss.userBulkCommandItems.remove),{onActivate:()=>{r("remove",t)}})]:void 0,l=o&&t?[{id:"manage",text:(0,D.format)(he.ButtonText_ManageCount1,t.length),className:Te.L2ClassNames.commandItems.bulkManageUsers,iconProps:{iconName:"Edit"},important:!0,subMenuProps:{id:"manage-menu",className:Te.L2ClassNames.dropdowns.bulkManageUsers.callout,items:o}}]:[];return[...o?[]:[{id:"summary",text:he.ButtonText_Summary,className:Te.L2ClassNames.commandItems.usersSummary,onActivate:()=>{i(!0)}}],...!o&&e?[Object.assign(Object.assign({},ms.userCommandItems.add),{className:Te.L2ClassNames.commandItems.addUsers,isPrimary:!0,important:!0,onActivate:()=>{a("add")}})]:[],...l]}static userEquals(e,t){return!!e&&!!t&&e.id===t.id}}t[e].UserTableCard=function(){const e=i.useContext(it.UsersContext),t=(0,ye.useUserHubConfiguration)(),n=i.useContext(st.GroupsContext),r=i.useContext(ms.UserCommandContext),a=i.useContext(ss.BulkUserCommandContext),[o,l]=i.useState([]),[c,u,m]=(0,g.useSelectedItems)(e.displayMembers,o,l,s.userEquals,g.onGetSelfValue),d=(0,g.useSelectionFactory)((()=>new M.ListSelection(!0)),c,u),p=i.useContext(xe.UsersSummaryContext),[b,C]=i.useState(!1),{isAdmin:v}=t,h=i.useMemo((()=>s.getCommandBarItems(v,m,r,n,a.onOpenBulkModifyUserCallout,C)),[v,r,n,e.displayMembers,a.onOpenBulkModifyUserCallout,C,m]),f=p.licenses&&p.licenses.length>0?p.licenses.reduce(((e,t)=>e+t.assigned+t.disabled),0):void 0,S=(0,et.membersContextFilterStateIsActive)(e.filterState),E=m&&m.length;return i.createElement(i.Fragment,null,i.createElement(le.Card,{headerCommandBarItems:h,className:(0,y.css)(Ss.tableCardClassName,Te.L2ClassNames.cards.users),titleProps:{text:i.createElement(Ss.MembersTableCardTitle,{totalCount:f,estimatedFilterCount:S?e.displayMembers.length:void 0,hasExactFilterCountEstimate:e.isFetchDone,selectedCount:0===E?void 0:E})}},i.createElement(Es.UserTable,{selection:d,hasFilter:S})),b&&i.createElement(xs.UsersSummaryPanel,{onDismiss:()=>{C(!1)}}))}}("ComponentsHubMemberListUserTableCard"),function(e){Us=t[e]={},t[e].useReEvaluateRulesNotification=function(){const e=i.useContext(st.GroupsContext),t=e&&e.allMembers&&e.allMembers.some((e=>e&&10===e.status)),s=i.useContext(kt.GroupCommandContext),[n,r]=(0,We.usePersistentUserHubNotification)("re-evaluate-rules"),[,a]=(0,Nt.useAllLicensingRulesApplicaitonStatus)(),o=n&&n.data;i.useEffect((()=>{a?1!==o&&r({statusType:"Running",title:he.GroupResolve_Running,data:1}):t&&s?0!==o&&r({statusType:"Warning",title:he.WarningMessage_GroupRulesAssignmentErrors,description:he.GroupResolve_UsersMissingLicenses,buttons:s&&[{text:he.GroupResolve_FixAssignmentIssues,onClick:()=>{s.onOpenIndependentCallout("fixAssignmentErrors")}}],data:0}):void 0!==o&&r(void 0)}),[t,s,a,o])}}("ComponentsHubNotificationsuseReEvaluateRulesNotification"),function(e){Is=t[e]={};class s{static getStyles(){return{listRoot:b.SizeClassNames.width100,listItemRoot:(0,y.css)(b.SizeClassNames.width100,(0,C.getSpacingClassName)("padding","y",8),(0,C.getSpacingClassName)("padding","x",4),(0,C.getSpacingContainerClassName)("y",8)),listItemTitle:(0,y.css)(I.FlexClassNames.flexRow,I.FlexClassNames.alignItemsCenter,(0,C.getSpacingContainerClassName)("x",8)),listItemTitleText:(0,y.css)(j.CssClassNames.whiteSpace.normal,j.CssClassNames.flex.auto,B.ColorClassNames.primaryText,I.FontClassNames.fontWeightSemiBold),listItemTitleTimestamp:(0,y.css)(B.ColorClassNames.secondaryText),listItemContent:(0,y.css)(j.CssClassNames.flex.auto,I.FlexClassNames.flexColumn,I.FlexClassNames.alignItemsFlexStart,j.CssClassNames.whiteSpace.normal),pillStatusIcon:(0,C.getSpacingClassName)("margin","x",8)}}static getStatusType(e){return"Canceling"===e?"Waiting":e}}function n(e){const{onDismiss:t,notification:n}=e,r=s.getStyles(),[a,o]=i.useState(!1),l=i.useMemo((()=>{const e=[];return n.details&&e.push({text:a?he.ButtonText_LessDetails:he.ButtonText_MoreDetails,iconProps:{iconName:a?"ChevronUp":"ChevronDown"},ariaExpanded:a,onClick:e=>{e.preventDefault(),e.stopPropagation(),o((e=>!e))}}),n.buttons&&e.push(...n.buttons),e}),[!n.details,a,o,n.buttons]);return i.createElement("div",{className:r.listItemRoot},i.createElement("div",{className:r.listItemTitle},i.createElement(ee.Status,Object.assign({},ee.Statuses[s.getStatusType(n.statusType)],{size:"16"})),i.createElement("div",{className:r.listItemTitleText},n.title),n.lastUpdated&&i.createElement("div",{className:r.listItemTitleTimestamp},i.createElement(ue.Ago,{date:n.lastUpdated})),t&&i.createElement(H.Button,{subtle:!0,iconProps:{iconName:"Clear"},ariaLabel:he.ButtonText_Dismiss,tooltipProps:{text:he.ButtonText_Dismiss},onClick:s=>{s.preventDefault(),s.stopPropagation(),t(),(()=>{const t=e.id&&document.getElementById(e.id);t&&t.focus()})()}})),i.createElement("div",{className:r.listItemContent},n.description&&i.createElement("div",null,n.description)),l&&i.createElement(O.ButtonGroup,null,l.map(((e,t)=>i.createElement(H.Button,Object.assign({},e,{key:t}))))),a&&n.details&&i.createElement("div",null,n.details))}function r(e){const t=i.useMemo((()=>new ce.ArrayItemProvider(e.sortedIdAndNotifications)),[e.sortedIdAndNotifications]),r=(0,K.useVersionKey)(t),a=s.getStyles(),o=i.useRef(null),{onDismiss:l}=e,c=i.useMemo((()=>(0,z.getId)("list-of-notifications")),[]),u=i.useCallback(((e,t,s)=>{const[r,a]=t;return i.createElement(M.ListItem,{key:r,index:e,details:s},i.createElement(n,{notification:a,notificationId:r,id:c,onDismiss:l&&(()=>l(r))}))}),[l]);return i.createElement("div",{id:c,tabIndex:-1},i.createElement(M.ScrollableList,{itemProvider:t,key:r,className:a.listRoot,renderRow:u,ref:o}))}function o(e){const{activeNotificationId:t}=e;let s;return void 0!==t&&(s=e.notifications[t]),i.useEffect((()=>{void 0!==t&&(e.notifications[t]||e.clearActiveNotification())})),s?t:void 0}function l(e){const t=i.useContext(We.UserHubNotificationsContext),{persistentIds:s,messageIds:n,notifications:a}=e,[l,c]=i.useState((()=>0===s.length?"messages":"persistent")),u=i.useMemo((()=>("persistent"===l?s:n).map((e=>[e,a[e]]))),[s,n,l,a]),m=o(t);return i.useEffect((()=>{void 0!==m&&(s.indexOf(m)>0?c("persistent"):c("messages"))})),i.createElement(V.Panel,{onDismiss:e.onDismiss,titleProps:{text:he.TitleText_Notifications},description:he.DescriptionText_NotificationsPanel,size:2},i.createElement("div",null,i.createElement(ae.TabBar,{selectedTabId:l,onSelectedTabChanged:c,renderAdditionalContent:"persistent"===l?void 0:()=>i.createElement(H.Button,{text:he.ButtonText_DismissAll,onClick:e.dismissAllNotifications})},s.length>0&&i.createElement(ae.Tab,{name:he.TitleText_Issues,id:"persistent",badgeCount:s.length}),i.createElement(ae.Tab,{name:he.TitleText_Messages,id:"messages",badgeCount:n.length})),i.createElement(r,{sortedIdAndNotifications:u,onDismiss:"persistent"===l?void 0:e.dismissNotification})))}function c(e){const{notifications:t}=e,[s,n]=i.useState(!1),r=i.useMemo((()=>(0,De.objectHasTruthyValue)(t)),[t]),a=o(e);return i.useEffect((()=>{r?void 0!==a&&(e.clearActiveNotification(),n(!0)):n(!1)})),[s,n,r]}__decorate([a.memoize],s,"getStyles",null),t[e].useActiveNotificationId=o,t[e].UserHubNotificationsPanel=l,t[e].useShowUserHubNotificationsPanel=c,t[e].UserHubNotificationsSummaryCard=function(e){const t=i.useContext(We.UserHubNotificationsContext),[n,r,a]=c(t),{notifications:o,dismissAllNotifications:u}=t,{persistentNotificationsIds:m,sortedMessageIds:d,runningTaskCount:g,severity:b}=i.useMemo((()=>Qe.NotificationUtils.summarizeNotifications(o)),[o]),C=i.useMemo((()=>[{text:he.ButtonText_ViewAll,onClick:()=>{r(!0)}},...d.length>0?[{text:he.ButtonText_DismissAll,onClick:u}]:[]]),[r,m.length>0,u]);if(!a)return null;const v=d.length-g,h=s.getStyles();return i.createElement("div",{className:e.className},i.createElement(X.MessageCard,{severity:b,buttonProps:C},i.createElement("div",null,i.createElement(Q.PillGroup,null,m.length>0&&i.createElement(J.Pill,null,i.createElement(p.TemplateString,{template:he.TextTemplate_CountItems2},m.length,m.length>1?he.Text_Issue_Plural:he.Text_Issue_Singular)),v>0&&i.createElement(J.Pill,null,i.createElement(p.TemplateString,{template:he.TextTemplate_CountItems2},v,v>1?he.Text_Message_Plural:he.Text_Message_Singular)),g>0&&i.createElement(J.Pill,{iconProps:{render:()=>i.createElement(ee.Status,Object.assign({className:h.pillStatusIcon},ee.Statuses.Running,{size:"16"}))}},i.createElement(p.TemplateString,{template:he.TextTemplate_CountItems2},g,g>1?he.Text_RunningTask_Plural:he.Text_RunningTask_Singular)))),n&&i.createElement(l,{notifications:o,persistentIds:m,messageIds:d,onDismiss:()=>{r(!1)},dismissAllNotifications:u,dismissNotification:t.dismissNotification})))}}("ComponentsHubNotificationsUserHubNotificationsCard"),function(e){Ps=t[e]={},t[e].useSummaryPendingTotalChangesNotification=function(){const e=i.useContext(xe.UsersSummaryContext),[t,s]=(0,We.usePersistentUserHubNotification)("purchase-licenses"),{licenses:n}=e,r=i.useMemo((()=>{const e=n&&n.filter((e=>e.isPurchasable&&0!==e.accountLicenseType&&e.totalAfterNextBillingDate&&e.totalAfterNextBillingDate<e.total));if(e&&e.length>0){const t=[],s=e[0],n=s.totalAfterNextBillingDate<s.assigned;if(n){const e=s.nextBillingDate?s.nextBillingDate.toLocaleDateString():void 0;t.push(i.createElement(p.TemplateString,{template:s.totalAfterNextBillingDate<2?he.BillingCycle_OnDateWillHaveSingular3:he.BillingCycle_OnDateWillHaveMultiple3},e?i.createElement("time",{dateTime:e},e):"",s.totalAfterNextBillingDate,s.licenseName));const n=s.assigned-s.totalAfterNextBillingDate;n>0&&t.push(i.createElement(p.TemplateString,{template:n<=1?he.BillingCycle_NumberWillLoseAccessSingular1:he.BillingCycle_NumberWillLoseAccessMultiple1},n))}return[t.length>0?t:void 0,n]}return[void 0,!1]}),[n]),[a,o]=r;i.useEffect((()=>{!a||t&&t.data===r?a||s(void 0):s((()=>({statusType:o?"Warning":"Information",title:he.WarningMessage_BilingIssues,description:i.createElement("div",null,i.createElement(p.TemplateJoinedString,{delimiter:he.PunctuationSuffix},...a.map(((e,t)=>i.createElement(i.Fragment,{key:t},e))))," ",i.createElement(S.Link,{target:"_blank",rel:"noopener noreferrer",href:Se.UserManagementLinks.UsersWillLoseAccessLevelsLink,underline:!0},he.UsersSummary_LearnMore)),data:r})))}))}}("ComponentsHubNotificationsuseSummaryPendingTotalChangesNotification"),function(e){Ns=t[e]={},t[e].useUserHubConfigurationErrorNotification=function(){const e=(0,ye.useUserHubConfiguration)(),[,t]=(0,We.usePersistentUserHubNotification)("config-error");i.useEffect((()=>{e.configurationError&&t((()=>({statusType:"Failed",title:he.ErrorTitle_ConfigurationError,description:i.createElement(p.TemplateString,{template:he.ErrorMessage_ConfigurationError1},i.createElement(qe.GenericErrorSupportLink,null))})))}),[e.configurationError])}}("ComponentsHubNotificationsuseUserHubConfigurationErrorNotification"),function(e){Ms=t[e]={};class s{static getAccessLevelFilters(e){return e.map((e=>({id:e.key,text:e.displayName,data:e})))}static getUserTypeFilters(e){return(e?s.availableUserTypeFilterStatesWithServicePrincipals:s.availableUserTypeFilterStates).map((e=>{switch(e){case 1:return{id:Se.UserMetaType.Guest,text:he.FilterLabel_Guest,data:1};case 3:return{id:Se.UserMetaType.Application,text:he.FilterLabel_Application,data:3};case 4:return{id:Se.UserMetaType.ManagedIdentity,text:he.FilterLabel_ManagedIdentity,data:4};default:return{id:Se.UserMetaType.Member,text:he.FilterLabel_Member,data:2}}}))}static getLicenseSourceFilters(){return s.availableLicenseSourceFilterStates.map((e=>1===e?{id:"1",text:he.AccessLevelAssignmentSourceDirect,data:1}:{id:"2",text:he.AccessLevelAssignmentSourceGroupRule,data:2}))}static updateFilter(e,t){if(!t)return;const s={name:{value:t.filter}};e.setState(s,!0)}}s.availableUserTypeFilterStates=[1,2],s.availableUserTypeFilterStatesWithServicePrincipals=[1,2,3,4],s.availableLicenseSourceFilterStates=[1,2],t[e].UserHubPageFilterBar=function(e){const t=(0,ye.useUserHubConfiguration)(),n=i.useMemo((()=>new pe.Filter),[]),r=i.useRef(void 0),a=i.useMemo((()=>e.availableAccessLevelFilters?e.availableAccessLevelFilters.map((e=>({id:e.key,text:e.displayName,data:e}))):[{id:"_loading",type:4}]),[e.availableAccessLevelFilters]),o=e.filterState&&e.filterState.accessLevelsFilter,[l,c]=(0,g.useSelectedItems)(a,o&&o.filterItems,e.onSetAccessLevelsFilter,i.useCallback(((e,t)=>!!e.data&&e.data.key===t.key),[]),i.useCallback((e=>e.data),[])),u=(0,g.useSelectionFactory)((()=>new E.DropdownMultiSelection),l,c),m=i.useMemo((()=>s.getUserTypeFilters(t.supportServicePrincipals)),[!(!e.filterState||!e.filterState.userTypeFilter)]),d=e.filterState&&e.filterState.userTypeFilter,[p,b]=(0,g.useSelectedItems)(m,d&&d.filterItems,e.onSetUserTypesFilter,i.useCallback(((e,t)=>e.data===t),[]),i.useCallback((e=>e.data),[])),C=(0,g.useSelectionFactory)((()=>new E.DropdownMultiSelection),p,b),v=i.useMemo((()=>s.getLicenseSourceFilters()),[!(!e.filterState||!e.filterState.licenseSourceFilter)]),f=e.filterState&&e.filterState.licenseSourceFilter,[S,y]=(0,g.useSelectedItems)(v,f&&f.filterItems,e.onSetLicenseSourceFilter,i.useCallback(((e,t)=>e.data===t),[]),i.useCallback((e=>e.data),[])),A=(0,g.useSelectionFactory)((()=>new E.DropdownMultiSelection),S,y),x=e.filterState&&e.filterState.nameFilter;return r.current!==e.filterState&&(s.updateFilter(n,x),r.current=e.filterState),i.useEffect((()=>{const t=()=>{const{onSetNameFilter:t,filterState:s}=e;if(!s)return;const r=n.getState(),{name:i}=r;t(i?i.value:void 0)};return n.subscribe(t),()=>{n.unsubscribe(t)}}),[n]),i.createElement(me.FilterBar,{filter:n},i.createElement(de.KeywordFilterBarItem,{filterItemKey:"name",placeholder:e.isGroupRules?he.FilterBar_FilterRules:he.FilterBar_FilterUsers,inputClassName:Te.L2ClassNames.userSearch,throttleWait:300}),i.createElement(h.DropdownFilterBarItem,{containerClassName:Te.L2ClassNames.FilterItems.accesslevelPickList,className:Te.L2ClassNames.FilterItems.accesslevels,filterItemKey:"accessLevel",items:a,selection:u,placeholder:he.HubColAccessLevel}),m&&!e.isGroupRules&&t.isAadAccount&&i.createElement(h.DropdownFilterBarItem,{containerClassName:Te.L2ClassNames.FilterItems.usertypePickList,className:Te.L2ClassNames.FilterItems.usertypes,filterItemKey:"userType",items:m,selection:C,placeholder:he.FilterPlaceholder_AadUserType}),v&&!e.isGroupRules&&t.useUpdatedSearchQuery&&e.hasGroupRules&&i.createElement(h.DropdownFilterBarItem,{containerClassName:Te.L2ClassNames.FilterItems.licenseSourcePickList,className:Te.L2ClassNames.FilterItems.licenseSource,filterItemKey:"licenseSource",items:v,selection:A,placeholder:he.HubColLicenseSource}))}}("ComponentsHubUserHubPageFilterBar"),function(e){Ls=t[e]={},t[e].GroupsTab=function(){const e=i.useContext(st.GroupsContext);return e?i.createElement(i.Fragment,null,i.createElement("div",null,i.createElement(Ms.UserHubPageFilterBar,{availableAccessLevelFilters:e.availableAccessLevelFilters,filterState:e.filterState,isGroupRules:!0,onSetAccessLevelsFilter:e.setAccessLevelsFilter,onSetNameFilter:e.setNameFilter,onSetUserTypesFilter:e.setUserTypesFilter,onSetLicenseSourceFilter:e.setLicenseSourcesFilter})),i.createElement("div",null,i.createElement(ys.GroupTableCard,null))):null}}("ComponentsHubTabsGroupsTab"),function(e){_s=t[e]={},t[e].UsersTab=function(){const e=i.useContext(it.UsersContext),t=i.useContext(st.GroupsContext);return i.createElement(i.Fragment,null,i.createElement("div",null,i.createElement(Ms.UserHubPageFilterBar,{availableAccessLevelFilters:e.availableAccessLevelFilters,filterState:e.filterState,onSetAccessLevelsFilter:e.setAccessLevelsFilter,onSetNameFilter:e.setNameFilter,onSetUserTypesFilter:e.setUserTypesFilter,onSetLicenseSourceFilter:e.setLicenseSourcesFilter,hasGroupRules:t&&t.displayMembers&&t.displayMembers.length>0})),i.createElement("div",null,i.createElement(ms.UserCommandContextProvider,null,i.createElement(ss.BulkUserCommandContextProvider,null,i.createElement(Ts.UserTableCard,null),i.createElement(hs.UserCallouts,null),i.createElement(us.BulkUserCallouts,null)))))}}("ComponentsHubTabsUsersTab"),function(e){Ds=t[e]={};class s{static getFilteredUsers(e,t){e=tt.MembersClientContextProviderUtils.getFilteredMembers(e,t);const{userTypeFilter:s,licenseSourceFilter:n}=t;return e&&n&&n.isActive&&(e=e.filter((e=>!e||n.matches(e)))),e&&s&&s.isActive&&(e=e.filter((e=>!e||s.matches(e)))),e}static sortUsersList(e,t){return tt.MembersClientContextProviderUtils.getSortedMembers(e,t,Ke.User.userSortComparisonFunction)}}t[e].UsersClientContextProvider=function(e){const t=(0,ye.useUserHubContext)(),n=(0,ye.useUserHubConfiguration)(),[r,a,o]=(0,et.useRefreshableMembersFetcherAndStore)((()=>n.shouldUseSearchApis?new it.UsersFetcher(t,n):new it.LegacyUsersFetcher(t,n)),[t,n]),l=(0,tt.useMembersClientContextProvider)(r,a,it.UsersContextUtils.getInitialFilterState(),s.getFilteredUsers,s.sortUsersList),{upsert:c}=l,u=i.useCallback((async(e,s)=>{const r=await it.UsersContextUtils.refreshUsers(t,n,e,s);return r.length>0&&c(r),r}),[c,t]),m={availableAccessLevelFilters:l.availableAccessLevelFilters,allMembers:l.allMembers,refreshMembersList:o,displayMembers:l.displayMembers,fetchError:l.fetchError,filterState:l.filterState,sortState:l.sortState,setAccessLevelsFilter:l.setAccessLevelsFilter,setNameFilter:l.setNameFilter,setUserTypesFilter:l.setUserTypesFilter,setLicenseSourcesFilter:l.setLicenseSourcesFilter,setSort:l.setSort,isFetchDone:l.isDone,refreshUsers:u,upsert:c,deleteMembers:l.deleteItems,exportUsers:()=>it.UsersContextUtils.exportUsers(t)};return i.createElement(it.UsersContext.Provider,{value:m},e.children)}}("ContextUsersContextClient"),function(e){Fs=t[e]={},t[e].UsersServerContextProvider=function(e){const t=(0,ye.useUserHubContext)(),s=(0,ye.useUserHubConfiguration)(),{filterState:n,setAccessLevelsFilter:r,setNameFilter:a,setUserTypesFilter:o,setLicenseSourcesFilter:l}=(0,et.useMembersFilter)(it.UsersContextUtils.getInitialFilterState(s.supportServicePrincipals)),[c,u]=i.useState({sortByKey:"displayName",sortOrder:0}),[m,d,p]=(0,et.useRefreshableMembersFetcherAndStore)((()=>s.shouldUseSearchApis?new it.UsersFetcher(t,s,n,c):new it.LegacyUsersFetcher(t,s,n,c)),[t,n,c,s.shouldUseSearchApis]),g=(0,et.useMembersFetcher)(m,d),{deleteItems:b,isDone:C,fetchNext:v,value:h}=g,[f,S]=(0,oe.useAsyncAction)((async()=>{try{await v()}catch(e){throw t.telemetry.trackException(e,"UsersServerContextProvider.fetchNextBatch"),e}})),y=i.useCallback((async(e,n)=>{const r=await it.UsersContextUtils.refreshUsers(t,s,e,n);return r.length>0&&p(),r}),[t,p]),E=i.useContext(xe.UsersSummaryContext),A={availableAccessLevelFilters:i.useMemo((()=>E.licenses&&et.MemberFilterStateBuilder.getAvailableAccessLevelFilters(E.licenses,s.useUpdatedSearchQuery)),[E.licenses]),allMembers:h,displayMembers:h,fetchError:f&&f.error,filterState:n,sortState:c,refreshMembersList:p,refreshUsers:y,fetchNextBatch:C?void 0:S,isFetchDone:C,exportUsers:()=>it.UsersContextUtils.exportUsers(t),setAccessLevelsFilter:r,setNameFilter:a,setUserTypesFilter:o,setLicenseSourcesFilter:l,setSort:u,upsert:p,deleteMembers:s.shouldUseSearchApis?b:p};return i.createElement(it.UsersContext.Provider,{value:A},e.children)}}("ContextUsersContextServer"),function(e){Rs=t[e]={};class s{static getStyles(){return{content:(0,y.css)((0,C.getSpacingClassName)("padding","x",20),(0,C.getSpacingClassName)("padding","bottom",20),(0,C.getSpacingContainerClassName)("y",20)),tabContent:(0,y.css)((0,C.getSpacingContainerClassName)("y",20)),notificationMessageCard:(0,y.css)((0,C.getSpacingClassName)("padding","x",20),(0,C.getSpacingClassName)("padding","top",20))}}}__decorate([a.memoize],s,"getStyles",null),t[e].UserHubPage=function(){const[e,t]=i.useState("all-users"),n=i.useContext(st.GroupsContext),r=i.useContext(it.UsersContext),a=s.getStyles(),{isAdmin:o}=(0,ye.useUserHubConfiguration)();(0,Us.useReEvaluateRulesNotification)(),(0,Ps.useSummaryPendingTotalChangesNotification)(),(0,Ns.useUserHubConfigurationErrorNotification)();const l=(0,ye.useUserHubContext)();return i.useEffect((()=>{l.perfRef.current.markRenderComplete()}),[]),i.createElement(W.Surface,{background:1},i.createElement(Ce.Page,{className:(0,y.css)(j.CssClassNames.flex.auto,Te.L2ClassNames.userManagementHub)},i.createElement(Is.UserHubNotificationsSummaryCard,{className:a.notificationMessageCard}),i.createElement(ge.Header,{title:he.HubSummary_Users,titleSize:1}),i.createElement("div",{className:a.content},i.createElement(ae.TabBar,{onSelectedTabChanged:e=>{t(e)},selectedTabId:e,renderAdditionalContent:o?()=>{const e=[{id:"export",iconProps:{iconName:"Download"},text:he.ContextualMenuOptionExportCSV,className:Te.L2ClassNames.commandItems.exportUsers,onActivate:()=>r.exportUsers()}];return i.createElement(be.HeaderCommandBar,{items:e})}:void 0},i.createElement(ae.Tab,{name:he.TabLabel_AllUsers,id:"all-users"}),n&&i.createElement(ae.Tab,{name:he.TabLabel_Groups,id:"group-rules"})),i.createElement("div",{className:a.tabContent},"all-users"===e&&i.createElement(_s.UsersTab,null),"group-rules"===e&&i.createElement(Ls.GroupsTab,null),i.createElement(ts.GroupCallouts,null)))))}}("ComponentsHubUserHubPage"),function(e){ks=t[e]={};class s{}s.emptyTabProviderContext={selectedId:void 0,tabs:[],commandBarItems:[],renderContent:void 0,renderFilterBar:void 0},t[e].UserHub=function(){const e=(0,ye.useUserHubConfiguration)(),t=e.shouldUseServerSideSearch?Fs.UsersServerContextProvider:Ds.UsersClientContextProvider;return i.createElement(ae.TabProviderContext.Provider,{value:s.emptyTabProviderContext},i.createElement(We.UserHubNotificationsContextProvider,null,i.createElement(xe.UsersSummaryContextProvider,null,i.createElement(t,null,i.createElement(As.BillingContextProvider,null,e.isAdmin?i.createElement(st.GroupsContextProvider,null,i.createElement(Nt.LicensingRulesContextProvider,null,i.createElement(kt.GroupCommandContextProvider,null,i.createElement(Rs.UserHubPage,null)))):i.createElement(Rs.UserHubPage,null))))))}}("ComponentsHubUserHub"),function(e){t[e]={};class s{}function n(){const e=i.useContext(We.UserHubNotificationsContext),[t,s]=(0,Is.useShowUserHubNotificationsPanel)(e),{sortedMessageIds:n}=i.useMemo((()=>Qe.NotificationUtils.summarizeNotifications(e.notifications)),[e.notifications]);return t?i.createElement(Is.UserHubNotificationsPanel,{persistentIds:[],notifications:e.notifications,messageIds:n,onDismiss:()=>s(!1),dismissAllNotifications:e.dismissAllNotifications,dismissNotification:e.dismissNotification}):null}function r(e){const[t,s]=i.useState(!1),{pageContext:r}=(0,o.useComponentContext)(),a=i.useRef(new ve.PerfUtil(r,"ms.vss-aex-user-management.user-hub.invite-user-context."));return i.createElement(ye.UserHubContextProvider,{telemetryArea:"Microsoft.VisualStudio.Services.UserManagement",telemetryFeature:"UserHub",perfRef:a},i.createElement(We.UserHubNotificationsContextProvider,null,i.createElement(xe.UsersSummaryContextProvider,{summarykeys:"defaultAccessLevel"},i.createElement(As.BillingContextProvider,null,t&&i.createElement(Rt.AddUsersToProjectPanel,{projectOrTeamDisplayName:e.projectOrTeamDisplayName,projectId:e.projectId,teamId:e.teamId,onDismiss:()=>{s(!1)},onUsersAdded:e.onUsersAdded}),i.createElement(n,null)))),i.createElement(e.context.Provider,{value:{onFlowStart:()=>{s(!0)}}},e.children))}s.componentType="inviteUserContextProvider",t[e].InviteUserContextProvider=r,o.VssComponent.register(s.componentType,r)}("EntryPointsInviteUserContextProvider"),function(e){function s(e){const{pageContext:t}=(0,o.useComponentContext)(),s=i.useRef(new ve.PerfUtil(t,"ms.vss-aex-user-management.user-hub.management-hub."));return s.current.markRenderStart(),i.createElement(ye.UserHubContextProvider,{telemetryArea:e.telemetryArea||"Unknown",telemetryFeature:e.telemetryFeature||"Unknown",perfRef:s},i.createElement(ks.UserHub,null))}t[e]={},t[e].ManagementHub=s,o.VssComponent.register("ms.vss-aex-user-management.user-hub.management-hub",s)}("EntryPointsManagementHub")}),["Resources","Components/Common/common","Models/MemberEntitlements","Generated/Constants","Context/UserHubContext","Components/Controls/useTrackedAsyncCallback","RestClient/MemberEntitlementManagement","Context/UsersSummaryContexts","Constants","Models/GroupOption","Components/Hub/Forms/ProjectForms","Components/Hub/Callouts/AddMember/useAddMemberFields","Models/UserIdentityPickerProvider","Components/Hub/Callouts/AddMember/useUserIdentityPicker","Models/AccessLevel","Models/Member","Utils/ObjectUtils","Utils/PromiseUtils","Utils/BatchUtils","Utils/JsonBatchUtils","Utils/MemberEntitlementJsonPatchBuilder","Models/Group","Utils/TableUtils","Components/Controls/FlexCenterBlock","Components/Controls/Tooltip.GroupMembership","Components/Hub/Callouts/EditMember/ProjectsForm","Components/Hub/Callouts/EditMember/useEditMemberInput","Components/Hub/Callouts/EditMember/useRefreshedMember","Components/Controls/GenericErrors","Context/NotificationContexts","Models/User","RestClient/Invitation","Components/Hub/Callouts/ResendUserInvitation","Components/Hub/Notifications/NotificationUtils","Utils/PatchResponseUtils","Components/Hub/Notifications/PatchResponseNotifications","Components/Hub/UserHubPage.Common","Context/CommandContext","Models/UserManagementFilters","Context/MembersContext","Context/MembersContext.Client","Context/GroupsContext","RestClient/MEMInternal","RestClientLegacy/MemberEntitlementManagement","Context/UsersContext","Context/useGroupsContextApiActions","Generated/Interfaces","Models/GroupIdentityPickerProvider","Models/LicensingRule.ApplicationStatus","Models/ProjectEntitlement","Models/MemberEntitlementsList","Models/UserEntitlement","RestClient/AzComm","RestClient/Core","RestClient/LicensingRule","Utils/DateUtils","Utils/FocusUtils","Components/Controls/AccessLevelDropdown","Components/Controls/FlexDividerCell","Components/Controls/AccessLevelDropdown.GroupAssignments","Components/Controls/CommonCallout","Components/Controls/CommonDialog","Components/Controls/CommonPanel","Components/Controls/IdentityPickers","Components/Controls/Notifications","Components/Controls/Persona","Components/Controls/StatusMessageCard","Components/Controls/TableCells","Components/Controls/TextFieldWithCopy","Context/LicensingRulesContext","Utils/IdentityUtils","Components/Hub/Notifications/BulkStatusTree","Components/Hub/Notifications/MemberOperationStatusNotifications","Components/Hub/Callouts/AddMember/AddGroupPanel","Components/Hub/Callouts/AddMember/AddUsersToCollection","Components/Hub/Callouts/BulkStatus","Components/Hub/Callouts/BulkStatus.Member","Components/Hub/Callouts/AddMember/AddUsersToProject","Context/CommandContext.Group","Components/Hub/Callouts/EditMember/EditMemberNotifications","Components/Hub/Callouts/EditMember/AccessLevelForm","Components/Hub/Callouts/EditMember/MemberPersona","Components/Hub/Callouts/EditMember/EditMemberPanel.AccessLevel","Components/Hub/Callouts/EditMember/EditMemberPanelTabGroup","Components/Hub/Callouts/EditMember/EditMemberPanel","Components/Hub/Callouts/EditMember/useEditGroup","Components/Hub/Callouts/EditMember/EditGroupPanel","Components/Hub/Callouts/EditMember/EditGroupForm.EditMembershipBar","Components/Hub/Callouts/EditMember/EditGroupForm.AddMembers","Components/Hub/Callouts/EditMember/EditGroupForm.RemoveMembers","Components/Hub/Callouts/EditMember/GroupMembersTable","Components/Hub/Callouts/EditMember/EditGroupPanel.ManageMembers","Components/Hub/Callouts/ReEvaluateRulesDialog","Components/Hub/Callouts/RemoveMember/RemoveMemberDialog","Components/Hub/Callouts/RemoveMember/RemoveGroupDialog","Components/Hub/Forms/ExtensionForms","Components/Hub/Callouts/ResolveGroupsDialog","Components/Hub/Callouts/Callouts.Group","Context/CommandContext.User.Bulk","Components/Hub/Callouts/EditUserBulk/Common","Components/Hub/Callouts/EditUserBulk/AddToProjectsPanel","Components/Hub/Callouts/EditUserBulk/ChangeAccessLevelPanel","Components/Hub/Callouts/RemoveMember/RemoveUserDialog","Components/Hub/Callouts/EditUserBulk/RemoveFromAccountDialog","Components/Hub/Callouts/EditUserBulk/RemoveFromProjectsPanel","Components/Hub/Callouts/RemoveMember/RemoveDirectAssignmentsDialog","Components/Hub/Callouts/Callouts.User.Bulk","Context/CommandContext.User","Components/Hub/Callouts/EditMember/EditUserPanel.AccessLevel","Components/Hub/MemberList/MemberTable","Components/Hub/MemberList/MemberTable.Columns","Components/Hub/Callouts/EditMember/GroupEntitlementsForm","Components/Hub/Callouts/EditMember/EditUserPanel","Components/Hub/Callouts/EditMember/ReinstateAssetsDialog","Components/Hub/Callouts/Callouts.User","Components/Hub/MemberList/GroupTable","Components/Hub/MemberList/MembersTableCard","Components/Hub/MemberList/GroupTableCard","Components/Hub/MemberList/UserTable","Context/BillingContext","Components/Hub/Summary/UsersSummaryPanel","Components/Hub/MemberList/UserTableCard","Components/Hub/Notifications/useReEvaluateRulesNotification","Components/Hub/Notifications/UserHubNotificationsCard","Components/Hub/Notifications/useSummaryPendingTotalChangesNotification","Components/Hub/Notifications/useUserHubConfigurationErrorNotification","Components/Hub/UserHubPage.FilterBar","Components/Hub/Tabs/GroupsTab","Components/Hub/Tabs/UsersTab","Context/UsersContext.Client","Context/UsersContext.Server","Components/Hub/UserHubPage","Components/Hub/UserHub","EntryPoints/InviteUserContextProvider","EntryPoints/ManagementHub"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-aex-user-management.user-hub-content"}}));