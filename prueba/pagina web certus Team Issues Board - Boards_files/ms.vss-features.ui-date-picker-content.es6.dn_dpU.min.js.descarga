"use strict";define("VSSUI",["require","exports","react","VSS/Core/Observable","VSS/Platform/Date","VSS/Platform/Layout"],(function(e,t,r,a,i,n){var s,o,l,d,c,u,p,h,m;s=t[m="ResourcesDatePicker"]={},t[m].Loading="Loading...",t[m].clearDateButton="Clear",t[m].goToToday="Go to today",t[m].invalidInputErrorMessage="Invalid date value specified.",t[m].isRequiredErrorMessage="A valid date is required",t[m].isOutOfBoundsErrorMessage="Selected date is not within the valid range",t[m].DatePickerCalloutLabel="Date Picker Callout",t[m].sunday="Sunday",t[m].monday="Monday",t[m].tuesday="Tuesday",t[m].wednesday="Wednesday",t[m].thursday="Thursday",t[m].friday="Friday",t[m].saturday="Saturday",t[m].sun="Sun",t[m].mon="Mon",t[m].tue="Tue",t[m].wed="Wed",t[m].thu="Thu",t[m].fri="Fri",t[m].sat="Sat",t[m].january="January",t[m].february="February",t[m].march="March",t[m].april="April",t[m].may="May",t[m].june="June",t[m].july="July",t[m].august="August",t[m].september="September",t[m].october="October",t[m].november="November",t[m].december="December",t[m].jan="Jan",t[m].feb="Feb",t[m].mar="Mar",t[m].apr="Apr",t[m].jun="Jun",t[m].jul="Jul",t[m].aug="Aug",t[m].sep="Sep",t[m].oct="Oct",t[m].nov="Nov",t[m].dec="Dec",t[m].prevMonthAriaLabel="Go to previous month",t[m].nextMonthAriaLabel="Go to next month",t[m].prevYearAriaLabel="Go to previous year",t[m].nextYearAriaLabel="Go to next year",function(e){o=t[e]={};t[e].ScreenContext=r.createContext(new class{constructor(){this.onResize=()=>{const e=this.getCurrentSize();this.size.value!==e&&(this.size.value=e)},this.size=new a.ObservableValue(this.getCurrentSize()),window.addEventListener("resize",this.onResize)}getCurrentSize(){return window.innerWidth>=750?1:0}})}("UtilsCustomizedScreen"),function(e){l=t[e]={};t[e].CustomizedScreenSizeObserver=e=>r.createElement(o.ScreenContext.Consumer,null,(a=>r.createElement(t.Observer.Observer,{screenSize:a.size},e.children)));t[e].ScreenSizeConditional=a=>r.createElement(t[e].CustomizedScreenSizeObserver,null,(e=>a.condition(e.screenSize)&&a.children))}("UtilsCustomizedScreenSize"),function(e){d=t[e]={},t[e].datePickerStrings=function(){return{months:[s.january,s.february,s.march,s.april,s.may,s.june,s.july,s.august,s.september,s.october,s.november,s.december],shortMonths:[s.jan,s.feb,s.mar,s.apr,s.may,s.jun,s.jul,s.aug,s.sep,s.oct,s.nov,s.dec],days:[s.sunday,s.monday,s.tuesday,s.wednesday,s.thursday,s.friday,s.saturday],shortDays:[s.sun,s.mon,s.tue,s.wed,s.thu,s.fri,s.sat],goToToday:s.goToToday,clear:s.clearDateButton,prevMonthAriaLabel:s.prevMonthAriaLabel,nextMonthAriaLabel:s.nextMonthAriaLabel,prevYearAriaLabel:s.prevYearAriaLabel,nextYearAriaLabel:s.nextYearAriaLabel}}}("ComponentsDatePickerDateStringHelper"),function(e){c=t[e]={};class a extends r.Component{constructor(e){super(e),this.containerDiv=r.createRef(),this.calendarDismissed=()=>{this.hidePicker()},this.onClick=e=>{e.defaultPrevented||this.props.disabled||(this.setState({pickerShown:!0}),e.preventDefault())},this.onChange=(e,t)=>{var r,a;this.setState({dateStr:t}),null===(a=(r=this.props).debounceOnChange)||void 0===a||a.call(r,t)},this.onTextFieldKeyDown=e=>{var t,r,a;if(!e.defaultPrevented&&!this.props.disabled)switch(e.which){case 40:case 13:this.setState({pickerShown:!0}),e.preventDefault();break;case 27:this.hidePicker(),e.preventDefault();break;case 8:case 46:this.props.showClear&&!(null===(t=this.props.manualEditingOptions)||void 0===t?void 0:t.value)&&(null===(a=(r=this.props).onChange)||void 0===a||a.call(r,void 0))}},this.onSelectDate=e=>{var t,r;this.hidePicker(),null===(r=(t=this.props).onChange)||void 0===r||r.call(t,e)},this.renderSpinner=()=>r.createElement("div",{className:"bolt-date-picker-spinner flex-row flex-center justify-center"},r.createElement(t.Spinner.Spinner,{label:s.Loading,size:"large"})),this.state={pickerShown:!1,dateStr:void 0}}componentDidMount(){this.props.expandOnMount&&this.setState({pickerShown:!0})}render(){const{containerClassName:e}=this.props,a=Object.assign({preprocessKeyStroke:e=>3},this.props.focusZoneProps);return r.createElement(t.Observer.Observer,{date:this.props.value,manualEditingOptions:this.props.manualEditingOptions},(i=>r.createElement("div",{className:e,ref:this.containerDiv},r.createElement(t.FormItem.FormItem,{error:this.props.hasError,message:this.props.errorMessage},r.createElement(t.TextField.TextField,{ariaControls:this.state.pickerShown?this.props.calendarId:void 0,ariaExpanded:this.state.pickerShown,ariaHasPopup:!0,ariaLabel:this.props.ariaLabel,ariaLabelledBy:this.props.ariaLabelledBy,className:(0,t.Util.css)("flex-row flex-grow",this.props.className),disabled:this.props.disabled,inputClassName:"bolt-date-picker-input",inputId:this.props.inputId,onClick:i.manualEditingOptions?void 0:this.onClick,onKeyDown:this.onTextFieldKeyDown,onChange:i.manualEditingOptions?this.onChange:void 0,readOnly:!i.manualEditingOptions,role:"combobox",suffixIconProps:this.getSuffixIconProps(i.manualEditingOptions),placeholder:this.props.placeholder,value:this.getValue(i)})),this.state.pickerShown&&r.createElement(l.CustomizedScreenSizeObserver,null,(e=>{var o;const l=0===e.screenSize;return r.createElement(t.Callout.Callout,{anchorElement:l?void 0:null!==(o=this.containerDiv.current)&&void 0!==o?o:void 0,anchorOrigin:l?void 0:{horizontal:"start",vertical:"end"},ariaLabel:this.props.calloutAriaLabel||s.DatePickerCalloutLabel,contentClassName:"depth-8 bolt-date-picker",contentLocation:l?0:void 0,contentShadow:!0,id:this.props.calendarId,onDismiss:this.calendarDismissed,escDismiss:!0,lightDismiss:!0,focuszoneProps:a},r.createElement(n.WrappedComponent,{className:"bolt-date-picker",dependencies:["ms.vss-features.ui-calendar-content"],loadingComponent:this.renderSpinner,wrappedProps:{onSelectDate:this.onSelectDate,onDismiss:this.calendarDismissed,shouldFocusOnMount:!0,showClear:this.props.showClear,minDate:this.props.minDate,maxDate:this.props.maxDate,value:this.getDateOrUndefined(i.date),strings:(0,d.datePickerStrings)()},wrappedType:"fabric.pickers.calendar"}))})))))}getDateOrUndefined(e){return e instanceof Date?e:void 0}hidePicker(){var e,t;this.setState({pickerShown:!1}),null===(t=(e=this.props).onCollapse)||void 0===t||t.call(e)}toLocaleTimeString(e){return e instanceof Date?(0,i.localeDateFormat)(e,"t",new Intl.DateTimeFormat(void 0,{hour:"numeric",minute:"numeric"})):void 0}getValue(e){if(e.manualEditingOptions){if(this.state.dateStr)return this.state.dateStr;if(1===e.manualEditingOptions.datePickerType){if(e.date instanceof Date)return this.toLocaleTimeString(this.getDateOrUndefined(e.date));if(this.props.hasError)return e.date}}if(e.date)return e.date instanceof Date?(0,i.localeDateFormat)(e.date,"d",new Intl.DateTimeFormat(void 0,{year:"numeric",month:"numeric",day:"numeric"})):this.props.hasError?e.date:void 0}getSuffixIconProps(e){return{iconName:1===(null==e?void 0:e.datePickerType)?"Clock":"Calendar",onClick:1===(null==e?void 0:e.datePickerType)?void 0:this.onClick}}}t[e].DatePicker=a}("ComponentsDatePickerDatePicker"),function(e){u=t[e]={},__exportStar(c,t[e])}("ComponentsDatePickerindex"),function(e){p=t[e]={};class i extends t.FilterBarItem.FilterBarItem{constructor(e){super(e),this.filterDate=new a.ObservableValue(void 0),this.componentDidMount=()=>{var e;if(super.componentDidMount(),this.props.filter){const t=null===(e=this.props.filter)||void 0===e?void 0:e.getFilterItemState(this.props.filterItemKey);this.onFilterChanged(t)}},this.onFilterChanged=e=>{super.onFilterChanged(e),e&&e.value?this.filterDate.value=e.value:this.filterDate.value=void 0},this._onSelectionChanged=e=>{this.setFilterValue({value:e}),this.filterDate.value=e},this.filterDate.value=e.initialValue}focus(){return!1}render(){return r.createElement("div",{className:"bolt-date-picker-filterbar-item"},r.createElement(c.DatePicker,{value:this.filterDate,onChange:this._onSelectionChanged,placeholder:this.props.placeholder}))}}t[e].DatePickerFilterBarItem=i}("ComponentsDatePickerFilterBarItemDatePickerFilterBarItem"),function(e){h=t[e]={},__exportStar(p,t[e])}("ComponentsDatePickerFilterBarItemindex"),function(e){t[e]={},__exportStar(u,t[e]),__exportStar(h,t[e])}("DatePicker")}),["Resources.DatePicker","Utils/CustomizedScreen","Utils/CustomizedScreenSize","Components/DatePicker/DateStringHelper","Components/DatePicker/DatePicker","Components/DatePicker/index","Components/DatePickerFilterBarItem/DatePickerFilterBarItem","Components/DatePickerFilterBarItem/index","DatePicker"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-date-picker-content"}}));