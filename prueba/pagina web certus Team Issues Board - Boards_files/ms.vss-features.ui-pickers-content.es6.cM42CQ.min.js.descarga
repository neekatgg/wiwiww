"use strict";define("VSSUI",["require","exports","react","OfficeFabric/DatePicker","OfficeFabric/Utilities","OfficeFabric/Persona","OfficeFabric/Pickers","VSS/Core/Util/String","OfficeFabric/Label","OfficeFabric/Callout","OfficeFabric/FocusZone","VSS/Core/TimerManagement","VSS/Core/Observable"],(function(e,t,s,i,a,r,n,o,l,c,d,p,u){var m,h,g,S,y,C,v,f,P,b,x,E,F,k,N,T,I,D,_,V,R,w,A,U,L;m=t[L="ResourcesPickers"]={},t[L].goToToday="Go to today",t[L].invalidInputErrorMessage="Invalid date value specified.",t[L].isRequiredErrorMessage="A valid date is required",t[L].isOutOfBoundsErrorMessage="Selected date is not within the valid range",t[L].sunday="Sunday",t[L].monday="Monday",t[L].tuesday="Tuesday",t[L].wednesday="Wednesday",t[L].thursday="Thursday",t[L].friday="Friday",t[L].saturday="Saturday",t[L].sun="Sun",t[L].mon="Mon",t[L].tue="Tue",t[L].wed="Wed",t[L].thu="Thu",t[L].fri="Fri",t[L].sat="Sat",t[L].january="January",t[L].february="February",t[L].march="March",t[L].april="April",t[L].may="May",t[L].june="June",t[L].july="July",t[L].august="August",t[L].september="September",t[L].october="October",t[L].november="November",t[L].december="December",t[L].jan="Jan",t[L].feb="Feb",t[L].mar="Mar",t[L].apr="Apr",t[L].jun="Jun",t[L].jul="Jul",t[L].aug="Aug",t[L].sep="Sep",t[L].oct="Oct",t[L].nov="Nov",t[L].dec="Dec",t[L].prevMonthAriaLabel="Go to previous month",t[L].nextMonthAriaLabel="Go to next month",t[L].prevYearAriaLabel="Go to previous year",t[L].nextYearAriaLabel="Go to next year",function(e){h=t[e]={};class r extends s.Component{constructor(e){super(e),this._value=new Date,this.onAdditionalInfoChange=(e,t)=>{const{parseTimeFromString:s=this._defaultParseTimeFromString}=this.props;this.setState({dateValue:t,dateErrorMessage:this._getErrorMessage(t)});let i=s(t);i&&(this._value.setHours(i.getHours(),i.getMinutes(),i.getSeconds()),this.props.onValueChanged&&this.props.onValueChanged(this._value))},this._getErrorMessage=e=>{const{parseTimeFromString:s=this._defaultParseTimeFromString}=this.props;return s(e)?"":t.VSSResourcesVSSUI.DateTimePicker_CannotParseTime},e&&(e.dateOnly||("value"in e&&(0,a.warn)("'value' will be ignored. Use 'defaultValue'."),"onSelectDate"in e&&(0,a.warn)("'onSelectDate' will be ignored.")),this._value=e.defaultValue,this.state={dateValue:this.props.formatTime?this.props.formatTime(this._value):this._defaultFormatTime(this._value),dateErrorMessage:""})}render(){const{dateValue:e,dateErrorMessage:a}=this.state;return this.props.dateOnly?s.createElement(i.DatePicker,Object.assign({"aria-label":t.VSSResourcesVSSUI.DateTimePicker_DateFieldAriaLabel},this.props)):s.createElement("div",{className:"vss-DateTimePicker"},s.createElement("div",{className:"vss-DateTimePicker--dateField"},s.createElement(i.DatePicker,Object.assign({className:this.props.dateFieldClassName,isMonthPickerVisible:!1},this.props,{value:this._value,ariaLabel:this.props.dateAriaLabel||t.VSSResourcesVSSUI.DateTimePicker_DateFieldAriaLabel,maxDate:this.props.maxDate,minDate:this.props.minDate,onSelectDate:e=>{this._value&&this._value.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),this.props.onValueChanged&&this.props.onValueChanged(this._value)}}))),s.createElement("div",{className:"vss-DateTimePicker--timeField"},s.createElement(t.FormItem.FormItem,{className:this.props.timeFieldClassName,message:a,error:""!==a},s.createElement(t.TextField.TextField,{value:e,onChange:this.onAdditionalInfoChange,ariaLabel:this.props.timeAriaLabel||t.VSSResourcesVSSUI.DateTimePicker_TimeFieldAriaLabel}))))}_defaultParseTimeFromString(e){const t=Date.parse(e);return t?new Date(t):null}_defaultFormatTime(e){return e?e.toLocaleTimeString():""}}t[e].DateTimePicker=r}("ComponentsDateTimePickerDateTimePicker"),function(e){g=t[e]={};class i extends t.FilterBarItem.FilterBarItem{constructor(){super(...arguments),this._onSelectionChanged=e=>{this.setFilterValue({value:e})}}focus(){return!1}componentWillMount(){this.props.filter.setFilterItemState(this.props.filterItemKey,{value:this.props.defaultValue})}render(){return s.createElement(h.DateTimePicker,{defaultValue:this.props.defaultValue,formatDate:this.props.formatDate,formatTime:this.props.formatTime,parseTimeFromString:this.props.parseTimeFromString,onValueChanged:this._onSelectionChanged})}onFilterChanged(e){}}t[e].DateTimePickerFilterBarItem=i}("ComponentsDateTimePickerDateTimePickerFilterBarItem"),function(e){S=t[e]={},t[e].datePickerStrings=function(){return{months:[m.january,m.february,m.march,m.april,m.may,m.june,m.july,m.august,m.september,m.october,m.november,m.december],shortMonths:[m.jan,m.feb,m.mar,m.apr,m.may,m.jun,m.jul,m.aug,m.sep,m.oct,m.nov,m.dec],days:[m.sunday,m.monday,m.tuesday,m.wednesday,m.thursday,m.friday,m.saturday],shortDays:[m.sun,m.mon,m.tue,m.wed,m.thu,m.fri,m.sat],goToToday:m.goToToday,prevMonthAriaLabel:m.prevMonthAriaLabel,nextMonthAriaLabel:m.nextMonthAriaLabel,prevYearAriaLabel:m.prevYearAriaLabel,nextYearAriaLabel:m.nextYearAriaLabel}}}("ComponentsDateTimePickerHelpers"),function(e){y=t[e]={},__exportStar(h,t[e]),__exportStar(g,t[e]),__exportStar(S,t[e])}("ComponentsDateTimePickerindex"),function(e){C=t[e]={},__exportStar(y,t[e])}("DateTimePicker"),function(e){function i(e,t){return e?t?e>t?e:t:e:t}v=t[e]={};class a extends s.Component{constructor(e){super(e),e&&(this._startTime=e.defaultStartTime,this._endTime=e.defaultEndTime)}render(){const{maxDate:e,minDate:a}=this.props;return s.createElement("div",{className:"vss-DateTimeRangePicker"},s.createElement("div",{className:"vss-DateTimeRangePicker--container"},s.createElement("span",{className:"vss-DateTimeRangePicker--label"},t.VSSResourcesVSSUI.DateTimeRangePicker_Start),s.createElement(C.DateTimePicker,{dateFieldClassName:"startDate",timeFieldClassName:"startTime",defaultValue:this._startTime,maxDate:(r=e,n=this._endTime,r?n?r<n?r:n:r:n),minDate:a,disableAutoFocus:!0,formatDate:this.props.formatDate,formatTime:this.props.formatTime,parseTimeFromString:this.props.parseTimeFromString,onValueChanged:e=>{this._startTime=e,this.props.onValueChanged&&this.props.onValueChanged(this._startTime,this._endTime)},dateAriaLabel:this.props.startDateAriaLabel||t.VSSResourcesVSSUI.DateTimeRangePicker_StartDate,timeAriaLabel:this.props.startTimeAriaLabel||t.VSSResourcesVSSUI.DateTimeRangePicker_StartTime})),s.createElement("div",{className:"vss-DateTimeRangePicker--container"},s.createElement("span",{className:"vss-DateTimeRangePicker--label"},t.VSSResourcesVSSUI.DateTimeRangePicker_End),s.createElement(C.DateTimePicker,{dateFieldClassName:"endDate",timeFieldClassName:"endTime",defaultValue:this._endTime,maxDate:e,minDate:i(a,this._startTime),disableAutoFocus:!0,formatDate:this.props.formatDate,formatTime:this.props.formatTime,parseTimeFromString:this.props.parseTimeFromString,onValueChanged:e=>{this._endTime=e,this.props.onValueChanged&&this.props.onValueChanged(this._startTime,this._endTime)},dateAriaLabel:this.props.endDateArialLabel||t.VSSResourcesVSSUI.DateTimeRangePicker_EndDate,timeAriaLabel:this.props.endTimeAriaLabel||t.VSSResourcesVSSUI.DateTimeRangePicker_EndTime})));var r,n}}t[e].DateTimeRangePicker=a}("ComponentsDateTimeRangePickerDateTimeRangePicker"),function(e){f=t[e]={},__exportStar(v,t[e])}("ComponentsDateTimeRangePickerindex"),function(e){function s(e){return{imageUrl:e.image,text:e.displayName,showSecondaryText:!!e.displayName&&""!==e.displayName,secondaryText:i(e),size:r.PersonaSize.extraExtraSmall}}function i(e){return!e.isHosted&&e.samAccountName&&e.samAccountName.trim()?(e.scopeName&&e.scopeName.trim()?e.scopeName+"\\":"")+e.samAccountName:e.signInAddress&&e.signInAddress.trim()?e.signInAddress:e.mail&&e.mail.trim()?e.mail:e.mailNickname&&e.mailNickname.trim()?e.mailNickname:""}P=t[e]={},t[e].convertIdentityToPersona=s,t[e].convertIdentityListToPersonaList=function(e){const t=e,i=e;return Array.isArray(t)?t.map((e=>s(e))):i&&i.then?i.then((e=>e.map((e=>s(e))))):null},t[e].getSignInAddress=i,t[e].isUser=function(e){return"user"===e.entityType.toLocaleLowerCase()}}("ComponentsPeoplePickerPeoplePickerUtils"),function(e){b=t[e]={};class i extends s.Component{constructor(){super(...arguments),this._peoplePicker=s.createRef(),this._getfilteredPersonas=e=>(0,P.convertIdentityListToPersonaList)(this.props.pickerProvider.onFilterIdentities(e)),this._resultsFooter=()=>this._peoplePicker.current&&this._peoplePicker.current.items.length>0?s.createElement("div",{className:"vss-NoIdentitiesFound"},(0,o.format)(t.VSSResourcesVSSUI.PeoplePickerResultsFoundText,this._peoplePicker.current.items)):null,this._onRenderNoIdentitiesFound=()=>s.createElement("div",{className:"vss-NoIdentitiesFound"},t.VSSResourcesVSSUI.PeoplePickerNoResultsText)}render(){const e={onRenderNoResultFound:this._onRenderNoIdentitiesFound,resultsFooter:this._resultsFooter},i={placeholder:this.props.placeholder||t.VSSResourcesVSSUI.PeoplePickerPlaceholderText};return s.createElement(n.NormalPeoplePicker,{ref:this._peoplePicker,className:"vss-PeoplePicker",pickerSuggestionsProps:e,inputProps:i,resolveDelay:200,searchingText:t.VSSResourcesVSSUI.PeoplePickerLoadingText,onResolveSuggestions:this._getfilteredPersonas})}}t[e].PeoplePicker=i}("ComponentsPeoplePickerPeoplePicker"),function(e){x=t[e]={};class i extends s.Component{render(){const{suggestionModel:e,renderSuggestion:i,onClick:a,className:r,onRemoveItem:n,isSelectedOverride:o,removeButtonAriaLabel:l}=this.props;return s.createElement("div",{className:(0,t.Util.css)("vss-suggestionsItem","flex-row flex-grow",(e.selected||o)&&"is-suggested vss-suggestionsItemIsSuggested",r)},s.createElement("div",{onClick:a,className:"ms-Suggestions-itemButton itemButton flex-row flex-grow"},i(e.item,this.props)),this.props.showRemoveButton?s.createElement(t.Button.Button,{subtle:!0,iconProps:{iconName:"Cancel",style:{fontSize:"12px"}},ariaLabel:l,onClick:n,className:(0,t.Util.css)("ms-Suggestions-closeButton","closeButton")}):null)}}t[e].SuggestionsItem=i;class a extends s.Component{constructor(e){super(e),this._forceResolveButton=s.createRef(),this._searchForMoreButton=s.createRef(),this._selectedElement=s.createRef(),this.SuggestionsItemOfProperType=i,this.tryHandleKeyDown=(e,t)=>{let s=!1,i=null;const a=this.state.selectedActionType,r=this.props.suggestions.length;if(40===e)switch(a){case 1:r>0?(this._refocusOnSuggestions(e),i=0):i=this._searchForMoreButton.current?2:1;break;case 2:this._forceResolveButton.current?i=1:r>0?(this._refocusOnSuggestions(e),i=0):i=2;break;case 0:-1===t&&this._forceResolveButton.current&&(i=1)}else if(38===e)switch(a){case 1:this._searchForMoreButton.current?i=2:r>0&&(this._refocusOnSuggestions(e),i=0);break;case 2:r>0?(this._refocusOnSuggestions(e),i=0):this._forceResolveButton.current&&(i=1);break;case 0:-1===t&&this._searchForMoreButton.current&&(i=2)}return null!==i&&(this.setState({selectedActionType:i}),s=!0),s},this._getMoreResults=()=>{this.props.onGetMoreResults&&this.props.onGetMoreResults()},this._forceResolve=()=>{this.props.createGenericItem&&this.props.createGenericItem()},this._shouldShowForceResolve=()=>!!this.props.showForceResolve&&this.props.showForceResolve(),this._onClickTypedSuggestionsItem=(e,t)=>s=>{this.props.onSuggestionClick(s,e,t)},this._refocusOnSuggestions=e=>{"function"==typeof this.props.refocusSuggestions&&this.props.refocusSuggestions(e)},this._onRemoveTypedSuggestionsItem=(e,t)=>s=>{(0,this.props.onSuggestionRemove)(s,e,t),s.stopPropagation()},this.state={selectedActionType:0}}componentDidMount(){this.scrollSelected(),this.activeSelectedElement=this._selectedElement?this._selectedElement.current:null}componentDidUpdate(){this._selectedElement.current&&this.activeSelectedElement!==this._selectedElement.current&&(this.scrollSelected(),this.activeSelectedElement=this._selectedElement.current)}render(){const{forceResolveText:e,mostRecentlyUsedHeaderText:i,searchForMoreText:a,className:r,moreSuggestionsAvailable:n,noResultsFoundText:o,suggestions:l,isLoading:c,isSearching:d,loadingText:p,onRenderNoResultFound:u,searchingText:m,isMostRecentlyUsedVisible:h,resultsMaximumNumber:g,resultsFooterFull:S,resultsFooter:y,isResultsFooterVisible:C=!0,suggestionsAvailableAlertText:v,suggestionsHeaderText:f}=this.props,P=()=>o?s.createElement("div",{role:"alert",className:"ms-Suggestions-none vss-suggestionsNone"},o):null;let b,x=f;h&&i&&(x=i),C&&(b=l.length>=g?S:y);const E=!(l&&l.length||c);return s.createElement("div",{className:(0,t.Util.css)("ms-Suggestions",r||"","vss-suggestions")},x?s.createElement("div",{className:(0,t.Util.css)("ms-Suggestions-title","vss-suggestionsTitle")},x):null,e&&this._shouldShowForceResolve()&&s.createElement(t.Button.Button,{ref:this._forceResolveButton,className:(0,t.Util.css)("ms-forceResolve-button actionButton",1===this.state.selectedActionType&&"is-selected buttonSelected"),onClick:this._forceResolve},e),c&&s.createElement(t.Spinner.Spinner,{className:"ms-Suggestions-spinner vss-suggestionsSpinner",label:p}),E?u?u(void 0,P):P():this._renderSuggestions(),a&&n&&s.createElement(t.Button.Button,{ref:this._searchForMoreButton,className:(0,t.Util.css)("ms-SearchMore-button","actionButton",2===this.state.selectedActionType&&"is-selected buttonSelected"),iconProps:{iconName:"Search"},onClick:this._getMoreResults},a),d?s.createElement(t.Spinner.Spinner,{className:"ms-Suggestions-spinner vss-suggestionsSpinner",label:m}):null,!b||n||h||d?null:s.createElement("div",{className:"ms-Suggestions-title vss-suggestionsTitle"},b(this.props)),s.createElement("span",{role:"alert","aria-live":"polite",className:"ms-Suggestions-suggestionsAvailable vss-suggestionsAvailable"},!c&&!d&&l&&l.length>0&&v?v:null))}hasSuggestedAction(){return void 0!==this._searchForMoreButton.current||void 0!==this._forceResolveButton.current}hasSuggestedActionSelected(){return 0!==this.state.selectedActionType}executeSelectedAction(){switch(this.state.selectedActionType){case 1:this._forceResolve();break;case 2:this._getMoreResults()}}focusAboveSuggestions(){this._forceResolveButton.current?this.setState({selectedActionType:1}):this._searchForMoreButton.current&&this.setState({selectedActionType:2})}focusBelowSuggestions(){this._searchForMoreButton.current?this.setState({selectedActionType:2}):this._forceResolveButton.current&&this.setState({selectedActionType:1})}focusSearchForMoreButton(){this._searchForMoreButton.current&&this._searchForMoreButton.current.focus()}scrollSelected(){this._selectedElement.current&&void 0!==this._selectedElement.current.scrollIntoView&&this._selectedElement.current.scrollIntoView(!1)}_renderSuggestions(){const{onRenderSuggestion:e,removeSuggestionAriaLabel:i,suggestionsItemClassName:a,resultsMaximumNumber:r,showRemoveButtons:n,suggestionsContainerAriaLabel:o}=this.props;let{suggestions:l}=this.props;const c=this.SuggestionsItemOfProperType;return r&&(l=l.slice(0,r)),s.createElement("div",{"aria-label":o,className:"ms-Suggestions-container vss-suggestionsContainer",id:(0,t.Util.getSafeId)("suggestion-list"),role:"list"},l.map(((r,o)=>s.createElement("div",{"aria-label":r.ariaLabel,key:r.item.key?r.item.key:o,id:(0,t.Util.getSafeId)("sug-"+o),ref:r.selected?this._selectedElement:"",role:"listitem"},s.createElement(c,{className:a,id:(0,t.Util.getSafeId)("sug-item"+o),onClick:this._onClickTypedSuggestionsItem(r.item,o),onRemoveItem:this._onRemoveTypedSuggestionsItem(r.item,o),removeButtonAriaLabel:i,renderSuggestion:e,showRemoveButton:n,suggestionModel:r})))))}}t[e].Suggestions=a}("ComponentsPeoplePickerSuggestions"),function(e){E=t[e]={},__exportStar(b,t[e]),__exportStar(P,t[e]),__exportStar(x,t[e])}("ComponentsPeoplePickerindex"),function(e){F=t[e]={};class i extends s.Component{render(){return s.createElement("div",null,s.createElement("div",{className:this.props.padTop?"contact-card-line-top":"contact-card-line"},s.createElement("div",{className:"contact-card-span-label"},this.props.label),s.createElement("div",{className:"contact-card-span-content"},this.props.link&&this.props.content&&s.createElement("a",{className:"profile-card-tab-element",href:this.props.link},this.props.content),!this.props.link&&this.props.content)),s.createElement("div",{style:{clear:"both"}}))}}t[e].ContactCardContactLine=i;class a extends s.Component{render(){const{identity:e}=this.props;return s.createElement("div",{className:"contact-or-organization-card-wrapper"},s.createElement("div",{className:"contact-card-header-wrapper"},s.createElement("div",{className:"body-m"},s.createElement(l.Label,null,t.VSSResourcesVSSUI.PeoplePickerContactInfo))),s.createElement("div",{className:"contact-card-info-wrapper"},s.createElement(i,{label:t.VSSResourcesVSSUI.PeoplePickerEmail,content:e.mail,link:`mailto:${e.mail}`}),s.createElement(i,{label:t.VSSResourcesVSSUI.PeoplePickerPhoneNumber,content:e.telephoneNumber,link:`mailto:${e.telephoneNumber}`}),s.createElement(i,{label:t.VSSResourcesVSSUI.PeoplePickerLocation,content:e.physicalDeliveryOfficeName}),s.createElement(i,{label:t.VSSResourcesVSSUI.PeoplePickerTitle,content:e.jobTitle,padTop:!0}),s.createElement(i,{label:t.VSSResourcesVSSUI.PeoplePickerDepartment,content:e.department}),s.createElement(i,{label:t.VSSResourcesVSSUI.PeoplePickerAlias,content:e.mailNickname})))}}t[e].ContactCard=a}("ComponentsPersonaCardContactCard"),function(e){k=t[e]={};class i extends s.Component{render(){return s.createElement("div",{className:"default-card-contact-line-wrapper"},s.createElement(l.Label,{className:"default-card-contact-line"},s.createElement(t.VssIcon.VssIcon,{iconName:this.props.iconName,className:"default-card-contact-line-label"}),this.props.link&&s.createElement("a",{href:this.props.link,className:"default-card-contact-line-link profile-card-tab-element"},this.props.content),!this.props.link&&s.createElement("span",{className:"default-card-contact-line-no-link"},this.props.content)))}}t[e].DefaultCardContactLine=i;class a extends s.Component{componentDidMount(){this.props.setFocus&&this.props.setFocus()}render(){const{identity:e,isPreviousHeader:a}=this.props,r={imageUrl:this.props.identity.image,primaryText:this.props.identity.displayName,secondaryText:this.props.identity.jobTitle,tertiaryText:this.props.identity.department},n=s.createElement("div",{className:"flex-row"},s.createElement(t.VssPersona.VssPersona,{className:"persona-main",displayName:r.primaryText,imageUrl:r.imageUrl?r.imageUrl+"?size=2":void 0,size:"extra-large",suppressPersonaCard:!0}),s.createElement("div",{className:"flex-column flex-grow persona-card-name"},s.createElement("div",{className:"persona-main-text-primary title-s"},r.primaryText),""===r.secondaryText?void 0:s.createElement("div",{className:"persona-main-text-secondary"},r.secondaryText),""===r.tertiaryText?void 0:s.createElement("div",{className:"persona-main-text-tertiary"},r.tertiaryText)));let o=null;if(this.props.manager){const e=this.props.manager,i={imageUrl:e.image,primaryText:e.displayName,secondaryText:e.jobTitle,tertiaryText:e.department};o=s.createElement("div",{className:"persona-list-manager-element profile-card-tab-element flex-row","aria-label":e.displayName,key:e.entityId+e.signInAddress,onClick:()=>{this.props.onClickEntity(e)},"data-is-focusable":!0,role:"button"},s.createElement(t.VssPersona.VssPersona,{displayName:i.primaryText,imageUrl:i.imageUrl,size:"medium-plus",suppressPersonaCard:!0}),s.createElement("div",{className:"flex-column flex-grow persona-card-name"},s.createElement("div",{className:"persona-list-element-text-primary"},i.primaryText),""===i.secondaryText?void 0:s.createElement("div",{className:"persona-list-element-text-secondary"},i.secondaryText)))}return s.createElement("div",{className:a?"default-card-with-header":"default-card-without-header"},n,s.createElement("div",null,(e.mail||e.telephoneNumber||e.physicalDeliveryOfficeName)&&s.createElement("div",{className:"default-card-contact-info-wrapper"},s.createElement("hr",{className:"hr-main"}),s.createElement("div",{className:"default-card-header-wrapper"},s.createElement("span",{className:"default-card-header pointer profile-card-tab-element",onClick:()=>{this.props.showContactCard()},"aria-label":t.VSSResourcesVSSUI.PeoplePickerContact,"data-is-focusable":!0,role:"button"},s.createElement(l.Label,{className:"pointer"},s.createElement("b",{className:"default-card-header-space"},t.VSSResourcesVSSUI.PeoplePickerContact),s.createElement(t.VssIcon.VssIcon,{iconType:0,iconName:"ChevronRight"})))),s.createElement("div",{className:"default-card-contact-info-container"},e.mail&&s.createElement(i,{iconName:"Mail",content:e.mail,link:`mailto:${e.mail}`}),e.mail&&s.createElement(i,{iconName:"Chat",content:t.VSSResourcesVSSUI.PeoplePickerStartChat,link:`sip:${e.mail}`}),e.telephoneNumber&&s.createElement(i,{iconName:"Phone",content:e.telephoneNumber,link:`tel:${e.telephoneNumber}`}),e.physicalDeliveryOfficeName&&s.createElement(i,{iconName:"POI",content:e.physicalDeliveryOfficeName}))),this._renderDirectManagerElement(o)))}_renderDirectManagerElement(e){return e?s.createElement("div",{className:"default-card-direct-manager-wrapper"},s.createElement("hr",{className:"hr-secondary"}),s.createElement("div",{className:"default-card-header-wrapper"},s.createElement("span",{className:"default-card-header pointer profile-card-tab-element",onClick:()=>{this.props.showOrganizationCard()},"aria-label":t.VSSResourcesVSSUI.PeoplePickerOrganization,"data-is-focusable":!0,role:"button"},s.createElement(l.Label,{className:"pointer"},s.createElement("b",{className:"default-card-header-space"},t.VSSResourcesVSSUI.PeoplePickerOrganization),s.createElement(t.VssIcon.VssIcon,{iconType:0,iconName:"ChevronRight"})))),s.createElement("div",{className:"default-card-direct-manager"},s.createElement("div",{className:"default-card-header-reportsto"},t.VSSResourcesVSSUI.PeoplePickerReportsTo),e)):null}}t[e].DefaultCard=a}("ComponentsPersonaCardDefaultCard"),function(e){N=t[e]={};class i extends s.Component{render(){const e={imageUrl:this.props.identity.image,primaryText:this.props.identity.displayName},i=s.createElement("div",{className:"flex-row"},s.createElement(t.VssPersona.VssPersona,{className:"persona-main",displayName:e.primaryText,imageUrl:e.imageUrl?e.imageUrl+"?size=2":void 0,size:"extra-large",suppressPersonaCard:!0}),s.createElement("div",{className:"flex-column flex-grow persona-card-name"},s.createElement("div",{className:"persona-main-text-primary"},e.primaryText)));return s.createElement("div",{className:"default-card-abridged flex-row"},i,this._verifySignInAddress()&&s.createElement("div",null,s.createElement("div",{className:"default-card-contact-info-wrapper"},s.createElement("hr",{className:"hr-main"}),s.createElement("div",{className:"default-card-header-wrapper"},s.createElement("span",{className:"default-card-header"},s.createElement(l.Label,null,s.createElement("b",{className:"default-card-header-space"},t.VSSResourcesVSSUI.PeoplePickerContact)))),s.createElement("div",{className:"default-card-contact-info-container"},s.createElement(k.DefaultCardContactLine,{iconName:"Mail",content:this.props.identity.signInAddress,link:`mailto:${this.props.identity.signInAddress}`}),s.createElement(k.DefaultCardContactLine,{iconName:"Chat",content:t.VSSResourcesVSSUI.PeoplePickerStartChat,link:`sip:${this.props.identity.signInAddress}`})))))}_verifySignInAddress(){if(!this.props.identity.signInAddress)return!1;return!!/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(this.props.identity.signInAddress)}}t[e].DefaultAbridgedCard=i}("ComponentsPersonaCardDefaultAbridgedCard"),function(e){T=t[e]={};class i extends s.Component{render(){const e={imageUrl:this.props.identity.image,primaryText:this.props.identity.displayName,secondaryText:this.props.identity.scopeName&&this.props.identity.signInAddress?this.props.identity.scopeName+"\\"+this.props.identity.signInAddress:this.props.identity.signInAddress?this.props.identity.signInAddress:""};return s.createElement("div",{className:"default-card-simple flex-row"},s.createElement("div",{className:"flex-row"},s.createElement(t.VssPersona.VssPersona,{className:"persona-main",displayName:e.primaryText,imageUrl:e.imageUrl?e.imageUrl+"?size=2":void 0,suppressPersonaCard:!0,size:"extra-large"}),s.createElement("div",{className:"flex-column flex-grow persona-card-name"},s.createElement("div",{className:"persona-main-text-primary"},e.primaryText),""===e.secondaryText?void 0:s.createElement("div",{className:"persona-main-text-secondary"},e.secondaryText))))}}t[e].DefaultSimpleCard=i}("ComponentsPersonaCardDefaultSimpleCard"),function(e){I=t[e]={};class i extends s.Component{render(){const e=this.createManagerChainPersonaElements(),i=this.createDirectReportsPersonaElements();return s.createElement("div",{className:"contact-or-organization-card-wrapper"},s.createElement("div",{className:"organization-card-content"},s.createElement("div",{className:"organization-card-header-wrapper"},s.createElement(l.Label,null,t.VSSResourcesVSSUI.PeoplePickerOrganization)),s.createElement("div",{className:"organization-card-manager-chain-wrapper"},e),i.length>0&&s.createElement("div",{className:"organization-card-direct-reports-wrapper"},s.createElement(l.Label,{className:"organization-card-direct-reports-label"},(0,o.format)(t.VSSResourcesVSSUI.PeoplePickerReportingTo,this.props.identity.displayName,this.props.directReportList.length)),i)))}createManagerChainPersonaElements(){var e=this;const i=this.props.managerList?this.props.managerList.map((i=>{const a={imageUrl:i.image,primaryText:i.displayName?i.displayName:"",secondaryText:i.jobTitle?i.jobTitle:"",tertiaryText:i.department?i.department:""};return s.createElement("div",{className:"persona-list-element profile-card-tab-element flex-row","aria-label":i.displayName,key:i.entityId+i.signInAddress,onClick:()=>{e.props.onClickEntity(i)},"data-is-focusable":!0,role:"button"},s.createElement(t.VssPersona.VssPersona,{displayName:a.primaryText,imageUrl:a.imageUrl,size:"medium-plus",suppressPersonaCard:!0}),s.createElement("div",{className:"flex-column flex-grow persona-card-name"},s.createElement("div",{className:"persona-list-element-text-primary"},a.primaryText),""===a.secondaryText?void 0:s.createElement("div",{className:"persona-list-element-text-secondary"},a.secondaryText)))})):[],a={imageUrl:this.props.identity.image,primaryText:this.props.identity.displayName,secondaryText:this.props.identity.jobTitle,tertiaryText:this.props.identity.department};return i.push(s.createElement("div",{className:"persona-list-element profile-card-tab-element flex-row","aria-label":this.props.identity.displayName,key:this.props.identity.entityId+this.props.identity.signInAddress,onClick:()=>{e.props.onClickEntity(this.props.identity)},"data-is-focusable":!0,role:"button"},s.createElement(t.VssPersona.VssPersona,{displayName:a.primaryText,imageUrl:a.imageUrl,size:"medium-plus",suppressPersonaCard:!0}),s.createElement("div",{className:"flex-column flex-grow persona-card-name"},s.createElement("div",{className:"persona-list-element-text-primary"},a.primaryText),""===a.secondaryText?void 0:s.createElement("div",{className:"persona-list-element-text-secondary"},a.secondaryText)))),i}createDirectReportsPersonaElements(){var e=this;return this.props.directReportList?this.props.directReportList.map((i=>{const a={imageUrl:i.image,primaryText:i.displayName?i.displayName:"",secondaryText:i.jobTitle?i.jobTitle:"",tertiaryText:i.department?i.department:""};return s.createElement("div",{className:"persona-list-element profile-card-tab-element flex-row","aria-label":i.displayName,key:i.entityId+i.signInAddress,onClick:()=>{e.props.onClickEntity(i)},"data-is-focusable":!0,role:"button"},s.createElement(t.VssPersona.VssPersona,{displayName:a.primaryText,imageUrl:a.imageUrl,size:"medium-plus",suppressPersonaCard:!0}),s.createElement("div",{className:"flex-column flex-grow persona-card-name"},s.createElement("div",{className:"persona-list-element-text-primary"},a.primaryText),""===a.secondaryText?void 0:s.createElement("div",{className:"persona-list-element-text-secondary"},a.secondaryText)))})):[]}}t[e].OrganizationCard=i}("ComponentsPersonaCardOrganizationCard"),function(e){function s(e){return e&&e.originDirectory&&"aad"===e.originDirectory.trim().toLowerCase()}function i(e){return e&&e.originDirectory&&"ad"===e.originDirectory.trim().toLowerCase()}function a(e){return e&&e.originDirectory&&"vsd"===e.originDirectory.trim().toLowerCase()}function r(e){return e&&e.originDirectory&&"wmd"===e.originDirectory.trim().toLowerCase()}D=t[e]={},t[e].isCompleteIdentity=function(e,t){return!!e&&(s(e)||i(e)?!!(t&&e.mail||e.mailNickname||e.jobTitle||e.department||e.physicalDeliveryOfficeName||e.manager||e.surname||e.telephoneNumber):a(e)?!!e.signInAddress:!!r(e)&&!(!e.scopeName&&!e.signInAddress))},t[e].isAadUser=s,t[e].isAdUser=i,t[e].isVsdUser=a,t[e].isWmdUser=r}("ComponentsPersonaCardPersonaCardIdentityUtils"),function(e){_=t[e]={};class i extends s.Component{componentDidMount(){this.props.setFocus&&this.props.setFocus()}componentDidUpdate(){this.props.setFocus&&this.props.setFocus()}render(){if(!this.props.identity)return null;const e=this.props.identity,i={imageUrl:e.image,primaryText:e.displayName,secondaryText:e.jobTitle,tertiaryText:e.department};return s.createElement("div",{className:"go-back-persona-wrapper",onClick:this.props.onClickFunction,"aria-label":t.VSSResourcesVSSUI.PeoplePickerHeaderButtonLabel,ref:e=>{this._personaElement=e},"data-is-focusable":!0,role:"button"},s.createElement("div",null,s.createElement(t.VssIcon.VssIcon,{iconType:0,iconName:"ChevronLeft"})),s.createElement("div",{className:"go-back-positioning flex-row"},s.createElement(t.VssPersona.VssPersona,{displayName:i.primaryText,imageUrl:i.imageUrl,className:"go-back-persona",size:"small",suppressPersonaCard:!0}),s.createElement("div",{className:"flex-column flex-grow persona-card-name"},s.createElement("div",{className:"persona-header-text-primary"},i.primaryText))))}setFocus(){this._personaElement&&this._personaElement.focus()}}t[e].PersonaCardHeaderElement=i}("ComponentsPersonaCardPersonaCardHeaderElement"),function(e){V=t[e]={};class i extends s.Component{constructor(){super(...arguments),this._onFocusZoneRef=e=>{this._focusZone=e,this._focusOnUpdate()},this._focusOnUpdate=()=>{const e=this.props.dataProps.directReportList;(0===this.props.dataProps.cardType&&e||0!==this.props.dataProps.cardType)&&this._focusZone.focus()},this._onDismissCallout=()=>{this.props.onDismissCallback&&this.props.onDismissCallback()}}componentDidUpdate(){const e=D.isVsdUser(this.props.dataProps.identity);this.props.dataProps.header||e||this._focusOnUpdate()}render(){const e=this.props.referenceHTMLComponent?this.props.referenceHTMLComponent:this.props.target;return s.createElement("div",null,s.createElement(c.Callout,{onDismiss:this._onDismissCallout,target:e,ariaLabel:t.VSSResourcesVSSUI.PeoplePickerProfileCardAriaLabel,role:"alert",isBeakVisible:!1,gapSpace:10,className:"persona-card-callout",directionalHint:11},s.createElement("div",null,this._renderCard())))}_renderCard(){const e="bolt-persona-card-styles";if(this.props.working&&!D.isCompleteIdentity(this.props.dataProps.identity))return s.createElement("div",{className:(0,t.Util.css)(e,"loading")},s.createElement(a.DelayedRender,{delay:300},s.createElement(t.Spinner.Spinner,{label:t.VSSResourcesVSSUI.Loading,size:"large",className:"persona-card-loading-spinner"})));const i=D.isAdUser(this.props.dataProps.identity)||D.isAadUser(this.props.dataProps.identity),r=this.props.dataProps.header||null;return s.createElement(d.FocusZone,{className:e,handleTabKey:1,isCircularNavigation:!0,componentRef:this._onFocusZoneRef,direction:d.FocusZoneDirection.vertical},i&&r&&s.createElement(_.PersonaCardHeaderElement,{identity:r,onClickFunction:this.props.onHeaderClick,setFocus:this._focusOnUpdate}),this._renderInnerCard())}_renderInnerCard(){const{identity:e,managerList:t,directReportList:i}=this.props.dataProps;if(!e)return null;const a=D.isVsdUser(e),r=D.isWmdUser(e),n=D.isAadUser(e),o=D.isAdUser(e);if(a)return s.createElement(N.DefaultAbridgedCard,{identity:e});if(r)return s.createElement(T.DefaultSimpleCard,{identity:e});if(n||o)switch(this.props.dataProps.cardType){case 1:return s.createElement(F.ContactCard,{identity:e});case 2:return s.createElement(I.OrganizationCard,{identity:e,managerList:t,directReportList:i,onClickEntity:this.props.onClickEntity});default:const a=t&&t.length>0?t[t.length-1]:null;return s.createElement(k.DefaultCard,{identity:e,manager:a,isPreviousHeader:!!this.props.dataProps.previousDataState||!!this.props.initialHeader,showContactCard:this.props.onShowContactCard,showOrganizationCard:this.props.onShowOrganizationCard,onClickEntity:this.props.onClickEntity,setFocus:this._focusOnUpdate})}return null}}t[e].PersonaCardContent=i}("ComponentsPersonaCardPersonaCardContent"),function(e){R=t[e]={};class i extends s.Component{constructor(e){super(e),this._onDismissCallback=()=>{this.props.onDismissCallback()},this._headerOnClickHandler=()=>{this.state.dataState.previousDataState?this.setState({dataState:this.state.dataState.previousDataState,working:!1}):this.props.initialHeader&&this.props.initialHeader.onClickFunction&&this.props.initialHeader.onClickFunction()},this._onShowContactCard=()=>{const e=Object.assign(Object.assign({},this.state.dataState),{previousDataState:this.state.dataState,cardType:1,header:this.state.dataState.identity});this.setState({dataState:e})},this._onShowOrganizationCard=()=>{if(this.state.working||this._dismissed)return;const e=this.state.dataState;if(e.managerList&&e.managerList.length<=1){const e=this.state.dataState,t=Object.assign(Object.assign({},e),{cardType:2,header:e.identity,previousDataState:e});this.setState({dataState:t,working:!0}),this._resolveIdentity(t,this.props.onRequestConnectionInformation(e.identity,!0))}else{const e=this.state.dataState,t=Object.assign(Object.assign({},e),{cardType:2,header:e.identity,previousDataState:e});this.setState({dataState:t,working:!1})}},this._onClickEntity=e=>{if(this.state.working)return;const t=this.state.dataState,s={identity:e,cardType:0,header:t.identity,directReportList:[],managerList:[],previousDataState:t,displayName:e.displayName,imageUrl:e.image,email:e.mail};this.setState({dataState:s,working:!0}),this._getIdentityByUniqueAttribute(e)},this._updateConnections=(e,t)=>{this._dismissed||this.state.dataState&&e.identity===this.state.dataState.identity&&this.setState({dataState:Object.assign(Object.assign({},this.state.dataState),{managerList:t.managers&&t.managers.reverse(),directReportList:t.directReports}),working:!1})},this._updateEntity=e=>{const t=D.isCompleteIdentity(e,!0),s=D.isAadUser(e)||D.isAdUser(e),i=this.props.imageUrl?this.props.imageUrl:e.image,a=Object.assign(Object.assign({},this.state.dataState),{identity:e,displayName:e.displayName,imageUrl:i});t?s?(this.setState({dataState:a,working:!1}),this._resolveIdentity(a,this.props.onRequestConnectionInformation(a.identity))):this.setState({dataState:a,working:!1}):this.setState({working:!0})};let t={identity:e.identity,managerList:null,directReportList:null,previousDataState:null,cardType:0,header:e.initialHeader?e.initialHeader.identity:null,displayName:e.displayName,imageUrl:e.imageUrl,email:this._getEmail()},s=!0;e.identity||e.uniqueAttribute||!e.displayName||(t.identity={entityId:"",entityType:"user",originDirectory:"vsd",originId:"",displayName:e.displayName,image:e.imageUrl,signInAddress:t.email},s=!1),this.state={dataState:t,working:s}}componentDidMount(){this.state.working&&this._setupInitialData(this.props.uniqueAttribute)}componentWillUnmount(){this._dismissed=!0}render(){return this.props.uniqueAttribute||this.props.identity||this.props.displayName?s.createElement(V.PersonaCardContent,Object.assign({},this.props,{dataProps:this.state.dataState,onClickEntity:this._onClickEntity,onDismissCallback:this._onDismissCallback,onShowContactCard:this._onShowContactCard,onShowOrganizationCard:this._onShowOrganizationCard,working:this.state.working,onHeaderClick:this._headerOnClickHandler})):null}_setupInitialData(e){let t=this.state.dataState;t.identity?D.isCompleteIdentity(t.identity)?this._resolveIdentity(t,this.props.onRequestConnectionInformation(t.identity)):this._getIdentityByUniqueAttribute(t.identity):this._getIdentityByUniqueAttribute(e)}_resolveIdentity(e,t){const s=t,i=t;i&&i.then?i.then((t=>{this._updateConnections(e,t)})):s&&this._updateConnections(e,s)}_resolveIEntity(e){const t=e,s=e;s&&s.then?s.then((e=>{this._updateEntity(e)})):t&&this._updateEntity(t)}_getIdentityByUniqueAttribute(e){let t;t="string"==typeof e?e:D.isAadUser(e)||D.isAdUser(e)?e.entityId:e.signInAddress,this._resolveIEntity(this.props.getEntityFromUniqueAttribute(t))}_getEmail(){if(D.isAadUser(this.props.identity)||D.isAdUser(this.props.identity))return this.props.identity.mail;if(this.props.identity&&this.props.identity.signInAddress)return this.props.identity.signInAddress;if(this.props.identity&&this.props.identity.mail)return this.props.identity.mail;if(this.props.uniqueAttribute){const e=this.props.uniqueAttribute.split("@");if(2===e.length&&e[0].length>=1&&e[1].length>=3){if(e[1].split(".").length>1)return this.props.uniqueAttribute}}return null}}t[e].PersonaCard=i}("ComponentsPersonaCardPersonaCard"),function(e){w=t[e]={},__exportStar(F,t[e]),__exportStar(N,t[e]),__exportStar(k,t[e]),__exportStar(T,t[e]),__exportStar(I,t[e]),__exportStar(R,t[e]),__exportStar(V,t[e]),__exportStar(_,t[e]),__exportStar(D,t[e])}("ComponentsPersonaCardindex"),function(e){A=t[e]={};class i extends s.Component{constructor(e){super(e),this.suggestionsVisible=new u.ObservableValue(!1),this.hasFocus=new u.ObservableValue(!1),this.inputElement=s.createRef(),this.openedIdentityCard=new u.ObservableValue(void 0),this.outerElement=s.createRef(),this.selectedIdentity=new u.ObservableValue(void 0),this.suggestionsControl=s.createRef(),this.suggestionsLoading=new u.ObservableValue(!1),this.textValue=new u.ObservableValue(""),this.currentSuggestion=()=>this.selectedIdentity.value,this.hidePicker=()=>{this.suggestionsVisible.value=!1,this.hasFocus.value||this.props.onBlur&&this.props.onBlur()},this.showPicker=()=>{this.suggestionsVisible.value=!0},this.renderPersonaCoin=e=>{const i="bolt-peoplepickerdropdown-icon flex-row flex-center justify-center";return s.createElement(t.Observer.Observer,{selectedIdentity:this.selectedIdentity},(e=>e.selectedIdentity?s.createElement(t.VssPersona.VssPersona,{className:i,displayName:e.selectedIdentity.displayName,imageUrl:e.selectedIdentity.image,size:"small"}):s.createElement(t.VssIcon.VssIcon,{className:i,iconName:"Contact"})))},this.closePersonaCard=()=>{this.openedIdentityCard.value=void 0},this.completeSuggestion=()=>{this.suggestionStore.suggestions.length>0&&this.suggestionsVisible.value?(this.suggestionStore.currentIndex<0&&this.suggestionStore.nextSuggestion(),this.setInputToSelectedPerson(),this.suggestionStore.currentSuggestion&&this.selectedPersonaChanged(this.suggestionStore.currentSuggestion.item),this.suggestionsVisible.value=!1):(this.suggestionStore.deselectAllSuggestions(),this.suggestionStore.currentSuggestion=void 0,this.selectedPersonaChanged())},this.onBlur=()=>{this.hasFocus.value=!1,this.timerManagement.setTimeout((()=>{const e=!this.openedIdentityCard.value&&!this.suggestionsVisible.value&&!this.suggestionsVisible.value;e&&this.props.onBlur&&this.props.onBlur(),e&&this.selectedPersonaChanged(this.selectedIdentity.value)}),100)},this.onClick=()=>{""===this.textValue.value&&this.props.pickerProvider.onEmptyInputFocus?(this.updateSuggestionsList(this.props.pickerProvider.onEmptyInputFocus()),this.suggestionsVisible.value=!this.suggestionsVisible.value):this.suggestionsVisible.value=!this.suggestionsVisible.value,this.inputElement.current.select()},this.onFocus=e=>{const{onFocus:t}=this.props;""===this.textValue.value&&this.props.pickerProvider.onEmptyInputFocus&&!this.suggestionsVisible.value&&this.updateSuggestionsList(this.props.pickerProvider.onEmptyInputFocus()),this.hasFocus.value=!0,t&&t(e)},this.onKeyDown=e=>{const t=e.which;switch(t){case 27:this.openedIdentityCard.value&&!this.suggestionStore.currentSuggestion&&this.selectedPersonaChanged(),this.suggestionsVisible.value&&(this.suggestionsVisible.value=!1,this.openedIdentityCard.value=void 0);break;case 9:case 13:this.suggestionsControl.current&&this.suggestionsControl.current.hasSuggestedActionSelected()?(this.suggestionsControl.current.executeSelectedAction(),this.completeSuggestion()):!e.shiftKey&&this.suggestionStore.hasSelectedSuggestion()&&this.suggestionsVisible.value?(this.completeSuggestion(),e.preventDefault(),e.stopPropagation()):this.suggestionsVisible.value?this.completeSuggestion():this.selectedPersonaChanged(this.selectedIdentity.value);break;case 39:this.suggestionStore.currentSuggestion&&(this.openedIdentityCard.value=this.suggestionStore.currentSuggestion.item);break;case 38:this.suggestionsControl.current&&this.suggestionsControl.current.tryHandleKeyDown(t,this.suggestionStore.currentIndex)?(e.preventDefault(),e.stopPropagation()):this.suggestionsControl.current&&this.suggestionsVisible.value&&(this.suggestionStore.previousSuggestion(),this.forceUpdate(),e.preventDefault(),e.stopPropagation());break;case 40:this.suggestionsControl.current&&this.suggestionsControl.current.tryHandleKeyDown(t,this.suggestionStore.currentIndex)?(e.preventDefault(),e.stopPropagation()):this.suggestionsControl.current&&this.suggestionsVisible.value?(this.suggestionStore.nextSuggestion(),this.forceUpdate(),e.preventDefault(),e.stopPropagation()):this.suggestionsVisible.value=!0}},this.onResolveSuggestions=e=>{const t=this.props.pickerProvider.onFilterIdentities(e,[this.suggestionStore.currentSuggestion&&this.suggestionStore.currentSuggestion.item]);null!==t&&this.updateSuggestionsList(t,e)},this.onSearchChange=(e,t)=>{if(this.suggestionsVisible.value=!!t,0==t.length){const{onClear:e}=this.props;e&&e()}this.selectedIdentity.value=void 0,this.textValue.value=t,this.updateValue(t)},this.onSuggestionClick=(e,t,s)=>{this.suggestionStore.setSelectedSuggestion(s),this.selectedPersonaChanged(t),this.textValue.value=t.displayName,this.hidePicker(),e.stopPropagation()},this.renderNoIdentitiesFound=()=>s.createElement("div",{className:"bolt-peoplepickerdropdown-noresults flex-row flex-center"},t.VSSResourcesVSSUI.PeoplePickerNoResultsText),this.renderSuggestionItem=(e,i)=>{const a=(0,P.getSignInAddress)(e);return s.createElement("div",{className:"bolt-picker-suggesteditem flex-row flex-grow flex-center text-ellipsis"},s.createElement(t.VssPersona.VssPersona,{cssClass:"bolt-picker-persona text-ellipsis",identityDetailsProvider:{getIdentityImageUrl:t=>e.image,getDisplayName:()=>e.displayName},size:"small"}),s.createElement("div",{className:"bolt-picker-persona-name flex-column flex-grow"},s.createElement("div",{className:"fontSizeM text-ellipsis"},e.displayName),""===a?void 0:s.createElement("div",{className:"fontSize secondary-text text-ellipsis"},a)),(0,P.isUser)(e)&&s.createElement(t.Button.Button,{className:"bolt-contact-card",iconProps:{iconName:"ContactCard",className:"bolt-contactcard-button flex-shrink"},onClick:t=>{this.openedIdentityCard.value=e,t.stopPropagation()},subtle:!0}))},this.selectedPersonaChanged=e=>{this.selectedIdentity.value=e,this.props.onChange&&this.lastPickedIdentity!==e&&(e&&this.props.pickerProvider.addIdentitiesToMRU&&this.props.pickerProvider.addIdentitiesToMRU([e]),this.props.onChange(this.selectedIdentity.value)),this.lastPickedIdentity=e},this.setInputToSelectedPerson=()=>{const e=this.suggestionStore.currentSuggestion?this.suggestionStore.currentSuggestion.item.displayName:this.textValue.value;this.textValue.value=e},this.cachedResults={},this.suggestionStore=new n.SuggestionsController,this.timerManagement=new p.TimerManagement,this.lastPickedIdentity=e.defaultIdentity}render(){return s.createElement(t.Observer.Observer,{suggestionsVisible:this.suggestionsVisible,hasFocus:this.hasFocus,openedIdentityCard:this.openedIdentityCard,selectedIdentity:this.selectedIdentity,textValue:this.textValue},(e=>{const{ariaLabel:i=t.VSSResourcesVSSUI.PeoplePickerPlaceholderText,autoFocus:a,placeholder:r=t.VSSResourcesVSSUI.PeoplePickerPlaceholderText}=this.props,n=(this.suggestionsVisible.value||e.hasFocus)&&"bolt-peoplepickerdropdown-open";return s.createElement("div",{className:"bolt-peoplepickerdropdown flex-row flex-grow",ref:this.outerElement,onClick:this.onClick,onKeyDown:this.onKeyDown},s.createElement(t.TextField.TextField,{"aria-autocomplete":"none","aria-label":i,"aria-expanded":e.suggestionsVisible,"aria-haspopup":"true",autoFocus:a,className:(0,t.Util.css)(this.props.className,"bolt-peoplepickerdropdown-textField flex-row flex-center",n),containerClassName:"bolt-peoplepickerdropdown-container flex-column flex-grow",onBlur:this.onBlur,onChange:this.onSearchChange,onFocus:this.onFocus,prefixIconProps:{render:this.renderPersonaCoin},placeholder:r,ref:this.inputElement,role:"comboBox",suffixIconProps:{className:"bolt-dropdown-button",iconName:"ChevronDown"},value:e.textValue}),this.renderSuggestions(),e.openedIdentityCard&&s.createElement(w.PersonaCard,{getEntityFromUniqueAttribute:this.props.pickerProvider.getEntityFromUniqueAttribute,key:e.openedIdentityCard.entityId,identity:e.openedIdentityCard,target:this.outerElement.current,onDismissCallback:this.closePersonaCard,onRequestConnectionInformation:this.props.pickerProvider.onRequestConnectionInformation}))}))}componentDidMount(){this.onResolveSuggestions=this.timerManagement.debounce(this.onResolveSuggestions,250),this.props.defaultIdentity?(this.suggestionStore.updateSuggestions([this.props.defaultIdentity],0),this.selectedIdentity.value=this.props.defaultIdentity,this.textValue.value=this.props.defaultIdentity.displayName,this.suggestionsVisible.value=!1):this.props.autoFocus&&this.updateSuggestionsList(this.props.pickerProvider.onEmptyInputFocus())}componentWillUnmount(){this.currentPromise=void 0}updateSuggestionsList(e,t){const s=e,i=e;if(Array.isArray(s))this.updateSuggestions(s);else if(i&&i.then){this.loadingTimer||(this.loadingTimer=this.timerManagement.setTimeout((()=>{this.suggestionsLoading.value=!0}),500));const e=this.currentPromise=i;e.then((s=>{e===this.currentPromise&&(this.suggestionsLoading.value=!1,this.updateSuggestions(s,t),""!==this.textValue.value&&this.suggestionStore.suggestions&&this.suggestionStore.suggestions.length>0&&(this.cachedResults[this.textValue.value]=s),this.loadingTimer&&(this.timerManagement.clearTimeout(this.loadingTimer),this.loadingTimer=void 0))}))}}renderSuggestions(){return this.suggestionsVisible.value||this.openedIdentityCard.value?s.createElement(c.Callout,{calloutWidth:this.props.calloutWidth,className:"bolt-peoplepickerdropdown-callout",directionalHint:4,isBeakVisible:!1,onDismiss:this.hidePicker,target:this.outerElement.current},s.createElement(x.Suggestions,{className:"bolt-peoplepickerdropdown-list",isLoading:this.suggestionsLoading.value,isResultsFooterVisible:this.props.isResultsFooterVisible,loadingText:t.VSSResourcesVSSUI.PeoplePickerLoadingText,onRenderNoResultFound:this.renderNoIdentitiesFound,onRenderSuggestion:this.renderSuggestionItem,onSuggestionClick:this.onSuggestionClick,ref:this.suggestionsControl,resultsMaximumNumber:this.props.resultsMaximumNumber,suggestionsContainerAriaLabel:this.props.suggestionsContainerAriaLabel,suggestionsItemClassName:(0,t.Util.css)("bolt-peoplepickerdropdown-item",this.props.suggestionsItemClassName),suggestions:this.suggestionStore.getSuggestions()})):null}updateSuggestions(e,t){(void 0===t||this.inputElement.current&&this.textValue.value===t)&&(this.suggestionStore.updateSuggestions(e,0),void 0!==t&&(this.selectedIdentity.value=void 0),this.forceUpdate())}updateValue(e){this.cachedResults[e]?this.updateSuggestionsList(this.cachedResults[e],e):this.onResolveSuggestions(e)}}t[e].PeoplePickerDropdown=i,i.defaultProps={calloutWidth:296}}("ComponentsPeoplePickerDropdownPeoplePickerDropdown"),function(e){U=t[e]={},__exportStar(A,t[e])}("ComponentsPeoplePickerDropdownindex"),function(e){t[e]={},__exportStar(f,t[e])}("DateTimeRangePicker"),function(e){t[e]={},__exportStar(E,t[e]),__exportStar(U,t[e]),__exportStar(w,t[e])}("PeoplePicker"),function(e){t[e]={},__exportStar(w,t[e])}("PersonaCard")}),["Resources.Pickers","Components/DateTimePicker/DateTimePicker","Components/DateTimePicker/DateTimePickerFilterBarItem","Components/DateTimePicker/Helpers","Components/DateTimePicker/index","DateTimePicker","Components/DateTimeRangePicker/DateTimeRangePicker","Components/DateTimeRangePicker/index","Components/PeoplePicker/PeoplePickerUtils","Components/PeoplePicker/PeoplePicker","Components/PeoplePicker/Suggestions","Components/PeoplePicker/index","Components/PersonaCard/ContactCard","Components/PersonaCard/DefaultCard","Components/PersonaCard/DefaultAbridgedCard","Components/PersonaCard/DefaultSimpleCard","Components/PersonaCard/OrganizationCard","Components/PersonaCard/PersonaCardIdentityUtils","Components/PersonaCard/PersonaCardHeaderElement","Components/PersonaCard/PersonaCardContent","Components/PersonaCard/PersonaCard","Components/PersonaCard/index","Components/PeoplePickerDropdown/PeoplePickerDropdown","Components/PeoplePickerDropdown/index","DateTimeRangePicker","PeoplePicker","PersonaCard"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-pickers-content"}}));