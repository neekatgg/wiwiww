"use strict";define("VC/Common",["require","exports","VSS/Core/Observable","VSS/Platform/Context","VSS/Platform/RestClientBase","VSS/Platform/Util/Serialization","VSS/Platform/Location","Favorites/Picker/ArtifactPickerProvider","VSS/Platform/FPS","VSS/Core/Util/String","VSSUI/Utilities/Date","react","VSSUI/Util","VSS/Platform/Layout","VSSUI/PickList","VSS/Features/PlatformUI/ContributedMenu","VSS/Legacy/Legacy","VSS/Features/Frame/CommandBar","VSSUI/Observer","VSS/Core/Util/Object","VSSUI/Spinner"],(function(e,t,r,s,o,i,a,n,p,c,u,l,d,m,h,g,y,I,R,v,f){var q,T,V,b,C,w,P,j,S,_,k,x;q=t[x="Resources"]={},t[x].RepositoryDropdown_AriaLabel="{0} Repository",t[x].VersionDropdown_PivotBranches="Branches",t[x].VersionDropdown_PivotTags="Tags",t[x].VersionDropdown_PivotCommits="Commits",t[x].VersionDropdown_MineBranches="Mine",t[x].VersionDropdown_AllBranches="All",t[x].VersionDropdown_TagsNoItemsText="No tags in this repository",t[x].VersionDropdown_BranchesSearchTextPlaceholder="Filter branches",t[x].VersionDropdown_TagsSearchTextPlaceholder="Filter tags",t[x].VersionDropdown_CommitsSearchTextPlaceholder="Search commits",t[x].VersionDropdown_BranchesSearchNoResultsText="No branches matched '{0}'",t[x].VersionDropdown_TagsSearchNoResultsText="No tags matched '{0}'",t[x].VersionDropdown_CommitsSearchNoResultsText="No commits matched '{0}'",t[x].VersionDropdown_CommitsSearchMinimumCharactersError="Enter first 4 characters of a commit ID",t[x].VersionDropdown_CommitsSearchWrongCharactersError="Commit IDs must be hex digits (0-9 and a-f)",t[x].VersionDropdown_NewBranch="New branch",t[x].VersionDropdown_ClearSelection="Clear selection",t[x].VersionDropdown_DefaultBadge="Default",t[x].VersionDropdown_BranchAriaLabel="{0} Branch",t[x].VersionDropdown_TagAriaLabel="{0} Tag",t[x].VersionDropdown_CommitAriaLabel="{0} Commit",t[x].ManageRepositories="Manage repositories",t[x].SearchRepositoriesWatermark="Filter repositories",t[x].ImportRepository="Import repository",t[x].NewRepository="New repository",t[x].NewPullRequest="New pull request",function(e){T=t[e]={},function(e){e.GitSecurityNamespaceId="2e9eb7ed-3c0a-47d4-87c1-0ffdd275fd87",e.SecurableRoot="repoV2/",e.GitToolName="Git"}(t[e].GitConstants||(t[e].GitConstants={})),t[e].VersionControlArea="VersionControl"}("ContractsConstants"),function(e){t[e]={},t[e].pullRequestStatusToString=function(e){switch(e){case 2:return"Abandoned";case 4:return"All";case 3:return"Completed";default:return"Active"}}}("ContractsEnumToString"),function(e){t[e]={};class r{constructor(){this._listeners=[]}invoke(e){if(r.s_executing)throw new Error("Cannot invoke an action from inside another action.");r.s_executing=!0;try{this._listeners.forEach((t=>{t(e)}))}finally{r.s_executing=!1}}addListener(e,t){let r=t?e.bind(t):e;return this._listeners.push(r),r}removeListener(e){let t=this._listeners.indexOf(e);t>=0&&this._listeners.splice(t,1)}}t[e].Action=r,r.s_executing=!1}("FluxAction"),function(e){t[e]={};t[e].Store=class{constructor(){this.observable=new r.Observable}subscribe(e){this.observable.subscribe(e,void 0)}unsubscribe(e){this.observable.unsubscribe(e,void 0)}_emitChanged(){this.observable.notify(void 0,"emitChanged")}}}("FluxStore"),function(e){t[e]={};class r extends o.RestClientBase{constructor(e){super(e)}async createAnnotatedTag(e,t,r){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/annotatedTags/{objectId}",routeValues:{project:t,repositoryId:r},body:e})}async getAnnotatedTag(e,t,r){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/annotatedTags/{objectId}",routeValues:{project:e,repositoryId:t,objectId:r}})}async getBlob(e,t,r,s,o,i){const a={download:s,fileName:o,resolveLfs:i};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/Blobs/{sha1}",routeValues:{project:r,repositoryId:e,sha1:t},queryParams:a})}async getBlobContent(e,t,r,s,o,i){const a={download:s,fileName:o,resolveLfs:i};return this.beginRequest({apiVersion:"5.0-preview.1",httpResponseType:"application/octet-stream",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/Blobs/{sha1}",routeValues:{project:r,repositoryId:e,sha1:t},queryParams:a})}async getBlobsZip(e,t,r,s){const o={filename:s};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",httpResponseType:"application/zip",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/Blobs/{sha1}",routeValues:{project:r,repositoryId:t},queryParams:o,body:e})}async getBlobZip(e,t,r,s,o,i){const a={download:s,fileName:o,resolveLfs:i};return this.beginRequest({apiVersion:"5.0-preview.1",httpResponseType:"application/zip",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/Blobs/{sha1}",routeValues:{project:r,repositoryId:e,sha1:t},queryParams:a})}async getBranch(e,t,r,s){const o={name:t,baseVersionDescriptor:s};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/stats/branches",routeValues:{project:r,repositoryId:e},queryParams:o})}async getBranches(e,t,r){const s={baseVersionDescriptor:r};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/stats/branches",routeValues:{project:t,repositoryId:e},queryParams:s})}async getBranchStatsBatch(e,t,r){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/stats/branches",routeValues:{project:r,repositoryId:t},body:e})}async getChanges(e,t,r,s,o){const i={top:s,skip:o};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/commits/{commitId}/Changes",routeValues:{project:r,commitId:e,repositoryId:t},queryParams:i})}async getCherryPickRelationships(e,t,r,s){const o={includeLinks:s};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryNameOrId}/cherryPickRelationships/{commitId}",routeValues:{project:r,repositoryNameOrId:e,commitId:t},queryParams:o})}async createCherryPick(e,t,r){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/cherryPicks/{cherryPickId}",routeValues:{project:t,repositoryId:r},body:e})}async getCherryPick(e,t,r){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/cherryPicks/{cherryPickId}",routeValues:{project:e,cherryPickId:t,repositoryId:r}})}async getCherryPickForRefName(e,t,r){const s={refName:r};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/cherryPicks/{cherryPickId}",routeValues:{project:e,repositoryId:t},queryParams:s})}async getCommitDiffs(e,t,r,s,o,i,a){const n={diffCommonCommit:r,$top:s,$skip:o};return i&&(n.baseVersionType=i.versionType,n.baseVersion=i.version,n.baseVersionOptions=i.versionOptions),a&&(n.targetVersionType=a.versionType,n.targetVersion=a.version,n.targetVersionOptions=a.versionOptions),this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/diffs/commits",routeValues:{project:t,repositoryId:e},queryParams:n})}async getCommit(e,t,r,s){const o={changeCount:s};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/Commits/{commitId}",routeValues:{project:r,commitId:e,repositoryId:t},queryParams:o})}async getCommits(e,t,r,s,o){const i={searchCriteria:t,$skip:s,$top:o};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/Commits/{commitId}",routeValues:{project:r,repositoryId:e},queryParams:i})}async getPushCommits(e,t,r,s,o,i){const a={pushId:t,top:s,skip:o,includeLinks:i};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/Commits/{commitId}",routeValues:{project:r,repositoryId:e},queryParams:a})}async getCommitsBatch(e,t,r,s,o,i){const a={$skip:s,$top:o,includeStatuses:i};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/CommitsBatch",routeValues:{project:r,repositoryId:t},queryParams:a,body:e})}async getDeletedRepositories(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/DeletedRepositories",routeValues:{project:e}})}async getFileDiffs(e,t,r){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/FileDiffs",routeValues:{project:t,repositoryId:r},body:e})}async getFilePaths(e,t,r,s){const o={scopePath:r,versionDescriptor:s};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/FilePaths/{*scopepath}",routeValues:{project:e,repositoryId:t},queryParams:o})}async getForks(e,t,r,s){const o={includeLinks:s};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryNameOrId}/forks/{collectionId}",routeValues:{project:r,repositoryNameOrId:e,collectionId:t},queryParams:o})}async createForkSyncRequest(e,t,r,s){const o={includeLinks:s};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryNameOrId}/forkSyncRequests/{forkSyncOperationId}",routeValues:{project:r,repositoryNameOrId:t},queryParams:o,body:e})}async getForkSyncRequest(e,t,r,s){const o={includeLinks:s};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryNameOrId}/forkSyncRequests/{forkSyncOperationId}",routeValues:{project:r,repositoryNameOrId:e,forkSyncOperationId:t},queryParams:o})}async getForkSyncRequests(e,t,r,s){const o={includeAbandoned:r,includeLinks:s};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryNameOrId}/forkSyncRequests/{forkSyncOperationId}",routeValues:{project:t,repositoryNameOrId:e},queryParams:o})}async validateRemoteRepository(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/import/ImportRepositoryValidations",routeValues:{project:t},body:e})}async createImportRequest(e,t,r){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/importRequests/{importRequestId}",routeValues:{project:t,repositoryId:r},body:e})}async getImportRequest(e,t,r){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/importRequests/{importRequestId}",routeValues:{project:e,repositoryId:t,importRequestId:r}})}async queryImportRequests(e,t,r){const s={includeAbandoned:r};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/importRequests/{importRequestId}",routeValues:{project:e,repositoryId:t},queryParams:s})}async updateImportRequest(e,t,r,s){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/importRequests/{importRequestId}",routeValues:{project:t,repositoryId:r,importRequestId:s},body:e})}async getItem(e,t,r,s,o,i,a,n,p,c,u,l){const d={path:t,scopePath:s,recursionLevel:o,includeContentMetadata:i,latestProcessedChange:a,download:n,versionDescriptor:p,includeContent:c,resolveLfs:u,sanitize:l};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/Items/{*path}",routeValues:{project:r,repositoryId:e},queryParams:d})}async getItemContent(e,t,r,s,o,i,a,n,p,c,u,l){const d={path:t,scopePath:s,recursionLevel:o,includeContentMetadata:i,latestProcessedChange:a,download:n,versionDescriptor:p,includeContent:c,resolveLfs:u,sanitize:l};return this.beginRequest({apiVersion:"5.0-preview.1",httpResponseType:"application/octet-stream",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/Items/{*path}",routeValues:{project:r,repositoryId:e},queryParams:d})}async getItems(e,t,r,s,o,i,a,n,p,c){const u={scopePath:r,recursionLevel:s,includeContentMetadata:o,latestProcessedChange:i,download:a,includeLinks:n,versionDescriptor:p,zipForUnix:c};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/Items/{*path}",routeValues:{project:t,repositoryId:e},queryParams:u})}async getItemText(e,t,r,s,o,i,a,n,p,c,u,l){const d={path:t,scopePath:s,recursionLevel:o,includeContentMetadata:i,latestProcessedChange:a,download:n,versionDescriptor:p,includeContent:c,resolveLfs:u,sanitize:l};return this.beginRequest({apiVersion:"5.0-preview.1",httpResponseType:"text/plain",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/Items/{*path}",routeValues:{project:r,repositoryId:e},queryParams:d})}async getItemZip(e,t,r,s,o,i,a,n,p,c,u,l){const d={path:t,scopePath:s,recursionLevel:o,includeContentMetadata:i,latestProcessedChange:a,download:n,versionDescriptor:p,includeContent:c,resolveLfs:u,sanitize:l};return this.beginRequest({apiVersion:"5.0-preview.1",httpResponseType:"application/zip",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/Items/{*path}",routeValues:{project:r,repositoryId:e},queryParams:d})}async getItemsBatch(e,t,r){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/ItemsBatch",routeValues:{project:r,repositoryId:t},body:e})}async getMergeBases(e,t,r,s,o,i){const a={otherCommitId:r,otherCollectionId:o,otherRepositoryId:i};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryNameOrId}/commits/{commitId}/mergeBases",routeValues:{project:s,repositoryNameOrId:e,commitId:t},queryParams:a})}async createMergeRequest(e,t,r,s){const o={includeLinks:s};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryNameOrId}/merges/{mergeOperationId}",routeValues:{project:t,repositoryNameOrId:r},queryParams:o,body:e})}async getMergeRequest(e,t,r,s){const o={includeLinks:s};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryNameOrId}/merges/{mergeOperationId}",routeValues:{project:e,repositoryNameOrId:t,mergeOperationId:r},queryParams:o})}async getPolicyConfigurations(e,t,r,s,o,a){const n={repositoryId:t,refName:r,policyType:s,$top:o,continuationToken:a};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/policy/configurations",routeValues:{project:e},queryParams:n,returnRawResponse:!0}).then((async e=>({policyConfigurations:await e.text().then(i.deserializeVssJsonObject),continuationToken:e.headers.get("x-ms-continuationtoken")})))}async createAttachment(e,t,r,s,o){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/attachments/{fileName}",routeValues:{project:o,fileName:t,repositoryId:r,pullRequestId:s},customHeaders:{"Content-Type":"application/octet-stream"},body:e,isRawData:!0})}async deleteAttachment(e,t,r,s){return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/attachments/{fileName}",routeValues:{project:s,fileName:e,repositoryId:t,pullRequestId:r}})}async getAttachmentContent(e,t,r,s){return this.beginRequest({apiVersion:"5.0-preview.1",httpResponseType:"application/octet-stream",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/attachments/{fileName}",routeValues:{project:s,fileName:e,repositoryId:t,pullRequestId:r}})}async getAttachments(e,t,r){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/attachments/{fileName}",routeValues:{project:r,repositoryId:e,pullRequestId:t}})}async getAttachmentZip(e,t,r,s){return this.beginRequest({apiVersion:"5.0-preview.1",httpResponseType:"application/zip",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/attachments/{fileName}",routeValues:{project:s,fileName:e,repositoryId:t,pullRequestId:r}})}async createLike(e,t,r,s,o){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/threads/{threadId}/comments/{commentId}/likes",routeValues:{project:o,repositoryId:e,pullRequestId:t,threadId:r,commentId:s}})}async deleteLike(e,t,r,s,o){return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/threads/{threadId}/comments/{commentId}/likes",routeValues:{project:o,repositoryId:e,pullRequestId:t,threadId:r,commentId:s}})}async getLikes(e,t,r,s,o){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/threads/{threadId}/comments/{commentId}/likes",routeValues:{project:o,repositoryId:e,pullRequestId:t,threadId:r,commentId:s}})}async getPullRequestIterationCommits(e,t,r,s,o,i){const a={top:o,skip:i};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/iterations/{iterationId}/commits",routeValues:{project:s,repositoryId:e,pullRequestId:t,iterationId:r},queryParams:a})}async getPullRequestCommits(e,t,r){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/commits",routeValues:{project:r,repositoryId:e,pullRequestId:t},returnRawResponse:!0}).then((async e=>{const t=await e.text().then(i.deserializeVssJsonObject);return t.continuationToken=e.headers.get("x-ms-continuationtoken"),t}))}async getPullRequestConflict(e,t,r,s){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/conflicts/{conflictId}",routeValues:{project:s,repositoryId:e,pullRequestId:t,conflictId:r}})}async getPullRequestConflicts(e,t,r,s,o,i,a,n){const p={$skip:s,$top:o,includeObsolete:i,excludeResolved:a,onlyResolved:n};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/conflicts/{conflictId}",routeValues:{project:r,repositoryId:e,pullRequestId:t},queryParams:p})}async updatePullRequestConflict(e,t,r,s,o){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/conflicts/{conflictId}",routeValues:{project:o,repositoryId:t,pullRequestId:r,conflictId:s},body:e})}async updatePullRequestConflicts(e,t,r,s){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/conflicts/{conflictId}",routeValues:{project:s,repositoryId:t,pullRequestId:r},body:e})}async getPullRequestIterationChanges(e,t,r,s,o,i,a){const n={$top:o,$skip:i,$compareTo:a};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/iterations/{iterationId}/changes",routeValues:{project:s,repositoryId:e,pullRequestId:t,iterationId:r},queryParams:n})}async getPullRequestIteration(e,t,r,s){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/iterations/{iterationId}",routeValues:{project:s,repositoryId:e,pullRequestId:t,iterationId:r}})}async getPullRequestIterations(e,t,r,s){const o={includeCommits:s};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/iterations/{iterationId}",routeValues:{project:r,repositoryId:e,pullRequestId:t},queryParams:o})}async createPullRequestIterationStatus(e,t,r,s,o){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/iterations/{iterationId}/statuses/{statusId}",routeValues:{project:o,repositoryId:t,pullRequestId:r,iterationId:s},body:e})}async deletePullRequestIterationStatus(e,t,r,s,o){return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/iterations/{iterationId}/statuses/{statusId}",routeValues:{project:o,repositoryId:e,pullRequestId:t,iterationId:r,statusId:s}})}async getPullRequestIterationStatus(e,t,r,s,o){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/iterations/{iterationId}/statuses/{statusId}",routeValues:{project:o,repositoryId:e,pullRequestId:t,iterationId:r,statusId:s}})}async getPullRequestIterationStatuses(e,t,r,s){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/iterations/{iterationId}/statuses/{statusId}",routeValues:{project:s,repositoryId:e,pullRequestId:t,iterationId:r}})}async updatePullRequestIterationStatuses(e,t,r,s,o){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/iterations/{iterationId}/statuses/{statusId}",routeValues:{project:o,repositoryId:t,pullRequestId:r,iterationId:s},customHeaders:{"Content-Type":"application/json-patch+json"},body:e})}async createPullRequestLabel(e,t,r,s,o){const i={projectId:o};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/labels/{labelIdOrName}",routeValues:{project:s,repositoryId:t,pullRequestId:r},queryParams:i,body:e})}async deletePullRequestLabels(e,t,r,s,o){const i={projectId:o};return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/labels/{labelIdOrName}",routeValues:{project:s,repositoryId:e,pullRequestId:t,labelIdOrName:r},queryParams:i})}async getPullRequestLabel(e,t,r,s,o){const i={projectId:o};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/labels/{labelIdOrName}",routeValues:{project:s,repositoryId:e,pullRequestId:t,labelIdOrName:r},queryParams:i})}async getPullRequestLabels(e,t,r,s){const o={projectId:s};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/labels/{labelIdOrName}",routeValues:{project:r,repositoryId:e,pullRequestId:t},queryParams:o})}async getPullRequestProperties(e,t,r){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/properties",routeValues:{project:r,repositoryId:e,pullRequestId:t}})}async updatePullRequestProperties(e,t,r,s){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/properties",routeValues:{project:s,repositoryId:t,pullRequestId:r},customHeaders:{"Content-Type":"application/json-patch+json"},body:e})}async getPullRequestQuery(e,t,r){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/PullRequestQuery",routeValues:{project:r,repositoryId:t},body:e})}async createPullRequestReviewer(e,t,r,s,o){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PUT",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/reviewers/{reviewerId}",routeValues:{project:o,repositoryId:t,pullRequestId:r,reviewerId:s},body:e})}async createPullRequestReviewers(e,t,r,s){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/reviewers/{reviewerId}",routeValues:{project:s,repositoryId:t,pullRequestId:r},body:e})}async createUnmaterializedPullRequestReviewer(e,t,r,s){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PUT",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/reviewers/{reviewerId}",routeValues:{project:s,repositoryId:t,pullRequestId:r},body:e})}async deletePullRequestReviewer(e,t,r,s){return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/reviewers/{reviewerId}",routeValues:{project:s,repositoryId:e,pullRequestId:t,reviewerId:r}})}async getPullRequestReviewer(e,t,r,s){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/reviewers/{reviewerId}",routeValues:{project:s,repositoryId:e,pullRequestId:t,reviewerId:r}})}async getPullRequestReviewers(e,t,r){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/reviewers/{reviewerId}",routeValues:{project:r,repositoryId:e,pullRequestId:t}})}async updatePullRequestReviewer(e,t,r,s,o){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/reviewers/{reviewerId}",routeValues:{project:o,repositoryId:t,pullRequestId:r,reviewerId:s},body:e})}async updatePullRequestReviewers(e,t,r,s){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/reviewers/{reviewerId}",routeValues:{project:s,repositoryId:t,pullRequestId:r},body:e})}async getPullRequestById(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/pullRequests/{pullRequestId}",routeValues:{project:t,pullRequestId:e}})}async getPullRequestsByProject(e,t,r,s,o){const i={searchCriteria:t,maxCommentLength:r,$skip:s,$top:o};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/pullRequests",routeValues:{project:e},queryParams:i})}async createPullRequest(e,t,r,s){const o={supportsIterations:s};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}",routeValues:{project:r,repositoryId:t},queryParams:o,body:e})}async getPullRequest(e,t,r,s,o,i,a,n){const p={maxCommentLength:s,$skip:o,$top:i,includeCommits:a,includeWorkItemRefs:n};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}",routeValues:{project:r,repositoryId:e,pullRequestId:t},queryParams:p})}async getPullRequests(e,t,r,s,o,i){const a={searchCriteria:t,maxCommentLength:s,$skip:o,$top:i};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}",routeValues:{project:r,repositoryId:e},queryParams:a})}async updatePullRequest(e,t,r,s){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}",routeValues:{project:s,repositoryId:t,pullRequestId:r},body:e})}async sharePullRequest(e,t,r,s){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/share",routeValues:{project:s,repositoryId:t,pullRequestId:r},body:e})}async createPullRequestStatus(e,t,r,s){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/statuses/{statusId}",routeValues:{project:s,repositoryId:t,pullRequestId:r},body:e})}async deletePullRequestStatus(e,t,r,s){return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/statuses/{statusId}",routeValues:{project:s,repositoryId:e,pullRequestId:t,statusId:r}})}async getPullRequestStatus(e,t,r,s){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/statuses/{statusId}",routeValues:{project:s,repositoryId:e,pullRequestId:t,statusId:r}})}async getPullRequestStatuses(e,t,r){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/statuses/{statusId}",routeValues:{project:r,repositoryId:e,pullRequestId:t}})}async updatePullRequestStatuses(e,t,r,s){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/statuses/{statusId}",routeValues:{project:s,repositoryId:t,pullRequestId:r},customHeaders:{"Content-Type":"application/json-patch+json"},body:e})}async createComment(e,t,r,s,o){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/threads/{threadId}/comments/{commentId}",routeValues:{project:o,repositoryId:t,pullRequestId:r,threadId:s},body:e})}async deleteComment(e,t,r,s,o){return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/threads/{threadId}/comments/{commentId}",routeValues:{project:o,repositoryId:e,pullRequestId:t,threadId:r,commentId:s}})}async getComment(e,t,r,s,o){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/threads/{threadId}/comments/{commentId}",routeValues:{project:o,repositoryId:e,pullRequestId:t,threadId:r,commentId:s}})}async getComments(e,t,r,s){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/threads/{threadId}/comments/{commentId}",routeValues:{project:s,repositoryId:e,pullRequestId:t,threadId:r}})}async updateComment(e,t,r,s,o,i){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/threads/{threadId}/comments/{commentId}",routeValues:{project:i,repositoryId:t,pullRequestId:r,threadId:s,commentId:o},body:e})}async createThread(e,t,r,s){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/threads/{threadId}",routeValues:{project:s,repositoryId:t,pullRequestId:r},body:e})}async getPullRequestThread(e,t,r,s,o,i){const a={$iteration:o,$baseIteration:i};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/threads/{threadId}",routeValues:{project:s,repositoryId:e,pullRequestId:t,threadId:r},queryParams:a})}async getThreads(e,t,r,s,o){const i={$iteration:s,$baseIteration:o};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/threads/{threadId}",routeValues:{project:r,repositoryId:e,pullRequestId:t},queryParams:i})}async updateThread(e,t,r,s,o){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/threads/{threadId}",routeValues:{project:o,repositoryId:t,pullRequestId:r,threadId:s},body:e})}async getPullRequestWorkItemRefs(e,t,r){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pullRequests/{pullRequestId}/workitems",routeValues:{project:r,repositoryId:e,pullRequestId:t}})}async createPush(e,t,r){return this.beginRequest({apiVersion:"5.0-preview.2",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pushes/{pushId}",routeValues:{project:r,repositoryId:t},body:e})}async getPush(e,t,r,s,o){const i={includeCommits:s,includeRefUpdates:o};return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pushes/{pushId}",routeValues:{project:r,repositoryId:e,pushId:t},queryParams:i})}async getPushes(e,t,r,s,o){const i={$skip:r,$top:s,searchCriteria:o};return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/pushes/{pushId}",routeValues:{project:t,repositoryId:e},queryParams:i})}async deleteRepositoryFromRecycleBin(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"{project}/_apis/git/recycleBin/repositories/{repositoryId}",routeValues:{project:e,repositoryId:t}})}async getRecycleBinRepositories(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/recycleBin/repositories/{repositoryId}",routeValues:{project:e}})}async restoreRepositoryFromRecycleBin(e,t,r){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"{project}/_apis/git/recycleBin/repositories/{repositoryId}",routeValues:{project:t,repositoryId:r},body:e})}async getRefs(e,t,r,s,o,a,n,p,c,u,l){const d={filter:r,includeLinks:s,includeStatuses:o,includeMyBranches:a,latestStatusesOnly:n,peelTags:p,filterContains:c,$top:u,continuationToken:l};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/refs/{*filter}",routeValues:{project:t,repositoryId:e},queryParams:d,returnRawResponse:!0}).then((async e=>{const t=await e.text().then(i.deserializeVssJsonObject);return t.continuationToken=e.headers.get("x-ms-continuationtoken"),t}))}async updateRef(e,t,r,s,o){const i={filter:r,projectId:o};return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/refs/{*filter}",routeValues:{project:s,repositoryId:t},queryParams:i,body:e})}async updateRefs(e,t,r,s){const o={projectId:s};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/refs/{*filter}",routeValues:{project:r,repositoryId:t},queryParams:o,body:e})}async createFavorite(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/favorites/refs/{favoriteId}",routeValues:{project:t},body:e})}async deleteRefFavorite(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"{project}/_apis/git/favorites/refs/{favoriteId}",routeValues:{project:e,favoriteId:t}})}async getRefFavorite(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/favorites/refs/{favoriteId}",routeValues:{project:e,favoriteId:t}})}async getRefFavorites(e,t,r){const s={repositoryId:t,identityId:r};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/favorites/refs/{favoriteId}",routeValues:{project:e},queryParams:s})}async createRepository(e,t,r){const s={sourceRef:r};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/Repositories/{repositoryId}",routeValues:{project:t},queryParams:s,body:e})}async deleteRepository(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"{project}/_apis/git/Repositories/{repositoryId}",routeValues:{project:t,repositoryId:e}})}async getRepositories(e,t,r,s){const o={includeLinks:t,includeAllUrls:r,includeHidden:s};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/Repositories/{repositoryId}",routeValues:{project:e},queryParams:o})}async getRepository(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/Repositories/{repositoryId}",routeValues:{project:t,repositoryId:e}})}async getRepositoryWithParent(e,t,r){const s={includeParent:t};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/Repositories/{repositoryId}",routeValues:{project:r,repositoryId:e},queryParams:s})}async updateRepository(e,t,r){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"{project}/_apis/git/Repositories/{repositoryId}",routeValues:{project:r,repositoryId:t},body:e})}async createRevert(e,t,r){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/reverts/{revertId}",routeValues:{project:t,repositoryId:r},body:e})}async getRevert(e,t,r){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/reverts/{revertId}",routeValues:{project:e,revertId:t,repositoryId:r}})}async getRevertForRefName(e,t,r){const s={refName:r};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/reverts/{revertId}",routeValues:{project:e,repositoryId:t},queryParams:s})}async createCommitStatus(e,t,r,s){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/commits/{commitId}/Statuses",routeValues:{project:s,commitId:t,repositoryId:r},body:e})}async getStatuses(e,t,r,s,o,i){const a={top:s,skip:o,latestOnly:i};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/commits/{commitId}/Statuses",routeValues:{project:r,commitId:e,repositoryId:t},queryParams:a})}async getSuggestions(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/suggestions",routeValues:{project:t,repositoryId:e}})}async getTemplateList(e,t){const r={type:t};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/templates",routeValues:{project:e},queryParams:r})}async getTreeDiffs(e,t,r,s,o,a){const n={baseId:r,targetId:s,$top:o,continuationToken:a};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/diffs/trees",routeValues:{project:e,repositoryId:t},queryParams:n,returnRawResponse:!0}).then((async e=>{const t=await e.text().then(i.deserializeVssJsonObject),r=e.headers.get("x-ms-continuationtoken");return{treeDiff:t,continuationToken:r?r.split(","):[]}}))}async getTree(e,t,r,s,o,i){const a={projectId:s,recursive:o,fileName:i};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/Trees/{sha1}",routeValues:{project:r,repositoryId:e,sha1:t},queryParams:a})}async getTreeZip(e,t,r,s,o,i){const a={projectId:s,recursive:o,fileName:i};return this.beginRequest({apiVersion:"5.0-preview.1",httpResponseType:"application/zip",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/Trees/{sha1}",routeValues:{project:r,repositoryId:e,sha1:t},queryParams:a})}}t[e].GitClientName="IGitRestClient",t[e].getGitClient=function(r,s){return r.getRestClient(t[e].GitClientName,s)},s.RestClients.add(t[e].GitClientName,{factory:r,options:{resourceAreaId:"4e080c62-fa21-4fbc-8fef-2a10a2b38049",serviceInstanceType:"00025394-6065-48ca-87d9-7f5672854ef7"}})}("RestClientGit"),function(e){V=t[e]={};const r="refs/heads/",s="refs/tags/";function o(e){return 0===(e||"").indexOf(r)}function i(e){return 0===(e||"").indexOf(s)}t[e].getFriendlyName=function(e){return o(e)?e.substr(r.length):i(e)?e.substr(s.length):e},t[e].getRefNameFromBranchName=function(e){return r+e},t[e].getRefNameFromTagName=function(e){return s+e},t[e].isBranch=o,t[e].isTag=i,t[e].getVersionFromBranchName=function(e){return"GB"+e},t[e].getVersionFromTagName=function(e){return"GT"+e},t[e].getVersionFromCommitHash=function(e){return"GC"+e},t[e].getShortCommitId=function(e){return e.substring(0,8)}}("UtilsRef"),function(e){var s;b=t[e]={},function(e){e.artifactType="Microsoft.TeamFoundation.Git.GitRefFavorite",e.artifactScopeType="Repository"}(s=t[e].GitRefFavoriteArtifactConstants||(t[e].GitRefFavoriteArtifactConstants={}));class o extends r.ObservableArray{dispose(){}}function i(e){return{id:e.id.toString(),artifactId:e.name,artifactName:(0,V.getFriendlyName)(e.name),artifactScope:{id:e.repositoryId,type:s.artifactScopeType},artifactType:s.artifactType}}t[e].GitRefFavoritesService=class{constructor(e,t,r){this.gitRestClient=e,this.canFavorites=t,this.projectId=r,this._favoritesCollection=new o([])}canUseFavorites(){return this.canFavorites}canFetchExtendedDetails(){return!1}async getFavorites(e,t,r){if(e!==s.artifactType)throw new Error(`Type ${e} not valid. GitRefFavoritesService only supports ${s.artifactType}.`);if(t!==s.artifactScopeType)throw new Error(`Scope ${t} not valid. GitRefFavoritesService only supports ${s.artifactScopeType}.`);return this._favoritesPromise||(this._favoritesPromise=this.gitRestClient.getRefFavorites(this.projectId,r)),this._favoritesPromise.then((e=>(this._favoritesCollection=new o(e.filter((e=>2===e.type)).map(i)),this._favoritesCollection)))}getCurrentFolderFavorites(){if(!this._favoritesPromise)throw new Error("Favorites not loading yet.");return this._favoritesPromise.then((e=>e.filter((e=>1===e.type)).map((e=>e.name))))}async addFavorite(e){this._favoritesCollection.push(e);const t=await this.gitRestClient.createFavorite(function(e){return{id:e.id&&parseInt(e.id),name:e.artifactId,repositoryId:e.artifactScope.id,type:2}}(e),this.projectId);return e.id=t.id.toString(),e}async removeFavorite(e){this._favoritesCollection.removeAll((t=>t.id===e.id)),await this.gitRestClient.deleteRefFavorite(this.projectId,parseInt(e.id))}}}("GitRefFavoritesService"),function(e){C=t[e]={};class r extends Array{constructor(e,t){if("number"==typeof e)super(e);else{super();for(const t of e)this.push(t);this.continuationToken=t}}}t[e].PagedList=r;const a=void 0;class n extends s.VssService{constructor(){super(...arguments),this.myBranchesByRepository={},this.branchesByRepository={},this.tagsByRepository={},this.refsByArea={heads:this.branchesByRepository,tags:this.tagsByRepository},this.branchesChangedListeners=[],this.tagsChangedListeners=[],this.searchBranches=(e,t,r,s)=>this.searchPagedRefs(e,t,r,"heads",s),this.searchTags=(e,t,r,s)=>this.searchPagedRefs(e,t,r,"tags",s)}getMyBranches(e,t){return this.myBranchesByRepository[e]||(this.myBranchesByRepository[e]=this.getGitClient().getRefs(e,t,void 0,!1,!1,!0).then(c)),this.myBranchesByRepository[e]}getPagedBranches(e,t){return this.getPagedRefs(e,t,"heads")}getMoreBranches(e,t,r){return this.getMoreRefs(e,t,r,"heads")}getPagedTags(e,t){return this.getPagedRefs(e,t,"tags")}getMoreTags(e,t,r){return this.getMoreRefs(e,t,r,"tags")}invalidateBranchesCache(e){delete this.myBranchesByRepository[e],delete this.branchesByRepository[e];for(const e of this.branchesChangedListeners)e()}registerBranchesChangedListener(e){this.branchesChangedListeners.push(e)}unregisterBranchesChangedListener(e){const t=this.branchesChangedListeners.indexOf(e);t>=0&&this.branchesChangedListeners.slice(t,1)}invalidateTagsCache(e){delete this.tagsByRepository[e];for(const e of this.tagsChangedListeners)e()}registerTagsChangedListener(e){this.tagsChangedListeners.push(e)}unregisterTagsChangedListener(e){const t=this.tagsChangedListeners.indexOf(e);t>=0&&this.tagsChangedListeners.slice(t,1)}async getPagedRefs(e,t,r){let s=this.getCachedRefs(r,e);if(!s){s=this.getRefPaginatedClient().getPaginatedRefs(e,t,r,a,200),this.cacheRefs(r,e,s)}return s}async getMoreRefs(e,t,s,o){const i=this.getCachedRefs(o,e);if(!i)return this.getPagedRefs(e,t,o);const n=await i;if(!n.continuationToken||n.continuationToken!==s)return n;const p=this.getRefPaginatedClient().getPaginatedRefs(e,t,o,a,200,n.continuationToken).then((e=>new r([...n,...e],e.continuationToken)));return this.cacheRefs(o,e,p),p}async searchPagedRefs(e,t,s,o,i){const a=this.getCachedRefs(o,e);if(a){const e=await a;if(!e.continuationToken){const t=e.filter((e=>-1!==e.name.toLowerCase().indexOf(s.toLowerCase())));return new r(t)}}return this.getRefPaginatedClient().getPaginatedRefs(e,t,o,s,200,i)}getRefPaginatedClient(){return this.pageContext.getRestClient("IPaginatedGitRefRestClient")}getGitClient(){return this.pageContext.getRestClient("IGitRestClient")}getCachedRefs(e,t){return this.refsByArea[e][t]}cacheRefs(e,t,r){this.refsByArea[e][t]=r}}t[e].GitRefService=n,s.Services.add("IDeprecatedGitRefService",{serviceFactory:n,options:2});class p extends o.RestClientBase{async getPaginatedRefs(e,t,s,o,a,n){const p={filter:s,filterContains:o,$top:a,continuationToken:n};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/git/repositories/{repositoryId}/refs/{*filter}",routeValues:{project:t,repositoryId:e},queryParams:p,returnRawResponse:!0}).then((async e=>new r(await e.text().then(i.deserializeVssJsonObject),function(e){return e.headers.get("x-ms-continuationtoken")||void 0}(e))))}}function c(e){return e.filter((e=>(0,V.isBranch)(e.name)))}t[e].PaginatedGitRefRestClient=p;s.RestClients.add("IPaginatedGitRefRestClient",{factory:p,options:{serviceInstanceType:"00025394-6065-48ca-87d9-7f5672854ef7"}})}("GitRefService"),function(e){t.GitRepositoryService={};class r extends s.VssService{constructor(){super(...arguments),this.repositoriesByProject={}}getAllRepositories(e){let t=this.repositoriesByProject[e||""];if(!t){t=this.pageContext.getRestClient("IGitRestClient").getRepositories(e),this.repositoriesByProject[e||""]=t}return t}getRepositoryById(e,t){return this.pageContext.getRestClient("IGitRestClient").getRepository(e,t)}}s.Services.add("IDeprecatedGitRepositoryService",{serviceFactory:r})}(),function(e){t[e]={},function(e){e.getHeadRelativeName=function(e){return e.substring(e.indexOf("/",e.indexOf("/")+1)+1)},e.getParentName=function(e){return e.substring(0,e.lastIndexOf("/"))},e.getShortName=function(e){return e.substring(e.lastIndexOf("/")+1)}}(t[e].BranchName||(t[e].BranchName={}))}("Helpers"),function(e){var r;t[e]={},function(e){e.Branches="ms.vss-code-web.branches-route",e.BranchesCompare="ms.vss-code-web.branch-compare-route",e.Changeset="ms.vss-code-web.tfvc-changeset-details-route",e.Commit="ms.vss-code-web.commit-route",e.Commits="ms.vss-code-web.commits-route",e.Shelveset="ms.vss-code-web.tfvc-shelveset-details-route",e.TfvcFiles="ms.vss-code-web.tfvc-files-route",e.GitFiles="ms.vss-code-web.files-route-git",e.Pushes="ms.vss-code-web.pushes-route",e.Tags="ms.vss-code-web.tags-route",e.PullRequests="ms.vss-code-web.pull-request-list-route",e.PullRequest="ms.vss-code-web.pull-request-review-route",e.MyPullRequests="ms.vss-code-web.my-pullrequests-me-page-route",e.GitOverview="ms.vss-code-web.repository-overview-git-route",e.TfvcOverview="ms.vss-code-web.repository-overview-tfvc-route"}(r=t[e].RouteIds||(t[e].RouteIds={}));const o={"ms.vss-code-web.git-repository-overview":r.GitOverview,"ms.vss-code-web.files-hub-git":r.GitFiles,"ms.vss-code-web.branches-hub":r.Branches,"ms.vss-code-web.tags-hub":r.Tags,"ms.vss-code-web.pushes-hub":r.Pushes,"ms.vss-code-web.commits-hub":r.Commits,"ms.vss-code-web.pull-request-hub":r.PullRequests};class i extends s.VssService{getData(){return this.pageContext.getService("IVssContributionService").getData("ms.vss-code-web.navigation-data-provider")}getTfvcCommitUrl(e,t,s){const o={};this._addDefaultRoutes(o,t,s);let i="";switch(e.charAt(0)){case"C":i=r.Changeset,o.parameters=encodeURIComponent(e.substring(1));break;case"L":case"W":case"D":return"";default:i=r.Shelveset,o.ss=e}return(0,a.routeUrl)(this.pageContext,i,o)}getGitCommitUrl(e,t,s,o){const i={};return this._addDefaultRoutes(i,s,o),t&&(i["vc.GitRepositoryName"]=t),i.parameters=encodeURIComponent(e),(0,a.routeUrl)(this.pageContext,r.Commit,i)}getRepositoryUrl(e,t,s,i,n){if(!i)if(e){const e=this.pageContext.getService("IVssNavigationService").getDisplayedNavigation()[3];i=o[e]||r.GitFiles}else i=r.TfvcFiles;let p={};return this._addDefaultRoutes(p,t,s),e&&(p["vc.GitRepositoryName"]=e),n&&(p=Object.assign(Object.assign({},n),p)),(0,a.routeUrl)(this.pageContext,i,p)}getPullRequestUrl(e,t,s){const o={};return this._addDefaultRoutes(o,s,null),t&&(o["vc.GitRepositoryName"]=t),o.parameters=e.toString(),(0,a.routeUrl)(this.pageContext,r.PullRequest,o)}getGitCompareCommitsUrl(e,t,s,o,i){let n={};return this._addDefaultRoutes(n,o,i),s&&(n["vc.GitRepositoryName"]=s),n.baseVersion="GC"+e,n.targetVersion="GC"+t,n._a="commits",(0,a.routeUrl)(this.pageContext,r.BranchesCompare,n)}getRefUrl(e,t,s,o){let i=r.GitFiles;t||(i=r.TfvcFiles);let n={};this._addDefaultRoutes(n,s,o),t&&(n["vc.GitRepositoryName"]=t);const p="refs/heads/",c="refs/tags/";return 0===e.indexOf(p)?n.version="GB"+e.substring(11):0===e.indexOf(c)?n.version="GT"+e.substring(10):i===r.TfvcFiles&&(n.path=e),(0,a.routeUrl)(this.pageContext,i,n)}getMyPullRequestsUrl(){return(0,a.routeUrl)(this.pageContext,r.MyPullRequests)}_addDefaultRoutes(e,t,r){if(!t||!r){const e=this.pageContext.getService("ITfsPageService").getData(),r=e&&e.project&&e.project.name;void 0===t&&r&&(t=r)}t&&(e.project=t),r&&(e.team=r)}}s.Services.add("IVCNavigationService",{serviceFactory:i})}("Navigation"),function(e){t.MenuProvider={};class r extends s.VssService{loadItems(e){const t=this.pageContext.getService("IVCNavigationService"),r=t.getData();if(r){const s=this.pageContext.getService("ITfsPageService").getData(),o=s&&s.project?s.project.name:"",i=r.defaultRepoIsGit?r.defaultGitRepoName:"$/"+o,a=r.defaultRepoIsGit?"git":"tfvc-repo";e([{key:"vcRepoItem",className:"repo-menu-item",groupKey:"navigation",href:r.defaultRepoIsGit?r.defaultGitRepoUrl:t.getRepositoryUrl(null),name:i,iconProps:{iconName:"",className:"bowtie-icon bowtie-"+a},rank:50}])}}}s.Services.add("code-hub-group-menu-provider",{serviceFactory:r})}(),function(e){t.MruRouteService={};class r extends s.VssService{constructor(){super(...arguments),this.id="vc-mru-route-service"}routeUrl(e,t){const r=this.pageContext.getService("IVssLocationService"),s=this.pageContext.getService("IVssContributionService").getData("ms.vss-code-web.versioncontrol-viewmodel-data-provider");return s&&(s.gitRepository?e.vcType="git":s.projectVersionControlInfo&&s.projectVersionControlInfo.supportsTFVC&&(e.vcType="tfvc")),r.routeUrl("ms.vss-code-web.code-redirect",e,t)}}s.Services.add("vc-mru-route-service",{serviceFactory:r})}(),function(e){w=t[e]={},t[e].debouncePromiseFunction=function(e,t,r){let s,o;return function(...i){return s&&(clearTimeout(s),o&&o(r),o=void 0,s=void 0),new Promise((r=>{o=r,s=setTimeout((()=>{o=void 0,s=void 0,r(e.apply(null,i))}),t)}))}},t[e].reuseIfStrictlyStronger=function(e,t,r){let s,o;return(i,a)=>{const n=()=>(s=i,o=e(i,a),o);return p=i,c=s,Boolean(p&&c&&p.toLowerCase().indexOf(c.toLowerCase())>=0)?o.then((e=>e&&r(e)?t(i,e):n())).catch(n):n();var p,c}},t[e].createValidator=function(e,t){return async(r,s)=>(await t(r),await e(r,s))},t[e].composeSearchByPivot=function(e,t){return(r,s,o)=>e[s||t](r,o)}}("UtilsSearch"),function(e){P=t[e]={},t[e].startTelemetryTimer=function(e,t){const r=Date.now();return{publishTime:function(s,o){e.getService("IVssTelemetryService").publishEvent(T.VersionControlArea,t,Object.assign({action:s,elapsedMs:Date.now()-r},o))}}}}("UtilsTelemetry"),function(e){j=t[e]={};const r=/^[0-9a-f]+$/i,s="VersionDropdownProvider";class o extends n.ArtifactPickerProviderBase{constructor(e,t){super(),this.pageContext=e,this.options=t,this._continuationTokens={},this.minItemsForSearchBox=0,this.selectExactMatchOnEnter=!0,this.getPickListItems=async e=>{if(!e)return[];const t=(0,P.startTelemetryTimer)(this.pageContext,s),r=await this.getRefs(e);if(this._continuationTokens[e]=r.continuationToken,!r.continuationToken){const t=this.getGroupsLoadingState();t[e]&&(t[e]=!1,this._artifactPickerOptions.groups=i(this.options,t))}const o=this.options.viewMyBranches?await this._gitRefFavoritesService.getCurrentFolderFavorites():[],n=r.map((e=>a(e,this.options.repository,this.options.currentIdentityId,o)));return this.selectedItem&&"commit"===this.selectedItem.kind&&n.push(this.selectedItem),t.publishTime("getPickListItems",{groupKey:e,count:n.length,hasMore:Boolean(r.continuationToken)}),n},this.searchCommits=async e=>{const t=(0,P.startTelemetryTimer)(this.pageContext,s),r=this.pageContext.getRestClient("IGitRestClient"),{id:o,project:{id:i}}=this.options.repository,a=(await r.getCommitsBatch({fromCommitId:c(e,"0",40),toCommitId:c(e,"F",40)},o,i,0,11)).map((e=>function(e,t){return{refName:e.commitId,friendlyName:V.getShortCommitId(e.commitId)+" "+e.comment,versionString:V.getVersionFromCommitHash(e.commitId),kind:"commit",repositoryId:t.id}}(e,this.options.repository)));return t.publishTime("searchCommits",{count:a.length}),a},this.searchBranchRefs=(e,t)=>this.searchRefs(e,t,"all-branches",this.getGitRefService().searchBranches),this.searchTagRefs=(e,t)=>this.searchRefs(e,t,"all-tags",this.getGitRefService().searchTags);const r={artifactType:b.GitRefFavoriteArtifactConstants.artifactType,artifactScope:{id:t.repository.id,name:t.repository.name,type:b.GitRefFavoriteArtifactConstants.artifactScopeType}},o={branch:"OpenSource",tag:"Tag",commit:"BranchCommit"};let n,p,h=function(e){const t=e&&e.viewClearButton?()=>e.onVersionSelected&&e.onVersionSelected(null):void 0;return[{id:"branches",name:q.VersionDropdown_PivotBranches,getActions:()=>function(e,t,r){const s=[];e&&s.push({name:q.VersionDropdown_NewBranch,iconProps:{iconName:"Add"},onClick:()=>e()});t&&s.push({name:q.VersionDropdown_ClearSelection,iconProps:{iconName:"Cancel"},disabled:r,onClick:t});return s}(e.onCreateBranchClick,t,!e.selectedVersionString),searchTextPlaceholder:q.VersionDropdown_BranchesSearchTextPlaceholder,searchNoResultsText:q.VersionDropdown_BranchesSearchNoResultsText},e.viewTagsPivot&&{id:"tags",name:q.VersionDropdown_PivotTags,searchTextPlaceholder:q.VersionDropdown_TagsSearchTextPlaceholder,searchNoResultsText:q.VersionDropdown_TagsSearchNoResultsText,noItemsText:q.VersionDropdown_TagsNoItemsText},e.viewCommitsPivot&&{id:"commits",name:q.VersionDropdown_PivotCommits,searchTextPlaceholder:q.VersionDropdown_CommitsSearchTextPlaceholder,searchNoResultsText:q.VersionDropdown_CommitsSearchNoResultsText,noItemsText:q.VersionDropdown_CommitsSearchMinimumCharactersError}].filter(Boolean)}(t);if(h&&1===h.length){const e=h[0].getActions;n=e&&e([]),p=h[0].searchTextPlaceholder,h=void 0}const{id:g}=t.repository.project;this._gitRefFavoritesService=this.getGitRefFavoritesService(g,t.viewMyBranches),this._artifactPickerOptions={pageContext:e,favoritesContext:r,favoritesService:this._gitRefFavoritesService,onArtifactClicked:e=>t.onVersionSelected&&t.onVersionSelected(e.versionString),selectedArtifact:u(t.selectedVersionString,t.repository),hideFavoriteSelectedItemIndicator:!0,getArtifacts:this.getPickListItems,getArtifactId:e=>e.refName,getArtifactName:e=>e.friendlyName,getArtifactIcon:e=>({iconType:0,iconName:o[e.kind]}),getFavoriteFromArtifact:l,getArtifactListGroupId:d,artifactComparer:m,groups:i(t,{"all-branches":!0,"all-tags":!0}),pivots:h,searchTextPlaceholder:p,otherActions:n,limitSearchToPivot:!0,getSearchResults:this.createSearchFunction(),getSearchResultsContinuationToken:e=>e.continuationToken,onFilterItemByText:v},this.initialize(this._artifactPickerOptions),this.getGitRefService().registerBranchesChangedListener(this.forgetCachedArtifacts),this._ariaLabelPrefix=t.ariaLabel}get ariaLabelFormat(){let e=q.VersionDropdown_BranchAriaLabel;return this.selectedItem&&("commit"===this.selectedItem.kind?e=q.VersionDropdown_CommitAriaLabel:"tag"===this.selectedItem.kind&&(e=q.VersionDropdown_TagAriaLabel)),this._ariaLabelPrefix?`${this._ariaLabelPrefix} ${e}`:e}dispose(){super.dispose(),this.getGitRefService().unregisterBranchesChangedListener(this.forgetCachedArtifacts)}getRefs(e){const t=this._continuationTokens[e],{id:r,project:{id:s}}=this.options.repository;return t?"all-tags"===e?this.getGitRefService().getMoreTags(r,s,t):this.getGitRefService().getMoreBranches(r,s,t):"all-tags"===e?this.getGitRefService().getPagedTags(r,s):this.options.viewMyBranches?this.getMyBranches():this.getGitRefService().getPagedBranches(r,s)}getMyBranches(){const{id:e,project:{id:t}}=this.options.repository;return this.getGitRefService().getMyBranches(e,t).then((e=>new C.PagedList(e,"!")))}getGitRefFavoritesService(e,t){const r=this.pageContext.getService("IFavoritesService"),s=this.pageContext.getRestClient("IGitRestClient");return new b.GitRefFavoritesService(s,t&&r.canUseFavorites(),e)}getGitRefService(){return this.pageContext.getService("IDeprecatedGitRefService")}createSearchFunction(){const e=e=>(0,w.debouncePromiseFunction)(e,1e3,[]),t=e=>(t,r)=>e(t&&t.trim(),r),r=e=>(0,w.reuseIfStrictlyStronger)(e,y,R);return(0,w.composeSearchByPivot)({branches:(e=>(t,r)=>this.isGroupFullyLoaded("all-branches")?Promise.resolve(void 0):e(t,r))(t(r(e(this.searchBranchRefs)))),tags:(e=>(t,r)=>this.isGroupFullyLoaded("all-tags")?Promise.resolve(void 0):e(t,r))(t(r(e(this.searchTagRefs)))),commits:t((e=>(0,w.createValidator)(e,h))((s=e(this.searchCommits),(0,w.reuseIfStrictlyStronger)(s,g,I))))},"branches");var s}async searchRefs(e,t,r,o){const i=(0,P.startTelemetryTimer)(this.pageContext,s);t||(t=this._continuationTokens[r]);const{id:n,project:{id:p}}=this.options.repository,c=await o(n,p,e,t),u=c.map((e=>a(e,this.options.repository,this.options.currentIdentityId,[])));return i.publishTime("searchRefs",{count:u.length,hasMore:Boolean(c.continuationToken)}),new C.PagedList(u,c.continuationToken)}getGroupsLoadingState(){return this._artifactPickerOptions&&this._artifactPickerOptions.groups?this._artifactPickerOptions.groups.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.key]:t.isLoading})),{}):{}}isGroupFullyLoaded(e){return!this.getGroupsLoadingState()[e]}}function i({viewMyBranches:e,viewTagsPivot:t,viewCommitsPivot:r},s){return[{key:"default",name:void 0,pivotId:"branches"},e&&{key:"favorites",name:q.VersionDropdown_MineBranches,pivotId:"branches"},{key:"all-branches",name:q.VersionDropdown_AllBranches,pivotId:"branches",isLoading:s["all-branches"]},t&&{key:"all-tags",name:void 0,pivotId:"tags",isLoading:s["all-tags"]},r&&{key:"found-commits",name:void 0,pivotId:"commits"}].filter(Boolean)}function a(e,t,r,s){const o=V.getFriendlyName(e.name),i=V.isTag(e.name);return{refName:e.name,friendlyName:o,versionString:i?V.getVersionFromTagName(o):V.getVersionFromBranchName(o),kind:i?"tag":"branch",isMine:e.creator&&e.creator.id===r,isDefault:e.name===t.defaultBranch,isFavoritedByFolder:!i&&p(e.name,s),repositoryId:t.id}}function p(e,t){return t.some((t=>e.startsWith(t+"/")))}function c(e,t,r){return!e||e.length>=r?e:e+Array(r-e.length+1).join(t)}function u(e,t){if(!e)return;const r="GT"===e.substring(0,2),s="GC"===e.substring(0,2);let o=e.substring(2);s&&(o=V.getShortCommitId(o));const i=V.getFriendlyName(t.defaultBranch);return{refName:r?V.getRefNameFromTagName(o):V.getRefNameFromBranchName(o),friendlyName:o,versionString:e,kind:s?"commit":r?"tag":"branch",isDefault:o===i,repositoryId:t.id}}function l(e){if("branch"===e.kind&&!e.isDefault&&!e.isMine)return{artifactId:e.refName,artifactName:e.friendlyName,artifactScope:{id:e.repositoryId,type:b.GitRefFavoriteArtifactConstants.artifactScopeType},artifactType:b.GitRefFavoriteArtifactConstants.artifactType}}function d(e){return"commit"===e.kind?"found-commits":"tag"===e.kind?"all-tags":e.isDefault?"default":e.isMine||e.isFavoritedByFolder?"favorites":"all-branches"}function m(e,t){return e.friendlyName.localeCompare(t.friendlyName)}function h(e){if(!e||e.length<4)throw new Error(q.VersionDropdown_CommitsSearchMinimumCharactersError);if(!r.test(e))throw new Error(q.VersionDropdown_CommitsSearchWrongCharactersError)}function g(e,t){return t.filter((t=>t.refName.startsWith(e)))}function y(e,t){return t.filter((t=>-1!==t.friendlyName.toLowerCase().indexOf(e.toLowerCase())))}function I(e){return e.length<=10}function R(e){return!e.continuationToken}function v(e,t,r){return-1!==("commit"===r.kind?r.refName:t.name).toLowerCase().indexOf(e.toLowerCase())}t[e].VersionDropdownProvider=o}("ProvidersVersionDropdownProvider"),function(e){S=t[e]={};const r="Microsoft.TeamFoundation.Git.Repository",s="RepositoryPickerProvider";class o extends n.ArtifactPickerProviderBase{constructor(e,t){super(),this.minItemsForSearchBox=0,this.getPickListItems=()=>{if(!this.itemsPromise){const e=(0,P.startTelemetryTimer)(this.pageContext,s),t=this.pageContext.getService("IDeprecatedGitRepositoryService");this.itemsPromise=t.getAllRepositories(this.projectId).then((t=>{const r=t.map(i);return r.sort(((e,t)=>(0,c.localeIgnoreCaseComparer)(e.name,t.name))),this.supportsTfvc&&r.unshift({name:"$/"+this.projectName,isTfvc:!0,id:"tfvc",isFork:!1}),e.publishTime("getAllRepositories"),r}))}return this.itemsPromise},this.onSelectedItemChanged=e=>{this.setSelectedItem(e);const{onArtifactClicked:t,getArtifactHref:r}=this.artifactPickerOptions;return t?t(e):r?(0,p.onClickFPS)(this.pageContext,r(e),!0,void 0,{telemetrySource:s}):void 0};const{actions:o,getItemHref:a,getRepositories:n,onRepositorySelected:u,selectedRepositoryIsTfvc:l,selectedRepositoryIsFork:d,selectedRepositoryId:m,selectedRepositoryName:h,supportsTfvc:g,projectName:y,projectId:I,defaultGroupHeader:R,favoriteGroupHeader:v,showFavoritesEarly:f=!0}=t;let T,V;this.pageContext=e,this.projectId=I,this.projectName=y,this.supportsTfvc=g,n&&(this.itemsPromise=n().then((e=>e.map(i)))),l?T={name:"$/"+y,isTfvc:!0,id:"tfvc",isFork:!1}:h&&(T={name:h,isTfvc:!1,id:m||h,isFork:!!d}),V=y&&I?{artifactType:r,artifactScope:{id:I,name:y,type:"Project"}}:{artifactType:r,artifactScope:{id:"",name:"",type:"Collection"}},this.artifactPickerOptions={pageContext:e,favoritesContext:V,onArtifactClicked:u,selectedArtifact:T,defaultGroupHeader:R,favoriteGroupHeader:v,hideFavoriteSelectedItemIndicator:!0,getArtifacts:this.getPickListItems,getArtifactId:e=>e.id,getArtifactName:e=>e.name,getArtifactHref:a,getArtifactIcon:e=>({iconType:1,iconName:e.isTfvc?"tfvc-repo":e.isFork?"git-fork":"git"}),getArtifactFromFavorite:f?e=>({name:e.artifactName,id:e.artifactId,isTfvc:!1,isFork:!1}):void 0,getFavoriteFromArtifact:e=>e.repository?{artifactId:e.repository.id,artifactName:e.repository.name,artifactScope:{id:e.repository.project.id,name:e.repository.project.name,type:"Project"},artifactType:r}:void 0,artifactComparer:(e,t)=>e.name.localeCompare(t.name),otherActions:o,searchTextPlaceholder:q.SearchRepositoriesWatermark,ariaLabelFormat:q.RepositoryDropdown_AriaLabel},this.initialize(this.artifactPickerOptions)}async _loadFavorites(e=!1){const t=(0,P.startTelemetryTimer)(this.pageContext,s),r=await super._loadFavorites(e);return r&&t.publishTime("loadFavorites",{includeExtendedData:e}),r}}function i(e){return{name:e.name,id:e.id,repository:e,isFork:e.isFork,isTfvc:!1}}t[e].RepositoryPickerProvider=o}("RepositoryPickerProvider"),function(e){t[e]={};class r extends o.RestClientBase{constructor(e){super(e)}async getBranch(e,t,r,s){const o={path:e,includeParent:r,includeChildren:s};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/tfvc/Branches/{*path}",routeValues:{project:t},queryParams:o})}async getBranches(e,t,r,s,o){const i={includeParent:t,includeChildren:r,includeDeleted:s,includeLinks:o};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/tfvc/Branches/{*path}",routeValues:{project:e},queryParams:i})}async getBranchRefs(e,t,r,s){const o={scopePath:e,includeDeleted:r,includeLinks:s};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/tfvc/Branches/{*path}",routeValues:{project:t},queryParams:o})}async getChangesetChanges(e,t,r){const s={$skip:t,$top:r};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/tfvc/changesets/{id}/changes",routeValues:{id:e},queryParams:s,returnRawResponse:!0}).then((async e=>{const t=await e.text().then(i.deserializeVssJsonObject);return t.continuationToken=e.headers.get("x-ms-continuationtoken"),t}))}async createChangeset(e,t){return this.beginRequest({apiVersion:"5.0-preview.3",method:"POST",routeTemplate:"{project}/_apis/tfvc/changesets/{id}",routeValues:{project:t},body:e})}async getChangeset(e,t,r,s,o,i,a,n,p,c,u){const l={maxChangeCount:r,includeDetails:s,includeWorkItems:o,maxCommentLength:i,includeSourceRename:a,$skip:n,$top:p,$orderby:c,searchCriteria:u};return this.beginRequest({apiVersion:"5.0-preview.3",routeTemplate:"{project}/_apis/tfvc/changesets/{id}",routeValues:{project:t,id:e},queryParams:l})}async getChangesets(e,t,r,s,o,i){const a={maxCommentLength:t,$skip:r,$top:s,$orderby:o,searchCriteria:i};return this.beginRequest({apiVersion:"5.0-preview.3",routeTemplate:"{project}/_apis/tfvc/changesets/{id}",routeValues:{project:e},queryParams:a})}async getBatchedChangesets(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/tfvc/ChangesetsBatch",body:e})}async getChangesetWorkItems(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/tfvc/changesets/{id}/workItems",routeValues:{id:e}})}async getItemsBatch(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/tfvc/ItemBatch",routeValues:{project:t},body:e})}async getItemsBatchZip(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",httpResponseType:"application/zip",routeTemplate:"{project}/_apis/tfvc/ItemBatch",routeValues:{project:t},body:e})}async getItem(e,t,r,s,o,i,a,n){const p={path:e,fileName:r,download:s,scopePath:o,recursionLevel:i,versionDescriptor:a,includeContent:n};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/tfvc/Items/{*path}",routeValues:{project:t},queryParams:p})}async getItemContent(e,t,r,s,o,i,a,n){const p={path:e,fileName:r,download:s,scopePath:o,recursionLevel:i,versionDescriptor:a,includeContent:n};return this.beginRequest({apiVersion:"5.0-preview.1",httpResponseType:"application/octet-stream",routeTemplate:"{project}/_apis/tfvc/Items/{*path}",routeValues:{project:t},queryParams:p})}async getItems(e,t,r,s,o){const i={scopePath:t,recursionLevel:r,includeLinks:s,versionDescriptor:o};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/tfvc/Items/{*path}",routeValues:{project:e},queryParams:i})}async getItemText(e,t,r,s,o,i,a,n){const p={path:e,fileName:r,download:s,scopePath:o,recursionLevel:i,versionDescriptor:a,includeContent:n};return this.beginRequest({apiVersion:"5.0-preview.1",httpResponseType:"text/plain",routeTemplate:"{project}/_apis/tfvc/Items/{*path}",routeValues:{project:t},queryParams:p})}async getItemZip(e,t,r,s,o,i,a,n){const p={path:e,fileName:r,download:s,scopePath:o,recursionLevel:i,versionDescriptor:a,includeContent:n};return this.beginRequest({apiVersion:"5.0-preview.1",httpResponseType:"application/zip",routeTemplate:"{project}/_apis/tfvc/Items/{*path}",routeValues:{project:t},queryParams:p})}async getLabelItems(e,t,r){const s={$top:t,$skip:r};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/tfvc/labels/{labelId}/items",routeValues:{labelId:e},queryParams:s})}async getLabel(e,t,r){const s={requestData:t};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/tfvc/Labels/{labelId}",routeValues:{project:r,labelId:e},queryParams:s})}async getLabels(e,t,r,s){const o={requestData:e,$top:r,$skip:s};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/tfvc/Labels/{labelId}",routeValues:{project:t},queryParams:o})}async getShelvesetChanges(e,t,r){const s={shelvesetId:e,$top:t,$skip:r};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/tfvc/shelvesets/changes",queryParams:s})}async getShelveset(e,t){const r={shelvesetId:e,requestData:t};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/tfvc/shelvesets",queryParams:r})}async getShelvesets(e,t,r){const s={requestData:e,$top:t,$skip:r};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/tfvc/shelvesets",queryParams:s})}async getShelvesetWorkItems(e){const t={shelvesetId:e};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/tfvc/shelvesets/workitems",queryParams:t})}async getTfvcStatistics(e,t){const r={scopePath:t};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/tfvc/stats",routeValues:{project:e},queryParams:r})}}t[e].TfvcClientName="ITfvcRestClient",t[e].getTfvcClient=function(r,s){return r.getRestClient(t[e].TfvcClientName,s)},s.RestClients.add(t[e].TfvcClientName,{factory:r,options:{resourceAreaId:"8aa40520-446d-40e6-89f6-9c9f9ce44c48",serviceInstanceType:"00025394-6065-48ca-87d9-7f5672854ef7"}})}("RestClientTfvc"),function(e){t[e]={},t[e].isDateRecent=function(e){if(!e)return!1;const t=new Date;return Math.abs(t.getTime()-e.getTime())/36e5<24},t[e].getDateString=function(e,t,r=!1){return e?t?(0,u.ago)(e):r?e.toLocaleDateString():e.toLocaleString():""}}("UtilsDate"),function(e){_=t[e]={};class r extends m.VssComponent{constructor(e,t){super(e,t),this.itemPicker=l.createRef(),this.pickerProvider=new S.RepositoryPickerProvider(t.pageContext,e.providerOptions)}render(){const{className:e,tabIndex:t,hideSelectedItemIcon:r,dropdownIconProps:s,isOpen:o,onToggleDropdown:i,ariaDescribedBy:a,onFocus:n,onFocusLost:p}=this.props;return l.createElement(h.ItemPickerDropdown,{ref:this.itemPicker,id:this.props.id,provider:this.pickerProvider,className:(0,d.css)("repository-selector",e),tabIndex:t,pickListClassName:"repository-selector-dropdown",hideSelectedItemIcon:r,dropdownIconProps:s,ariaDescribedBy:a,isOpen:o,onToggleDropdown:i,onFocus:n,onFocusLost:p})}componentDidMount(){super.componentDidMount(),this.props.componentRef&&this.props.componentRef(this)}componentWillReceiveProps(e){e.providerOptions!==this.props.providerOptions&&(this.pickerProvider=new S.RepositoryPickerProvider(this.context.pageContext,e.providerOptions))}focus(){this.itemPicker.current&&this.itemPicker.current.focus()}}t[e].RepositoryDropdownComponent=r}("ComponentsRepositoryDropdown"),function(e){t.ComponentsCommandBarRepositorySelector={};class r extends m.VssComponent{constructor(e,t){super(e,t),this.repositoryDropdown=l.createRef(),this.expand=(e,t,r)=>{this.props.expand&&this.props.expand(e,t,r)},this.onToggleDropdown=e=>{this.props.expand&&this.props.itemKey&&this.props.expand(this.props.itemKey,e)},this.getActions=()=>{const e=[];if(this.canCreateRepositories&&(e.push({name:q.NewRepository,iconProps:{iconName:"Add"},onClick:()=>{this.context.pageContext.getService("IVssLayoutManager").renderCallout((e=>l.createElement(y.LegacyComponent,{modules:["VersionControl/Scripts/Components/HeaderComponents/HeaderComponents"],wrappedType:"newRepositoryDialog",onClose:()=>{e()}},null)))}}),e.push({name:q.ImportRepository,iconProps:{iconName:"Upload"},onClick:()=>{this.context.pageContext.getService("IVssLayoutManager").renderCallout((e=>l.createElement(y.LegacyComponent,{modules:["VersionControl/Scripts/Components/HeaderComponents/HeaderComponents"],wrappedType:"importRepositoryDialog",onClose:()=>{e()}},null)))}})),this.canManageRepositories){const t=(0,a.routeUrl)(this.context.pageContext,"ms.vss-code-web.admin-version-control-route",{project:this.projectName});e.push({name:q.ManageRepositories,iconProps:{iconName:"Settings"},href:t})}return e},this.menuItemsToPickListActions=e=>{const t=[];return e.forEach((e=>{t.push({name:e.text||"",iconProps:e.iconProps,onClick:e.onActivate,href:e.href})})),t},this.getItemHref=e=>this.context.pageContext.getService("IVCNavigationService").getRepositoryUrl(e.isTfvc?null:e.name),this.initializeData(e,t),this.state={selected:!1}}render(){return this.vcData&&this.projectName?l.createElement(I.CommandBarExpandableComponent,Object.assign({},this.props,{calloutId:this.props.expanded?"dropdown"+this.componentId:void 0,className:(0,m.css)("commandbar-item-menu",this.props.className),expandOnHover:!1,id:"cmec"+this.componentId,noTabIndex:!0,expand:this.expand}),l.createElement(R.Observer,{contributedActions:this.repositoryContributedActions},(e=>l.createElement(_.RepositoryDropdownComponent,{ref:this.repositoryDropdown,className:"command-bar-repository-selector",id:"dropdown"+this.componentId,tabIndex:this.props.selected?0:-1,onFocus:this.props.onFocus,onFocusLost:this.props.onFocusLost,hideSelectedItemIcon:this.props.hideIcon,dropdownIconProps:this.props.useSmallDropdownIcon?{iconName:"ChevronDownSmall"}:void 0,providerOptions:{actions:[...this.repositoryActions,...this.menuItemsToPickListActions(e.contributedActions)],getItemHref:this.getItemHref,projectName:this.projectName,projectId:this.projectId,selectedRepositoryId:this.vcData&&this.vcData.defaultRepoId||"tfvc",selectedRepositoryName:this.vcData&&this.vcData.defaultGitRepoName,selectedRepositoryIsTfvc:this.vcData&&!this.vcData.defaultRepoIsGit,selectedRepositoryIsFork:this.vcData&&this.vcData.defaultRepoIsFork,supportsTfvc:this.vcData&&this.vcData.supportsTfvc},isOpen:this.props.expanded,onToggleDropdown:this.onToggleDropdown})))):null}componentDidUpdate(e){!e.selected&&this.props.selected&&this.repositoryDropdown.current&&this.repositoryDropdown.current.focus()}initializeData(e,t){const r=t.pageContext.getService("IVCNavigationService");this.vcData=r.getData();const s=t.pageContext.getService("ITfsPageService").getData();if(s&&s.project){this.projectName=s.project.name,this.projectId=s.project.id;const e=t.pageContext.getService("IVssSecurityService"),r=`repoV2/${this.projectId}/`;this.canCreateRepositories=e.hasPermission(T.GitConstants.GitSecurityNamespaceId,r,256),this.canManageRepositories=e.hasPermission(T.GitConstants.GitSecurityNamespaceId,r,1024)||e.hasPermission(T.GitConstants.GitSecurityNamespaceId,r,512)||e.hasPermission(T.GitConstants.GitSecurityNamespaceId,r,8192)}else this.projectName=void 0,this.projectId=void 0;this.repositoryActions=this.getActions(),this.repositoryContributedActions=(0,g.getMenuItems)(this.context.pageContext,"ms.vss-code-web.command-bar-repository-picker-actions")}hasFocus(e){return!1}}m.Components.add("navigation-repository-selector",r)}(),function(e){t.ComponentsHeaderComponents={};class r extends m.VssComponent{render(){return l.createElement(I.CommandBarChildComponent,Object.assign({},this.props,{noTabIndex:!0}),l.createElement(y.LegacyComponent,{key:this.props.wrappedComponentType,wrappedType:this.props.wrappedComponentType,modules:["VersionControl/Scripts/Components/HeaderComponents/HeaderComponents"],selected:this.props.selected}))}}r.componentType="versionControlActionHeader",m.VssComponent.register(r.componentType,r)}(),function(e){k=t[e]={};class r extends m.VssComponent{constructor(e,t){super(e,t),this.provider=new j.VersionDropdownProvider(t.pageContext,e.providerOptions)}render(){const{className:e,dropdownClassName:t,id:r,tabIndex:o,hideSelectedItemIcon:i,dropdownIconProps:a,isOpen:n,autoFocus:p,isDrodownFullWidth:c,placeholderText:u,onToggleDropdown:m,titleTooltipFormat:g}=this.props;return l.createElement(h.ItemPickerDropdown,{id:r,provider:this.provider,className:(0,d.css)("version-selector",e),tabIndex:o,pickListClassName:(0,d.css)("version-selector-dropdown",t),hideSelectedItemIcon:i,dropdownIconProps:a,pickListWidth:c?void 0:350,isOpen:n,autoFocus:p,placeholderText:u,onRenderItemText:s,onToggleDropdown:m,titleTooltipFormat:g})}componentDidMount(){super.componentDidMount(),this.props.componentRef&&this.props.componentRef(this)}componentWillReceiveProps(e){(0,v.shallowCompare)(e.providerOptions,this.props.providerOptions)||(this.provider=new j.VersionDropdownProvider(this.context.pageContext,e.providerOptions))}}function s(e,t){const{prefix:r,lastName:s}="commit"===t.kind?{lastName:e.name}:function(e){const t=e.lastIndexOf("/");return t>0?{prefix:e.substring(0,t+1),lastName:e.substring(t+1)}:{lastName:e}}(e.name);return l.createElement("span",null,r&&l.createElement("span",{className:"prefix-name"},r),s,t.isDefault&&l.createElement("span",{className:"default-badge"},q.VersionDropdown_DefaultBadge))}t[e].VersionDropdown=r}("ComponentsVersionDropdown"),function(e){t[e]={};class r extends m.VssComponent{constructor(e,t){super(e,t),this.state={}}componentDidMount(){super.componentDidMount(),this.state.gitRepository||this._fetchGitRepository()}render(){const e=Object.assign(Object.assign({},this.props.versionDropdownProps.providerOptions),{repository:this.state.gitRepository||{}}),t=Object.assign(Object.assign({},this.props.versionDropdownProps),{providerOptions:e});return l.createElement(l.Fragment,null,this.state.gitRepository?l.createElement(k.VersionDropdown,Object.assign({},t)):l.createElement(f.Spinner,null))}_fetchGitRepository(){this.context.pageContext.getService("IDeprecatedGitRepositoryService").getRepositoryById(this.props.repositoryId,this.props.projectId).then((e=>{this.setState({gitRepository:e})}))}}t[e].VersionDropdownAsync=r,m.Components.add("version-dropdown-async",r)}("ComponentsVersionDropdownAsync"),function(e){t.CreateMenuProvider={};class r extends s.VssService{constructor(){super(...arguments),this.menuItems=[]}_serviceStart(e){super._serviceStart(e);const t=this.pageContext.getService("IVCNavigationService").getData(),r=e.getService("IStartRightExtensionService");if(t){const s=this.pageContext.getService("ITfsPageService").getData();if(s&&s.project){const o=s.project.name,i=s.project.id;if(t.defaultGitRepoName){const e={project:o};t.defaultGitRepoName!==o&&(e["vc.GitRepositoryName"]=t.defaultGitRepoName),this.menuItems.push({groupKey:"vc-actions",href:(0,a.routeUrl)(this.pageContext,"ms.vss-code-web.pull-request-create-route",e),iconProps:{iconName:"BranchPullRequest"},id:"vcNewPr",onActivate:(e,t)=>(0,p.onClickFPS)(this.pageContext,e.href,!0,t),rank:100,text:q.NewPullRequest})}this.menuItems.push({groupKey:"vc-actions",id:"vcNewRepo",onActivate:()=>{if(!r.navigateToCreateRepository(e)){this.pageContext.getService("IVssLayoutManager").renderCallout((e=>l.createElement(m.WrappedComponent,{dependencies:["ms.vss-code-web.import-dependencies"],wrappedProps:{onCreate:e=>{e.then((e=>{(0,p.FastPageSwitch)(this.pageContext,e.repository.webUrl,!0)}),d.noop)},onDismiss:e,projectId:i,projectName:o},wrappedType:"ms.vss-code-web.panel-create"})))}},rank:100,text:q.NewRepository})}}}getMenuItems(e){return"ms.vss-tfs-web.vertical-header-create-menu"===e?this.menuItems:null}}s.Services.add("code-create-menu-provider",{serviceFactory:r})}()}),["Resources","Contracts/Constants","Contracts/EnumToString","Flux/Action","Flux/Store","RestClient/Git","Utils/Ref","GitRefFavoritesService","GitRefService","GitRepositoryService","Helpers","Navigation","MenuProvider","MruRouteService","Utils/Search","Utils/Telemetry","Providers/VersionDropdownProvider","RepositoryPickerProvider","RestClient/Tfvc","Utils/Date","Components/RepositoryDropdown","Components/CommandBarRepositorySelector","Components/HeaderComponents","Components/VersionDropdown","Components/VersionDropdownAsync","CreateMenuProvider"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-code-web.common-content"}}));