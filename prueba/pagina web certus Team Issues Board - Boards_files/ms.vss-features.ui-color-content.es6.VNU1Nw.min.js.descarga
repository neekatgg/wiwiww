"use strict";define("VSSUI",["require","exports","VSS/Core/Util/String","react","VSS/Core/Util/Promise","VSS/Core/Observable"],(function(e,t,o,r,n,l){var i,s,c,a,d,C,u,m;i=t[m="ResourcesColor"]={},t[m].Black="Black",t[m].Blue="Blue",t[m].EightyPercentLighterColor="80% lighter {0}",t[m].FortyPercentLighterColor="40% lighter {0}",t[m].Green="Green",t[m].Indigo="Indigo",t[m].Orange="Orange",t[m].Pink="Pink",t[m].Purple="Purple",t[m].Red="Red",t[m].SixtyPercentLighterColor="60% lighter {0}",t[m].Teal="Teal",t[m].TenPercentLighterColor="10% lighter {0}",t[m].Turquoise="Turquoise",t[m].TwentyPercentLighterColor="20% lighter {0}",t[m].White="White",t[m].Yellow="Yellow",function(e){s=t[e]={};const r="colorDropdownStyles";function n(){for(let e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].title===r)return document.styleSheets[e];const e=document.createElement("style");return e.title=r,e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}t[e].addColorClass=function(e){e=e.replace("#","");const t=n(),o=`bg-${e}`,r=`.${o} .bolt-dropdown-expandable-textfield-input`;for(let e=0;e<t.cssRules.length;e++)if(t.cssRules[e].type===CSSRule.STYLE_RULE){if(t.cssRules[e].selectorText===r)return o}return t.insertRule(`${r} { background-color: #${e}; }`),o},t[e].getStyleSheet=n;const l=[{cells:[{id:"222222",text:i.Black},{id:"292E6B",text:i.Blue},{id:"009CCC",text:i.Turquoise},{id:"00643A",text:i.Teal},{id:"339947",text:i.Green},{id:"FBBC3D",text:i.Yellow},{id:"DB552C",text:i.Orange},{id:"7F1725",text:i.Red},{id:"EC008C",text:i.Pink},{id:"5C197B",text:i.Purple},{id:"51399F",text:i.Indigo}]},{cells:[{id:"444444",text:(0,o.format)(i.TenPercentLighterColor,i.Black.toLowerCase())},{id:"1B478B",text:(0,o.format)(i.TenPercentLighterColor,i.Blue.toLowerCase())},{id:"43B4D5",text:(0,o.format)(i.TenPercentLighterColor,i.Turquoise.toLowerCase())},{id:"207752",text:(0,o.format)(i.TenPercentLighterColor,i.Teal.toLowerCase())},{id:"60AF49",text:(0,o.format)(i.TenPercentLighterColor,i.Green.toLowerCase())},{id:"FBD144",text:(0,o.format)(i.TenPercentLighterColor,i.Yellow.toLowerCase())},{id:"E87025",text:(0,o.format)(i.TenPercentLighterColor,i.Orange.toLowerCase())},{id:"B20B1E",text:(0,o.format)(i.TenPercentLighterColor,i.Red.toLowerCase())},{id:"EF33A3",text:(0,o.format)(i.TenPercentLighterColor,i.Pink.toLowerCase())},{id:"71338D",text:(0,o.format)(i.TenPercentLighterColor,i.Purple.toLowerCase())},{id:"6951AA",text:(0,o.format)(i.TenPercentLighterColor,i.Indigo.toLowerCase())}]},{cells:[{id:"666666",text:(0,o.format)(i.TwentyPercentLighterColor,i.Black.toLowerCase())},{id:"0D60AB",text:(0,o.format)(i.TwentyPercentLighterColor,i.Blue.toLowerCase())},{id:"86CDDE",text:(0,o.format)(i.TwentyPercentLighterColor,i.Turquoise.toLowerCase())},{id:"56987D",text:(0,o.format)(i.TwentyPercentLighterColor,i.Teal.toLowerCase())},{id:"8DC54B",text:(0,o.format)(i.TwentyPercentLighterColor,i.Green.toLowerCase())},{id:"FBE74B",text:(0,o.format)(i.TwentyPercentLighterColor,i.Yellow.toLowerCase())},{id:"F58B1F",text:(0,o.format)(i.TwentyPercentLighterColor,i.Orange.toLowerCase())},{id:"E60017",text:(0,o.format)(i.TwentyPercentLighterColor,i.Red.toLowerCase())},{id:"F266BA",text:(0,o.format)(i.TwentyPercentLighterColor,i.Pink.toLowerCase())},{id:"9260A1",text:(0,o.format)(i.TwentyPercentLighterColor,i.Purple.toLowerCase())},{id:"8874C2",text:(0,o.format)(i.TwentyPercentLighterColor,i.Indigo.toLowerCase())}]},{cells:[{id:"888888",text:(0,o.format)(i.FortyPercentLighterColor,i.Black.toLowerCase())},{id:"007ACC",text:(0,o.format)(i.FortyPercentLighterColor,i.Blue.toLowerCase())},{id:"C9E7E7",text:(0,o.format)(i.FortyPercentLighterColor,i.Turquoise.toLowerCase())},{id:"7CAF9A",text:(0,o.format)(i.FortyPercentLighterColor,i.Teal.toLowerCase())},{id:"A8CE4B",text:(0,o.format)(i.FortyPercentLighterColor,i.Green.toLowerCase())},{id:"FBFD52",text:(0,o.format)(i.FortyPercentLighterColor,i.Yellow.toLowerCase())},{id:"F7A24B",text:(0,o.format)(i.FortyPercentLighterColor,i.Orange.toLowerCase())},{id:"EB3345",text:(0,o.format)(i.FortyPercentLighterColor,i.Red.toLowerCase())},{id:"F599D1",text:(0,o.format)(i.FortyPercentLighterColor,i.Pink.toLowerCase())},{id:"AE88B9",text:(0,o.format)(i.FortyPercentLighterColor,i.Purple.toLowerCase())},{id:"AA9CDF",text:(0,o.format)(i.FortyPercentLighterColor,i.Indigo.toLowerCase())}]},{cells:[{id:"AAAAAA",text:(0,o.format)(i.SixtyPercentLighterColor,i.Black.toLowerCase())},{id:"3F9BD8",text:(0,o.format)(i.SixtyPercentLighterColor,i.Blue.toLowerCase())},{id:"D6EDED",text:(0,o.format)(i.SixtyPercentLighterColor,i.Turquoise.toLowerCase())},{id:"9CC3B2",text:(0,o.format)(i.SixtyPercentLighterColor,i.Teal.toLowerCase())},{id:"C3D84C",text:(0,o.format)(i.SixtyPercentLighterColor,i.Green.toLowerCase())},{id:"FCFD7D",text:(0,o.format)(i.SixtyPercentLighterColor,i.Yellow.toLowerCase())},{id:"F9B978",text:(0,o.format)(i.SixtyPercentLighterColor,i.Orange.toLowerCase())},{id:"F06673",text:(0,o.format)(i.SixtyPercentLighterColor,i.Red.toLowerCase())},{id:"F9CCE8",text:(0,o.format)(i.SixtyPercentLighterColor,i.Pink.toLowerCase())},{id:"C7ABD0",text:(0,o.format)(i.SixtyPercentLighterColor,i.Purple.toLowerCase())},{id:"C0B6E9",text:(0,o.format)(i.SixtyPercentLighterColor,i.Indigo.toLowerCase())}]},{cells:[{id:"FFFFFF",text:(0,o.format)(i.White,i.White.toLowerCase())},{id:"7FBCE5",text:(0,o.format)(i.EightyPercentLighterColor,i.Blue.toLowerCase())},{id:"E4F3F3",text:(0,o.format)(i.EightyPercentLighterColor,i.Turquoise.toLowerCase())},{id:"BFD8CD",text:(0,o.format)(i.EightyPercentLighterColor,i.Teal.toLowerCase())},{id:"D7E587",text:(0,o.format)(i.EightyPercentLighterColor,i.Green.toLowerCase())},{id:"FCFEA8",text:(0,o.format)(i.EightyPercentLighterColor,i.Yellow.toLowerCase())},{id:"FBD0A5",text:(0,o.format)(i.EightyPercentLighterColor,i.Orange.toLowerCase())},{id:"F599A2",text:(0,o.format)(i.EightyPercentLighterColor,i.Red.toLowerCase())},{id:"FBDDEF",text:(0,o.format)(i.EightyPercentLighterColor,i.Pink.toLowerCase())},{id:"E0CAE7",text:(0,o.format)(i.EightyPercentLighterColor,i.Purple.toLowerCase())},{id:"DAD4F7",text:(0,o.format)(i.EightyPercentLighterColor,i.Indigo.toLowerCase())}]}];t[e].colorRowProvider=new t.UtilitiesProvider.ArrayItemProvider(l),t[e].colorItems=l.reduce(((e,t)=>e.concat(t.cells)),[])}("ComponentsColorPickerUtils"),function(e){c=t[e]={};class o extends r.Component{constructor(){super(...arguments),this._focusedColumn=0,this.renderCell=(e,o,n,l,i)=>{var c;const a=l.cells[o],d=null===(c=this.props.selection)||void 0===c?void 0:c.value[0].beginIndex,C=a===s.colorItems[null!=d?d:0];return r.createElement(t.Table.SimpleTableCell,{ariaRowIndex:i,columnIndex:o,key:o,tableColumn:n},r.createElement(t.Button.Button,{id:`${e}-${o}`,className:(0,t.Util.css)(C&&"bolt-dropdown-init-focus","color-button flex-grow"),style:{backgroundColor:"#"+a.id},tooltipProps:{text:a.text},onClick:e=>{var t;const o=s.colorItems.findIndex((e=>e.id===a.id));o>=0&&(null===(t=this.props.selection)||void 0===t||t.select(o),this.props.onSelect&&this.props.onSelect(e,s.colorItems[o]),this.props.onDismiss())},onFocus:()=>this._focusedColumn=o,onKeyDown:e=>{0===o&&37===e.which&&e.preventDefault()}}))},this.columns=[{id:"c1",renderCell:this.renderCell,width:-100/11},{id:"c2",renderCell:this.renderCell,width:-100/11},{id:"c3",renderCell:this.renderCell,width:-100/11},{id:"c4",renderCell:this.renderCell,width:-100/11},{id:"c5",renderCell:this.renderCell,width:-100/11},{id:"c6",renderCell:this.renderCell,width:-100/11},{id:"c7",renderCell:this.renderCell,width:-100/11},{id:"c8",renderCell:this.renderCell,width:-100/11},{id:"c9",renderCell:this.renderCell,width:-100/11},{id:"c10",renderCell:this.renderCell,width:-100/11},{id:"c11",renderCell:this.renderCell,width:-100/11}]}render(){const{anchorElement:e,anchorOffset:o,anchorOrigin:l,anchorPoint:i,blurDismiss:c=!0,calloutContentClassName:a,contentLocation:d,dropdownOrigin:C,excludeTabStop:u,id:m,lightDismiss:h,onFilterKeyDown:w}=this.props,L=()=>{this.props.onDismiss&&this.props.onDismiss()};return r.createElement(t.Callout.Callout,{anchorElement:e,anchorOffset:o,anchorOrigin:l,anchorPoint:i,blurDismiss:c,calloutOrigin:C,contentClassName:(0,t.Util.css)(a,"bolt-dropdown flex-column custom-scrollbar v-scroll-auto h-scroll-hidden color-dropdown-callout"),contentLocation:d,contentShadow:!0,contentSize:3,escDismiss:!0,id:m,lightDismiss:h,focuszoneProps:{postprocessKeyStroke:e=>9!==e.which||e.defaultPrevented?1:(e.preventDefault(),L(),3)},onDismiss:L},r.createElement(t.FocusZone.FocusZone,{circularNavigation:!0,defaultActiveElement:".bolt-dropdown-init-focus",direction:2,focusOnMount:true},r.createElement("div",{className:"bolt-dropdown-container no-outline",onKeyDown:w},r.createElement("div",{"aria-hidden":"true",className:"no-outline",tabIndex:u?void 0:-1,role:"listbox"}),r.createElement(t.Table.Table,{columns:this.columns,containerClassName:"color-dropdown-table-container",itemProvider:s.colorRowProvider,onFocus:async(e,t)=>{const o=e.nativeEvent;if(await(0,n.wait)(0),"TR"===o.target.tagName){const e=o.target.querySelector(`td[data-column-index="${this._focusedColumn}"] button`);e&&e!==document.activeElement&&e.focus()}}}))))}}t[e].ColorDropdownCalloutComponent=o}("ComponentsColorPickerColorCallout"),function(e){function o(e){return r.createElement(c.ColorDropdownCalloutComponent,Object.assign({},e))}a=t[e]={},t[e].ColorDropdown=function({ariaLabel:e,className:n,color:i,disabled:c,onColorSelected:a}){const d=r.useRef(new t.List.ListSelection),[C]=(0,l.useObservable)("#000000");r.useEffect((()=>{C.value=i;const e=s.colorItems.findIndex((e=>"#"+e.id===i));d.current.select(e>=0?e:0)}),[i]);const u=(0,s.addColorClass)(i);return r.createElement(t.Dropdown.Dropdown,{ariaLabel:e,className:(0,t.Util.css)(n,u,"color-dropdown"),dismissOnSelect:!0,disabled:c,items:s.colorItems,renderCallout:o,renderSelectedItems:()=>"",selection:d.current,onSelect:(e,t)=>{a("#"+t.id)}})},t[e].ColorDropdownCallout=o}("ComponentsColorPickerColorDropdown"),function(e){d=t[e]={},t[e].ExpandableColorButton=function({ariaLabel:e,className:o,color:n,onColorSelected:i}){const c=r.useRef(new t.List.ListSelection),[d]=(0,l.useObservable)("#000000");r.useEffect((()=>{d.value=n;const e=s.colorItems.findIndex((e=>"#"+e.id===n));c.current.select(e>=0?e:0)}),[n]);const C=(0,s.addColorClass)(n),u=(e,t)=>{d.value="#"+t.id,i("#"+t.id)};return r.createElement("div",{className:"flex-column justify-center color-callout"},r.createElement(t.Button.ExpandableButton,{ariaLabel:e,className:(0,t.Util.css)(o,C,"color-dropdown color-callout"),renderCallout:(e,t,o,n,i,d,C)=>r.createElement(a.ColorDropdownCallout,{id:t,focusOnMount:!0,anchorElement:o,anchorOffset:n,anchorOrigin:i,anchorPoint:d,dropdownOrigin:C,blurDismiss:!0,lightDismiss:!0,onDismiss:e.collapse,items:s.colorItems,filterText:new l.ObservableValue(""),onSelect:u,selection:c.current}),iconProps:{iconName:"FontColor",size:"medium"},hideDropdownIcon:!0}),r.createElement(t.Observer.Observer,{color:d},(e=>r.createElement("div",{className:"style-rule-font-color-bar",style:{backgroundColor:e.color}}))))}}("ComponentsColorPickerExpandableColorButton"),function(e){C=t[e]={};class o extends r.Component{constructor(){super(...arguments),this.rootRef=r.createRef(),this.onClick=e=>{this.props.onClick&&this.props.onClick(e,this.props.color)}}render(){const{className:e,color:o,isSelected:n}=this.props;return r.createElement(t.FocusZone.FocusZoneContext.Consumer,null,(l=>r.createElement("div",{ref:this.rootRef,className:(0,t.Util.css)(e,"bolt-colorpip"),onClick:this.onClick,"data-focuszone":l.focuszoneId,tabIndex:n?0:-1},r.createElement("div",{className:(0,t.Util.css)("bolt-colorpip-content",n&&"selected"),style:o?{backgroundColor:(0,t.UtilitiesColor.getColorString)(o)}:void 0}))))}}t[e].ColorPip=o}("ComponentsColorPipColorPip"),function(e){u=t[e]={};t[e].ColorSwatchPicker=e=>{const{colors:o,className:n,onPipClick:l,selectedIndex:i}=e;return r.createElement(t.FocusZone.FocusZone,{activateOnEnter:!0,direction:1},r.createElement("div",{className:(0,t.Util.css)("bolt-colorswatchpicker flex-row",n)},r.createElement(t.Observer.Observer,{selectedIndex:i},(e=>o.map(((t,o)=>r.createElement(C.ColorPip,{key:o,color:t,isSelected:e.selectedIndex===o,onClick:(e,t)=>l(e,t,o)})))))))}}("ComponentsColorSwatchPickerColorSwatchPicker"),function(e){t[e]={},Object.defineProperty(t[e],"ColorDropdown",{enumerable:!0,get:function(){return a.ColorDropdown}}),Object.defineProperty(t[e],"ExpandableColorButton",{enumerable:!0,get:function(){return d.ExpandableColorButton}}),Object.defineProperty(t[e],"ColorPip",{enumerable:!0,get:function(){return C.ColorPip}}),Object.defineProperty(t[e],"ColorSwatchPicker",{enumerable:!0,get:function(){return u.ColorSwatchPicker}})}("Color")}),["Resources.Color","Components/ColorPicker/Utils","Components/ColorPicker/ColorCallout","Components/ColorPicker/ColorDropdown","Components/ColorPicker/ExpandableColorButton","Components/ColorPip/ColorPip","Components/ColorSwatchPicker/ColorSwatchPicker","Color"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-color-content"}}));