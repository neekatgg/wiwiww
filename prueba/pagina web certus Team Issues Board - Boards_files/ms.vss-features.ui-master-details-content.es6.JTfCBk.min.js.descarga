"use strict";define("VSSUI",["require","exports","react","VSS/Core/Observable","VSS/Core/TimerManagement","VSS/Core/Util/Accessibility"],(function(e,t,a,n,r,l){var s,i,c,o,u,d;!function(e){s=t[e]={};class r{constructor(e,t){this.hideDetailsPanel=new n.ObservableValue(!1),this.getCurrentLayer=()=>this.payload,this.getStack=()=>this.payloadStack,this.push=e=>{this.payloadStack.push(e),e.onPushed&&e.onPushed(this),this.payload.value=this.payloadStack[this.payloadStack.length-1]},this.pop=()=>{const e=this.payloadStack.pop();return e&&e.onPopped&&e.onPopped(this),this.payloadStack.length>0?this.payload.value=this.payloadStack[this.payloadStack.length-1]:this.onExit(),e},this.setDetailsPanelVisbility=e=>{this.hideDetailsPanel.value=!e},this.payload=new n.ObservableValue(e),this.payloadStack=[e],this.onExit=t,e.onPushed&&e.onPushed(this)}}t[e].BaseMasterDetailsContext=r,t[e].MasterDetailsContext=a.createContext(new r({key:"",masterPanelContent:{},detailsContent:{renderContent:()=>a.createElement("div",null)},selectedMasterItem:new n.ObservableValue(null)},(()=>{}))),t[e].bindSelectionToObservable=function(e,t,a){const n=t.value.findIndex((e=>e===a.value));n>=0&&e.select(n),e.subscribe((e=>{if(e[0]){const n=e[0].beginIndex;a.value=t.value[n]}}))},t[e].createChildLayer=function(e,t,a,r,l,s,i){return{key:e,masterPanelContent:t,detailsContent:a,selectedMasterItem:new n.ObservableValue(r),parentItem:l.selectedMasterItem.value,onPushed:s,ariaLabel:i}}}("ContextMasterDetailsContext"),i=t[d="MasterDetailsContext"]={},Object.defineProperty(t[d],"MasterDetailsContext",{enumerable:!0,get:function(){return s.MasterDetailsContext}}),Object.defineProperty(t[d],"BaseMasterDetailsContext",{enumerable:!0,get:function(){return s.BaseMasterDetailsContext}}),Object.defineProperty(t[d],"bindSelectionToObservable",{enumerable:!0,get:function(){return s.bindSelectionToObservable}}),Object.defineProperty(t[d],"createChildLayer",{enumerable:!0,get:function(){return s.createChildLayer}}),function(e){c=t[e]={};t[e].DetailsPanel=e=>{const n=a.useContext(i.MasterDetailsContext);return a.createElement(t.Surface.Surface,{background:1},a.createElement("div",{className:(0,t.Util.css)(e.className,"bolt-details-panel flex-row flex-grow")},a.createElement(t.Observer.Observer,{masterDetailsLayer:n.getCurrentLayer()},(e=>a.createElement(t.Observer.Observer,{selectedItem:e.masterDetailsLayer.selectedMasterItem,hideDetailsPanel:n.hideDetailsPanel},(t=>!t.hideDetailsPanel&&e.masterDetailsLayer.detailsContent.renderContent(t.selectedItem)))))))}}("ComponentsDetailsPanelDetailsPanel"),function(e){o=t[e]={};t[e].SingleLayerMasterPanel=e=>{const{className:l,renderContent:s,renderHeader:i,renderSearch:c,showOnSmallScreens:o=!1}=e,[u,d]=(0,n.useObservable)(!1),m=a.useRef(null),h=a.useRef(null),b=a.useRef(null),f=a.useRef(null),p=a.useRef(0),P=a.useRef(0),C=a.useRef(new r.TimerManagement),y=a.useRef(!1),S=a.useRef(),v=()=>{if(m.current&&f.current){const e=m.current.scrollTop;u.value&&!y.current&&0===e?d(!1):u.value||p.current+f.current.clientHeight>m.current.clientHeight&&P.current+f.current.clientHeight<m.current.clientHeight||(y.current=!0,S.current&&C.current.clearTimeout(S.current),S.current=C.current.setTimeout((()=>{y.current=!1,v()}),100),d(!0))}},g=e=>{if(e&&(e.id="",e.hasChildNodes())){const t=e.children;for(let e=0;e<t.length;e++)g(t.item(e))}};return a.useEffect((()=>(h.current&&(p.current=h.current.clientHeight),b.current&&(g(b.current),P.current=b.current.clientHeight),document.addEventListener("resize",v),()=>{document.removeEventListener("resize",v),C.current.dispose()})),[]),a.createElement(t.Intersection.Intersection,null,a.createElement("div",{className:(0,t.Util.css)(l,"bolt-master-panel flex-column flex-noshrink scroll-auto",o&&"show-on-small-screens"),onScroll:v,ref:m},i&&a.createElement(a.Fragment,null,a.createElement(t.Observer.Observer,{isScrolled:u},(e=>a.createElement("div",{className:(0,t.Util.css)("bolt-master-panel-header",c&&"has-search",e.isScrolled&&"content-scrolled"),ref:h},i()))),a.createElement("div",{"aria-hidden":"true",className:(0,t.Util.css)("bolt-master-panel-header hide",c&&"has-search","content-scrolled"),ref:b},i())),a.createElement("div",{className:"bolt-master-panel-content flex-column",ref:f},c&&a.createElement("div",{className:"bolt-master-panel-search"},c()),s&&s())))};t[e].SingleLayerMasterPanelHeader=e=>{const{title:n,titleAriaLevel:r,subTitle:l,onBackButtonClick:s}=e;return a.createElement(t.Header.Header,{backButtonProps:s?{onClick:s,subtle:!0}:void 0,className:"bolt-master-panel-standard-header",description:l,descriptionClassName:"bolt-master-panel-header-subtitle bolt-master-panel-header-secondary",title:n,titleAriaLevel:r,titleClassName:"bolt-master-panel-header-title",titleSize:1})}}("ComponentsSingleLayerMasterPanelSingleLayerMasterPanel"),function(e){u=t[e]={};t[e].MasterPanel=e=>{const{className:r,showOnSmallScreens:l}=e,s=(a.useRef(null),a.useContext(i.MasterDetailsContext));return a.createElement(t.Surface.Surface,{background:1},a.createElement(t.Observer.Observer,{masterDetailsLayer:s.getCurrentLayer(),hideDetailsPanel:s.hideDetailsPanel},(e=>a.createElement(n,{className:(0,t.Util.css)(r,e.hideDetailsPanel&&"full-screen"),layer:e.masterDetailsLayer,showOnSmallScreens:l||e.hideDetailsPanel}))))};const n=e=>{const{className:t,layer:n,showOnSmallScreens:r}=e,s=a.createRef(),i=a.useRef(!0);a.useEffect((()=>{i.current?i.current=!1:(s.current&&s.current.focus(),l.announce(n.ariaLabel))}),[e.layer]);const c=n.masterPanelContent,u=n.parentItem,d=n.selectedMasterItem,m=c.renderHeader?()=>c.renderHeader(u):void 0,h=c.renderSearch?()=>c.renderSearch(u):void 0,b=c.renderContent?()=>c.renderContent(u,d):void 0;return a.createElement(a.Fragment,null,a.createElement("div",{ref:s,tabIndex:-1}),a.createElement(o.SingleLayerMasterPanel,{className:t,key:`master-panel-${n.key}`,renderContent:b,renderHeader:m,renderSearch:h,showOnSmallScreens:r}))};t[e].MasterPanelHeader=e=>{const t=a.useContext(i.MasterDetailsContext),n=t.getCurrentLayer().value.masterPanelContent;return a.createElement(o.SingleLayerMasterPanelHeader,Object.assign({},e,{onBackButtonClick:!1!==n.hideBackButton?void 0:()=>{!1!==(n.onBackButtonClick&&n.onBackButtonClick())&&t.pop()}}))}}("ComponentsMasterPanelMasterPanel"),function(e){t[e]={},Object.defineProperty(t[e],"DetailsPanel",{enumerable:!0,get:function(){return c.DetailsPanel}}),Object.defineProperty(t[e],"MasterPanel",{enumerable:!0,get:function(){return u.MasterPanel}}),Object.defineProperty(t[e],"MasterPanelHeader",{enumerable:!0,get:function(){return u.MasterPanelHeader}}),Object.defineProperty(t[e],"SingleLayerMasterPanel",{enumerable:!0,get:function(){return o.SingleLayerMasterPanel}}),Object.defineProperty(t[e],"SingleLayerMasterPanelHeader",{enumerable:!0,get:function(){return o.SingleLayerMasterPanelHeader}})}("MasterDetails")}),["Context/MasterDetailsContext","MasterDetailsContext","Components/DetailsPanel/DetailsPanel","Components/SingleLayerMasterPanel/SingleLayerMasterPanel","Components/MasterPanel/MasterPanel","MasterDetails"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-master-details-content"}}));